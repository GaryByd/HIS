11:04:30:072  INFO 32776 --- [main] c.l.his_service.HisServiceApplication    : Starting HisServiceApplication using Java 17.0.11 on luo with PID 32776 (A:\Desktop\workspace\HIS\his_service\target\classes started by 22407 in A:\Desktop\workspace\HIS)
11:04:30:078 DEBUG 32776 --- [main] c.l.his_service.HisServiceApplication    : Running with Spring Boot v2.7.12, Spring v5.3.27
11:04:30:079  INFO 32776 --- [main] c.l.his_service.HisServiceApplication    : The following 1 profile is active: "dev"
11:04:31:699  INFO 32776 --- [main] .s.d.r.c.RepositoryConfigurationDelegate : Multiple Spring Data modules found, entering strict repository configuration mode
11:04:31:702  INFO 32776 --- [main] .s.d.r.c.RepositoryConfigurationDelegate : Bootstrapping Spring Data Redis repositories in DEFAULT mode.
11:04:31:735  INFO 32776 --- [main] .s.d.r.c.RepositoryConfigurationDelegate : Finished Spring Data repository scanning in 15 ms. Found 0 Redis repository interfaces.
11:04:32:011  INFO 32776 --- [main] o.s.cloud.context.scope.GenericScope     : BeanFactory id=6223b6d6-9ee6-3c52-951c-fcc2980a1fa1
11:04:32:718  INFO 32776 --- [main] o.s.b.w.embedded.tomcat.TomcatWebServer  : Tomcat initialized with port(s): 8080 (http)
11:04:32:727  INFO 32776 --- [main] o.apache.catalina.core.StandardService   : Starting service [Tomcat]
11:04:32:727  INFO 32776 --- [main] org.apache.catalina.core.StandardEngine  : Starting Servlet engine: [Apache Tomcat/9.0.75]
11:04:32:856  INFO 32776 --- [main] o.a.c.c.C.[Tomcat].[localhost].[/]       : Initializing Spring embedded WebApplicationContext
11:04:32:856  INFO 32776 --- [main] w.s.c.ServletWebServerApplicationContext : Root WebApplicationContext: initialization completed in 2707 ms
11:04:33:119  INFO 32776 --- [main] org.redisson.Version                     : Redisson 3.17.7
11:04:33:544  INFO 32776 --- [redisson-netty-2-9] o.r.c.pool.MasterPubSubConnectionPool    : 1 connections initialized for 111.230.32.147/111.230.32.147:9631
11:04:34:426  INFO 32776 --- [redisson-netty-2-19] o.r.c.pool.MasterConnectionPool          : 24 connections initialized for 111.230.32.147/111.230.32.147:9631
11:04:35:071 DEBUG 32776 --- [main] c.l.h.filter.RefreshTokenFilter          : Filter 'refreshTokenFilter' configured for use
11:04:36:319  INFO 32776 --- [main] o.s.c.openfeign.FeignClientFactoryBean   : For 'flask-service' URL not provided. Will try picking an instance via load-balancing.
11:04:36:454  INFO 32776 --- [main] o.s.c.openfeign.FeignClientFactoryBean   : For 'ai-service' URL not provided. Will try picking an instance via load-balancing.
11:04:36:503  WARN 32776 --- [main] c.b.m.core.metadata.TableInfoHelper      : Can not find table primary key in Class: "java.lang.Object".
11:04:36:503  WARN 32776 --- [main] c.b.m.core.injector.DefaultSqlInjector   : class java.lang.Object ,Not found @TableId annotation, Cannot use Mybatis-Plus 'xxById' Method.
11:04:38:339  WARN 32776 --- [main] iguration$LoadBalancerCaffeineWarnLogger : Spring Cloud LoadBalancer is currently working with the default cache. While this cache implementation is useful for development and tests, it's recommended to use Caffeine cache in production.You can switch to using Caffeine cache, by adding it and org.springframework.cache.caffeine.CaffeineCacheManager to the classpath.
11:04:38:347  INFO 32776 --- [main] o.s.b.a.e.web.EndpointLinksResolver      : Exposing 1 endpoint(s) beneath base path '/actuator'
11:04:38:440  INFO 32776 --- [main] o.s.b.w.embedded.tomcat.TomcatWebServer  : Tomcat started on port(s): 8080 (http) with context path ''
11:04:38:712  INFO 32776 --- [main] c.l.his_service.HisServiceApplication    : Started HisServiceApplication in 9.797 seconds (JVM running for 11.232)
11:04:39:285  INFO 32776 --- [RMI TCP Connection(1)-10.21.194.87] o.a.c.c.C.[Tomcat].[localhost].[/]       : Initializing Spring DispatcherServlet 'dispatcherServlet'
11:04:39:286  INFO 32776 --- [RMI TCP Connection(1)-10.21.194.87] o.s.web.servlet.DispatcherServlet        : Initializing Servlet 'dispatcherServlet'
11:04:39:286  INFO 32776 --- [RMI TCP Connection(2)-10.21.194.87] com.zaxxer.hikari.HikariDataSource       : HikariPool-1 - Starting...
11:04:39:287  INFO 32776 --- [RMI TCP Connection(1)-10.21.194.87] o.s.web.servlet.DispatcherServlet        : Completed initialization in 1 ms
11:04:40:308  INFO 32776 --- [RMI TCP Connection(2)-10.21.194.87] com.zaxxer.hikari.HikariDataSource       : HikariPool-1 - Start completed.
11:04:46:611  INFO 32776 --- [SpringApplicationShutdownHook] com.zaxxer.hikari.HikariDataSource       : HikariPool-1 - Shutdown initiated...
11:04:46:922  INFO 32776 --- [SpringApplicationShutdownHook] com.zaxxer.hikari.HikariDataSource       : HikariPool-1 - Shutdown completed.
11:04:51:377  INFO 27448 --- [main] c.l.his_service.HisServiceApplication    : Starting HisServiceApplication using Java 17.0.11 on luo with PID 27448 (A:\Desktop\workspace\HIS\his_service\target\classes started by 22407 in A:\Desktop\workspace\HIS)
11:04:51:379 DEBUG 27448 --- [main] c.l.his_service.HisServiceApplication    : Running with Spring Boot v2.7.12, Spring v5.3.27
11:04:51:379  INFO 27448 --- [main] c.l.his_service.HisServiceApplication    : The following 1 profile is active: "dev"
11:04:52:416  INFO 27448 --- [main] .s.d.r.c.RepositoryConfigurationDelegate : Multiple Spring Data modules found, entering strict repository configuration mode
11:04:52:419  INFO 27448 --- [main] .s.d.r.c.RepositoryConfigurationDelegate : Bootstrapping Spring Data Redis repositories in DEFAULT mode.
11:04:52:450  INFO 27448 --- [main] .s.d.r.c.RepositoryConfigurationDelegate : Finished Spring Data repository scanning in 15 ms. Found 0 Redis repository interfaces.
11:04:52:705  INFO 27448 --- [main] o.s.cloud.context.scope.GenericScope     : BeanFactory id=6223b6d6-9ee6-3c52-951c-fcc2980a1fa1
11:04:53:334  INFO 27448 --- [main] o.s.b.w.embedded.tomcat.TomcatWebServer  : Tomcat initialized with port(s): 8080 (http)
11:04:53:342  INFO 27448 --- [main] o.apache.catalina.core.StandardService   : Starting service [Tomcat]
11:04:53:343  INFO 27448 --- [main] org.apache.catalina.core.StandardEngine  : Starting Servlet engine: [Apache Tomcat/9.0.75]
11:04:53:493  INFO 27448 --- [main] o.a.c.c.C.[Tomcat].[localhost].[/]       : Initializing Spring embedded WebApplicationContext
11:04:53:493  INFO 27448 --- [main] w.s.c.ServletWebServerApplicationContext : Root WebApplicationContext: initialization completed in 2061 ms
11:04:53:713  INFO 27448 --- [main] org.redisson.Version                     : Redisson 3.17.7
11:04:54:077  INFO 27448 --- [redisson-netty-2-9] o.r.c.pool.MasterPubSubConnectionPool    : 1 connections initialized for 111.230.32.147/111.230.32.147:9631
11:04:54:916  INFO 27448 --- [redisson-netty-2-19] o.r.c.pool.MasterConnectionPool          : 24 connections initialized for 111.230.32.147/111.230.32.147:9631
11:04:55:171 DEBUG 27448 --- [main] c.l.h.filter.RefreshTokenFilter          : Filter 'refreshTokenFilter' configured for use
11:04:55:879  INFO 27448 --- [main] o.s.c.openfeign.FeignClientFactoryBean   : For 'flask-service' URL not provided. Will try picking an instance via load-balancing.
11:04:55:988  INFO 27448 --- [main] o.s.c.openfeign.FeignClientFactoryBean   : For 'ai-service' URL not provided. Will try picking an instance via load-balancing.
11:04:56:028  WARN 27448 --- [main] c.b.m.core.metadata.TableInfoHelper      : Can not find table primary key in Class: "java.lang.Object".
11:04:56:028  WARN 27448 --- [main] c.b.m.core.injector.DefaultSqlInjector   : class java.lang.Object ,Not found @TableId annotation, Cannot use Mybatis-Plus 'xxById' Method.
11:04:57:051  WARN 27448 --- [main] iguration$LoadBalancerCaffeineWarnLogger : Spring Cloud LoadBalancer is currently working with the default cache. While this cache implementation is useful for development and tests, it's recommended to use Caffeine cache in production.You can switch to using Caffeine cache, by adding it and org.springframework.cache.caffeine.CaffeineCacheManager to the classpath.
11:04:57:058  INFO 27448 --- [main] o.s.b.a.e.web.EndpointLinksResolver      : Exposing 1 endpoint(s) beneath base path '/actuator'
11:04:57:139  INFO 27448 --- [main] o.s.b.w.embedded.tomcat.TomcatWebServer  : Tomcat started on port(s): 8080 (http) with context path ''
11:04:57:443  INFO 27448 --- [main] c.l.his_service.HisServiceApplication    : Started HisServiceApplication in 6.94 seconds (JVM running for 8.321)
11:04:57:868  INFO 27448 --- [RMI TCP Connection(2)-10.21.194.87] o.a.c.c.C.[Tomcat].[localhost].[/]       : Initializing Spring DispatcherServlet 'dispatcherServlet'
11:04:57:869  INFO 27448 --- [RMI TCP Connection(2)-10.21.194.87] o.s.web.servlet.DispatcherServlet        : Initializing Servlet 'dispatcherServlet'
11:04:57:873  INFO 27448 --- [RMI TCP Connection(2)-10.21.194.87] o.s.web.servlet.DispatcherServlet        : Completed initialization in 3 ms
11:04:57:873  INFO 27448 --- [RMI TCP Connection(1)-10.21.194.87] com.zaxxer.hikari.HikariDataSource       : HikariPool-1 - Starting...
11:04:58:600  INFO 27448 --- [RMI TCP Connection(1)-10.21.194.87] com.zaxxer.hikari.HikariDataSource       : HikariPool-1 - Start completed.
11:06:01:140  WARN 27448 --- [http-nio-8080-exec-2] o.a.c.util.SessionIdGeneratorBase        : Creation of SecureRandom instance for session ID generation using [SHA1PRNG] took [121] milliseconds.
11:06:02:016 DEBUG 27448 --- [http-nio-8080-exec-2] c.l.h.m.PatientMapper.selectIdByOpenId   : ==>  Preparing: select id, open_id, phone, name, verified, hospital_pid from patient where open_id = ?
11:06:02:042 DEBUG 27448 --- [http-nio-8080-exec-2] c.l.h.m.PatientMapper.selectIdByOpenId   : ==> Parameters: owhoa7fITbB2gA1N4dxwWmjN8Xsw(String)
11:06:02:147 DEBUG 27448 --- [http-nio-8080-exec-2] c.l.h.m.PatientMapper.selectIdByOpenId   : <==      Total: 1
11:06:35:414  WARN 27448 --- [http-nio-8080-exec-4] .w.s.m.s.DefaultHandlerExceptionResolver : Resolved [org.springframework.http.converter.HttpMessageNotReadableException: Required request body is missing: public com.luojiawei.his_service.domain.dto.Result<com.luojiawei.his_service.domain.dto.DiagnosisReportDetails> com.luojiawei.his_service.controller.ChatController.ask(java.lang.Integer,com.luojiawei.his_service.domain.dto.QuestionForm)]
11:07:02:895 DEBUG 27448 --- [http-nio-8080-exec-5] c.l.h.m.D.selectById                     : ==>  Preparing: SELECT id,patient_id,doctor_id,disease_name,disease_category,aimodel_id,result,create_time,status,id_card,name,score,remark FROM diagnosis_report WHERE id=?
11:07:02:896 DEBUG 27448 --- [http-nio-8080-exec-5] c.l.h.m.D.selectById                     : ==> Parameters: 1(Integer)
11:07:02:951 DEBUG 27448 --- [http-nio-8080-exec-5] c.l.h.m.D.selectById                     : <==      Total: 1
11:07:02:952 DEBUG 27448 --- [http-nio-8080-exec-5] c.l.h.mapper.PatientMapper.selectById    : ==>  Preparing: SELECT id,phone,id_card,name,verified,verified_by,verified_time,open_id,hospital_pid FROM patient WHERE id=?
11:07:02:953 DEBUG 27448 --- [http-nio-8080-exec-5] c.l.h.mapper.PatientMapper.selectById    : ==> Parameters: 1(Integer)
11:07:03:016 DEBUG 27448 --- [http-nio-8080-exec-5] c.l.h.mapper.PatientMapper.selectById    : <==      Total: 1
11:07:03:017 DEBUG 27448 --- [http-nio-8080-exec-5] c.l.h.mapper.DoctorMapper.selectById     : ==>  Preparing: SELECT id,phone,id_card,name,verified,verified_by,verified_time,license,department,hospital_pid FROM doctor WHERE id=?
11:07:03:018 DEBUG 27448 --- [http-nio-8080-exec-5] c.l.h.mapper.DoctorMapper.selectById     : ==> Parameters: 1(Integer)
11:07:03:125 DEBUG 27448 --- [http-nio-8080-exec-5] c.l.h.mapper.DoctorMapper.selectById     : <==      Total: 1
11:07:03:128 DEBUG 27448 --- [http-nio-8080-exec-5] c.l.h.m.E.selectListByDiagnosisId        : ==>  Preparing: select * from eye_images where dignosis_report_id = ?
11:07:03:128 DEBUG 27448 --- [http-nio-8080-exec-5] c.l.h.m.E.selectListByDiagnosisId        : ==> Parameters: 1(Integer)
11:07:03:175 DEBUG 27448 --- [http-nio-8080-exec-5] c.l.h.m.E.selectListByDiagnosisId        : <==      Total: 1
11:07:03:176 DEBUG 27448 --- [http-nio-8080-exec-5] c.l.h.m.T.selectByDiagnosisId            : ==>  Preparing: select * from treatment_plans where diagnosis_id = ?
11:07:03:176 DEBUG 27448 --- [http-nio-8080-exec-5] c.l.h.m.T.selectByDiagnosisId            : ==> Parameters: 1(Integer)
11:07:03:235 DEBUG 27448 --- [http-nio-8080-exec-5] c.l.h.m.T.selectByDiagnosisId            : <==      Total: 1
11:07:03:236 DEBUG 27448 --- [http-nio-8080-exec-5] c.l.h.m.M.selectByDiagnosisId            : ==>  Preparing: select * from medication_recommendations where diagnosis_id = ?
11:07:03:237 DEBUG 27448 --- [http-nio-8080-exec-5] c.l.h.m.M.selectByDiagnosisId            : ==> Parameters: 1(Integer)
11:07:03:286 DEBUG 27448 --- [http-nio-8080-exec-5] c.l.h.m.M.selectByDiagnosisId            : <==      Total: 1
11:07:03:287 DEBUG 27448 --- [http-nio-8080-exec-5] c.l.h.mapper.AiModelMapper.selectById    : ==>  Preparing: SELECT id,version,deploy_time,accuracy FROM ai_model WHERE id=?
11:07:03:288 DEBUG 27448 --- [http-nio-8080-exec-5] c.l.h.mapper.AiModelMapper.selectById    : ==> Parameters: 1(Integer)
11:07:03:355 DEBUG 27448 --- [http-nio-8080-exec-5] c.l.h.mapper.AiModelMapper.selectById    : <==      Total: 1
11:07:18:798  INFO 27448 --- [SpringApplicationShutdownHook] com.zaxxer.hikari.HikariDataSource       : HikariPool-1 - Shutdown initiated...
11:07:19:112  INFO 27448 --- [SpringApplicationShutdownHook] com.zaxxer.hikari.HikariDataSource       : HikariPool-1 - Shutdown completed.
15:28:19:057  INFO 5140 --- [main] c.l.his_service.HisServiceApplication    : Starting HisServiceApplication using Java 17.0.11 on luo with PID 5140 (A:\Desktop\workspace\HIS\his_service\target\classes started by 22407 in A:\Desktop\workspace\HIS)
15:28:19:063 DEBUG 5140 --- [main] c.l.his_service.HisServiceApplication    : Running with Spring Boot v2.7.12, Spring v5.3.27
15:28:19:063  INFO 5140 --- [main] c.l.his_service.HisServiceApplication    : The following 1 profile is active: "dev"
15:28:23:183  INFO 5140 --- [main] .s.d.r.c.RepositoryConfigurationDelegate : Multiple Spring Data modules found, entering strict repository configuration mode
15:28:23:204  INFO 5140 --- [main] .s.d.r.c.RepositoryConfigurationDelegate : Bootstrapping Spring Data Redis repositories in DEFAULT mode.
15:28:23:378  INFO 5140 --- [main] .s.d.r.c.RepositoryConfigurationDelegate : Finished Spring Data repository scanning in 31 ms. Found 0 Redis repository interfaces.
15:28:24:409  INFO 5140 --- [main] o.s.cloud.context.scope.GenericScope     : BeanFactory id=6223b6d6-9ee6-3c52-951c-fcc2980a1fa1
15:28:25:982  INFO 5140 --- [main] o.s.b.w.embedded.tomcat.TomcatWebServer  : Tomcat initialized with port(s): 8080 (http)
15:28:25:996  INFO 5140 --- [main] o.apache.catalina.core.StandardService   : Starting service [Tomcat]
15:28:25:997  INFO 5140 --- [main] org.apache.catalina.core.StandardEngine  : Starting Servlet engine: [Apache Tomcat/9.0.75]
15:28:26:213  INFO 5140 --- [main] o.a.c.c.C.[Tomcat].[localhost].[/]       : Initializing Spring embedded WebApplicationContext
15:28:26:213  INFO 5140 --- [main] w.s.c.ServletWebServerApplicationContext : Root WebApplicationContext: initialization completed in 6914 ms
15:28:26:588  INFO 5140 --- [main] org.redisson.Version                     : Redisson 3.17.7
15:28:27:549  INFO 5140 --- [redisson-netty-2-9] o.r.c.pool.MasterPubSubConnectionPool    : 1 connections initialized for 111.230.32.147/111.230.32.147:9631
15:28:28:286  INFO 5140 --- [redisson-netty-2-19] o.r.c.pool.MasterConnectionPool          : 24 connections initialized for 111.230.32.147/111.230.32.147:9631
15:28:29:437 DEBUG 5140 --- [main] c.l.h.filter.RefreshTokenFilter          : Filter 'refreshTokenFilter' configured for use
15:28:30:867  WARN 5140 --- [main] ConfigServletWebServerApplicationContext : Exception encountered during context initialization - cancelling refresh attempt: org.springframework.beans.factory.UnsatisfiedDependencyException: Error creating bean with name 'aiModelController' defined in file [A:\Desktop\workspace\HIS\his_service\target\classes\com\luojiawei\his_service\controller\AiModelController.class]: Unsatisfied dependency expressed through constructor parameter 0; nested exception is org.springframework.beans.factory.UnsatisfiedDependencyException: Error creating bean with name 'uploadServiceImpl' defined in file [A:\Desktop\workspace\HIS\his_service\target\classes\com\luojiawei\his_service\service\impl\UploadServiceImpl.class]: Unsatisfied dependency expressed through constructor parameter 0; nested exception is org.springframework.beans.factory.UnsatisfiedDependencyException: Error creating bean with name 'aiModelMapper' defined in file [A:\Desktop\workspace\HIS\his_service\target\classes\com\luojiawei\his_service\mapper\AiModelMapper.class]: Unsatisfied dependency expressed through bean property 'sqlSessionFactory'; nested exception is org.springframework.beans.factory.BeanCreationException: Error creating bean with name 'sqlSessionFactory' defined in class path resource [com/baomidou/mybatisplus/autoconfigure/MybatisPlusAutoConfiguration.class]: Bean instantiation via factory method failed; nested exception is org.springframework.beans.BeanInstantiationException: Failed to instantiate [org.apache.ibatis.session.SqlSessionFactory]: Factory method 'sqlSessionFactory' threw exception; nested exception is java.io.IOException: Failed to parse mapping resource: 'file [A:\Desktop\workspace\HIS\his_service\target\classes\mapper\DiagnosisReportMapper.xml]'
15:28:30:946  INFO 5140 --- [main] o.apache.catalina.core.StandardService   : Stopping service [Tomcat]
15:28:30:952  WARN 5140 --- [main] o.a.c.loader.WebappClassLoaderBase       : The web application [ROOT] appears to have started a thread named [Thread-2] but has failed to stop it. This is very likely to create a memory leak. Stack trace of thread:
 java.base@17.0.11/sun.net.dns.ResolverConfigurationImpl.notifyAddrChange0(Native Method)
 java.base@17.0.11/sun.net.dns.ResolverConfigurationImpl$AddressChangeListener.run(ResolverConfigurationImpl.java:176)
15:28:30:989  INFO 5140 --- [main] ConditionEvaluationReportLoggingListener : 

Error starting ApplicationContext. To display the conditions report re-run your application with 'debug' enabled.
15:28:31:054 ERROR 5140 --- [main] o.s.boot.SpringApplication               : Application run failed

org.springframework.beans.factory.UnsatisfiedDependencyException: Error creating bean with name 'aiModelController' defined in file [A:\Desktop\workspace\HIS\his_service\target\classes\com\luojiawei\his_service\controller\AiModelController.class]: Unsatisfied dependency expressed through constructor parameter 0; nested exception is org.springframework.beans.factory.UnsatisfiedDependencyException: Error creating bean with name 'uploadServiceImpl' defined in file [A:\Desktop\workspace\HIS\his_service\target\classes\com\luojiawei\his_service\service\impl\UploadServiceImpl.class]: Unsatisfied dependency expressed through constructor parameter 0; nested exception is org.springframework.beans.factory.UnsatisfiedDependencyException: Error creating bean with name 'aiModelMapper' defined in file [A:\Desktop\workspace\HIS\his_service\target\classes\com\luojiawei\his_service\mapper\AiModelMapper.class]: Unsatisfied dependency expressed through bean property 'sqlSessionFactory'; nested exception is org.springframework.beans.factory.BeanCreationException: Error creating bean with name 'sqlSessionFactory' defined in class path resource [com/baomidou/mybatisplus/autoconfigure/MybatisPlusAutoConfiguration.class]: Bean instantiation via factory method failed; nested exception is org.springframework.beans.BeanInstantiationException: Failed to instantiate [org.apache.ibatis.session.SqlSessionFactory]: Factory method 'sqlSessionFactory' threw exception; nested exception is java.io.IOException: Failed to parse mapping resource: 'file [A:\Desktop\workspace\HIS\his_service\target\classes\mapper\DiagnosisReportMapper.xml]'
	at org.springframework.beans.factory.support.ConstructorResolver.createArgumentArray(ConstructorResolver.java:800) ~[spring-beans-5.3.27.jar:5.3.27]
	at org.springframework.beans.factory.support.ConstructorResolver.autowireConstructor(ConstructorResolver.java:229) ~[spring-beans-5.3.27.jar:5.3.27]
	at org.springframework.beans.factory.support.AbstractAutowireCapableBeanFactory.autowireConstructor(AbstractAutowireCapableBeanFactory.java:1372) ~[spring-beans-5.3.27.jar:5.3.27]
	at org.springframework.beans.factory.support.AbstractAutowireCapableBeanFactory.createBeanInstance(AbstractAutowireCapableBeanFactory.java:1222) ~[spring-beans-5.3.27.jar:5.3.27]
	at org.springframework.beans.factory.support.AbstractAutowireCapableBeanFactory.doCreateBean(AbstractAutowireCapableBeanFactory.java:582) ~[spring-beans-5.3.27.jar:5.3.27]
	at org.springframework.beans.factory.support.AbstractAutowireCapableBeanFactory.createBean(AbstractAutowireCapableBeanFactory.java:542) ~[spring-beans-5.3.27.jar:5.3.27]
	at org.springframework.beans.factory.support.AbstractBeanFactory.lambda$doGetBean$0(AbstractBeanFactory.java:335) ~[spring-beans-5.3.27.jar:5.3.27]
	at org.springframework.beans.factory.support.DefaultSingletonBeanRegistry.getSingleton(DefaultSingletonBeanRegistry.java:234) ~[spring-beans-5.3.27.jar:5.3.27]
	at org.springframework.beans.factory.support.AbstractBeanFactory.doGetBean(AbstractBeanFactory.java:333) ~[spring-beans-5.3.27.jar:5.3.27]
	at org.springframework.beans.factory.support.AbstractBeanFactory.getBean(AbstractBeanFactory.java:208) ~[spring-beans-5.3.27.jar:5.3.27]
	at org.springframework.beans.factory.support.DefaultListableBeanFactory.preInstantiateSingletons(DefaultListableBeanFactory.java:955) ~[spring-beans-5.3.27.jar:5.3.27]
	at org.springframework.context.support.AbstractApplicationContext.finishBeanFactoryInitialization(AbstractApplicationContext.java:920) ~[spring-context-5.3.27.jar:5.3.27]
	at org.springframework.context.support.AbstractApplicationContext.refresh(AbstractApplicationContext.java:583) ~[spring-context-5.3.27.jar:5.3.27]
	at org.springframework.boot.web.servlet.context.ServletWebServerApplicationContext.refresh(ServletWebServerApplicationContext.java:147) ~[spring-boot-2.7.12.jar:2.7.12]
	at org.springframework.boot.SpringApplication.refresh(SpringApplication.java:731) ~[spring-boot-2.7.12.jar:2.7.12]
	at org.springframework.boot.SpringApplication.refreshContext(SpringApplication.java:408) ~[spring-boot-2.7.12.jar:2.7.12]
	at org.springframework.boot.SpringApplication.run(SpringApplication.java:307) ~[spring-boot-2.7.12.jar:2.7.12]
	at org.springframework.boot.SpringApplication.run(SpringApplication.java:1303) ~[spring-boot-2.7.12.jar:2.7.12]
	at org.springframework.boot.SpringApplication.run(SpringApplication.java:1292) ~[spring-boot-2.7.12.jar:2.7.12]
	at com.luojiawei.his_service.HisServiceApplication.main(HisServiceApplication.java:19) ~[classes/:na]
Caused by: org.springframework.beans.factory.UnsatisfiedDependencyException: Error creating bean with name 'uploadServiceImpl' defined in file [A:\Desktop\workspace\HIS\his_service\target\classes\com\luojiawei\his_service\service\impl\UploadServiceImpl.class]: Unsatisfied dependency expressed through constructor parameter 0; nested exception is org.springframework.beans.factory.UnsatisfiedDependencyException: Error creating bean with name 'aiModelMapper' defined in file [A:\Desktop\workspace\HIS\his_service\target\classes\com\luojiawei\his_service\mapper\AiModelMapper.class]: Unsatisfied dependency expressed through bean property 'sqlSessionFactory'; nested exception is org.springframework.beans.factory.BeanCreationException: Error creating bean with name 'sqlSessionFactory' defined in class path resource [com/baomidou/mybatisplus/autoconfigure/MybatisPlusAutoConfiguration.class]: Bean instantiation via factory method failed; nested exception is org.springframework.beans.BeanInstantiationException: Failed to instantiate [org.apache.ibatis.session.SqlSessionFactory]: Factory method 'sqlSessionFactory' threw exception; nested exception is java.io.IOException: Failed to parse mapping resource: 'file [A:\Desktop\workspace\HIS\his_service\target\classes\mapper\DiagnosisReportMapper.xml]'
	at org.springframework.beans.factory.support.ConstructorResolver.createArgumentArray(ConstructorResolver.java:800) ~[spring-beans-5.3.27.jar:5.3.27]
	at org.springframework.beans.factory.support.ConstructorResolver.autowireConstructor(ConstructorResolver.java:229) ~[spring-beans-5.3.27.jar:5.3.27]
	at org.springframework.beans.factory.support.AbstractAutowireCapableBeanFactory.autowireConstructor(AbstractAutowireCapableBeanFactory.java:1372) ~[spring-beans-5.3.27.jar:5.3.27]
	at org.springframework.beans.factory.support.AbstractAutowireCapableBeanFactory.createBeanInstance(AbstractAutowireCapableBeanFactory.java:1222) ~[spring-beans-5.3.27.jar:5.3.27]
	at org.springframework.beans.factory.support.AbstractAutowireCapableBeanFactory.doCreateBean(AbstractAutowireCapableBeanFactory.java:582) ~[spring-beans-5.3.27.jar:5.3.27]
	at org.springframework.beans.factory.support.AbstractAutowireCapableBeanFactory.createBean(AbstractAutowireCapableBeanFactory.java:542) ~[spring-beans-5.3.27.jar:5.3.27]
	at org.springframework.beans.factory.support.AbstractBeanFactory.lambda$doGetBean$0(AbstractBeanFactory.java:335) ~[spring-beans-5.3.27.jar:5.3.27]
	at org.springframework.beans.factory.support.DefaultSingletonBeanRegistry.getSingleton(DefaultSingletonBeanRegistry.java:234) ~[spring-beans-5.3.27.jar:5.3.27]
	at org.springframework.beans.factory.support.AbstractBeanFactory.doGetBean(AbstractBeanFactory.java:333) ~[spring-beans-5.3.27.jar:5.3.27]
	at org.springframework.beans.factory.support.AbstractBeanFactory.getBean(AbstractBeanFactory.java:208) ~[spring-beans-5.3.27.jar:5.3.27]
	at org.springframework.beans.factory.config.DependencyDescriptor.resolveCandidate(DependencyDescriptor.java:276) ~[spring-beans-5.3.27.jar:5.3.27]
	at org.springframework.beans.factory.support.DefaultListableBeanFactory.doResolveDependency(DefaultListableBeanFactory.java:1391) ~[spring-beans-5.3.27.jar:5.3.27]
	at org.springframework.beans.factory.support.DefaultListableBeanFactory.resolveDependency(DefaultListableBeanFactory.java:1311) ~[spring-beans-5.3.27.jar:5.3.27]
	at org.springframework.beans.factory.support.ConstructorResolver.resolveAutowiredArgument(ConstructorResolver.java:887) ~[spring-beans-5.3.27.jar:5.3.27]
	at org.springframework.beans.factory.support.ConstructorResolver.createArgumentArray(ConstructorResolver.java:791) ~[spring-beans-5.3.27.jar:5.3.27]
	... 19 common frames omitted
Caused by: org.springframework.beans.factory.UnsatisfiedDependencyException: Error creating bean with name 'aiModelMapper' defined in file [A:\Desktop\workspace\HIS\his_service\target\classes\com\luojiawei\his_service\mapper\AiModelMapper.class]: Unsatisfied dependency expressed through bean property 'sqlSessionFactory'; nested exception is org.springframework.beans.factory.BeanCreationException: Error creating bean with name 'sqlSessionFactory' defined in class path resource [com/baomidou/mybatisplus/autoconfigure/MybatisPlusAutoConfiguration.class]: Bean instantiation via factory method failed; nested exception is org.springframework.beans.BeanInstantiationException: Failed to instantiate [org.apache.ibatis.session.SqlSessionFactory]: Factory method 'sqlSessionFactory' threw exception; nested exception is java.io.IOException: Failed to parse mapping resource: 'file [A:\Desktop\workspace\HIS\his_service\target\classes\mapper\DiagnosisReportMapper.xml]'
	at org.springframework.beans.factory.support.AbstractAutowireCapableBeanFactory.autowireByType(AbstractAutowireCapableBeanFactory.java:1534) ~[spring-beans-5.3.27.jar:5.3.27]
	at org.springframework.beans.factory.support.AbstractAutowireCapableBeanFactory.populateBean(AbstractAutowireCapableBeanFactory.java:1417) ~[spring-beans-5.3.27.jar:5.3.27]
	at org.springframework.beans.factory.support.AbstractAutowireCapableBeanFactory.doCreateBean(AbstractAutowireCapableBeanFactory.java:619) ~[spring-beans-5.3.27.jar:5.3.27]
	at org.springframework.beans.factory.support.AbstractAutowireCapableBeanFactory.createBean(AbstractAutowireCapableBeanFactory.java:542) ~[spring-beans-5.3.27.jar:5.3.27]
	at org.springframework.beans.factory.support.AbstractBeanFactory.lambda$doGetBean$0(AbstractBeanFactory.java:335) ~[spring-beans-5.3.27.jar:5.3.27]
	at org.springframework.beans.factory.support.DefaultSingletonBeanRegistry.getSingleton(DefaultSingletonBeanRegistry.java:234) ~[spring-beans-5.3.27.jar:5.3.27]
	at org.springframework.beans.factory.support.AbstractBeanFactory.doGetBean(AbstractBeanFactory.java:333) ~[spring-beans-5.3.27.jar:5.3.27]
	at org.springframework.beans.factory.support.AbstractBeanFactory.getBean(AbstractBeanFactory.java:208) ~[spring-beans-5.3.27.jar:5.3.27]
	at org.springframework.beans.factory.config.DependencyDescriptor.resolveCandidate(DependencyDescriptor.java:276) ~[spring-beans-5.3.27.jar:5.3.27]
	at org.springframework.beans.factory.support.DefaultListableBeanFactory.doResolveDependency(DefaultListableBeanFactory.java:1391) ~[spring-beans-5.3.27.jar:5.3.27]
	at org.springframework.beans.factory.support.DefaultListableBeanFactory.resolveDependency(DefaultListableBeanFactory.java:1311) ~[spring-beans-5.3.27.jar:5.3.27]
	at org.springframework.beans.factory.support.ConstructorResolver.resolveAutowiredArgument(ConstructorResolver.java:887) ~[spring-beans-5.3.27.jar:5.3.27]
	at org.springframework.beans.factory.support.ConstructorResolver.createArgumentArray(ConstructorResolver.java:791) ~[spring-beans-5.3.27.jar:5.3.27]
	... 33 common frames omitted
Caused by: org.springframework.beans.factory.BeanCreationException: Error creating bean with name 'sqlSessionFactory' defined in class path resource [com/baomidou/mybatisplus/autoconfigure/MybatisPlusAutoConfiguration.class]: Bean instantiation via factory method failed; nested exception is org.springframework.beans.BeanInstantiationException: Failed to instantiate [org.apache.ibatis.session.SqlSessionFactory]: Factory method 'sqlSessionFactory' threw exception; nested exception is java.io.IOException: Failed to parse mapping resource: 'file [A:\Desktop\workspace\HIS\his_service\target\classes\mapper\DiagnosisReportMapper.xml]'
	at org.springframework.beans.factory.support.ConstructorResolver.instantiate(ConstructorResolver.java:658) ~[spring-beans-5.3.27.jar:5.3.27]
	at org.springframework.beans.factory.support.ConstructorResolver.instantiateUsingFactoryMethod(ConstructorResolver.java:638) ~[spring-beans-5.3.27.jar:5.3.27]
	at org.springframework.beans.factory.support.AbstractAutowireCapableBeanFactory.instantiateUsingFactoryMethod(AbstractAutowireCapableBeanFactory.java:1352) ~[spring-beans-5.3.27.jar:5.3.27]
	at org.springframework.beans.factory.support.AbstractAutowireCapableBeanFactory.createBeanInstance(AbstractAutowireCapableBeanFactory.java:1195) ~[spring-beans-5.3.27.jar:5.3.27]
	at org.springframework.beans.factory.support.AbstractAutowireCapableBeanFactory.doCreateBean(AbstractAutowireCapableBeanFactory.java:582) ~[spring-beans-5.3.27.jar:5.3.27]
	at org.springframework.beans.factory.support.AbstractAutowireCapableBeanFactory.createBean(AbstractAutowireCapableBeanFactory.java:542) ~[spring-beans-5.3.27.jar:5.3.27]
	at org.springframework.beans.factory.support.AbstractBeanFactory.lambda$doGetBean$0(AbstractBeanFactory.java:335) ~[spring-beans-5.3.27.jar:5.3.27]
	at org.springframework.beans.factory.support.DefaultSingletonBeanRegistry.getSingleton(DefaultSingletonBeanRegistry.java:234) ~[spring-beans-5.3.27.jar:5.3.27]
	at org.springframework.beans.factory.support.AbstractBeanFactory.doGetBean(AbstractBeanFactory.java:333) ~[spring-beans-5.3.27.jar:5.3.27]
	at org.springframework.beans.factory.support.AbstractBeanFactory.getBean(AbstractBeanFactory.java:208) ~[spring-beans-5.3.27.jar:5.3.27]
	at org.springframework.beans.factory.config.DependencyDescriptor.resolveCandidate(DependencyDescriptor.java:276) ~[spring-beans-5.3.27.jar:5.3.27]
	at org.springframework.beans.factory.support.DefaultListableBeanFactory.doResolveDependency(DefaultListableBeanFactory.java:1391) ~[spring-beans-5.3.27.jar:5.3.27]
	at org.springframework.beans.factory.support.DefaultListableBeanFactory.resolveDependency(DefaultListableBeanFactory.java:1311) ~[spring-beans-5.3.27.jar:5.3.27]
	at org.springframework.beans.factory.support.AbstractAutowireCapableBeanFactory.autowireByType(AbstractAutowireCapableBeanFactory.java:1519) ~[spring-beans-5.3.27.jar:5.3.27]
	... 45 common frames omitted
Caused by: org.springframework.beans.BeanInstantiationException: Failed to instantiate [org.apache.ibatis.session.SqlSessionFactory]: Factory method 'sqlSessionFactory' threw exception; nested exception is java.io.IOException: Failed to parse mapping resource: 'file [A:\Desktop\workspace\HIS\his_service\target\classes\mapper\DiagnosisReportMapper.xml]'
	at org.springframework.beans.factory.support.SimpleInstantiationStrategy.instantiate(SimpleInstantiationStrategy.java:185) ~[spring-beans-5.3.27.jar:5.3.27]
	at org.springframework.beans.factory.support.ConstructorResolver.instantiate(ConstructorResolver.java:653) ~[spring-beans-5.3.27.jar:5.3.27]
	... 58 common frames omitted
Caused by: java.io.IOException: Failed to parse mapping resource: 'file [A:\Desktop\workspace\HIS\his_service\target\classes\mapper\DiagnosisReportMapper.xml]'
	at com.baomidou.mybatisplus.extension.spring.MybatisSqlSessionFactoryBean.buildSqlSessionFactory(MybatisSqlSessionFactoryBean.java:575) ~[mybatis-plus-extension-3.5.3.1.jar:3.5.3.1]
	at com.baomidou.mybatisplus.extension.spring.MybatisSqlSessionFactoryBean.afterPropertiesSet(MybatisSqlSessionFactoryBean.java:444) ~[mybatis-plus-extension-3.5.3.1.jar:3.5.3.1]
	at com.baomidou.mybatisplus.extension.spring.MybatisSqlSessionFactoryBean.getObject(MybatisSqlSessionFactoryBean.java:608) ~[mybatis-plus-extension-3.5.3.1.jar:3.5.3.1]
	at com.baomidou.mybatisplus.autoconfigure.MybatisPlusAutoConfiguration.sqlSessionFactory(MybatisPlusAutoConfiguration.java:224) ~[mybatis-plus-boot-starter-3.5.3.1.jar:3.5.3.1]
	at java.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke0(Native Method) ~[na:na]
	at java.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:77) ~[na:na]
	at java.base/jdk.internal.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43) ~[na:na]
	at java.base/java.lang.reflect.Method.invoke(Method.java:568) ~[na:na]
	at org.springframework.beans.factory.support.SimpleInstantiationStrategy.instantiate(SimpleInstantiationStrategy.java:154) ~[spring-beans-5.3.27.jar:5.3.27]
	... 59 common frames omitted
Caused by: org.apache.ibatis.builder.BuilderException: Error parsing Mapper XML. The XML location is 'file [A:\Desktop\workspace\HIS\his_service\target\classes\mapper\DiagnosisReportMapper.xml]'. Cause: org.apache.ibatis.builder.BuilderException: Error resolving class. Cause: org.apache.ibatis.type.TypeException: Could not resolve type alias 'com.luojiawei.his_service.domain.vo.Diagnosises'.  Cause: java.lang.ClassNotFoundException: Cannot find class: com.luojiawei.his_service.domain.vo.Diagnosises
	at org.apache.ibatis.builder.xml.XMLMapperBuilder.configurationElement(XMLMapperBuilder.java:128) ~[mybatis-3.5.13.jar:3.5.13]
	at org.apache.ibatis.builder.xml.XMLMapperBuilder.parse(XMLMapperBuilder.java:100) ~[mybatis-3.5.13.jar:3.5.13]
	at com.baomidou.mybatisplus.extension.spring.MybatisSqlSessionFactoryBean.buildSqlSessionFactory(MybatisSqlSessionFactoryBean.java:573) ~[mybatis-plus-extension-3.5.3.1.jar:3.5.3.1]
	... 67 common frames omitted
Caused by: org.apache.ibatis.builder.BuilderException: Error resolving class. Cause: org.apache.ibatis.type.TypeException: Could not resolve type alias 'com.luojiawei.his_service.domain.vo.Diagnosises'.  Cause: java.lang.ClassNotFoundException: Cannot find class: com.luojiawei.his_service.domain.vo.Diagnosises
	at org.apache.ibatis.builder.BaseBuilder.resolveClass(BaseBuilder.java:118) ~[mybatis-3.5.13.jar:3.5.13]
	at org.apache.ibatis.builder.xml.XMLStatementBuilder.parseStatementNode(XMLStatementBuilder.java:105) ~[mybatis-3.5.13.jar:3.5.13]
	at org.apache.ibatis.builder.xml.XMLMapperBuilder.buildStatementFromContext(XMLMapperBuilder.java:144) ~[mybatis-3.5.13.jar:3.5.13]
	at org.apache.ibatis.builder.xml.XMLMapperBuilder.buildStatementFromContext(XMLMapperBuilder.java:136) ~[mybatis-3.5.13.jar:3.5.13]
	at org.apache.ibatis.builder.xml.XMLMapperBuilder.configurationElement(XMLMapperBuilder.java:126) ~[mybatis-3.5.13.jar:3.5.13]
	... 69 common frames omitted
Caused by: org.apache.ibatis.type.TypeException: Could not resolve type alias 'com.luojiawei.his_service.domain.vo.Diagnosises'.  Cause: java.lang.ClassNotFoundException: Cannot find class: com.luojiawei.his_service.domain.vo.Diagnosises
	at org.apache.ibatis.type.TypeAliasRegistry.resolveAlias(TypeAliasRegistry.java:128) ~[mybatis-3.5.13.jar:3.5.13]
	at org.apache.ibatis.builder.BaseBuilder.resolveAlias(BaseBuilder.java:150) ~[mybatis-3.5.13.jar:3.5.13]
	at org.apache.ibatis.builder.BaseBuilder.resolveClass(BaseBuilder.java:116) ~[mybatis-3.5.13.jar:3.5.13]
	... 73 common frames omitted
Caused by: java.lang.ClassNotFoundException: Cannot find class: com.luojiawei.his_service.domain.vo.Diagnosises
	at org.apache.ibatis.io.ClassLoaderWrapper.classForName(ClassLoaderWrapper.java:226) ~[mybatis-3.5.13.jar:3.5.13]
	at org.apache.ibatis.io.ClassLoaderWrapper.classForName(ClassLoaderWrapper.java:103) ~[mybatis-3.5.13.jar:3.5.13]
	at org.apache.ibatis.io.Resources.classForName(Resources.java:322) ~[mybatis-3.5.13.jar:3.5.13]
	at org.apache.ibatis.type.TypeAliasRegistry.resolveAlias(TypeAliasRegistry.java:124) ~[mybatis-3.5.13.jar:3.5.13]
	... 75 common frames omitted

15:41:04:594  INFO 34684 --- [main] c.l.his_service.HisServiceApplication    : Starting HisServiceApplication using Java 17.0.11 on luo with PID 34684 (A:\Desktop\workspace\HIS\his_service\target\classes started by 22407 in A:\Desktop\workspace\HIS)
15:41:04:596 DEBUG 34684 --- [main] c.l.his_service.HisServiceApplication    : Running with Spring Boot v2.7.12, Spring v5.3.27
15:41:04:596  INFO 34684 --- [main] c.l.his_service.HisServiceApplication    : The following 1 profile is active: "dev"
15:41:05:470  INFO 34684 --- [main] .s.d.r.c.RepositoryConfigurationDelegate : Multiple Spring Data modules found, entering strict repository configuration mode
15:41:05:473  INFO 34684 --- [main] .s.d.r.c.RepositoryConfigurationDelegate : Bootstrapping Spring Data Redis repositories in DEFAULT mode.
15:41:05:502  INFO 34684 --- [main] .s.d.r.c.RepositoryConfigurationDelegate : Finished Spring Data repository scanning in 14 ms. Found 0 Redis repository interfaces.
15:41:05:757  INFO 34684 --- [main] o.s.cloud.context.scope.GenericScope     : BeanFactory id=6223b6d6-9ee6-3c52-951c-fcc2980a1fa1
15:41:06:308  INFO 34684 --- [main] o.s.b.w.embedded.tomcat.TomcatWebServer  : Tomcat initialized with port(s): 8080 (http)
15:41:06:315  INFO 34684 --- [main] o.apache.catalina.core.StandardService   : Starting service [Tomcat]
15:41:06:315  INFO 34684 --- [main] org.apache.catalina.core.StandardEngine  : Starting Servlet engine: [Apache Tomcat/9.0.75]
15:41:06:459  INFO 34684 --- [main] o.a.c.c.C.[Tomcat].[localhost].[/]       : Initializing Spring embedded WebApplicationContext
15:41:06:459  INFO 34684 --- [main] w.s.c.ServletWebServerApplicationContext : Root WebApplicationContext: initialization completed in 1819 ms
15:41:06:685  INFO 34684 --- [main] org.redisson.Version                     : Redisson 3.17.7
15:41:07:050  INFO 34684 --- [redisson-netty-2-9] o.r.c.pool.MasterPubSubConnectionPool    : 1 connections initialized for 111.230.32.147/111.230.32.147:9631
15:41:07:730  INFO 34684 --- [redisson-netty-2-19] o.r.c.pool.MasterConnectionPool          : 24 connections initialized for 111.230.32.147/111.230.32.147:9631
15:41:07:975 DEBUG 34684 --- [main] c.l.h.filter.RefreshTokenFilter          : Filter 'refreshTokenFilter' configured for use
15:41:08:386  WARN 34684 --- [main] ConfigServletWebServerApplicationContext : Exception encountered during context initialization - cancelling refresh attempt: org.springframework.beans.factory.UnsatisfiedDependencyException: Error creating bean with name 'aiModelController' defined in file [A:\Desktop\workspace\HIS\his_service\target\classes\com\luojiawei\his_service\controller\AiModelController.class]: Unsatisfied dependency expressed through constructor parameter 0; nested exception is org.springframework.beans.factory.UnsatisfiedDependencyException: Error creating bean with name 'uploadServiceImpl' defined in file [A:\Desktop\workspace\HIS\his_service\target\classes\com\luojiawei\his_service\service\impl\UploadServiceImpl.class]: Unsatisfied dependency expressed through constructor parameter 0; nested exception is org.springframework.beans.factory.UnsatisfiedDependencyException: Error creating bean with name 'aiModelMapper' defined in file [A:\Desktop\workspace\HIS\his_service\target\classes\com\luojiawei\his_service\mapper\AiModelMapper.class]: Unsatisfied dependency expressed through bean property 'sqlSessionFactory'; nested exception is org.springframework.beans.factory.BeanCreationException: Error creating bean with name 'sqlSessionFactory' defined in class path resource [com/baomidou/mybatisplus/autoconfigure/MybatisPlusAutoConfiguration.class]: Bean instantiation via factory method failed; nested exception is org.springframework.beans.BeanInstantiationException: Failed to instantiate [org.apache.ibatis.session.SqlSessionFactory]: Factory method 'sqlSessionFactory' threw exception; nested exception is java.io.IOException: Failed to parse mapping resource: 'file [A:\Desktop\workspace\HIS\his_service\target\classes\mapper\DiagnosisReportMapper.xml]'
15:41:08:436  INFO 34684 --- [main] o.apache.catalina.core.StandardService   : Stopping service [Tomcat]
15:41:08:440  WARN 34684 --- [main] o.a.c.loader.WebappClassLoaderBase       : The web application [ROOT] appears to have started a thread named [Thread-2] but has failed to stop it. This is very likely to create a memory leak. Stack trace of thread:
 java.base@17.0.11/sun.net.dns.ResolverConfigurationImpl.notifyAddrChange0(Native Method)
 java.base@17.0.11/sun.net.dns.ResolverConfigurationImpl$AddressChangeListener.run(ResolverConfigurationImpl.java:176)
15:41:08:455  INFO 34684 --- [main] ConditionEvaluationReportLoggingListener : 

Error starting ApplicationContext. To display the conditions report re-run your application with 'debug' enabled.
15:41:08:476 ERROR 34684 --- [main] o.s.boot.SpringApplication               : Application run failed

org.springframework.beans.factory.UnsatisfiedDependencyException: Error creating bean with name 'aiModelController' defined in file [A:\Desktop\workspace\HIS\his_service\target\classes\com\luojiawei\his_service\controller\AiModelController.class]: Unsatisfied dependency expressed through constructor parameter 0; nested exception is org.springframework.beans.factory.UnsatisfiedDependencyException: Error creating bean with name 'uploadServiceImpl' defined in file [A:\Desktop\workspace\HIS\his_service\target\classes\com\luojiawei\his_service\service\impl\UploadServiceImpl.class]: Unsatisfied dependency expressed through constructor parameter 0; nested exception is org.springframework.beans.factory.UnsatisfiedDependencyException: Error creating bean with name 'aiModelMapper' defined in file [A:\Desktop\workspace\HIS\his_service\target\classes\com\luojiawei\his_service\mapper\AiModelMapper.class]: Unsatisfied dependency expressed through bean property 'sqlSessionFactory'; nested exception is org.springframework.beans.factory.BeanCreationException: Error creating bean with name 'sqlSessionFactory' defined in class path resource [com/baomidou/mybatisplus/autoconfigure/MybatisPlusAutoConfiguration.class]: Bean instantiation via factory method failed; nested exception is org.springframework.beans.BeanInstantiationException: Failed to instantiate [org.apache.ibatis.session.SqlSessionFactory]: Factory method 'sqlSessionFactory' threw exception; nested exception is java.io.IOException: Failed to parse mapping resource: 'file [A:\Desktop\workspace\HIS\his_service\target\classes\mapper\DiagnosisReportMapper.xml]'
	at org.springframework.beans.factory.support.ConstructorResolver.createArgumentArray(ConstructorResolver.java:800) ~[spring-beans-5.3.27.jar:5.3.27]
	at org.springframework.beans.factory.support.ConstructorResolver.autowireConstructor(ConstructorResolver.java:229) ~[spring-beans-5.3.27.jar:5.3.27]
	at org.springframework.beans.factory.support.AbstractAutowireCapableBeanFactory.autowireConstructor(AbstractAutowireCapableBeanFactory.java:1372) ~[spring-beans-5.3.27.jar:5.3.27]
	at org.springframework.beans.factory.support.AbstractAutowireCapableBeanFactory.createBeanInstance(AbstractAutowireCapableBeanFactory.java:1222) ~[spring-beans-5.3.27.jar:5.3.27]
	at org.springframework.beans.factory.support.AbstractAutowireCapableBeanFactory.doCreateBean(AbstractAutowireCapableBeanFactory.java:582) ~[spring-beans-5.3.27.jar:5.3.27]
	at org.springframework.beans.factory.support.AbstractAutowireCapableBeanFactory.createBean(AbstractAutowireCapableBeanFactory.java:542) ~[spring-beans-5.3.27.jar:5.3.27]
	at org.springframework.beans.factory.support.AbstractBeanFactory.lambda$doGetBean$0(AbstractBeanFactory.java:335) ~[spring-beans-5.3.27.jar:5.3.27]
	at org.springframework.beans.factory.support.DefaultSingletonBeanRegistry.getSingleton(DefaultSingletonBeanRegistry.java:234) ~[spring-beans-5.3.27.jar:5.3.27]
	at org.springframework.beans.factory.support.AbstractBeanFactory.doGetBean(AbstractBeanFactory.java:333) ~[spring-beans-5.3.27.jar:5.3.27]
	at org.springframework.beans.factory.support.AbstractBeanFactory.getBean(AbstractBeanFactory.java:208) ~[spring-beans-5.3.27.jar:5.3.27]
	at org.springframework.beans.factory.support.DefaultListableBeanFactory.preInstantiateSingletons(DefaultListableBeanFactory.java:955) ~[spring-beans-5.3.27.jar:5.3.27]
	at org.springframework.context.support.AbstractApplicationContext.finishBeanFactoryInitialization(AbstractApplicationContext.java:920) ~[spring-context-5.3.27.jar:5.3.27]
	at org.springframework.context.support.AbstractApplicationContext.refresh(AbstractApplicationContext.java:583) ~[spring-context-5.3.27.jar:5.3.27]
	at org.springframework.boot.web.servlet.context.ServletWebServerApplicationContext.refresh(ServletWebServerApplicationContext.java:147) ~[spring-boot-2.7.12.jar:2.7.12]
	at org.springframework.boot.SpringApplication.refresh(SpringApplication.java:731) ~[spring-boot-2.7.12.jar:2.7.12]
	at org.springframework.boot.SpringApplication.refreshContext(SpringApplication.java:408) ~[spring-boot-2.7.12.jar:2.7.12]
	at org.springframework.boot.SpringApplication.run(SpringApplication.java:307) ~[spring-boot-2.7.12.jar:2.7.12]
	at org.springframework.boot.SpringApplication.run(SpringApplication.java:1303) ~[spring-boot-2.7.12.jar:2.7.12]
	at org.springframework.boot.SpringApplication.run(SpringApplication.java:1292) ~[spring-boot-2.7.12.jar:2.7.12]
	at com.luojiawei.his_service.HisServiceApplication.main(HisServiceApplication.java:19) ~[classes/:na]
Caused by: org.springframework.beans.factory.UnsatisfiedDependencyException: Error creating bean with name 'uploadServiceImpl' defined in file [A:\Desktop\workspace\HIS\his_service\target\classes\com\luojiawei\his_service\service\impl\UploadServiceImpl.class]: Unsatisfied dependency expressed through constructor parameter 0; nested exception is org.springframework.beans.factory.UnsatisfiedDependencyException: Error creating bean with name 'aiModelMapper' defined in file [A:\Desktop\workspace\HIS\his_service\target\classes\com\luojiawei\his_service\mapper\AiModelMapper.class]: Unsatisfied dependency expressed through bean property 'sqlSessionFactory'; nested exception is org.springframework.beans.factory.BeanCreationException: Error creating bean with name 'sqlSessionFactory' defined in class path resource [com/baomidou/mybatisplus/autoconfigure/MybatisPlusAutoConfiguration.class]: Bean instantiation via factory method failed; nested exception is org.springframework.beans.BeanInstantiationException: Failed to instantiate [org.apache.ibatis.session.SqlSessionFactory]: Factory method 'sqlSessionFactory' threw exception; nested exception is java.io.IOException: Failed to parse mapping resource: 'file [A:\Desktop\workspace\HIS\his_service\target\classes\mapper\DiagnosisReportMapper.xml]'
	at org.springframework.beans.factory.support.ConstructorResolver.createArgumentArray(ConstructorResolver.java:800) ~[spring-beans-5.3.27.jar:5.3.27]
	at org.springframework.beans.factory.support.ConstructorResolver.autowireConstructor(ConstructorResolver.java:229) ~[spring-beans-5.3.27.jar:5.3.27]
	at org.springframework.beans.factory.support.AbstractAutowireCapableBeanFactory.autowireConstructor(AbstractAutowireCapableBeanFactory.java:1372) ~[spring-beans-5.3.27.jar:5.3.27]
	at org.springframework.beans.factory.support.AbstractAutowireCapableBeanFactory.createBeanInstance(AbstractAutowireCapableBeanFactory.java:1222) ~[spring-beans-5.3.27.jar:5.3.27]
	at org.springframework.beans.factory.support.AbstractAutowireCapableBeanFactory.doCreateBean(AbstractAutowireCapableBeanFactory.java:582) ~[spring-beans-5.3.27.jar:5.3.27]
	at org.springframework.beans.factory.support.AbstractAutowireCapableBeanFactory.createBean(AbstractAutowireCapableBeanFactory.java:542) ~[spring-beans-5.3.27.jar:5.3.27]
	at org.springframework.beans.factory.support.AbstractBeanFactory.lambda$doGetBean$0(AbstractBeanFactory.java:335) ~[spring-beans-5.3.27.jar:5.3.27]
	at org.springframework.beans.factory.support.DefaultSingletonBeanRegistry.getSingleton(DefaultSingletonBeanRegistry.java:234) ~[spring-beans-5.3.27.jar:5.3.27]
	at org.springframework.beans.factory.support.AbstractBeanFactory.doGetBean(AbstractBeanFactory.java:333) ~[spring-beans-5.3.27.jar:5.3.27]
	at org.springframework.beans.factory.support.AbstractBeanFactory.getBean(AbstractBeanFactory.java:208) ~[spring-beans-5.3.27.jar:5.3.27]
	at org.springframework.beans.factory.config.DependencyDescriptor.resolveCandidate(DependencyDescriptor.java:276) ~[spring-beans-5.3.27.jar:5.3.27]
	at org.springframework.beans.factory.support.DefaultListableBeanFactory.doResolveDependency(DefaultListableBeanFactory.java:1391) ~[spring-beans-5.3.27.jar:5.3.27]
	at org.springframework.beans.factory.support.DefaultListableBeanFactory.resolveDependency(DefaultListableBeanFactory.java:1311) ~[spring-beans-5.3.27.jar:5.3.27]
	at org.springframework.beans.factory.support.ConstructorResolver.resolveAutowiredArgument(ConstructorResolver.java:887) ~[spring-beans-5.3.27.jar:5.3.27]
	at org.springframework.beans.factory.support.ConstructorResolver.createArgumentArray(ConstructorResolver.java:791) ~[spring-beans-5.3.27.jar:5.3.27]
	... 19 common frames omitted
Caused by: org.springframework.beans.factory.UnsatisfiedDependencyException: Error creating bean with name 'aiModelMapper' defined in file [A:\Desktop\workspace\HIS\his_service\target\classes\com\luojiawei\his_service\mapper\AiModelMapper.class]: Unsatisfied dependency expressed through bean property 'sqlSessionFactory'; nested exception is org.springframework.beans.factory.BeanCreationException: Error creating bean with name 'sqlSessionFactory' defined in class path resource [com/baomidou/mybatisplus/autoconfigure/MybatisPlusAutoConfiguration.class]: Bean instantiation via factory method failed; nested exception is org.springframework.beans.BeanInstantiationException: Failed to instantiate [org.apache.ibatis.session.SqlSessionFactory]: Factory method 'sqlSessionFactory' threw exception; nested exception is java.io.IOException: Failed to parse mapping resource: 'file [A:\Desktop\workspace\HIS\his_service\target\classes\mapper\DiagnosisReportMapper.xml]'
	at org.springframework.beans.factory.support.AbstractAutowireCapableBeanFactory.autowireByType(AbstractAutowireCapableBeanFactory.java:1534) ~[spring-beans-5.3.27.jar:5.3.27]
	at org.springframework.beans.factory.support.AbstractAutowireCapableBeanFactory.populateBean(AbstractAutowireCapableBeanFactory.java:1417) ~[spring-beans-5.3.27.jar:5.3.27]
	at org.springframework.beans.factory.support.AbstractAutowireCapableBeanFactory.doCreateBean(AbstractAutowireCapableBeanFactory.java:619) ~[spring-beans-5.3.27.jar:5.3.27]
	at org.springframework.beans.factory.support.AbstractAutowireCapableBeanFactory.createBean(AbstractAutowireCapableBeanFactory.java:542) ~[spring-beans-5.3.27.jar:5.3.27]
	at org.springframework.beans.factory.support.AbstractBeanFactory.lambda$doGetBean$0(AbstractBeanFactory.java:335) ~[spring-beans-5.3.27.jar:5.3.27]
	at org.springframework.beans.factory.support.DefaultSingletonBeanRegistry.getSingleton(DefaultSingletonBeanRegistry.java:234) ~[spring-beans-5.3.27.jar:5.3.27]
	at org.springframework.beans.factory.support.AbstractBeanFactory.doGetBean(AbstractBeanFactory.java:333) ~[spring-beans-5.3.27.jar:5.3.27]
	at org.springframework.beans.factory.support.AbstractBeanFactory.getBean(AbstractBeanFactory.java:208) ~[spring-beans-5.3.27.jar:5.3.27]
	at org.springframework.beans.factory.config.DependencyDescriptor.resolveCandidate(DependencyDescriptor.java:276) ~[spring-beans-5.3.27.jar:5.3.27]
	at org.springframework.beans.factory.support.DefaultListableBeanFactory.doResolveDependency(DefaultListableBeanFactory.java:1391) ~[spring-beans-5.3.27.jar:5.3.27]
	at org.springframework.beans.factory.support.DefaultListableBeanFactory.resolveDependency(DefaultListableBeanFactory.java:1311) ~[spring-beans-5.3.27.jar:5.3.27]
	at org.springframework.beans.factory.support.ConstructorResolver.resolveAutowiredArgument(ConstructorResolver.java:887) ~[spring-beans-5.3.27.jar:5.3.27]
	at org.springframework.beans.factory.support.ConstructorResolver.createArgumentArray(ConstructorResolver.java:791) ~[spring-beans-5.3.27.jar:5.3.27]
	... 33 common frames omitted
Caused by: org.springframework.beans.factory.BeanCreationException: Error creating bean with name 'sqlSessionFactory' defined in class path resource [com/baomidou/mybatisplus/autoconfigure/MybatisPlusAutoConfiguration.class]: Bean instantiation via factory method failed; nested exception is org.springframework.beans.BeanInstantiationException: Failed to instantiate [org.apache.ibatis.session.SqlSessionFactory]: Factory method 'sqlSessionFactory' threw exception; nested exception is java.io.IOException: Failed to parse mapping resource: 'file [A:\Desktop\workspace\HIS\his_service\target\classes\mapper\DiagnosisReportMapper.xml]'
	at org.springframework.beans.factory.support.ConstructorResolver.instantiate(ConstructorResolver.java:658) ~[spring-beans-5.3.27.jar:5.3.27]
	at org.springframework.beans.factory.support.ConstructorResolver.instantiateUsingFactoryMethod(ConstructorResolver.java:638) ~[spring-beans-5.3.27.jar:5.3.27]
	at org.springframework.beans.factory.support.AbstractAutowireCapableBeanFactory.instantiateUsingFactoryMethod(AbstractAutowireCapableBeanFactory.java:1352) ~[spring-beans-5.3.27.jar:5.3.27]
	at org.springframework.beans.factory.support.AbstractAutowireCapableBeanFactory.createBeanInstance(AbstractAutowireCapableBeanFactory.java:1195) ~[spring-beans-5.3.27.jar:5.3.27]
	at org.springframework.beans.factory.support.AbstractAutowireCapableBeanFactory.doCreateBean(AbstractAutowireCapableBeanFactory.java:582) ~[spring-beans-5.3.27.jar:5.3.27]
	at org.springframework.beans.factory.support.AbstractAutowireCapableBeanFactory.createBean(AbstractAutowireCapableBeanFactory.java:542) ~[spring-beans-5.3.27.jar:5.3.27]
	at org.springframework.beans.factory.support.AbstractBeanFactory.lambda$doGetBean$0(AbstractBeanFactory.java:335) ~[spring-beans-5.3.27.jar:5.3.27]
	at org.springframework.beans.factory.support.DefaultSingletonBeanRegistry.getSingleton(DefaultSingletonBeanRegistry.java:234) ~[spring-beans-5.3.27.jar:5.3.27]
	at org.springframework.beans.factory.support.AbstractBeanFactory.doGetBean(AbstractBeanFactory.java:333) ~[spring-beans-5.3.27.jar:5.3.27]
	at org.springframework.beans.factory.support.AbstractBeanFactory.getBean(AbstractBeanFactory.java:208) ~[spring-beans-5.3.27.jar:5.3.27]
	at org.springframework.beans.factory.config.DependencyDescriptor.resolveCandidate(DependencyDescriptor.java:276) ~[spring-beans-5.3.27.jar:5.3.27]
	at org.springframework.beans.factory.support.DefaultListableBeanFactory.doResolveDependency(DefaultListableBeanFactory.java:1391) ~[spring-beans-5.3.27.jar:5.3.27]
	at org.springframework.beans.factory.support.DefaultListableBeanFactory.resolveDependency(DefaultListableBeanFactory.java:1311) ~[spring-beans-5.3.27.jar:5.3.27]
	at org.springframework.beans.factory.support.AbstractAutowireCapableBeanFactory.autowireByType(AbstractAutowireCapableBeanFactory.java:1519) ~[spring-beans-5.3.27.jar:5.3.27]
	... 45 common frames omitted
Caused by: org.springframework.beans.BeanInstantiationException: Failed to instantiate [org.apache.ibatis.session.SqlSessionFactory]: Factory method 'sqlSessionFactory' threw exception; nested exception is java.io.IOException: Failed to parse mapping resource: 'file [A:\Desktop\workspace\HIS\his_service\target\classes\mapper\DiagnosisReportMapper.xml]'
	at org.springframework.beans.factory.support.SimpleInstantiationStrategy.instantiate(SimpleInstantiationStrategy.java:185) ~[spring-beans-5.3.27.jar:5.3.27]
	at org.springframework.beans.factory.support.ConstructorResolver.instantiate(ConstructorResolver.java:653) ~[spring-beans-5.3.27.jar:5.3.27]
	... 58 common frames omitted
Caused by: java.io.IOException: Failed to parse mapping resource: 'file [A:\Desktop\workspace\HIS\his_service\target\classes\mapper\DiagnosisReportMapper.xml]'
	at com.baomidou.mybatisplus.extension.spring.MybatisSqlSessionFactoryBean.buildSqlSessionFactory(MybatisSqlSessionFactoryBean.java:575) ~[mybatis-plus-extension-3.5.3.1.jar:3.5.3.1]
	at com.baomidou.mybatisplus.extension.spring.MybatisSqlSessionFactoryBean.afterPropertiesSet(MybatisSqlSessionFactoryBean.java:444) ~[mybatis-plus-extension-3.5.3.1.jar:3.5.3.1]
	at com.baomidou.mybatisplus.extension.spring.MybatisSqlSessionFactoryBean.getObject(MybatisSqlSessionFactoryBean.java:608) ~[mybatis-plus-extension-3.5.3.1.jar:3.5.3.1]
	at com.baomidou.mybatisplus.autoconfigure.MybatisPlusAutoConfiguration.sqlSessionFactory(MybatisPlusAutoConfiguration.java:224) ~[mybatis-plus-boot-starter-3.5.3.1.jar:3.5.3.1]
	at java.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke0(Native Method) ~[na:na]
	at java.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:77) ~[na:na]
	at java.base/jdk.internal.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43) ~[na:na]
	at java.base/java.lang.reflect.Method.invoke(Method.java:568) ~[na:na]
	at org.springframework.beans.factory.support.SimpleInstantiationStrategy.instantiate(SimpleInstantiationStrategy.java:154) ~[spring-beans-5.3.27.jar:5.3.27]
	... 59 common frames omitted
Caused by: org.apache.ibatis.builder.BuilderException: Error parsing Mapper XML. The XML location is 'file [A:\Desktop\workspace\HIS\his_service\target\classes\mapper\DiagnosisReportMapper.xml]'. Cause: org.apache.ibatis.builder.BuilderException: Error resolving class. Cause: org.apache.ibatis.type.TypeException: Could not resolve type alias 'com.luojiawei.his_service.domain.vo.Diagnosises'.  Cause: java.lang.ClassNotFoundException: Cannot find class: com.luojiawei.his_service.domain.vo.Diagnosises
	at org.apache.ibatis.builder.xml.XMLMapperBuilder.configurationElement(XMLMapperBuilder.java:128) ~[mybatis-3.5.13.jar:3.5.13]
	at org.apache.ibatis.builder.xml.XMLMapperBuilder.parse(XMLMapperBuilder.java:100) ~[mybatis-3.5.13.jar:3.5.13]
	at com.baomidou.mybatisplus.extension.spring.MybatisSqlSessionFactoryBean.buildSqlSessionFactory(MybatisSqlSessionFactoryBean.java:573) ~[mybatis-plus-extension-3.5.3.1.jar:3.5.3.1]
	... 67 common frames omitted
Caused by: org.apache.ibatis.builder.BuilderException: Error resolving class. Cause: org.apache.ibatis.type.TypeException: Could not resolve type alias 'com.luojiawei.his_service.domain.vo.Diagnosises'.  Cause: java.lang.ClassNotFoundException: Cannot find class: com.luojiawei.his_service.domain.vo.Diagnosises
	at org.apache.ibatis.builder.BaseBuilder.resolveClass(BaseBuilder.java:118) ~[mybatis-3.5.13.jar:3.5.13]
	at org.apache.ibatis.builder.xml.XMLStatementBuilder.parseStatementNode(XMLStatementBuilder.java:105) ~[mybatis-3.5.13.jar:3.5.13]
	at org.apache.ibatis.builder.xml.XMLMapperBuilder.buildStatementFromContext(XMLMapperBuilder.java:144) ~[mybatis-3.5.13.jar:3.5.13]
	at org.apache.ibatis.builder.xml.XMLMapperBuilder.buildStatementFromContext(XMLMapperBuilder.java:136) ~[mybatis-3.5.13.jar:3.5.13]
	at org.apache.ibatis.builder.xml.XMLMapperBuilder.configurationElement(XMLMapperBuilder.java:126) ~[mybatis-3.5.13.jar:3.5.13]
	... 69 common frames omitted
Caused by: org.apache.ibatis.type.TypeException: Could not resolve type alias 'com.luojiawei.his_service.domain.vo.Diagnosises'.  Cause: java.lang.ClassNotFoundException: Cannot find class: com.luojiawei.his_service.domain.vo.Diagnosises
	at org.apache.ibatis.type.TypeAliasRegistry.resolveAlias(TypeAliasRegistry.java:128) ~[mybatis-3.5.13.jar:3.5.13]
	at org.apache.ibatis.builder.BaseBuilder.resolveAlias(BaseBuilder.java:150) ~[mybatis-3.5.13.jar:3.5.13]
	at org.apache.ibatis.builder.BaseBuilder.resolveClass(BaseBuilder.java:116) ~[mybatis-3.5.13.jar:3.5.13]
	... 73 common frames omitted
Caused by: java.lang.ClassNotFoundException: Cannot find class: com.luojiawei.his_service.domain.vo.Diagnosises
	at org.apache.ibatis.io.ClassLoaderWrapper.classForName(ClassLoaderWrapper.java:226) ~[mybatis-3.5.13.jar:3.5.13]
	at org.apache.ibatis.io.ClassLoaderWrapper.classForName(ClassLoaderWrapper.java:103) ~[mybatis-3.5.13.jar:3.5.13]
	at org.apache.ibatis.io.Resources.classForName(Resources.java:322) ~[mybatis-3.5.13.jar:3.5.13]
	at org.apache.ibatis.type.TypeAliasRegistry.resolveAlias(TypeAliasRegistry.java:124) ~[mybatis-3.5.13.jar:3.5.13]
	... 75 common frames omitted

15:41:12:951  INFO 23208 --- [main] c.l.his_service.HisServiceApplication    : Starting HisServiceApplication using Java 17.0.11 on luo with PID 23208 (A:\Desktop\workspace\HIS\his_service\target\classes started by 22407 in A:\Desktop\workspace\HIS)
15:41:12:954 DEBUG 23208 --- [main] c.l.his_service.HisServiceApplication    : Running with Spring Boot v2.7.12, Spring v5.3.27
15:41:12:956  INFO 23208 --- [main] c.l.his_service.HisServiceApplication    : The following 1 profile is active: "dev"
15:41:13:854  INFO 23208 --- [main] .s.d.r.c.RepositoryConfigurationDelegate : Multiple Spring Data modules found, entering strict repository configuration mode
15:41:13:856  INFO 23208 --- [main] .s.d.r.c.RepositoryConfigurationDelegate : Bootstrapping Spring Data Redis repositories in DEFAULT mode.
15:41:13:882  INFO 23208 --- [main] .s.d.r.c.RepositoryConfigurationDelegate : Finished Spring Data repository scanning in 13 ms. Found 0 Redis repository interfaces.
15:41:14:152  INFO 23208 --- [main] o.s.cloud.context.scope.GenericScope     : BeanFactory id=6223b6d6-9ee6-3c52-951c-fcc2980a1fa1
15:41:14:782  INFO 23208 --- [main] o.s.b.w.embedded.tomcat.TomcatWebServer  : Tomcat initialized with port(s): 8080 (http)
15:41:14:793  INFO 23208 --- [main] o.apache.catalina.core.StandardService   : Starting service [Tomcat]
15:41:14:794  INFO 23208 --- [main] org.apache.catalina.core.StandardEngine  : Starting Servlet engine: [Apache Tomcat/9.0.75]
15:41:14:967  INFO 23208 --- [main] o.a.c.c.C.[Tomcat].[localhost].[/]       : Initializing Spring embedded WebApplicationContext
15:41:14:967  INFO 23208 --- [main] w.s.c.ServletWebServerApplicationContext : Root WebApplicationContext: initialization completed in 1966 ms
15:41:15:245  INFO 23208 --- [main] org.redisson.Version                     : Redisson 3.17.7
15:41:15:605  INFO 23208 --- [redisson-netty-2-9] o.r.c.pool.MasterPubSubConnectionPool    : 1 connections initialized for 111.230.32.147/111.230.32.147:9631
15:41:17:022  INFO 23208 --- [redisson-netty-2-19] o.r.c.pool.MasterConnectionPool          : 24 connections initialized for 111.230.32.147/111.230.32.147:9631
15:41:17:316 DEBUG 23208 --- [main] c.l.h.filter.RefreshTokenFilter          : Filter 'refreshTokenFilter' configured for use
15:41:17:783  WARN 23208 --- [main] ConfigServletWebServerApplicationContext : Exception encountered during context initialization - cancelling refresh attempt: org.springframework.beans.factory.UnsatisfiedDependencyException: Error creating bean with name 'aiModelController' defined in file [A:\Desktop\workspace\HIS\his_service\target\classes\com\luojiawei\his_service\controller\AiModelController.class]: Unsatisfied dependency expressed through constructor parameter 0; nested exception is org.springframework.beans.factory.UnsatisfiedDependencyException: Error creating bean with name 'uploadServiceImpl' defined in file [A:\Desktop\workspace\HIS\his_service\target\classes\com\luojiawei\his_service\service\impl\UploadServiceImpl.class]: Unsatisfied dependency expressed through constructor parameter 0; nested exception is org.springframework.beans.factory.UnsatisfiedDependencyException: Error creating bean with name 'aiModelMapper' defined in file [A:\Desktop\workspace\HIS\his_service\target\classes\com\luojiawei\his_service\mapper\AiModelMapper.class]: Unsatisfied dependency expressed through bean property 'sqlSessionFactory'; nested exception is org.springframework.beans.factory.BeanCreationException: Error creating bean with name 'sqlSessionFactory' defined in class path resource [com/baomidou/mybatisplus/autoconfigure/MybatisPlusAutoConfiguration.class]: Bean instantiation via factory method failed; nested exception is org.springframework.beans.BeanInstantiationException: Failed to instantiate [org.apache.ibatis.session.SqlSessionFactory]: Factory method 'sqlSessionFactory' threw exception; nested exception is java.io.IOException: Failed to parse mapping resource: 'file [A:\Desktop\workspace\HIS\his_service\target\classes\mapper\EyeImagesMapper.xml]'
15:41:17:832  INFO 23208 --- [main] o.apache.catalina.core.StandardService   : Stopping service [Tomcat]
15:41:17:836  WARN 23208 --- [main] o.a.c.loader.WebappClassLoaderBase       : The web application [ROOT] appears to have started a thread named [Thread-2] but has failed to stop it. This is very likely to create a memory leak. Stack trace of thread:
 java.base@17.0.11/sun.net.dns.ResolverConfigurationImpl.notifyAddrChange0(Native Method)
 java.base@17.0.11/sun.net.dns.ResolverConfigurationImpl$AddressChangeListener.run(ResolverConfigurationImpl.java:176)
15:41:17:852  INFO 23208 --- [main] ConditionEvaluationReportLoggingListener : 

Error starting ApplicationContext. To display the conditions report re-run your application with 'debug' enabled.
15:41:17:875 ERROR 23208 --- [main] o.s.boot.SpringApplication               : Application run failed

org.springframework.beans.factory.UnsatisfiedDependencyException: Error creating bean with name 'aiModelController' defined in file [A:\Desktop\workspace\HIS\his_service\target\classes\com\luojiawei\his_service\controller\AiModelController.class]: Unsatisfied dependency expressed through constructor parameter 0; nested exception is org.springframework.beans.factory.UnsatisfiedDependencyException: Error creating bean with name 'uploadServiceImpl' defined in file [A:\Desktop\workspace\HIS\his_service\target\classes\com\luojiawei\his_service\service\impl\UploadServiceImpl.class]: Unsatisfied dependency expressed through constructor parameter 0; nested exception is org.springframework.beans.factory.UnsatisfiedDependencyException: Error creating bean with name 'aiModelMapper' defined in file [A:\Desktop\workspace\HIS\his_service\target\classes\com\luojiawei\his_service\mapper\AiModelMapper.class]: Unsatisfied dependency expressed through bean property 'sqlSessionFactory'; nested exception is org.springframework.beans.factory.BeanCreationException: Error creating bean with name 'sqlSessionFactory' defined in class path resource [com/baomidou/mybatisplus/autoconfigure/MybatisPlusAutoConfiguration.class]: Bean instantiation via factory method failed; nested exception is org.springframework.beans.BeanInstantiationException: Failed to instantiate [org.apache.ibatis.session.SqlSessionFactory]: Factory method 'sqlSessionFactory' threw exception; nested exception is java.io.IOException: Failed to parse mapping resource: 'file [A:\Desktop\workspace\HIS\his_service\target\classes\mapper\EyeImagesMapper.xml]'
	at org.springframework.beans.factory.support.ConstructorResolver.createArgumentArray(ConstructorResolver.java:800) ~[spring-beans-5.3.27.jar:5.3.27]
	at org.springframework.beans.factory.support.ConstructorResolver.autowireConstructor(ConstructorResolver.java:229) ~[spring-beans-5.3.27.jar:5.3.27]
	at org.springframework.beans.factory.support.AbstractAutowireCapableBeanFactory.autowireConstructor(AbstractAutowireCapableBeanFactory.java:1372) ~[spring-beans-5.3.27.jar:5.3.27]
	at org.springframework.beans.factory.support.AbstractAutowireCapableBeanFactory.createBeanInstance(AbstractAutowireCapableBeanFactory.java:1222) ~[spring-beans-5.3.27.jar:5.3.27]
	at org.springframework.beans.factory.support.AbstractAutowireCapableBeanFactory.doCreateBean(AbstractAutowireCapableBeanFactory.java:582) ~[spring-beans-5.3.27.jar:5.3.27]
	at org.springframework.beans.factory.support.AbstractAutowireCapableBeanFactory.createBean(AbstractAutowireCapableBeanFactory.java:542) ~[spring-beans-5.3.27.jar:5.3.27]
	at org.springframework.beans.factory.support.AbstractBeanFactory.lambda$doGetBean$0(AbstractBeanFactory.java:335) ~[spring-beans-5.3.27.jar:5.3.27]
	at org.springframework.beans.factory.support.DefaultSingletonBeanRegistry.getSingleton(DefaultSingletonBeanRegistry.java:234) ~[spring-beans-5.3.27.jar:5.3.27]
	at org.springframework.beans.factory.support.AbstractBeanFactory.doGetBean(AbstractBeanFactory.java:333) ~[spring-beans-5.3.27.jar:5.3.27]
	at org.springframework.beans.factory.support.AbstractBeanFactory.getBean(AbstractBeanFactory.java:208) ~[spring-beans-5.3.27.jar:5.3.27]
	at org.springframework.beans.factory.support.DefaultListableBeanFactory.preInstantiateSingletons(DefaultListableBeanFactory.java:955) ~[spring-beans-5.3.27.jar:5.3.27]
	at org.springframework.context.support.AbstractApplicationContext.finishBeanFactoryInitialization(AbstractApplicationContext.java:920) ~[spring-context-5.3.27.jar:5.3.27]
	at org.springframework.context.support.AbstractApplicationContext.refresh(AbstractApplicationContext.java:583) ~[spring-context-5.3.27.jar:5.3.27]
	at org.springframework.boot.web.servlet.context.ServletWebServerApplicationContext.refresh(ServletWebServerApplicationContext.java:147) ~[spring-boot-2.7.12.jar:2.7.12]
	at org.springframework.boot.SpringApplication.refresh(SpringApplication.java:731) ~[spring-boot-2.7.12.jar:2.7.12]
	at org.springframework.boot.SpringApplication.refreshContext(SpringApplication.java:408) ~[spring-boot-2.7.12.jar:2.7.12]
	at org.springframework.boot.SpringApplication.run(SpringApplication.java:307) ~[spring-boot-2.7.12.jar:2.7.12]
	at org.springframework.boot.SpringApplication.run(SpringApplication.java:1303) ~[spring-boot-2.7.12.jar:2.7.12]
	at org.springframework.boot.SpringApplication.run(SpringApplication.java:1292) ~[spring-boot-2.7.12.jar:2.7.12]
	at com.luojiawei.his_service.HisServiceApplication.main(HisServiceApplication.java:19) ~[classes/:na]
Caused by: org.springframework.beans.factory.UnsatisfiedDependencyException: Error creating bean with name 'uploadServiceImpl' defined in file [A:\Desktop\workspace\HIS\his_service\target\classes\com\luojiawei\his_service\service\impl\UploadServiceImpl.class]: Unsatisfied dependency expressed through constructor parameter 0; nested exception is org.springframework.beans.factory.UnsatisfiedDependencyException: Error creating bean with name 'aiModelMapper' defined in file [A:\Desktop\workspace\HIS\his_service\target\classes\com\luojiawei\his_service\mapper\AiModelMapper.class]: Unsatisfied dependency expressed through bean property 'sqlSessionFactory'; nested exception is org.springframework.beans.factory.BeanCreationException: Error creating bean with name 'sqlSessionFactory' defined in class path resource [com/baomidou/mybatisplus/autoconfigure/MybatisPlusAutoConfiguration.class]: Bean instantiation via factory method failed; nested exception is org.springframework.beans.BeanInstantiationException: Failed to instantiate [org.apache.ibatis.session.SqlSessionFactory]: Factory method 'sqlSessionFactory' threw exception; nested exception is java.io.IOException: Failed to parse mapping resource: 'file [A:\Desktop\workspace\HIS\his_service\target\classes\mapper\EyeImagesMapper.xml]'
	at org.springframework.beans.factory.support.ConstructorResolver.createArgumentArray(ConstructorResolver.java:800) ~[spring-beans-5.3.27.jar:5.3.27]
	at org.springframework.beans.factory.support.ConstructorResolver.autowireConstructor(ConstructorResolver.java:229) ~[spring-beans-5.3.27.jar:5.3.27]
	at org.springframework.beans.factory.support.AbstractAutowireCapableBeanFactory.autowireConstructor(AbstractAutowireCapableBeanFactory.java:1372) ~[spring-beans-5.3.27.jar:5.3.27]
	at org.springframework.beans.factory.support.AbstractAutowireCapableBeanFactory.createBeanInstance(AbstractAutowireCapableBeanFactory.java:1222) ~[spring-beans-5.3.27.jar:5.3.27]
	at org.springframework.beans.factory.support.AbstractAutowireCapableBeanFactory.doCreateBean(AbstractAutowireCapableBeanFactory.java:582) ~[spring-beans-5.3.27.jar:5.3.27]
	at org.springframework.beans.factory.support.AbstractAutowireCapableBeanFactory.createBean(AbstractAutowireCapableBeanFactory.java:542) ~[spring-beans-5.3.27.jar:5.3.27]
	at org.springframework.beans.factory.support.AbstractBeanFactory.lambda$doGetBean$0(AbstractBeanFactory.java:335) ~[spring-beans-5.3.27.jar:5.3.27]
	at org.springframework.beans.factory.support.DefaultSingletonBeanRegistry.getSingleton(DefaultSingletonBeanRegistry.java:234) ~[spring-beans-5.3.27.jar:5.3.27]
	at org.springframework.beans.factory.support.AbstractBeanFactory.doGetBean(AbstractBeanFactory.java:333) ~[spring-beans-5.3.27.jar:5.3.27]
	at org.springframework.beans.factory.support.AbstractBeanFactory.getBean(AbstractBeanFactory.java:208) ~[spring-beans-5.3.27.jar:5.3.27]
	at org.springframework.beans.factory.config.DependencyDescriptor.resolveCandidate(DependencyDescriptor.java:276) ~[spring-beans-5.3.27.jar:5.3.27]
	at org.springframework.beans.factory.support.DefaultListableBeanFactory.doResolveDependency(DefaultListableBeanFactory.java:1391) ~[spring-beans-5.3.27.jar:5.3.27]
	at org.springframework.beans.factory.support.DefaultListableBeanFactory.resolveDependency(DefaultListableBeanFactory.java:1311) ~[spring-beans-5.3.27.jar:5.3.27]
	at org.springframework.beans.factory.support.ConstructorResolver.resolveAutowiredArgument(ConstructorResolver.java:887) ~[spring-beans-5.3.27.jar:5.3.27]
	at org.springframework.beans.factory.support.ConstructorResolver.createArgumentArray(ConstructorResolver.java:791) ~[spring-beans-5.3.27.jar:5.3.27]
	... 19 common frames omitted
Caused by: org.springframework.beans.factory.UnsatisfiedDependencyException: Error creating bean with name 'aiModelMapper' defined in file [A:\Desktop\workspace\HIS\his_service\target\classes\com\luojiawei\his_service\mapper\AiModelMapper.class]: Unsatisfied dependency expressed through bean property 'sqlSessionFactory'; nested exception is org.springframework.beans.factory.BeanCreationException: Error creating bean with name 'sqlSessionFactory' defined in class path resource [com/baomidou/mybatisplus/autoconfigure/MybatisPlusAutoConfiguration.class]: Bean instantiation via factory method failed; nested exception is org.springframework.beans.BeanInstantiationException: Failed to instantiate [org.apache.ibatis.session.SqlSessionFactory]: Factory method 'sqlSessionFactory' threw exception; nested exception is java.io.IOException: Failed to parse mapping resource: 'file [A:\Desktop\workspace\HIS\his_service\target\classes\mapper\EyeImagesMapper.xml]'
	at org.springframework.beans.factory.support.AbstractAutowireCapableBeanFactory.autowireByType(AbstractAutowireCapableBeanFactory.java:1534) ~[spring-beans-5.3.27.jar:5.3.27]
	at org.springframework.beans.factory.support.AbstractAutowireCapableBeanFactory.populateBean(AbstractAutowireCapableBeanFactory.java:1417) ~[spring-beans-5.3.27.jar:5.3.27]
	at org.springframework.beans.factory.support.AbstractAutowireCapableBeanFactory.doCreateBean(AbstractAutowireCapableBeanFactory.java:619) ~[spring-beans-5.3.27.jar:5.3.27]
	at org.springframework.beans.factory.support.AbstractAutowireCapableBeanFactory.createBean(AbstractAutowireCapableBeanFactory.java:542) ~[spring-beans-5.3.27.jar:5.3.27]
	at org.springframework.beans.factory.support.AbstractBeanFactory.lambda$doGetBean$0(AbstractBeanFactory.java:335) ~[spring-beans-5.3.27.jar:5.3.27]
	at org.springframework.beans.factory.support.DefaultSingletonBeanRegistry.getSingleton(DefaultSingletonBeanRegistry.java:234) ~[spring-beans-5.3.27.jar:5.3.27]
	at org.springframework.beans.factory.support.AbstractBeanFactory.doGetBean(AbstractBeanFactory.java:333) ~[spring-beans-5.3.27.jar:5.3.27]
	at org.springframework.beans.factory.support.AbstractBeanFactory.getBean(AbstractBeanFactory.java:208) ~[spring-beans-5.3.27.jar:5.3.27]
	at org.springframework.beans.factory.config.DependencyDescriptor.resolveCandidate(DependencyDescriptor.java:276) ~[spring-beans-5.3.27.jar:5.3.27]
	at org.springframework.beans.factory.support.DefaultListableBeanFactory.doResolveDependency(DefaultListableBeanFactory.java:1391) ~[spring-beans-5.3.27.jar:5.3.27]
	at org.springframework.beans.factory.support.DefaultListableBeanFactory.resolveDependency(DefaultListableBeanFactory.java:1311) ~[spring-beans-5.3.27.jar:5.3.27]
	at org.springframework.beans.factory.support.ConstructorResolver.resolveAutowiredArgument(ConstructorResolver.java:887) ~[spring-beans-5.3.27.jar:5.3.27]
	at org.springframework.beans.factory.support.ConstructorResolver.createArgumentArray(ConstructorResolver.java:791) ~[spring-beans-5.3.27.jar:5.3.27]
	... 33 common frames omitted
Caused by: org.springframework.beans.factory.BeanCreationException: Error creating bean with name 'sqlSessionFactory' defined in class path resource [com/baomidou/mybatisplus/autoconfigure/MybatisPlusAutoConfiguration.class]: Bean instantiation via factory method failed; nested exception is org.springframework.beans.BeanInstantiationException: Failed to instantiate [org.apache.ibatis.session.SqlSessionFactory]: Factory method 'sqlSessionFactory' threw exception; nested exception is java.io.IOException: Failed to parse mapping resource: 'file [A:\Desktop\workspace\HIS\his_service\target\classes\mapper\EyeImagesMapper.xml]'
	at org.springframework.beans.factory.support.ConstructorResolver.instantiate(ConstructorResolver.java:658) ~[spring-beans-5.3.27.jar:5.3.27]
	at org.springframework.beans.factory.support.ConstructorResolver.instantiateUsingFactoryMethod(ConstructorResolver.java:638) ~[spring-beans-5.3.27.jar:5.3.27]
	at org.springframework.beans.factory.support.AbstractAutowireCapableBeanFactory.instantiateUsingFactoryMethod(AbstractAutowireCapableBeanFactory.java:1352) ~[spring-beans-5.3.27.jar:5.3.27]
	at org.springframework.beans.factory.support.AbstractAutowireCapableBeanFactory.createBeanInstance(AbstractAutowireCapableBeanFactory.java:1195) ~[spring-beans-5.3.27.jar:5.3.27]
	at org.springframework.beans.factory.support.AbstractAutowireCapableBeanFactory.doCreateBean(AbstractAutowireCapableBeanFactory.java:582) ~[spring-beans-5.3.27.jar:5.3.27]
	at org.springframework.beans.factory.support.AbstractAutowireCapableBeanFactory.createBean(AbstractAutowireCapableBeanFactory.java:542) ~[spring-beans-5.3.27.jar:5.3.27]
	at org.springframework.beans.factory.support.AbstractBeanFactory.lambda$doGetBean$0(AbstractBeanFactory.java:335) ~[spring-beans-5.3.27.jar:5.3.27]
	at org.springframework.beans.factory.support.DefaultSingletonBeanRegistry.getSingleton(DefaultSingletonBeanRegistry.java:234) ~[spring-beans-5.3.27.jar:5.3.27]
	at org.springframework.beans.factory.support.AbstractBeanFactory.doGetBean(AbstractBeanFactory.java:333) ~[spring-beans-5.3.27.jar:5.3.27]
	at org.springframework.beans.factory.support.AbstractBeanFactory.getBean(AbstractBeanFactory.java:208) ~[spring-beans-5.3.27.jar:5.3.27]
	at org.springframework.beans.factory.config.DependencyDescriptor.resolveCandidate(DependencyDescriptor.java:276) ~[spring-beans-5.3.27.jar:5.3.27]
	at org.springframework.beans.factory.support.DefaultListableBeanFactory.doResolveDependency(DefaultListableBeanFactory.java:1391) ~[spring-beans-5.3.27.jar:5.3.27]
	at org.springframework.beans.factory.support.DefaultListableBeanFactory.resolveDependency(DefaultListableBeanFactory.java:1311) ~[spring-beans-5.3.27.jar:5.3.27]
	at org.springframework.beans.factory.support.AbstractAutowireCapableBeanFactory.autowireByType(AbstractAutowireCapableBeanFactory.java:1519) ~[spring-beans-5.3.27.jar:5.3.27]
	... 45 common frames omitted
Caused by: org.springframework.beans.BeanInstantiationException: Failed to instantiate [org.apache.ibatis.session.SqlSessionFactory]: Factory method 'sqlSessionFactory' threw exception; nested exception is java.io.IOException: Failed to parse mapping resource: 'file [A:\Desktop\workspace\HIS\his_service\target\classes\mapper\EyeImagesMapper.xml]'
	at org.springframework.beans.factory.support.SimpleInstantiationStrategy.instantiate(SimpleInstantiationStrategy.java:185) ~[spring-beans-5.3.27.jar:5.3.27]
	at org.springframework.beans.factory.support.ConstructorResolver.instantiate(ConstructorResolver.java:653) ~[spring-beans-5.3.27.jar:5.3.27]
	... 58 common frames omitted
Caused by: java.io.IOException: Failed to parse mapping resource: 'file [A:\Desktop\workspace\HIS\his_service\target\classes\mapper\EyeImagesMapper.xml]'
	at com.baomidou.mybatisplus.extension.spring.MybatisSqlSessionFactoryBean.buildSqlSessionFactory(MybatisSqlSessionFactoryBean.java:575) ~[mybatis-plus-extension-3.5.3.1.jar:3.5.3.1]
	at com.baomidou.mybatisplus.extension.spring.MybatisSqlSessionFactoryBean.afterPropertiesSet(MybatisSqlSessionFactoryBean.java:444) ~[mybatis-plus-extension-3.5.3.1.jar:3.5.3.1]
	at com.baomidou.mybatisplus.extension.spring.MybatisSqlSessionFactoryBean.getObject(MybatisSqlSessionFactoryBean.java:608) ~[mybatis-plus-extension-3.5.3.1.jar:3.5.3.1]
	at com.baomidou.mybatisplus.autoconfigure.MybatisPlusAutoConfiguration.sqlSessionFactory(MybatisPlusAutoConfiguration.java:224) ~[mybatis-plus-boot-starter-3.5.3.1.jar:3.5.3.1]
	at java.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke0(Native Method) ~[na:na]
	at java.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:77) ~[na:na]
	at java.base/jdk.internal.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43) ~[na:na]
	at java.base/java.lang.reflect.Method.invoke(Method.java:568) ~[na:na]
	at org.springframework.beans.factory.support.SimpleInstantiationStrategy.instantiate(SimpleInstantiationStrategy.java:154) ~[spring-beans-5.3.27.jar:5.3.27]
	... 59 common frames omitted
Caused by: org.apache.ibatis.builder.BuilderException: Error parsing Mapper XML. The XML location is 'file [A:\Desktop\workspace\HIS\his_service\target\classes\mapper\EyeImagesMapper.xml]'. Cause: org.apache.ibatis.builder.BuilderException: Error resolving class. Cause: org.apache.ibatis.type.TypeException: Could not resolve type alias 'com.luojiawei.his_service.domain.po.EyeImages'.  Cause: java.lang.ClassNotFoundException: Cannot find class: com.luojiawei.his_service.domain.po.EyeImages
	at org.apache.ibatis.builder.xml.XMLMapperBuilder.configurationElement(XMLMapperBuilder.java:128) ~[mybatis-3.5.13.jar:3.5.13]
	at org.apache.ibatis.builder.xml.XMLMapperBuilder.parse(XMLMapperBuilder.java:100) ~[mybatis-3.5.13.jar:3.5.13]
	at com.baomidou.mybatisplus.extension.spring.MybatisSqlSessionFactoryBean.buildSqlSessionFactory(MybatisSqlSessionFactoryBean.java:573) ~[mybatis-plus-extension-3.5.3.1.jar:3.5.3.1]
	... 67 common frames omitted
Caused by: org.apache.ibatis.builder.BuilderException: Error resolving class. Cause: org.apache.ibatis.type.TypeException: Could not resolve type alias 'com.luojiawei.his_service.domain.po.EyeImages'.  Cause: java.lang.ClassNotFoundException: Cannot find class: com.luojiawei.his_service.domain.po.EyeImages
	at org.apache.ibatis.builder.BaseBuilder.resolveClass(BaseBuilder.java:118) ~[mybatis-3.5.13.jar:3.5.13]
	at org.apache.ibatis.builder.xml.XMLStatementBuilder.parseStatementNode(XMLStatementBuilder.java:105) ~[mybatis-3.5.13.jar:3.5.13]
	at org.apache.ibatis.builder.xml.XMLMapperBuilder.buildStatementFromContext(XMLMapperBuilder.java:144) ~[mybatis-3.5.13.jar:3.5.13]
	at org.apache.ibatis.builder.xml.XMLMapperBuilder.buildStatementFromContext(XMLMapperBuilder.java:136) ~[mybatis-3.5.13.jar:3.5.13]
	at org.apache.ibatis.builder.xml.XMLMapperBuilder.configurationElement(XMLMapperBuilder.java:126) ~[mybatis-3.5.13.jar:3.5.13]
	... 69 common frames omitted
Caused by: org.apache.ibatis.type.TypeException: Could not resolve type alias 'com.luojiawei.his_service.domain.po.EyeImages'.  Cause: java.lang.ClassNotFoundException: Cannot find class: com.luojiawei.his_service.domain.po.EyeImages
	at org.apache.ibatis.type.TypeAliasRegistry.resolveAlias(TypeAliasRegistry.java:128) ~[mybatis-3.5.13.jar:3.5.13]
	at org.apache.ibatis.builder.BaseBuilder.resolveAlias(BaseBuilder.java:150) ~[mybatis-3.5.13.jar:3.5.13]
	at org.apache.ibatis.builder.BaseBuilder.resolveClass(BaseBuilder.java:116) ~[mybatis-3.5.13.jar:3.5.13]
	... 73 common frames omitted
Caused by: java.lang.ClassNotFoundException: Cannot find class: com.luojiawei.his_service.domain.po.EyeImages
	at org.apache.ibatis.io.ClassLoaderWrapper.classForName(ClassLoaderWrapper.java:226) ~[mybatis-3.5.13.jar:3.5.13]
	at org.apache.ibatis.io.ClassLoaderWrapper.classForName(ClassLoaderWrapper.java:103) ~[mybatis-3.5.13.jar:3.5.13]
	at org.apache.ibatis.io.Resources.classForName(Resources.java:322) ~[mybatis-3.5.13.jar:3.5.13]
	at org.apache.ibatis.type.TypeAliasRegistry.resolveAlias(TypeAliasRegistry.java:124) ~[mybatis-3.5.13.jar:3.5.13]
	... 75 common frames omitted

15:41:23:745  INFO 5528 --- [main] c.l.his_service.HisServiceApplication    : Starting HisServiceApplication using Java 17.0.11 on luo with PID 5528 (A:\Desktop\workspace\HIS\his_service\target\classes started by 22407 in A:\Desktop\workspace\HIS)
15:41:23:747 DEBUG 5528 --- [main] c.l.his_service.HisServiceApplication    : Running with Spring Boot v2.7.12, Spring v5.3.27
15:41:23:748  INFO 5528 --- [main] c.l.his_service.HisServiceApplication    : The following 1 profile is active: "dev"
15:41:24:789  INFO 5528 --- [main] .s.d.r.c.RepositoryConfigurationDelegate : Multiple Spring Data modules found, entering strict repository configuration mode
15:41:24:794  INFO 5528 --- [main] .s.d.r.c.RepositoryConfigurationDelegate : Bootstrapping Spring Data Redis repositories in DEFAULT mode.
15:41:24:823  INFO 5528 --- [main] .s.d.r.c.RepositoryConfigurationDelegate : Finished Spring Data repository scanning in 14 ms. Found 0 Redis repository interfaces.
15:41:25:098  INFO 5528 --- [main] o.s.cloud.context.scope.GenericScope     : BeanFactory id=6223b6d6-9ee6-3c52-951c-fcc2980a1fa1
15:41:25:641  INFO 5528 --- [main] o.s.b.w.embedded.tomcat.TomcatWebServer  : Tomcat initialized with port(s): 8080 (http)
15:41:25:649  INFO 5528 --- [main] o.apache.catalina.core.StandardService   : Starting service [Tomcat]
15:41:25:649  INFO 5528 --- [main] org.apache.catalina.core.StandardEngine  : Starting Servlet engine: [Apache Tomcat/9.0.75]
15:41:25:790  INFO 5528 --- [main] o.a.c.c.C.[Tomcat].[localhost].[/]       : Initializing Spring embedded WebApplicationContext
15:41:25:791  INFO 5528 --- [main] w.s.c.ServletWebServerApplicationContext : Root WebApplicationContext: initialization completed in 2000 ms
15:41:26:013  INFO 5528 --- [main] org.redisson.Version                     : Redisson 3.17.7
15:41:26:367  INFO 5528 --- [redisson-netty-2-9] o.r.c.pool.MasterPubSubConnectionPool    : 1 connections initialized for 111.230.32.147/111.230.32.147:9631
15:41:27:038  INFO 5528 --- [redisson-netty-2-19] o.r.c.pool.MasterConnectionPool          : 24 connections initialized for 111.230.32.147/111.230.32.147:9631
15:41:27:276 DEBUG 5528 --- [main] c.l.h.filter.RefreshTokenFilter          : Filter 'refreshTokenFilter' configured for use
15:41:27:686  WARN 5528 --- [main] ConfigServletWebServerApplicationContext : Exception encountered during context initialization - cancelling refresh attempt: org.springframework.beans.factory.UnsatisfiedDependencyException: Error creating bean with name 'aiModelController' defined in file [A:\Desktop\workspace\HIS\his_service\target\classes\com\luojiawei\his_service\controller\AiModelController.class]: Unsatisfied dependency expressed through constructor parameter 0; nested exception is org.springframework.beans.factory.UnsatisfiedDependencyException: Error creating bean with name 'uploadServiceImpl' defined in file [A:\Desktop\workspace\HIS\his_service\target\classes\com\luojiawei\his_service\service\impl\UploadServiceImpl.class]: Unsatisfied dependency expressed through constructor parameter 0; nested exception is org.springframework.beans.factory.UnsatisfiedDependencyException: Error creating bean with name 'aiModelMapper' defined in file [A:\Desktop\workspace\HIS\his_service\target\classes\com\luojiawei\his_service\mapper\AiModelMapper.class]: Unsatisfied dependency expressed through bean property 'sqlSessionFactory'; nested exception is org.springframework.beans.factory.BeanCreationException: Error creating bean with name 'sqlSessionFactory' defined in class path resource [com/baomidou/mybatisplus/autoconfigure/MybatisPlusAutoConfiguration.class]: Bean instantiation via factory method failed; nested exception is org.springframework.beans.BeanInstantiationException: Failed to instantiate [org.apache.ibatis.session.SqlSessionFactory]: Factory method 'sqlSessionFactory' threw exception; nested exception is java.io.IOException: Failed to parse mapping resource: 'file [A:\Desktop\workspace\HIS\his_service\target\classes\mapper\EyeImagesMapper.xml]'
15:41:27:737  INFO 5528 --- [main] o.apache.catalina.core.StandardService   : Stopping service [Tomcat]
15:41:27:740  WARN 5528 --- [main] o.a.c.loader.WebappClassLoaderBase       : The web application [ROOT] appears to have started a thread named [Thread-2] but has failed to stop it. This is very likely to create a memory leak. Stack trace of thread:
 java.base@17.0.11/sun.net.dns.ResolverConfigurationImpl.notifyAddrChange0(Native Method)
 java.base@17.0.11/sun.net.dns.ResolverConfigurationImpl$AddressChangeListener.run(ResolverConfigurationImpl.java:176)
15:41:27:753  INFO 5528 --- [main] ConditionEvaluationReportLoggingListener : 

Error starting ApplicationContext. To display the conditions report re-run your application with 'debug' enabled.
15:41:27:776 ERROR 5528 --- [main] o.s.boot.SpringApplication               : Application run failed

org.springframework.beans.factory.UnsatisfiedDependencyException: Error creating bean with name 'aiModelController' defined in file [A:\Desktop\workspace\HIS\his_service\target\classes\com\luojiawei\his_service\controller\AiModelController.class]: Unsatisfied dependency expressed through constructor parameter 0; nested exception is org.springframework.beans.factory.UnsatisfiedDependencyException: Error creating bean with name 'uploadServiceImpl' defined in file [A:\Desktop\workspace\HIS\his_service\target\classes\com\luojiawei\his_service\service\impl\UploadServiceImpl.class]: Unsatisfied dependency expressed through constructor parameter 0; nested exception is org.springframework.beans.factory.UnsatisfiedDependencyException: Error creating bean with name 'aiModelMapper' defined in file [A:\Desktop\workspace\HIS\his_service\target\classes\com\luojiawei\his_service\mapper\AiModelMapper.class]: Unsatisfied dependency expressed through bean property 'sqlSessionFactory'; nested exception is org.springframework.beans.factory.BeanCreationException: Error creating bean with name 'sqlSessionFactory' defined in class path resource [com/baomidou/mybatisplus/autoconfigure/MybatisPlusAutoConfiguration.class]: Bean instantiation via factory method failed; nested exception is org.springframework.beans.BeanInstantiationException: Failed to instantiate [org.apache.ibatis.session.SqlSessionFactory]: Factory method 'sqlSessionFactory' threw exception; nested exception is java.io.IOException: Failed to parse mapping resource: 'file [A:\Desktop\workspace\HIS\his_service\target\classes\mapper\EyeImagesMapper.xml]'
	at org.springframework.beans.factory.support.ConstructorResolver.createArgumentArray(ConstructorResolver.java:800) ~[spring-beans-5.3.27.jar:5.3.27]
	at org.springframework.beans.factory.support.ConstructorResolver.autowireConstructor(ConstructorResolver.java:229) ~[spring-beans-5.3.27.jar:5.3.27]
	at org.springframework.beans.factory.support.AbstractAutowireCapableBeanFactory.autowireConstructor(AbstractAutowireCapableBeanFactory.java:1372) ~[spring-beans-5.3.27.jar:5.3.27]
	at org.springframework.beans.factory.support.AbstractAutowireCapableBeanFactory.createBeanInstance(AbstractAutowireCapableBeanFactory.java:1222) ~[spring-beans-5.3.27.jar:5.3.27]
	at org.springframework.beans.factory.support.AbstractAutowireCapableBeanFactory.doCreateBean(AbstractAutowireCapableBeanFactory.java:582) ~[spring-beans-5.3.27.jar:5.3.27]
	at org.springframework.beans.factory.support.AbstractAutowireCapableBeanFactory.createBean(AbstractAutowireCapableBeanFactory.java:542) ~[spring-beans-5.3.27.jar:5.3.27]
	at org.springframework.beans.factory.support.AbstractBeanFactory.lambda$doGetBean$0(AbstractBeanFactory.java:335) ~[spring-beans-5.3.27.jar:5.3.27]
	at org.springframework.beans.factory.support.DefaultSingletonBeanRegistry.getSingleton(DefaultSingletonBeanRegistry.java:234) ~[spring-beans-5.3.27.jar:5.3.27]
	at org.springframework.beans.factory.support.AbstractBeanFactory.doGetBean(AbstractBeanFactory.java:333) ~[spring-beans-5.3.27.jar:5.3.27]
	at org.springframework.beans.factory.support.AbstractBeanFactory.getBean(AbstractBeanFactory.java:208) ~[spring-beans-5.3.27.jar:5.3.27]
	at org.springframework.beans.factory.support.DefaultListableBeanFactory.preInstantiateSingletons(DefaultListableBeanFactory.java:955) ~[spring-beans-5.3.27.jar:5.3.27]
	at org.springframework.context.support.AbstractApplicationContext.finishBeanFactoryInitialization(AbstractApplicationContext.java:920) ~[spring-context-5.3.27.jar:5.3.27]
	at org.springframework.context.support.AbstractApplicationContext.refresh(AbstractApplicationContext.java:583) ~[spring-context-5.3.27.jar:5.3.27]
	at org.springframework.boot.web.servlet.context.ServletWebServerApplicationContext.refresh(ServletWebServerApplicationContext.java:147) ~[spring-boot-2.7.12.jar:2.7.12]
	at org.springframework.boot.SpringApplication.refresh(SpringApplication.java:731) ~[spring-boot-2.7.12.jar:2.7.12]
	at org.springframework.boot.SpringApplication.refreshContext(SpringApplication.java:408) ~[spring-boot-2.7.12.jar:2.7.12]
	at org.springframework.boot.SpringApplication.run(SpringApplication.java:307) ~[spring-boot-2.7.12.jar:2.7.12]
	at org.springframework.boot.SpringApplication.run(SpringApplication.java:1303) ~[spring-boot-2.7.12.jar:2.7.12]
	at org.springframework.boot.SpringApplication.run(SpringApplication.java:1292) ~[spring-boot-2.7.12.jar:2.7.12]
	at com.luojiawei.his_service.HisServiceApplication.main(HisServiceApplication.java:19) ~[classes/:na]
Caused by: org.springframework.beans.factory.UnsatisfiedDependencyException: Error creating bean with name 'uploadServiceImpl' defined in file [A:\Desktop\workspace\HIS\his_service\target\classes\com\luojiawei\his_service\service\impl\UploadServiceImpl.class]: Unsatisfied dependency expressed through constructor parameter 0; nested exception is org.springframework.beans.factory.UnsatisfiedDependencyException: Error creating bean with name 'aiModelMapper' defined in file [A:\Desktop\workspace\HIS\his_service\target\classes\com\luojiawei\his_service\mapper\AiModelMapper.class]: Unsatisfied dependency expressed through bean property 'sqlSessionFactory'; nested exception is org.springframework.beans.factory.BeanCreationException: Error creating bean with name 'sqlSessionFactory' defined in class path resource [com/baomidou/mybatisplus/autoconfigure/MybatisPlusAutoConfiguration.class]: Bean instantiation via factory method failed; nested exception is org.springframework.beans.BeanInstantiationException: Failed to instantiate [org.apache.ibatis.session.SqlSessionFactory]: Factory method 'sqlSessionFactory' threw exception; nested exception is java.io.IOException: Failed to parse mapping resource: 'file [A:\Desktop\workspace\HIS\his_service\target\classes\mapper\EyeImagesMapper.xml]'
	at org.springframework.beans.factory.support.ConstructorResolver.createArgumentArray(ConstructorResolver.java:800) ~[spring-beans-5.3.27.jar:5.3.27]
	at org.springframework.beans.factory.support.ConstructorResolver.autowireConstructor(ConstructorResolver.java:229) ~[spring-beans-5.3.27.jar:5.3.27]
	at org.springframework.beans.factory.support.AbstractAutowireCapableBeanFactory.autowireConstructor(AbstractAutowireCapableBeanFactory.java:1372) ~[spring-beans-5.3.27.jar:5.3.27]
	at org.springframework.beans.factory.support.AbstractAutowireCapableBeanFactory.createBeanInstance(AbstractAutowireCapableBeanFactory.java:1222) ~[spring-beans-5.3.27.jar:5.3.27]
	at org.springframework.beans.factory.support.AbstractAutowireCapableBeanFactory.doCreateBean(AbstractAutowireCapableBeanFactory.java:582) ~[spring-beans-5.3.27.jar:5.3.27]
	at org.springframework.beans.factory.support.AbstractAutowireCapableBeanFactory.createBean(AbstractAutowireCapableBeanFactory.java:542) ~[spring-beans-5.3.27.jar:5.3.27]
	at org.springframework.beans.factory.support.AbstractBeanFactory.lambda$doGetBean$0(AbstractBeanFactory.java:335) ~[spring-beans-5.3.27.jar:5.3.27]
	at org.springframework.beans.factory.support.DefaultSingletonBeanRegistry.getSingleton(DefaultSingletonBeanRegistry.java:234) ~[spring-beans-5.3.27.jar:5.3.27]
	at org.springframework.beans.factory.support.AbstractBeanFactory.doGetBean(AbstractBeanFactory.java:333) ~[spring-beans-5.3.27.jar:5.3.27]
	at org.springframework.beans.factory.support.AbstractBeanFactory.getBean(AbstractBeanFactory.java:208) ~[spring-beans-5.3.27.jar:5.3.27]
	at org.springframework.beans.factory.config.DependencyDescriptor.resolveCandidate(DependencyDescriptor.java:276) ~[spring-beans-5.3.27.jar:5.3.27]
	at org.springframework.beans.factory.support.DefaultListableBeanFactory.doResolveDependency(DefaultListableBeanFactory.java:1391) ~[spring-beans-5.3.27.jar:5.3.27]
	at org.springframework.beans.factory.support.DefaultListableBeanFactory.resolveDependency(DefaultListableBeanFactory.java:1311) ~[spring-beans-5.3.27.jar:5.3.27]
	at org.springframework.beans.factory.support.ConstructorResolver.resolveAutowiredArgument(ConstructorResolver.java:887) ~[spring-beans-5.3.27.jar:5.3.27]
	at org.springframework.beans.factory.support.ConstructorResolver.createArgumentArray(ConstructorResolver.java:791) ~[spring-beans-5.3.27.jar:5.3.27]
	... 19 common frames omitted
Caused by: org.springframework.beans.factory.UnsatisfiedDependencyException: Error creating bean with name 'aiModelMapper' defined in file [A:\Desktop\workspace\HIS\his_service\target\classes\com\luojiawei\his_service\mapper\AiModelMapper.class]: Unsatisfied dependency expressed through bean property 'sqlSessionFactory'; nested exception is org.springframework.beans.factory.BeanCreationException: Error creating bean with name 'sqlSessionFactory' defined in class path resource [com/baomidou/mybatisplus/autoconfigure/MybatisPlusAutoConfiguration.class]: Bean instantiation via factory method failed; nested exception is org.springframework.beans.BeanInstantiationException: Failed to instantiate [org.apache.ibatis.session.SqlSessionFactory]: Factory method 'sqlSessionFactory' threw exception; nested exception is java.io.IOException: Failed to parse mapping resource: 'file [A:\Desktop\workspace\HIS\his_service\target\classes\mapper\EyeImagesMapper.xml]'
	at org.springframework.beans.factory.support.AbstractAutowireCapableBeanFactory.autowireByType(AbstractAutowireCapableBeanFactory.java:1534) ~[spring-beans-5.3.27.jar:5.3.27]
	at org.springframework.beans.factory.support.AbstractAutowireCapableBeanFactory.populateBean(AbstractAutowireCapableBeanFactory.java:1417) ~[spring-beans-5.3.27.jar:5.3.27]
	at org.springframework.beans.factory.support.AbstractAutowireCapableBeanFactory.doCreateBean(AbstractAutowireCapableBeanFactory.java:619) ~[spring-beans-5.3.27.jar:5.3.27]
	at org.springframework.beans.factory.support.AbstractAutowireCapableBeanFactory.createBean(AbstractAutowireCapableBeanFactory.java:542) ~[spring-beans-5.3.27.jar:5.3.27]
	at org.springframework.beans.factory.support.AbstractBeanFactory.lambda$doGetBean$0(AbstractBeanFactory.java:335) ~[spring-beans-5.3.27.jar:5.3.27]
	at org.springframework.beans.factory.support.DefaultSingletonBeanRegistry.getSingleton(DefaultSingletonBeanRegistry.java:234) ~[spring-beans-5.3.27.jar:5.3.27]
	at org.springframework.beans.factory.support.AbstractBeanFactory.doGetBean(AbstractBeanFactory.java:333) ~[spring-beans-5.3.27.jar:5.3.27]
	at org.springframework.beans.factory.support.AbstractBeanFactory.getBean(AbstractBeanFactory.java:208) ~[spring-beans-5.3.27.jar:5.3.27]
	at org.springframework.beans.factory.config.DependencyDescriptor.resolveCandidate(DependencyDescriptor.java:276) ~[spring-beans-5.3.27.jar:5.3.27]
	at org.springframework.beans.factory.support.DefaultListableBeanFactory.doResolveDependency(DefaultListableBeanFactory.java:1391) ~[spring-beans-5.3.27.jar:5.3.27]
	at org.springframework.beans.factory.support.DefaultListableBeanFactory.resolveDependency(DefaultListableBeanFactory.java:1311) ~[spring-beans-5.3.27.jar:5.3.27]
	at org.springframework.beans.factory.support.ConstructorResolver.resolveAutowiredArgument(ConstructorResolver.java:887) ~[spring-beans-5.3.27.jar:5.3.27]
	at org.springframework.beans.factory.support.ConstructorResolver.createArgumentArray(ConstructorResolver.java:791) ~[spring-beans-5.3.27.jar:5.3.27]
	... 33 common frames omitted
Caused by: org.springframework.beans.factory.BeanCreationException: Error creating bean with name 'sqlSessionFactory' defined in class path resource [com/baomidou/mybatisplus/autoconfigure/MybatisPlusAutoConfiguration.class]: Bean instantiation via factory method failed; nested exception is org.springframework.beans.BeanInstantiationException: Failed to instantiate [org.apache.ibatis.session.SqlSessionFactory]: Factory method 'sqlSessionFactory' threw exception; nested exception is java.io.IOException: Failed to parse mapping resource: 'file [A:\Desktop\workspace\HIS\his_service\target\classes\mapper\EyeImagesMapper.xml]'
	at org.springframework.beans.factory.support.ConstructorResolver.instantiate(ConstructorResolver.java:658) ~[spring-beans-5.3.27.jar:5.3.27]
	at org.springframework.beans.factory.support.ConstructorResolver.instantiateUsingFactoryMethod(ConstructorResolver.java:638) ~[spring-beans-5.3.27.jar:5.3.27]
	at org.springframework.beans.factory.support.AbstractAutowireCapableBeanFactory.instantiateUsingFactoryMethod(AbstractAutowireCapableBeanFactory.java:1352) ~[spring-beans-5.3.27.jar:5.3.27]
	at org.springframework.beans.factory.support.AbstractAutowireCapableBeanFactory.createBeanInstance(AbstractAutowireCapableBeanFactory.java:1195) ~[spring-beans-5.3.27.jar:5.3.27]
	at org.springframework.beans.factory.support.AbstractAutowireCapableBeanFactory.doCreateBean(AbstractAutowireCapableBeanFactory.java:582) ~[spring-beans-5.3.27.jar:5.3.27]
	at org.springframework.beans.factory.support.AbstractAutowireCapableBeanFactory.createBean(AbstractAutowireCapableBeanFactory.java:542) ~[spring-beans-5.3.27.jar:5.3.27]
	at org.springframework.beans.factory.support.AbstractBeanFactory.lambda$doGetBean$0(AbstractBeanFactory.java:335) ~[spring-beans-5.3.27.jar:5.3.27]
	at org.springframework.beans.factory.support.DefaultSingletonBeanRegistry.getSingleton(DefaultSingletonBeanRegistry.java:234) ~[spring-beans-5.3.27.jar:5.3.27]
	at org.springframework.beans.factory.support.AbstractBeanFactory.doGetBean(AbstractBeanFactory.java:333) ~[spring-beans-5.3.27.jar:5.3.27]
	at org.springframework.beans.factory.support.AbstractBeanFactory.getBean(AbstractBeanFactory.java:208) ~[spring-beans-5.3.27.jar:5.3.27]
	at org.springframework.beans.factory.config.DependencyDescriptor.resolveCandidate(DependencyDescriptor.java:276) ~[spring-beans-5.3.27.jar:5.3.27]
	at org.springframework.beans.factory.support.DefaultListableBeanFactory.doResolveDependency(DefaultListableBeanFactory.java:1391) ~[spring-beans-5.3.27.jar:5.3.27]
	at org.springframework.beans.factory.support.DefaultListableBeanFactory.resolveDependency(DefaultListableBeanFactory.java:1311) ~[spring-beans-5.3.27.jar:5.3.27]
	at org.springframework.beans.factory.support.AbstractAutowireCapableBeanFactory.autowireByType(AbstractAutowireCapableBeanFactory.java:1519) ~[spring-beans-5.3.27.jar:5.3.27]
	... 45 common frames omitted
Caused by: org.springframework.beans.BeanInstantiationException: Failed to instantiate [org.apache.ibatis.session.SqlSessionFactory]: Factory method 'sqlSessionFactory' threw exception; nested exception is java.io.IOException: Failed to parse mapping resource: 'file [A:\Desktop\workspace\HIS\his_service\target\classes\mapper\EyeImagesMapper.xml]'
	at org.springframework.beans.factory.support.SimpleInstantiationStrategy.instantiate(SimpleInstantiationStrategy.java:185) ~[spring-beans-5.3.27.jar:5.3.27]
	at org.springframework.beans.factory.support.ConstructorResolver.instantiate(ConstructorResolver.java:653) ~[spring-beans-5.3.27.jar:5.3.27]
	... 58 common frames omitted
Caused by: java.io.IOException: Failed to parse mapping resource: 'file [A:\Desktop\workspace\HIS\his_service\target\classes\mapper\EyeImagesMapper.xml]'
	at com.baomidou.mybatisplus.extension.spring.MybatisSqlSessionFactoryBean.buildSqlSessionFactory(MybatisSqlSessionFactoryBean.java:575) ~[mybatis-plus-extension-3.5.3.1.jar:3.5.3.1]
	at com.baomidou.mybatisplus.extension.spring.MybatisSqlSessionFactoryBean.afterPropertiesSet(MybatisSqlSessionFactoryBean.java:444) ~[mybatis-plus-extension-3.5.3.1.jar:3.5.3.1]
	at com.baomidou.mybatisplus.extension.spring.MybatisSqlSessionFactoryBean.getObject(MybatisSqlSessionFactoryBean.java:608) ~[mybatis-plus-extension-3.5.3.1.jar:3.5.3.1]
	at com.baomidou.mybatisplus.autoconfigure.MybatisPlusAutoConfiguration.sqlSessionFactory(MybatisPlusAutoConfiguration.java:224) ~[mybatis-plus-boot-starter-3.5.3.1.jar:3.5.3.1]
	at java.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke0(Native Method) ~[na:na]
	at java.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:77) ~[na:na]
	at java.base/jdk.internal.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43) ~[na:na]
	at java.base/java.lang.reflect.Method.invoke(Method.java:568) ~[na:na]
	at org.springframework.beans.factory.support.SimpleInstantiationStrategy.instantiate(SimpleInstantiationStrategy.java:154) ~[spring-beans-5.3.27.jar:5.3.27]
	... 59 common frames omitted
Caused by: org.apache.ibatis.builder.BuilderException: Error parsing Mapper XML. The XML location is 'file [A:\Desktop\workspace\HIS\his_service\target\classes\mapper\EyeImagesMapper.xml]'. Cause: org.apache.ibatis.builder.BuilderException: Error resolving class. Cause: org.apache.ibatis.type.TypeException: Could not resolve type alias 'com.luojiawei.his_service.domain.po.EyeImages'.  Cause: java.lang.ClassNotFoundException: Cannot find class: com.luojiawei.his_service.domain.po.EyeImages
	at org.apache.ibatis.builder.xml.XMLMapperBuilder.configurationElement(XMLMapperBuilder.java:128) ~[mybatis-3.5.13.jar:3.5.13]
	at org.apache.ibatis.builder.xml.XMLMapperBuilder.parse(XMLMapperBuilder.java:100) ~[mybatis-3.5.13.jar:3.5.13]
	at com.baomidou.mybatisplus.extension.spring.MybatisSqlSessionFactoryBean.buildSqlSessionFactory(MybatisSqlSessionFactoryBean.java:573) ~[mybatis-plus-extension-3.5.3.1.jar:3.5.3.1]
	... 67 common frames omitted
Caused by: org.apache.ibatis.builder.BuilderException: Error resolving class. Cause: org.apache.ibatis.type.TypeException: Could not resolve type alias 'com.luojiawei.his_service.domain.po.EyeImages'.  Cause: java.lang.ClassNotFoundException: Cannot find class: com.luojiawei.his_service.domain.po.EyeImages
	at org.apache.ibatis.builder.BaseBuilder.resolveClass(BaseBuilder.java:118) ~[mybatis-3.5.13.jar:3.5.13]
	at org.apache.ibatis.builder.xml.XMLStatementBuilder.parseStatementNode(XMLStatementBuilder.java:105) ~[mybatis-3.5.13.jar:3.5.13]
	at org.apache.ibatis.builder.xml.XMLMapperBuilder.buildStatementFromContext(XMLMapperBuilder.java:144) ~[mybatis-3.5.13.jar:3.5.13]
	at org.apache.ibatis.builder.xml.XMLMapperBuilder.buildStatementFromContext(XMLMapperBuilder.java:136) ~[mybatis-3.5.13.jar:3.5.13]
	at org.apache.ibatis.builder.xml.XMLMapperBuilder.configurationElement(XMLMapperBuilder.java:126) ~[mybatis-3.5.13.jar:3.5.13]
	... 69 common frames omitted
Caused by: org.apache.ibatis.type.TypeException: Could not resolve type alias 'com.luojiawei.his_service.domain.po.EyeImages'.  Cause: java.lang.ClassNotFoundException: Cannot find class: com.luojiawei.his_service.domain.po.EyeImages
	at org.apache.ibatis.type.TypeAliasRegistry.resolveAlias(TypeAliasRegistry.java:128) ~[mybatis-3.5.13.jar:3.5.13]
	at org.apache.ibatis.builder.BaseBuilder.resolveAlias(BaseBuilder.java:150) ~[mybatis-3.5.13.jar:3.5.13]
	at org.apache.ibatis.builder.BaseBuilder.resolveClass(BaseBuilder.java:116) ~[mybatis-3.5.13.jar:3.5.13]
	... 73 common frames omitted
Caused by: java.lang.ClassNotFoundException: Cannot find class: com.luojiawei.his_service.domain.po.EyeImages
	at org.apache.ibatis.io.ClassLoaderWrapper.classForName(ClassLoaderWrapper.java:226) ~[mybatis-3.5.13.jar:3.5.13]
	at org.apache.ibatis.io.ClassLoaderWrapper.classForName(ClassLoaderWrapper.java:103) ~[mybatis-3.5.13.jar:3.5.13]
	at org.apache.ibatis.io.Resources.classForName(Resources.java:322) ~[mybatis-3.5.13.jar:3.5.13]
	at org.apache.ibatis.type.TypeAliasRegistry.resolveAlias(TypeAliasRegistry.java:124) ~[mybatis-3.5.13.jar:3.5.13]
	... 75 common frames omitted

15:41:52:818  INFO 34656 --- [main] c.l.his_service.HisServiceApplication    : Starting HisServiceApplication using Java 17.0.11 on luo with PID 34656 (A:\Desktop\workspace\HIS\his_service\target\classes started by 22407 in A:\Desktop\workspace\HIS)
15:41:52:820 DEBUG 34656 --- [main] c.l.his_service.HisServiceApplication    : Running with Spring Boot v2.7.12, Spring v5.3.27
15:41:52:821  INFO 34656 --- [main] c.l.his_service.HisServiceApplication    : The following 1 profile is active: "dev"
15:41:53:782  INFO 34656 --- [main] .s.d.r.c.RepositoryConfigurationDelegate : Multiple Spring Data modules found, entering strict repository configuration mode
15:41:53:785  INFO 34656 --- [main] .s.d.r.c.RepositoryConfigurationDelegate : Bootstrapping Spring Data Redis repositories in DEFAULT mode.
15:41:53:812  INFO 34656 --- [main] .s.d.r.c.RepositoryConfigurationDelegate : Finished Spring Data repository scanning in 15 ms. Found 0 Redis repository interfaces.
15:41:54:065  INFO 34656 --- [main] o.s.cloud.context.scope.GenericScope     : BeanFactory id=6223b6d6-9ee6-3c52-951c-fcc2980a1fa1
15:41:54:611  INFO 34656 --- [main] o.s.b.w.embedded.tomcat.TomcatWebServer  : Tomcat initialized with port(s): 8080 (http)
15:41:54:619  INFO 34656 --- [main] o.apache.catalina.core.StandardService   : Starting service [Tomcat]
15:41:54:619  INFO 34656 --- [main] org.apache.catalina.core.StandardEngine  : Starting Servlet engine: [Apache Tomcat/9.0.75]
15:41:54:745  INFO 34656 --- [main] o.a.c.c.C.[Tomcat].[localhost].[/]       : Initializing Spring embedded WebApplicationContext
15:41:54:746  INFO 34656 --- [main] w.s.c.ServletWebServerApplicationContext : Root WebApplicationContext: initialization completed in 1862 ms
15:41:54:969  INFO 34656 --- [main] org.redisson.Version                     : Redisson 3.17.7
15:41:55:330  INFO 34656 --- [redisson-netty-2-9] o.r.c.pool.MasterPubSubConnectionPool    : 1 connections initialized for 111.230.32.147/111.230.32.147:9631
15:41:56:010  INFO 34656 --- [redisson-netty-2-19] o.r.c.pool.MasterConnectionPool          : 24 connections initialized for 111.230.32.147/111.230.32.147:9631
15:41:56:264 DEBUG 34656 --- [main] c.l.h.filter.RefreshTokenFilter          : Filter 'refreshTokenFilter' configured for use
15:41:57:136  INFO 34656 --- [main] o.s.c.openfeign.FeignClientFactoryBean   : For 'flask-service' URL not provided. Will try picking an instance via load-balancing.
15:41:57:256  INFO 34656 --- [main] o.s.c.openfeign.FeignClientFactoryBean   : For 'ai-service' URL not provided. Will try picking an instance via load-balancing.
15:41:57:297  WARN 34656 --- [main] c.b.m.core.metadata.TableInfoHelper      : Can not find table primary key in Class: "java.lang.Object".
15:41:57:297  WARN 34656 --- [main] c.b.m.core.injector.DefaultSqlInjector   : class java.lang.Object ,Not found @TableId annotation, Cannot use Mybatis-Plus 'xxById' Method.
15:41:59:025  WARN 34656 --- [main] iguration$LoadBalancerCaffeineWarnLogger : Spring Cloud LoadBalancer is currently working with the default cache. While this cache implementation is useful for development and tests, it's recommended to use Caffeine cache in production.You can switch to using Caffeine cache, by adding it and org.springframework.cache.caffeine.CaffeineCacheManager to the classpath.
15:41:59:034  INFO 34656 --- [main] o.s.b.a.e.web.EndpointLinksResolver      : Exposing 1 endpoint(s) beneath base path '/actuator'
15:41:59:115  INFO 34656 --- [main] o.s.b.w.embedded.tomcat.TomcatWebServer  : Tomcat started on port(s): 8080 (http) with context path ''
15:41:59:376  INFO 34656 --- [main] c.l.his_service.HisServiceApplication    : Started HisServiceApplication in 7.437 seconds (JVM running for 8.226)
15:41:59:527  INFO 34656 --- [RMI TCP Connection(2)-10.21.93.70] o.a.c.c.C.[Tomcat].[localhost].[/]       : Initializing Spring DispatcherServlet 'dispatcherServlet'
15:41:59:527  INFO 34656 --- [RMI TCP Connection(2)-10.21.93.70] o.s.web.servlet.DispatcherServlet        : Initializing Servlet 'dispatcherServlet'
15:41:59:529  INFO 34656 --- [RMI TCP Connection(2)-10.21.93.70] o.s.web.servlet.DispatcherServlet        : Completed initialization in 1 ms
15:41:59:545  INFO 34656 --- [RMI TCP Connection(3)-10.21.93.70] com.zaxxer.hikari.HikariDataSource       : HikariPool-1 - Starting...
15:42:00:245  INFO 34656 --- [RMI TCP Connection(3)-10.21.93.70] com.zaxxer.hikari.HikariDataSource       : HikariPool-1 - Start completed.
15:45:07:386  WARN 34656 --- [http-nio-8080-exec-2] o.a.c.util.SessionIdGeneratorBase        : Creation of SecureRandom instance for session ID generation using [SHA1PRNG] took [110] milliseconds.
15:45:08:151 DEBUG 34656 --- [http-nio-8080-exec-2] c.l.h.m.PatientMapper.selectIdByOpenId   : ==>  Preparing: select id, open_id, phone, name, verified, hospital_pid from patient where open_id = ?
15:45:08:184 DEBUG 34656 --- [http-nio-8080-exec-2] c.l.h.m.PatientMapper.selectIdByOpenId   : ==> Parameters: owhoa7fITbB2gA1N4dxwWmjN8Xsw(String)
15:45:08:274 DEBUG 34656 --- [http-nio-8080-exec-2] c.l.h.m.PatientMapper.selectIdByOpenId   : <==      Total: 1
15:45:16:548 DEBUG 34656 --- [http-nio-8080-exec-3] c.l.h.m.D.getDiagnosisList_mpCount       : ==>  Preparing: SELECT COUNT(*) AS total FROM diagnosis_report d JOIN ai_model a ON d.aimodel_id = a.id
15:45:16:548 DEBUG 34656 --- [http-nio-8080-exec-3] c.l.h.m.D.getDiagnosisList_mpCount       : ==> Parameters: 
15:45:16:583 DEBUG 34656 --- [http-nio-8080-exec-3] c.l.h.m.D.getDiagnosisList_mpCount       : <==      Total: 1
15:45:16:597 DEBUG 34656 --- [http-nio-8080-exec-3] c.l.h.m.D.getDiagnosisList               : ==>  Preparing: SELECT d.id, d.disease_name, d.disease_category, d.create_time, d.status, d.name, a.version FROM diagnosis_report d JOIN ai_model a ON d.aimodel_id = a.id ORDER BY d.create_time DESC LIMIT ?
15:45:16:598 DEBUG 34656 --- [http-nio-8080-exec-3] c.l.h.m.D.getDiagnosisList               : ==> Parameters: 2(Long)
15:45:16:637 DEBUG 34656 --- [http-nio-8080-exec-3] c.l.h.m.D.getDiagnosisList               : <==      Total: 2
15:45:20:302 DEBUG 34656 --- [http-nio-8080-exec-5] c.l.h.m.D.selectById                     : ==>  Preparing: SELECT id,patient_id,doctor_id,disease_name,disease_category,aimodel_id,result,create_time,status,id_card,name,score,remark FROM diagnosis_report WHERE id=?
15:45:20:303 DEBUG 34656 --- [http-nio-8080-exec-5] c.l.h.m.D.selectById                     : ==> Parameters: 1(Integer)
15:45:20:340 DEBUG 34656 --- [http-nio-8080-exec-5] c.l.h.m.D.selectById                     : <==      Total: 1
15:45:20:341 DEBUG 34656 --- [http-nio-8080-exec-5] c.l.h.mapper.PatientMapper.selectById    : ==>  Preparing: SELECT id,phone,id_card,name,verified,verified_by,verified_time,open_id,hospital_pid FROM patient WHERE id=?
15:45:20:341 DEBUG 34656 --- [http-nio-8080-exec-5] c.l.h.mapper.PatientMapper.selectById    : ==> Parameters: 1(Integer)
15:45:20:375 DEBUG 34656 --- [http-nio-8080-exec-5] c.l.h.mapper.PatientMapper.selectById    : <==      Total: 1
15:45:20:377 DEBUG 34656 --- [http-nio-8080-exec-5] c.l.h.mapper.DoctorMapper.selectById     : ==>  Preparing: SELECT id,phone,id_card,name,verified,verified_by,verified_time,license,department,hospital_pid FROM doctor WHERE id=?
15:45:20:378 DEBUG 34656 --- [http-nio-8080-exec-5] c.l.h.mapper.DoctorMapper.selectById     : ==> Parameters: 1(Integer)
15:45:20:413 DEBUG 34656 --- [http-nio-8080-exec-5] c.l.h.mapper.DoctorMapper.selectById     : <==      Total: 1
15:45:20:414 DEBUG 34656 --- [http-nio-8080-exec-5] c.l.h.m.E.selectListByDiagnosisId        : ==>  Preparing: select * from eye_images where dignosis_report_id = ?
15:45:20:414 DEBUG 34656 --- [http-nio-8080-exec-5] c.l.h.m.E.selectListByDiagnosisId        : ==> Parameters: 1(Integer)
15:45:20:449 DEBUG 34656 --- [http-nio-8080-exec-5] c.l.h.m.E.selectListByDiagnosisId        : <==      Total: 1
15:45:20:449 DEBUG 34656 --- [http-nio-8080-exec-5] c.l.h.m.T.selectByDiagnosisId            : ==>  Preparing: select * from treatment_plans where diagnosis_id = ?
15:45:20:450 DEBUG 34656 --- [http-nio-8080-exec-5] c.l.h.m.T.selectByDiagnosisId            : ==> Parameters: 1(Integer)
15:45:20:485 DEBUG 34656 --- [http-nio-8080-exec-5] c.l.h.m.T.selectByDiagnosisId            : <==      Total: 1
15:45:20:487 DEBUG 34656 --- [http-nio-8080-exec-5] c.l.h.m.M.selectByDiagnosisId            : ==>  Preparing: select * from medication_recommendations where diagnosis_id = ?
15:45:20:487 DEBUG 34656 --- [http-nio-8080-exec-5] c.l.h.m.M.selectByDiagnosisId            : ==> Parameters: 1(Integer)
15:45:20:523 DEBUG 34656 --- [http-nio-8080-exec-5] c.l.h.m.M.selectByDiagnosisId            : <==      Total: 1
15:45:20:524 DEBUG 34656 --- [http-nio-8080-exec-5] c.l.h.mapper.AiModelMapper.selectById    : ==>  Preparing: SELECT id,version,deploy_time,accuracy FROM ai_model WHERE id=?
15:45:20:524 DEBUG 34656 --- [http-nio-8080-exec-5] c.l.h.mapper.AiModelMapper.selectById    : ==> Parameters: 1(Integer)
15:45:20:557 DEBUG 34656 --- [http-nio-8080-exec-5] c.l.h.mapper.AiModelMapper.selectById    : <==      Total: 1
15:45:24:494 DEBUG 34656 --- [http-nio-8080-exec-4] c.l.h.m.D.getDiagnosisHistory_mpCount    : ==>  Preparing: SELECT COUNT(*) AS total FROM diagnosis_report d JOIN ai_model a ON d.aimodel_id = a.id JOIN doctor d2 ON d.doctor_id = d2.id
15:45:24:495 DEBUG 34656 --- [http-nio-8080-exec-4] c.l.h.m.D.getDiagnosisHistory_mpCount    : ==> Parameters: 
15:45:24:529 DEBUG 34656 --- [http-nio-8080-exec-4] c.l.h.m.D.getDiagnosisHistory_mpCount    : <==      Total: 1
15:45:24:530 DEBUG 34656 --- [http-nio-8080-exec-4] c.l.h.m.D.getDiagnosisHistory            : ==>  Preparing: SELECT d.id, d.disease_name, d.disease_category, d.create_time, d.status, d2.name, a.version AS model_version FROM diagnosis_report d JOIN ai_model a ON d.aimodel_id = a.id JOIN doctor d2 ON d.doctor_id = d2.id ORDER BY create_time Desc LIMIT ?
15:45:24:530 DEBUG 34656 --- [http-nio-8080-exec-4] c.l.h.m.D.getDiagnosisHistory            : ==> Parameters: 5(Long)
15:45:24:565 DEBUG 34656 --- [http-nio-8080-exec-4] c.l.h.m.D.getDiagnosisHistory            : <==      Total: 5
15:46:31:232 DEBUG 34656 --- [http-nio-8080-exec-8] c.l.h.m.D.selectById                     : ==>  Preparing: SELECT id,patient_id,doctor_id,disease_name,disease_category,aimodel_id,result,create_time,status,id_card,name,score,remark FROM diagnosis_report WHERE id=?
15:46:31:233 DEBUG 34656 --- [http-nio-8080-exec-8] c.l.h.m.D.selectById                     : ==> Parameters: 1(Integer)
15:46:31:267 DEBUG 34656 --- [http-nio-8080-exec-8] c.l.h.m.D.selectById                     : <==      Total: 1
15:46:31:268 DEBUG 34656 --- [http-nio-8080-exec-8] c.l.h.mapper.PatientMapper.selectById    : ==>  Preparing: SELECT id,phone,id_card,name,verified,verified_by,verified_time,open_id,hospital_pid FROM patient WHERE id=?
15:46:31:269 DEBUG 34656 --- [http-nio-8080-exec-8] c.l.h.mapper.PatientMapper.selectById    : ==> Parameters: 1(Integer)
15:46:31:302 DEBUG 34656 --- [http-nio-8080-exec-8] c.l.h.mapper.PatientMapper.selectById    : <==      Total: 1
15:46:31:303 DEBUG 34656 --- [http-nio-8080-exec-8] c.l.h.mapper.DoctorMapper.selectById     : ==>  Preparing: SELECT id,phone,id_card,name,verified,verified_by,verified_time,license,department,hospital_pid FROM doctor WHERE id=?
15:46:31:304 DEBUG 34656 --- [http-nio-8080-exec-8] c.l.h.mapper.DoctorMapper.selectById     : ==> Parameters: 1(Integer)
15:46:31:337 DEBUG 34656 --- [http-nio-8080-exec-8] c.l.h.mapper.DoctorMapper.selectById     : <==      Total: 1
15:46:31:338 DEBUG 34656 --- [http-nio-8080-exec-8] c.l.h.m.E.selectListByDiagnosisId        : ==>  Preparing: select * from eye_images where dignosis_report_id = ?
15:46:31:341 DEBUG 34656 --- [http-nio-8080-exec-8] c.l.h.m.E.selectListByDiagnosisId        : ==> Parameters: 1(Integer)
15:46:31:375 DEBUG 34656 --- [http-nio-8080-exec-8] c.l.h.m.E.selectListByDiagnosisId        : <==      Total: 1
15:46:31:377 DEBUG 34656 --- [http-nio-8080-exec-8] c.l.h.m.T.selectByDiagnosisId            : ==>  Preparing: select * from treatment_plans where diagnosis_id = ?
15:46:31:377 DEBUG 34656 --- [http-nio-8080-exec-8] c.l.h.m.T.selectByDiagnosisId            : ==> Parameters: 1(Integer)
15:46:31:412 DEBUG 34656 --- [http-nio-8080-exec-8] c.l.h.m.T.selectByDiagnosisId            : <==      Total: 1
15:46:31:413 DEBUG 34656 --- [http-nio-8080-exec-8] c.l.h.m.M.selectByDiagnosisId            : ==>  Preparing: select * from medication_recommendations where diagnosis_id = ?
15:46:31:413 DEBUG 34656 --- [http-nio-8080-exec-8] c.l.h.m.M.selectByDiagnosisId            : ==> Parameters: 1(Integer)
15:46:31:448 DEBUG 34656 --- [http-nio-8080-exec-8] c.l.h.m.M.selectByDiagnosisId            : <==      Total: 1
15:46:31:449 DEBUG 34656 --- [http-nio-8080-exec-8] c.l.h.mapper.AiModelMapper.selectById    : ==>  Preparing: SELECT id,version,deploy_time,accuracy FROM ai_model WHERE id=?
15:46:31:449 DEBUG 34656 --- [http-nio-8080-exec-8] c.l.h.mapper.AiModelMapper.selectById    : ==> Parameters: 1(Integer)
15:46:31:485 DEBUG 34656 --- [http-nio-8080-exec-8] c.l.h.mapper.AiModelMapper.selectById    : <==      Total: 1
15:46:31:543 DEBUG 34656 --- [http-nio-8080-exec-8] c.l.api.client.FlaskAiDoctorClient       : [FlaskAiDoctorClient#uploadFile] ---> POST http://ai-service/api/chat/completions HTTP/1.1
15:46:31:543 DEBUG 34656 --- [http-nio-8080-exec-8] c.l.api.client.FlaskAiDoctorClient       : [FlaskAiDoctorClient#uploadFile] Content-Length: 726
15:46:31:543 DEBUG 34656 --- [http-nio-8080-exec-8] c.l.api.client.FlaskAiDoctorClient       : [FlaskAiDoctorClient#uploadFile] Content-Type: application/json
15:46:31:544 DEBUG 34656 --- [http-nio-8080-exec-8] c.l.api.client.FlaskAiDoctorClient       : [FlaskAiDoctorClient#uploadFile] 
15:46:31:544 DEBUG 34656 --- [http-nio-8080-exec-8] c.l.api.client.FlaskAiDoctorClient       : [FlaskAiDoctorClient#uploadFile] {"diagnosis_name":"","diagnosis_category":"","result":"A","remark":"A","treatment_plan":{"id":1,"treatmentType":1,"treatmentDetail":"","startTime":"2025-03-01 09:00:00","endDate":"2025-03-10 09:00:00","doctorId":1,"createdTime":[2025,3,1,9,0],"updatedTime":[2025,3,1,9,0]},"medications":[{"id":1,"diagnosisId":1,"medicationName":"A","dosage":"10mg","frequency":"","sideEffects":"","startTime":[2025,3,1,9,0],"endTime":[2025,3,10,9,0],"doctorId":1,"createdTime":"2025-03-01 09:00:00","updatedTime":"2025-03-01 09:00:00"}],"previous_conversations":[{"role":"pariatur tempor do","content":"sit cupidatat commodo"}],"question":"irure eu esse","stream":false}
15:46:31:544 DEBUG 34656 --- [http-nio-8080-exec-8] c.l.api.client.FlaskAiDoctorClient       : [FlaskAiDoctorClient#uploadFile] ---> END HTTP (726-byte body)
15:46:31:627  WARN 34656 --- [http-nio-8080-exec-8] o.s.c.l.core.RoundRobinLoadBalancer      : No servers available for service: ai-service
15:46:31:629  WARN 34656 --- [http-nio-8080-exec-8] .s.c.o.l.FeignBlockingLoadBalancerClient : Load balancer does not contain an instance for the service ai-service
15:46:31:631 DEBUG 34656 --- [http-nio-8080-exec-8] c.l.api.client.FlaskAiDoctorClient       : [FlaskAiDoctorClient#uploadFile] <--- HTTP/1.1 503 (86ms)
15:46:31:631 DEBUG 34656 --- [http-nio-8080-exec-8] c.l.api.client.FlaskAiDoctorClient       : [FlaskAiDoctorClient#uploadFile] 
15:46:31:632 DEBUG 34656 --- [http-nio-8080-exec-8] c.l.api.client.FlaskAiDoctorClient       : [FlaskAiDoctorClient#uploadFile] Load balancer does not contain an instance for the service ai-service
15:46:31:632 DEBUG 34656 --- [http-nio-8080-exec-8] c.l.api.client.FlaskAiDoctorClient       : [FlaskAiDoctorClient#uploadFile] <--- END HTTP (69-byte body)
15:46:31:651 ERROR 34656 --- [http-nio-8080-exec-8] o.a.c.c.C.[.[.[/].[dispatcherServlet]    : Servlet.service() for servlet [dispatcherServlet] in context with path [] threw exception [Request processing failed; nested exception is feign.FeignException$ServiceUnavailable: [503] during [POST] to [http://ai-service/api/chat/completions] [FlaskAiDoctorClient#uploadFile(ChatForm,String)]: [Load balancer does not contain an instance for the service ai-service]] with root cause

feign.FeignException$ServiceUnavailable: [503] during [POST] to [http://ai-service/api/chat/completions] [FlaskAiDoctorClient#uploadFile(ChatForm,String)]: [Load balancer does not contain an instance for the service ai-service]
	at feign.FeignException.serverErrorStatus(FeignException.java:256) ~[feign-core-11.10.jar:na]
	at feign.FeignException.errorStatus(FeignException.java:197) ~[feign-core-11.10.jar:na]
	at feign.FeignException.errorStatus(FeignException.java:185) ~[feign-core-11.10.jar:na]
	at feign.codec.ErrorDecoder$Default.decode(ErrorDecoder.java:92) ~[feign-core-11.10.jar:na]
	at feign.AsyncResponseHandler.handleResponse(AsyncResponseHandler.java:98) ~[feign-core-11.10.jar:na]
	at feign.SynchronousMethodHandler.executeAndDecode(SynchronousMethodHandler.java:141) ~[feign-core-11.10.jar:na]
	at feign.SynchronousMethodHandler.invoke(SynchronousMethodHandler.java:91) ~[feign-core-11.10.jar:na]
	at feign.ReflectiveFeign$FeignInvocationHandler.invoke(ReflectiveFeign.java:100) ~[feign-core-11.10.jar:na]
	at jdk.proxy2/jdk.proxy2.$Proxy134.uploadFile(Unknown Source) ~[na:na]
	at com.luojiawei.his_service.controller.ChatController.ask(ChatController.java:38) ~[classes/:na]
	at java.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke0(Native Method) ~[na:na]
	at java.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:77) ~[na:na]
	at java.base/jdk.internal.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43) ~[na:na]
	at java.base/java.lang.reflect.Method.invoke(Method.java:568) ~[na:na]
	at org.springframework.web.method.support.InvocableHandlerMethod.doInvoke(InvocableHandlerMethod.java:205) ~[spring-web-5.3.27.jar:5.3.27]
	at org.springframework.web.method.support.InvocableHandlerMethod.invokeForRequest(InvocableHandlerMethod.java:150) ~[spring-web-5.3.27.jar:5.3.27]
	at org.springframework.web.servlet.mvc.method.annotation.ServletInvocableHandlerMethod.invokeAndHandle(ServletInvocableHandlerMethod.java:117) ~[spring-webmvc-5.3.27.jar:5.3.27]
	at org.springframework.web.servlet.mvc.method.annotation.RequestMappingHandlerAdapter.invokeHandlerMethod(RequestMappingHandlerAdapter.java:895) ~[spring-webmvc-5.3.27.jar:5.3.27]
	at org.springframework.web.servlet.mvc.method.annotation.RequestMappingHandlerAdapter.handleInternal(RequestMappingHandlerAdapter.java:808) ~[spring-webmvc-5.3.27.jar:5.3.27]
	at org.springframework.web.servlet.mvc.method.AbstractHandlerMethodAdapter.handle(AbstractHandlerMethodAdapter.java:87) ~[spring-webmvc-5.3.27.jar:5.3.27]
	at org.springframework.web.servlet.DispatcherServlet.doDispatch(DispatcherServlet.java:1072) ~[spring-webmvc-5.3.27.jar:5.3.27]
	at org.springframework.web.servlet.DispatcherServlet.doService(DispatcherServlet.java:965) ~[spring-webmvc-5.3.27.jar:5.3.27]
	at org.springframework.web.servlet.FrameworkServlet.processRequest(FrameworkServlet.java:1006) ~[spring-webmvc-5.3.27.jar:5.3.27]
	at org.springframework.web.servlet.FrameworkServlet.doPost(FrameworkServlet.java:909) ~[spring-webmvc-5.3.27.jar:5.3.27]
	at javax.servlet.http.HttpServlet.service(HttpServlet.java:555) ~[tomcat-embed-core-9.0.75.jar:4.0.FR]
	at org.springframework.web.servlet.FrameworkServlet.service(FrameworkServlet.java:883) ~[spring-webmvc-5.3.27.jar:5.3.27]
	at javax.servlet.http.HttpServlet.service(HttpServlet.java:623) ~[tomcat-embed-core-9.0.75.jar:4.0.FR]
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:209) ~[tomcat-embed-core-9.0.75.jar:9.0.75]
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:153) ~[tomcat-embed-core-9.0.75.jar:9.0.75]
	at com.luojiawei.his_service.filter.RefreshTokenFilter.doFilterInternal(RefreshTokenFilter.java:58) ~[classes/:na]
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:117) ~[spring-web-5.3.27.jar:5.3.27]
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:178) ~[tomcat-embed-core-9.0.75.jar:9.0.75]
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:153) ~[tomcat-embed-core-9.0.75.jar:9.0.75]
	at org.springframework.web.filter.RequestContextFilter.doFilterInternal(RequestContextFilter.java:100) ~[spring-web-5.3.27.jar:5.3.27]
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:117) ~[spring-web-5.3.27.jar:5.3.27]
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:178) ~[tomcat-embed-core-9.0.75.jar:9.0.75]
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:153) ~[tomcat-embed-core-9.0.75.jar:9.0.75]
	at org.springframework.web.filter.FormContentFilter.doFilterInternal(FormContentFilter.java:93) ~[spring-web-5.3.27.jar:5.3.27]
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:117) ~[spring-web-5.3.27.jar:5.3.27]
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:178) ~[tomcat-embed-core-9.0.75.jar:9.0.75]
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:153) ~[tomcat-embed-core-9.0.75.jar:9.0.75]
	at org.springframework.boot.actuate.metrics.web.servlet.WebMvcMetricsFilter.doFilterInternal(WebMvcMetricsFilter.java:96) ~[spring-boot-actuator-2.7.12.jar:2.7.12]
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:117) ~[spring-web-5.3.27.jar:5.3.27]
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:178) ~[tomcat-embed-core-9.0.75.jar:9.0.75]
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:153) ~[tomcat-embed-core-9.0.75.jar:9.0.75]
	at org.springframework.web.filter.CharacterEncodingFilter.doFilterInternal(CharacterEncodingFilter.java:201) ~[spring-web-5.3.27.jar:5.3.27]
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:117) ~[spring-web-5.3.27.jar:5.3.27]
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:178) ~[tomcat-embed-core-9.0.75.jar:9.0.75]
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:153) ~[tomcat-embed-core-9.0.75.jar:9.0.75]
	at org.apache.catalina.core.StandardWrapperValve.invoke(StandardWrapperValve.java:167) ~[tomcat-embed-core-9.0.75.jar:9.0.75]
	at org.apache.catalina.core.StandardContextValve.invoke(StandardContextValve.java:90) ~[tomcat-embed-core-9.0.75.jar:9.0.75]
	at org.apache.catalina.authenticator.AuthenticatorBase.invoke(AuthenticatorBase.java:481) ~[tomcat-embed-core-9.0.75.jar:9.0.75]
	at org.apache.catalina.core.StandardHostValve.invoke(StandardHostValve.java:130) ~[tomcat-embed-core-9.0.75.jar:9.0.75]
	at org.apache.catalina.valves.ErrorReportValve.invoke(ErrorReportValve.java:93) ~[tomcat-embed-core-9.0.75.jar:9.0.75]
	at org.apache.catalina.core.StandardEngineValve.invoke(StandardEngineValve.java:74) ~[tomcat-embed-core-9.0.75.jar:9.0.75]
	at org.apache.catalina.connector.CoyoteAdapter.service(CoyoteAdapter.java:343) ~[tomcat-embed-core-9.0.75.jar:9.0.75]
	at org.apache.coyote.http11.Http11Processor.service(Http11Processor.java:390) ~[tomcat-embed-core-9.0.75.jar:9.0.75]
	at org.apache.coyote.AbstractProcessorLight.process(AbstractProcessorLight.java:63) ~[tomcat-embed-core-9.0.75.jar:9.0.75]
	at org.apache.coyote.AbstractProtocol$ConnectionHandler.process(AbstractProtocol.java:926) ~[tomcat-embed-core-9.0.75.jar:9.0.75]
	at org.apache.tomcat.util.net.NioEndpoint$SocketProcessor.doRun(NioEndpoint.java:1791) ~[tomcat-embed-core-9.0.75.jar:9.0.75]
	at org.apache.tomcat.util.net.SocketProcessorBase.run(SocketProcessorBase.java:52) ~[tomcat-embed-core-9.0.75.jar:9.0.75]
	at org.apache.tomcat.util.threads.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1191) ~[tomcat-embed-core-9.0.75.jar:9.0.75]
	at org.apache.tomcat.util.threads.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:659) ~[tomcat-embed-core-9.0.75.jar:9.0.75]
	at org.apache.tomcat.util.threads.TaskThread$WrappingRunnable.run(TaskThread.java:61) ~[tomcat-embed-core-9.0.75.jar:9.0.75]
	at java.base/java.lang.Thread.run(Thread.java:840) ~[na:na]

15:46:49:469  INFO 34656 --- [SpringApplicationShutdownHook] com.zaxxer.hikari.HikariDataSource       : HikariPool-1 - Shutdown initiated...
15:46:49:772  INFO 34656 --- [SpringApplicationShutdownHook] com.zaxxer.hikari.HikariDataSource       : HikariPool-1 - Shutdown completed.
15:46:53:976  INFO 25496 --- [main] c.l.his_service.HisServiceApplication    : Starting HisServiceApplication using Java 17.0.11 on luo with PID 25496 (A:\Desktop\workspace\HIS\his_service\target\classes started by 22407 in A:\Desktop\workspace\HIS)
15:46:53:977 DEBUG 25496 --- [main] c.l.his_service.HisServiceApplication    : Running with Spring Boot v2.7.12, Spring v5.3.27
15:46:53:978  INFO 25496 --- [main] c.l.his_service.HisServiceApplication    : The following 1 profile is active: "dev"
15:46:54:961  INFO 25496 --- [main] .s.d.r.c.RepositoryConfigurationDelegate : Multiple Spring Data modules found, entering strict repository configuration mode
15:46:54:965  INFO 25496 --- [main] .s.d.r.c.RepositoryConfigurationDelegate : Bootstrapping Spring Data Redis repositories in DEFAULT mode.
15:46:54:995  INFO 25496 --- [main] .s.d.r.c.RepositoryConfigurationDelegate : Finished Spring Data repository scanning in 14 ms. Found 0 Redis repository interfaces.
15:46:55:252  INFO 25496 --- [main] o.s.cloud.context.scope.GenericScope     : BeanFactory id=6223b6d6-9ee6-3c52-951c-fcc2980a1fa1
15:46:55:827  INFO 25496 --- [main] o.s.b.w.embedded.tomcat.TomcatWebServer  : Tomcat initialized with port(s): 8080 (http)
15:46:55:835  INFO 25496 --- [main] o.apache.catalina.core.StandardService   : Starting service [Tomcat]
15:46:55:835  INFO 25496 --- [main] org.apache.catalina.core.StandardEngine  : Starting Servlet engine: [Apache Tomcat/9.0.75]
15:46:55:979  INFO 25496 --- [main] o.a.c.c.C.[Tomcat].[localhost].[/]       : Initializing Spring embedded WebApplicationContext
15:46:55:979  INFO 25496 --- [main] w.s.c.ServletWebServerApplicationContext : Root WebApplicationContext: initialization completed in 1949 ms
15:46:56:218  INFO 25496 --- [main] org.redisson.Version                     : Redisson 3.17.7
15:46:56:597  INFO 25496 --- [redisson-netty-2-9] o.r.c.pool.MasterPubSubConnectionPool    : 1 connections initialized for 111.230.32.147/111.230.32.147:9631
15:46:57:261  INFO 25496 --- [redisson-netty-2-19] o.r.c.pool.MasterConnectionPool          : 24 connections initialized for 111.230.32.147/111.230.32.147:9631
15:46:57:538 DEBUG 25496 --- [main] c.l.h.filter.RefreshTokenFilter          : Filter 'refreshTokenFilter' configured for use
15:46:58:330  INFO 25496 --- [main] o.s.c.openfeign.FeignClientFactoryBean   : For 'flask-service' URL not provided. Will try picking an instance via load-balancing.
15:46:58:471  INFO 25496 --- [main] o.s.c.openfeign.FeignClientFactoryBean   : For 'ai-service' URL not provided. Will try picking an instance via load-balancing.
15:46:58:537  WARN 25496 --- [main] c.b.m.core.metadata.TableInfoHelper      : Can not find table primary key in Class: "java.lang.Object".
15:46:58:538  WARN 25496 --- [main] c.b.m.core.injector.DefaultSqlInjector   : class java.lang.Object ,Not found @TableId annotation, Cannot use Mybatis-Plus 'xxById' Method.
15:46:59:651  WARN 25496 --- [main] iguration$LoadBalancerCaffeineWarnLogger : Spring Cloud LoadBalancer is currently working with the default cache. While this cache implementation is useful for development and tests, it's recommended to use Caffeine cache in production.You can switch to using Caffeine cache, by adding it and org.springframework.cache.caffeine.CaffeineCacheManager to the classpath.
15:46:59:657  INFO 25496 --- [main] o.s.b.a.e.web.EndpointLinksResolver      : Exposing 1 endpoint(s) beneath base path '/actuator'
15:46:59:737  INFO 25496 --- [main] o.s.b.w.embedded.tomcat.TomcatWebServer  : Tomcat started on port(s): 8080 (http) with context path ''
15:46:59:992  INFO 25496 --- [main] c.l.his_service.HisServiceApplication    : Started HisServiceApplication in 6.795 seconds (JVM running for 8.122)
15:47:00:113  INFO 25496 --- [RMI TCP Connection(6)-10.21.93.70] o.a.c.c.C.[Tomcat].[localhost].[/]       : Initializing Spring DispatcherServlet 'dispatcherServlet'
15:47:00:113  INFO 25496 --- [RMI TCP Connection(6)-10.21.93.70] o.s.web.servlet.DispatcherServlet        : Initializing Servlet 'dispatcherServlet'
15:47:00:117  INFO 25496 --- [RMI TCP Connection(6)-10.21.93.70] o.s.web.servlet.DispatcherServlet        : Completed initialization in 4 ms
15:47:00:119  INFO 25496 --- [RMI TCP Connection(5)-10.21.93.70] com.zaxxer.hikari.HikariDataSource       : HikariPool-1 - Starting...
15:47:00:787  INFO 25496 --- [RMI TCP Connection(5)-10.21.93.70] com.zaxxer.hikari.HikariDataSource       : HikariPool-1 - Start completed.
15:48:24:542 DEBUG 25496 --- [http-nio-8080-exec-2] c.l.h.m.D.selectById                     : ==>  Preparing: SELECT id,patient_id,doctor_id,disease_name,disease_category,aimodel_id,result,create_time,status,id_card,name,score,remark FROM diagnosis_report WHERE id=?
15:48:24:604 DEBUG 25496 --- [http-nio-8080-exec-2] c.l.h.m.D.selectById                     : ==> Parameters: 1(Integer)
15:48:24:694 DEBUG 25496 --- [http-nio-8080-exec-2] c.l.h.m.D.selectById                     : <==      Total: 1
15:48:24:698 DEBUG 25496 --- [http-nio-8080-exec-2] c.l.h.mapper.PatientMapper.selectById    : ==>  Preparing: SELECT id,phone,id_card,name,verified,verified_by,verified_time,open_id,hospital_pid FROM patient WHERE id=?
15:48:24:699 DEBUG 25496 --- [http-nio-8080-exec-2] c.l.h.mapper.PatientMapper.selectById    : ==> Parameters: 1(Integer)
15:48:24:730 DEBUG 25496 --- [http-nio-8080-exec-2] c.l.h.mapper.PatientMapper.selectById    : <==      Total: 1
15:48:24:733 DEBUG 25496 --- [http-nio-8080-exec-2] c.l.h.mapper.DoctorMapper.selectById     : ==>  Preparing: SELECT id,phone,id_card,name,verified,verified_by,verified_time,license,department,hospital_pid FROM doctor WHERE id=?
15:48:24:735 DEBUG 25496 --- [http-nio-8080-exec-2] c.l.h.mapper.DoctorMapper.selectById     : ==> Parameters: 1(Integer)
15:48:24:767 DEBUG 25496 --- [http-nio-8080-exec-2] c.l.h.mapper.DoctorMapper.selectById     : <==      Total: 1
15:48:24:773 DEBUG 25496 --- [http-nio-8080-exec-2] c.l.h.m.E.selectListByDiagnosisId        : ==>  Preparing: select * from eye_images where dignosis_report_id = ?
15:48:24:774 DEBUG 25496 --- [http-nio-8080-exec-2] c.l.h.m.E.selectListByDiagnosisId        : ==> Parameters: 1(Integer)
15:48:24:805 DEBUG 25496 --- [http-nio-8080-exec-2] c.l.h.m.E.selectListByDiagnosisId        : <==      Total: 1
15:48:24:807 DEBUG 25496 --- [http-nio-8080-exec-2] c.l.h.m.T.selectByDiagnosisId            : ==>  Preparing: select * from treatment_plans where diagnosis_id = ?
15:48:24:807 DEBUG 25496 --- [http-nio-8080-exec-2] c.l.h.m.T.selectByDiagnosisId            : ==> Parameters: 1(Integer)
15:48:24:837 DEBUG 25496 --- [http-nio-8080-exec-2] c.l.h.m.T.selectByDiagnosisId            : <==      Total: 1
15:48:24:838 DEBUG 25496 --- [http-nio-8080-exec-2] c.l.h.m.M.selectByDiagnosisId            : ==>  Preparing: select * from medication_recommendations where diagnosis_id = ?
15:48:24:839 DEBUG 25496 --- [http-nio-8080-exec-2] c.l.h.m.M.selectByDiagnosisId            : ==> Parameters: 1(Integer)
15:48:24:870 DEBUG 25496 --- [http-nio-8080-exec-2] c.l.h.m.M.selectByDiagnosisId            : <==      Total: 1
15:48:24:871 DEBUG 25496 --- [http-nio-8080-exec-2] c.l.h.mapper.AiModelMapper.selectById    : ==>  Preparing: SELECT id,version,deploy_time,accuracy FROM ai_model WHERE id=?
15:48:24:871 DEBUG 25496 --- [http-nio-8080-exec-2] c.l.h.mapper.AiModelMapper.selectById    : ==> Parameters: 1(Integer)
15:48:24:901 DEBUG 25496 --- [http-nio-8080-exec-2] c.l.h.mapper.AiModelMapper.selectById    : <==      Total: 1
15:48:38:052 DEBUG 25496 --- [http-nio-8080-exec-2] c.l.api.client.FlaskAiDoctorClient       : [FlaskAiDoctorClient#uploadFile] ---> POST http://ai-service/api/chat/completions HTTP/1.1
15:48:38:053 DEBUG 25496 --- [http-nio-8080-exec-2] c.l.api.client.FlaskAiDoctorClient       : [FlaskAiDoctorClient#uploadFile] Content-Length: 726
15:48:38:053 DEBUG 25496 --- [http-nio-8080-exec-2] c.l.api.client.FlaskAiDoctorClient       : [FlaskAiDoctorClient#uploadFile] Content-Type: application/json
15:48:38:053 DEBUG 25496 --- [http-nio-8080-exec-2] c.l.api.client.FlaskAiDoctorClient       : [FlaskAiDoctorClient#uploadFile] 
15:48:38:053 DEBUG 25496 --- [http-nio-8080-exec-2] c.l.api.client.FlaskAiDoctorClient       : [FlaskAiDoctorClient#uploadFile] {"diagnosis_name":"","diagnosis_category":"","result":"A","remark":"A","treatment_plan":{"id":1,"treatmentType":1,"treatmentDetail":"","startTime":"2025-03-01 09:00:00","endDate":"2025-03-10 09:00:00","doctorId":1,"createdTime":[2025,3,1,9,0],"updatedTime":[2025,3,1,9,0]},"medications":[{"id":1,"diagnosisId":1,"medicationName":"A","dosage":"10mg","frequency":"","sideEffects":"","startTime":[2025,3,1,9,0],"endTime":[2025,3,10,9,0],"doctorId":1,"createdTime":"2025-03-01 09:00:00","updatedTime":"2025-03-01 09:00:00"}],"previous_conversations":[{"role":"pariatur tempor do","content":"sit cupidatat commodo"}],"question":"irure eu esse","stream":false}
15:48:38:054 DEBUG 25496 --- [http-nio-8080-exec-2] c.l.api.client.FlaskAiDoctorClient       : [FlaskAiDoctorClient#uploadFile] ---> END HTTP (726-byte body)
15:48:38:185  WARN 25496 --- [http-nio-8080-exec-2] o.s.c.l.core.RoundRobinLoadBalancer      : No servers available for service: ai-service
15:48:38:187  WARN 25496 --- [http-nio-8080-exec-2] .s.c.o.l.FeignBlockingLoadBalancerClient : Load balancer does not contain an instance for the service ai-service
15:48:38:189 DEBUG 25496 --- [http-nio-8080-exec-2] c.l.api.client.FlaskAiDoctorClient       : [FlaskAiDoctorClient#uploadFile] <--- HTTP/1.1 503 (133ms)
15:48:38:189 DEBUG 25496 --- [http-nio-8080-exec-2] c.l.api.client.FlaskAiDoctorClient       : [FlaskAiDoctorClient#uploadFile] 
15:48:38:190 DEBUG 25496 --- [http-nio-8080-exec-2] c.l.api.client.FlaskAiDoctorClient       : [FlaskAiDoctorClient#uploadFile] Load balancer does not contain an instance for the service ai-service
15:48:38:190 DEBUG 25496 --- [http-nio-8080-exec-2] c.l.api.client.FlaskAiDoctorClient       : [FlaskAiDoctorClient#uploadFile] <--- END HTTP (69-byte body)
15:48:38:224 ERROR 25496 --- [http-nio-8080-exec-2] o.a.c.c.C.[.[.[/].[dispatcherServlet]    : Servlet.service() for servlet [dispatcherServlet] in context with path [] threw exception [Request processing failed; nested exception is feign.FeignException$ServiceUnavailable: [503] during [POST] to [http://ai-service/api/chat/completions] [FlaskAiDoctorClient#uploadFile(ChatForm,String)]: [Load balancer does not contain an instance for the service ai-service]] with root cause

feign.FeignException$ServiceUnavailable: [503] during [POST] to [http://ai-service/api/chat/completions] [FlaskAiDoctorClient#uploadFile(ChatForm,String)]: [Load balancer does not contain an instance for the service ai-service]
	at feign.FeignException.serverErrorStatus(FeignException.java:256) ~[feign-core-11.10.jar:na]
	at feign.FeignException.errorStatus(FeignException.java:197) ~[feign-core-11.10.jar:na]
	at feign.FeignException.errorStatus(FeignException.java:185) ~[feign-core-11.10.jar:na]
	at feign.codec.ErrorDecoder$Default.decode(ErrorDecoder.java:92) ~[feign-core-11.10.jar:na]
	at feign.AsyncResponseHandler.handleResponse(AsyncResponseHandler.java:98) ~[feign-core-11.10.jar:na]
	at feign.SynchronousMethodHandler.executeAndDecode(SynchronousMethodHandler.java:141) ~[feign-core-11.10.jar:na]
	at feign.SynchronousMethodHandler.invoke(SynchronousMethodHandler.java:91) ~[feign-core-11.10.jar:na]
	at feign.ReflectiveFeign$FeignInvocationHandler.invoke(ReflectiveFeign.java:100) ~[feign-core-11.10.jar:na]
	at jdk.proxy2/jdk.proxy2.$Proxy134.uploadFile(Unknown Source) ~[na:na]
	at com.luojiawei.his_service.controller.ChatController.ask(ChatController.java:38) ~[classes/:na]
	at java.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke0(Native Method) ~[na:na]
	at java.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:77) ~[na:na]
	at java.base/jdk.internal.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43) ~[na:na]
	at java.base/java.lang.reflect.Method.invoke(Method.java:568) ~[na:na]
	at org.springframework.web.method.support.InvocableHandlerMethod.doInvoke(InvocableHandlerMethod.java:205) ~[spring-web-5.3.27.jar:5.3.27]
	at org.springframework.web.method.support.InvocableHandlerMethod.invokeForRequest(InvocableHandlerMethod.java:150) ~[spring-web-5.3.27.jar:5.3.27]
	at org.springframework.web.servlet.mvc.method.annotation.ServletInvocableHandlerMethod.invokeAndHandle(ServletInvocableHandlerMethod.java:117) ~[spring-webmvc-5.3.27.jar:5.3.27]
	at org.springframework.web.servlet.mvc.method.annotation.RequestMappingHandlerAdapter.invokeHandlerMethod(RequestMappingHandlerAdapter.java:895) ~[spring-webmvc-5.3.27.jar:5.3.27]
	at org.springframework.web.servlet.mvc.method.annotation.RequestMappingHandlerAdapter.handleInternal(RequestMappingHandlerAdapter.java:808) ~[spring-webmvc-5.3.27.jar:5.3.27]
	at org.springframework.web.servlet.mvc.method.AbstractHandlerMethodAdapter.handle(AbstractHandlerMethodAdapter.java:87) ~[spring-webmvc-5.3.27.jar:5.3.27]
	at org.springframework.web.servlet.DispatcherServlet.doDispatch(DispatcherServlet.java:1072) ~[spring-webmvc-5.3.27.jar:5.3.27]
	at org.springframework.web.servlet.DispatcherServlet.doService(DispatcherServlet.java:965) ~[spring-webmvc-5.3.27.jar:5.3.27]
	at org.springframework.web.servlet.FrameworkServlet.processRequest(FrameworkServlet.java:1006) ~[spring-webmvc-5.3.27.jar:5.3.27]
	at org.springframework.web.servlet.FrameworkServlet.doPost(FrameworkServlet.java:909) ~[spring-webmvc-5.3.27.jar:5.3.27]
	at javax.servlet.http.HttpServlet.service(HttpServlet.java:555) ~[tomcat-embed-core-9.0.75.jar:4.0.FR]
	at org.springframework.web.servlet.FrameworkServlet.service(FrameworkServlet.java:883) ~[spring-webmvc-5.3.27.jar:5.3.27]
	at javax.servlet.http.HttpServlet.service(HttpServlet.java:623) ~[tomcat-embed-core-9.0.75.jar:4.0.FR]
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:209) ~[tomcat-embed-core-9.0.75.jar:9.0.75]
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:153) ~[tomcat-embed-core-9.0.75.jar:9.0.75]
	at com.luojiawei.his_service.filter.RefreshTokenFilter.doFilterInternal(RefreshTokenFilter.java:58) ~[classes/:na]
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:117) ~[spring-web-5.3.27.jar:5.3.27]
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:178) ~[tomcat-embed-core-9.0.75.jar:9.0.75]
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:153) ~[tomcat-embed-core-9.0.75.jar:9.0.75]
	at org.springframework.web.filter.RequestContextFilter.doFilterInternal(RequestContextFilter.java:100) ~[spring-web-5.3.27.jar:5.3.27]
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:117) ~[spring-web-5.3.27.jar:5.3.27]
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:178) ~[tomcat-embed-core-9.0.75.jar:9.0.75]
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:153) ~[tomcat-embed-core-9.0.75.jar:9.0.75]
	at org.springframework.web.filter.FormContentFilter.doFilterInternal(FormContentFilter.java:93) ~[spring-web-5.3.27.jar:5.3.27]
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:117) ~[spring-web-5.3.27.jar:5.3.27]
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:178) ~[tomcat-embed-core-9.0.75.jar:9.0.75]
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:153) ~[tomcat-embed-core-9.0.75.jar:9.0.75]
	at org.springframework.boot.actuate.metrics.web.servlet.WebMvcMetricsFilter.doFilterInternal(WebMvcMetricsFilter.java:96) ~[spring-boot-actuator-2.7.12.jar:2.7.12]
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:117) ~[spring-web-5.3.27.jar:5.3.27]
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:178) ~[tomcat-embed-core-9.0.75.jar:9.0.75]
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:153) ~[tomcat-embed-core-9.0.75.jar:9.0.75]
	at org.springframework.web.filter.CharacterEncodingFilter.doFilterInternal(CharacterEncodingFilter.java:201) ~[spring-web-5.3.27.jar:5.3.27]
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:117) ~[spring-web-5.3.27.jar:5.3.27]
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:178) ~[tomcat-embed-core-9.0.75.jar:9.0.75]
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:153) ~[tomcat-embed-core-9.0.75.jar:9.0.75]
	at org.apache.catalina.core.StandardWrapperValve.invoke(StandardWrapperValve.java:167) ~[tomcat-embed-core-9.0.75.jar:9.0.75]
	at org.apache.catalina.core.StandardContextValve.invoke(StandardContextValve.java:90) ~[tomcat-embed-core-9.0.75.jar:9.0.75]
	at org.apache.catalina.authenticator.AuthenticatorBase.invoke(AuthenticatorBase.java:481) ~[tomcat-embed-core-9.0.75.jar:9.0.75]
	at org.apache.catalina.core.StandardHostValve.invoke(StandardHostValve.java:130) ~[tomcat-embed-core-9.0.75.jar:9.0.75]
	at org.apache.catalina.valves.ErrorReportValve.invoke(ErrorReportValve.java:93) ~[tomcat-embed-core-9.0.75.jar:9.0.75]
	at org.apache.catalina.core.StandardEngineValve.invoke(StandardEngineValve.java:74) ~[tomcat-embed-core-9.0.75.jar:9.0.75]
	at org.apache.catalina.connector.CoyoteAdapter.service(CoyoteAdapter.java:343) ~[tomcat-embed-core-9.0.75.jar:9.0.75]
	at org.apache.coyote.http11.Http11Processor.service(Http11Processor.java:390) ~[tomcat-embed-core-9.0.75.jar:9.0.75]
	at org.apache.coyote.AbstractProcessorLight.process(AbstractProcessorLight.java:63) ~[tomcat-embed-core-9.0.75.jar:9.0.75]
	at org.apache.coyote.AbstractProtocol$ConnectionHandler.process(AbstractProtocol.java:926) ~[tomcat-embed-core-9.0.75.jar:9.0.75]
	at org.apache.tomcat.util.net.NioEndpoint$SocketProcessor.doRun(NioEndpoint.java:1791) ~[tomcat-embed-core-9.0.75.jar:9.0.75]
	at org.apache.tomcat.util.net.SocketProcessorBase.run(SocketProcessorBase.java:52) ~[tomcat-embed-core-9.0.75.jar:9.0.75]
	at org.apache.tomcat.util.threads.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1191) ~[tomcat-embed-core-9.0.75.jar:9.0.75]
	at org.apache.tomcat.util.threads.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:659) ~[tomcat-embed-core-9.0.75.jar:9.0.75]
	at org.apache.tomcat.util.threads.TaskThread$WrappingRunnable.run(TaskThread.java:61) ~[tomcat-embed-core-9.0.75.jar:9.0.75]
	at java.base/java.lang.Thread.run(Thread.java:840) ~[na:na]

15:49:10:174 DEBUG 25496 --- [http-nio-8080-exec-3] c.l.h.m.D.selectById                     : ==>  Preparing: SELECT id,patient_id,doctor_id,disease_name,disease_category,aimodel_id,result,create_time,status,id_card,name,score,remark FROM diagnosis_report WHERE id=?
15:49:10:175 DEBUG 25496 --- [http-nio-8080-exec-3] c.l.h.m.D.selectById                     : ==> Parameters: 1(Integer)
15:49:10:206 DEBUG 25496 --- [http-nio-8080-exec-3] c.l.h.m.D.selectById                     : <==      Total: 1
15:49:10:207 DEBUG 25496 --- [http-nio-8080-exec-3] c.l.h.mapper.PatientMapper.selectById    : ==>  Preparing: SELECT id,phone,id_card,name,verified,verified_by,verified_time,open_id,hospital_pid FROM patient WHERE id=?
15:49:10:207 DEBUG 25496 --- [http-nio-8080-exec-3] c.l.h.mapper.PatientMapper.selectById    : ==> Parameters: 1(Integer)
15:49:10:237 DEBUG 25496 --- [http-nio-8080-exec-3] c.l.h.mapper.PatientMapper.selectById    : <==      Total: 1
15:49:10:239 DEBUG 25496 --- [http-nio-8080-exec-3] c.l.h.mapper.DoctorMapper.selectById     : ==>  Preparing: SELECT id,phone,id_card,name,verified,verified_by,verified_time,license,department,hospital_pid FROM doctor WHERE id=?
15:49:10:239 DEBUG 25496 --- [http-nio-8080-exec-3] c.l.h.mapper.DoctorMapper.selectById     : ==> Parameters: 1(Integer)
15:49:10:270 DEBUG 25496 --- [http-nio-8080-exec-3] c.l.h.mapper.DoctorMapper.selectById     : <==      Total: 1
15:49:10:272 DEBUG 25496 --- [http-nio-8080-exec-3] c.l.h.m.E.selectListByDiagnosisId        : ==>  Preparing: select * from eye_images where dignosis_report_id = ?
15:49:10:272 DEBUG 25496 --- [http-nio-8080-exec-3] c.l.h.m.E.selectListByDiagnosisId        : ==> Parameters: 1(Integer)
15:49:10:302 DEBUG 25496 --- [http-nio-8080-exec-3] c.l.h.m.E.selectListByDiagnosisId        : <==      Total: 1
15:49:10:303 DEBUG 25496 --- [http-nio-8080-exec-3] c.l.h.m.T.selectByDiagnosisId            : ==>  Preparing: select * from treatment_plans where diagnosis_id = ?
15:49:10:304 DEBUG 25496 --- [http-nio-8080-exec-3] c.l.h.m.T.selectByDiagnosisId            : ==> Parameters: 1(Integer)
15:49:10:335 DEBUG 25496 --- [http-nio-8080-exec-3] c.l.h.m.T.selectByDiagnosisId            : <==      Total: 1
15:49:10:336 DEBUG 25496 --- [http-nio-8080-exec-3] c.l.h.m.M.selectByDiagnosisId            : ==>  Preparing: select * from medication_recommendations where diagnosis_id = ?
15:49:10:336 DEBUG 25496 --- [http-nio-8080-exec-3] c.l.h.m.M.selectByDiagnosisId            : ==> Parameters: 1(Integer)
15:49:10:366 DEBUG 25496 --- [http-nio-8080-exec-3] c.l.h.m.M.selectByDiagnosisId            : <==      Total: 1
15:49:10:367 DEBUG 25496 --- [http-nio-8080-exec-3] c.l.h.mapper.AiModelMapper.selectById    : ==>  Preparing: SELECT id,version,deploy_time,accuracy FROM ai_model WHERE id=?
15:49:10:367 DEBUG 25496 --- [http-nio-8080-exec-3] c.l.h.mapper.AiModelMapper.selectById    : ==> Parameters: 1(Integer)
15:49:10:397 DEBUG 25496 --- [http-nio-8080-exec-3] c.l.h.mapper.AiModelMapper.selectById    : <==      Total: 1
15:49:10:410 DEBUG 25496 --- [http-nio-8080-exec-3] c.l.api.client.FlaskAiDoctorClient       : [FlaskAiDoctorClient#uploadFile] ---> POST http://ai-service/api/chat/completions HTTP/1.1
15:49:10:410 DEBUG 25496 --- [http-nio-8080-exec-3] c.l.api.client.FlaskAiDoctorClient       : [FlaskAiDoctorClient#uploadFile] Content-Length: 726
15:49:10:410 DEBUG 25496 --- [http-nio-8080-exec-3] c.l.api.client.FlaskAiDoctorClient       : [FlaskAiDoctorClient#uploadFile] Content-Type: application/json
15:49:10:410 DEBUG 25496 --- [http-nio-8080-exec-3] c.l.api.client.FlaskAiDoctorClient       : [FlaskAiDoctorClient#uploadFile] 
15:49:10:410 DEBUG 25496 --- [http-nio-8080-exec-3] c.l.api.client.FlaskAiDoctorClient       : [FlaskAiDoctorClient#uploadFile] {"diagnosis_name":"","diagnosis_category":"","result":"A","remark":"A","treatment_plan":{"id":1,"treatmentType":1,"treatmentDetail":"","startTime":"2025-03-01 09:00:00","endDate":"2025-03-10 09:00:00","doctorId":1,"createdTime":[2025,3,1,9,0],"updatedTime":[2025,3,1,9,0]},"medications":[{"id":1,"diagnosisId":1,"medicationName":"A","dosage":"10mg","frequency":"","sideEffects":"","startTime":[2025,3,1,9,0],"endTime":[2025,3,10,9,0],"doctorId":1,"createdTime":"2025-03-01 09:00:00","updatedTime":"2025-03-01 09:00:00"}],"previous_conversations":[{"role":"pariatur tempor do","content":"sit cupidatat commodo"}],"question":"irure eu esse","stream":false}
15:49:10:411 DEBUG 25496 --- [http-nio-8080-exec-3] c.l.api.client.FlaskAiDoctorClient       : [FlaskAiDoctorClient#uploadFile] ---> END HTTP (726-byte body)
15:49:10:413  WARN 25496 --- [http-nio-8080-exec-3] o.s.c.l.core.RoundRobinLoadBalancer      : No servers available for service: ai-service
15:49:10:413  WARN 25496 --- [http-nio-8080-exec-3] .s.c.o.l.FeignBlockingLoadBalancerClient : Load balancer does not contain an instance for the service ai-service
15:49:10:413 DEBUG 25496 --- [http-nio-8080-exec-3] c.l.api.client.FlaskAiDoctorClient       : [FlaskAiDoctorClient#uploadFile] <--- HTTP/1.1 503 (2ms)
15:49:10:413 DEBUG 25496 --- [http-nio-8080-exec-3] c.l.api.client.FlaskAiDoctorClient       : [FlaskAiDoctorClient#uploadFile] 
15:49:10:413 DEBUG 25496 --- [http-nio-8080-exec-3] c.l.api.client.FlaskAiDoctorClient       : [FlaskAiDoctorClient#uploadFile] Load balancer does not contain an instance for the service ai-service
15:49:10:413 DEBUG 25496 --- [http-nio-8080-exec-3] c.l.api.client.FlaskAiDoctorClient       : [FlaskAiDoctorClient#uploadFile] <--- END HTTP (69-byte body)
15:49:10:414 ERROR 25496 --- [http-nio-8080-exec-3] o.a.c.c.C.[.[.[/].[dispatcherServlet]    : Servlet.service() for servlet [dispatcherServlet] in context with path [] threw exception [Request processing failed; nested exception is feign.FeignException$ServiceUnavailable: [503] during [POST] to [http://ai-service/api/chat/completions] [FlaskAiDoctorClient#uploadFile(ChatForm,String)]: [Load balancer does not contain an instance for the service ai-service]] with root cause

feign.FeignException$ServiceUnavailable: [503] during [POST] to [http://ai-service/api/chat/completions] [FlaskAiDoctorClient#uploadFile(ChatForm,String)]: [Load balancer does not contain an instance for the service ai-service]
	at feign.FeignException.serverErrorStatus(FeignException.java:256) ~[feign-core-11.10.jar:na]
	at feign.FeignException.errorStatus(FeignException.java:197) ~[feign-core-11.10.jar:na]
	at feign.FeignException.errorStatus(FeignException.java:185) ~[feign-core-11.10.jar:na]
	at feign.codec.ErrorDecoder$Default.decode(ErrorDecoder.java:92) ~[feign-core-11.10.jar:na]
	at feign.AsyncResponseHandler.handleResponse(AsyncResponseHandler.java:98) ~[feign-core-11.10.jar:na]
	at feign.SynchronousMethodHandler.executeAndDecode(SynchronousMethodHandler.java:141) ~[feign-core-11.10.jar:na]
	at feign.SynchronousMethodHandler.invoke(SynchronousMethodHandler.java:91) ~[feign-core-11.10.jar:na]
	at feign.ReflectiveFeign$FeignInvocationHandler.invoke(ReflectiveFeign.java:100) ~[feign-core-11.10.jar:na]
	at jdk.proxy2/jdk.proxy2.$Proxy134.uploadFile(Unknown Source) ~[na:na]
	at com.luojiawei.his_service.controller.ChatController.ask(ChatController.java:38) ~[classes/:na]
	at java.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke0(Native Method) ~[na:na]
	at java.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:77) ~[na:na]
	at java.base/jdk.internal.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43) ~[na:na]
	at java.base/java.lang.reflect.Method.invoke(Method.java:568) ~[na:na]
	at org.springframework.web.method.support.InvocableHandlerMethod.doInvoke(InvocableHandlerMethod.java:205) ~[spring-web-5.3.27.jar:5.3.27]
	at org.springframework.web.method.support.InvocableHandlerMethod.invokeForRequest(InvocableHandlerMethod.java:150) ~[spring-web-5.3.27.jar:5.3.27]
	at org.springframework.web.servlet.mvc.method.annotation.ServletInvocableHandlerMethod.invokeAndHandle(ServletInvocableHandlerMethod.java:117) ~[spring-webmvc-5.3.27.jar:5.3.27]
	at org.springframework.web.servlet.mvc.method.annotation.RequestMappingHandlerAdapter.invokeHandlerMethod(RequestMappingHandlerAdapter.java:895) ~[spring-webmvc-5.3.27.jar:5.3.27]
	at org.springframework.web.servlet.mvc.method.annotation.RequestMappingHandlerAdapter.handleInternal(RequestMappingHandlerAdapter.java:808) ~[spring-webmvc-5.3.27.jar:5.3.27]
	at org.springframework.web.servlet.mvc.method.AbstractHandlerMethodAdapter.handle(AbstractHandlerMethodAdapter.java:87) ~[spring-webmvc-5.3.27.jar:5.3.27]
	at org.springframework.web.servlet.DispatcherServlet.doDispatch(DispatcherServlet.java:1072) ~[spring-webmvc-5.3.27.jar:5.3.27]
	at org.springframework.web.servlet.DispatcherServlet.doService(DispatcherServlet.java:965) ~[spring-webmvc-5.3.27.jar:5.3.27]
	at org.springframework.web.servlet.FrameworkServlet.processRequest(FrameworkServlet.java:1006) ~[spring-webmvc-5.3.27.jar:5.3.27]
	at org.springframework.web.servlet.FrameworkServlet.doPost(FrameworkServlet.java:909) ~[spring-webmvc-5.3.27.jar:5.3.27]
	at javax.servlet.http.HttpServlet.service(HttpServlet.java:555) ~[tomcat-embed-core-9.0.75.jar:4.0.FR]
	at org.springframework.web.servlet.FrameworkServlet.service(FrameworkServlet.java:883) ~[spring-webmvc-5.3.27.jar:5.3.27]
	at javax.servlet.http.HttpServlet.service(HttpServlet.java:623) ~[tomcat-embed-core-9.0.75.jar:4.0.FR]
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:209) ~[tomcat-embed-core-9.0.75.jar:9.0.75]
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:153) ~[tomcat-embed-core-9.0.75.jar:9.0.75]
	at com.luojiawei.his_service.filter.RefreshTokenFilter.doFilterInternal(RefreshTokenFilter.java:58) ~[classes/:na]
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:117) ~[spring-web-5.3.27.jar:5.3.27]
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:178) ~[tomcat-embed-core-9.0.75.jar:9.0.75]
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:153) ~[tomcat-embed-core-9.0.75.jar:9.0.75]
	at org.springframework.web.filter.RequestContextFilter.doFilterInternal(RequestContextFilter.java:100) ~[spring-web-5.3.27.jar:5.3.27]
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:117) ~[spring-web-5.3.27.jar:5.3.27]
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:178) ~[tomcat-embed-core-9.0.75.jar:9.0.75]
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:153) ~[tomcat-embed-core-9.0.75.jar:9.0.75]
	at org.springframework.web.filter.FormContentFilter.doFilterInternal(FormContentFilter.java:93) ~[spring-web-5.3.27.jar:5.3.27]
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:117) ~[spring-web-5.3.27.jar:5.3.27]
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:178) ~[tomcat-embed-core-9.0.75.jar:9.0.75]
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:153) ~[tomcat-embed-core-9.0.75.jar:9.0.75]
	at org.springframework.boot.actuate.metrics.web.servlet.WebMvcMetricsFilter.doFilterInternal(WebMvcMetricsFilter.java:96) ~[spring-boot-actuator-2.7.12.jar:2.7.12]
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:117) ~[spring-web-5.3.27.jar:5.3.27]
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:178) ~[tomcat-embed-core-9.0.75.jar:9.0.75]
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:153) ~[tomcat-embed-core-9.0.75.jar:9.0.75]
	at org.springframework.web.filter.CharacterEncodingFilter.doFilterInternal(CharacterEncodingFilter.java:201) ~[spring-web-5.3.27.jar:5.3.27]
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:117) ~[spring-web-5.3.27.jar:5.3.27]
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:178) ~[tomcat-embed-core-9.0.75.jar:9.0.75]
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:153) ~[tomcat-embed-core-9.0.75.jar:9.0.75]
	at org.apache.catalina.core.StandardWrapperValve.invoke(StandardWrapperValve.java:167) ~[tomcat-embed-core-9.0.75.jar:9.0.75]
	at org.apache.catalina.core.StandardContextValve.invoke(StandardContextValve.java:90) ~[tomcat-embed-core-9.0.75.jar:9.0.75]
	at org.apache.catalina.authenticator.AuthenticatorBase.invoke(AuthenticatorBase.java:481) ~[tomcat-embed-core-9.0.75.jar:9.0.75]
	at org.apache.catalina.core.StandardHostValve.invoke(StandardHostValve.java:130) ~[tomcat-embed-core-9.0.75.jar:9.0.75]
	at org.apache.catalina.valves.ErrorReportValve.invoke(ErrorReportValve.java:93) ~[tomcat-embed-core-9.0.75.jar:9.0.75]
	at org.apache.catalina.core.StandardEngineValve.invoke(StandardEngineValve.java:74) ~[tomcat-embed-core-9.0.75.jar:9.0.75]
	at org.apache.catalina.connector.CoyoteAdapter.service(CoyoteAdapter.java:343) ~[tomcat-embed-core-9.0.75.jar:9.0.75]
	at org.apache.coyote.http11.Http11Processor.service(Http11Processor.java:390) ~[tomcat-embed-core-9.0.75.jar:9.0.75]
	at org.apache.coyote.AbstractProcessorLight.process(AbstractProcessorLight.java:63) ~[tomcat-embed-core-9.0.75.jar:9.0.75]
	at org.apache.coyote.AbstractProtocol$ConnectionHandler.process(AbstractProtocol.java:926) ~[tomcat-embed-core-9.0.75.jar:9.0.75]
	at org.apache.tomcat.util.net.NioEndpoint$SocketProcessor.doRun(NioEndpoint.java:1791) ~[tomcat-embed-core-9.0.75.jar:9.0.75]
	at org.apache.tomcat.util.net.SocketProcessorBase.run(SocketProcessorBase.java:52) ~[tomcat-embed-core-9.0.75.jar:9.0.75]
	at org.apache.tomcat.util.threads.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1191) ~[tomcat-embed-core-9.0.75.jar:9.0.75]
	at org.apache.tomcat.util.threads.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:659) ~[tomcat-embed-core-9.0.75.jar:9.0.75]
	at org.apache.tomcat.util.threads.TaskThread$WrappingRunnable.run(TaskThread.java:61) ~[tomcat-embed-core-9.0.75.jar:9.0.75]
	at java.base/java.lang.Thread.run(Thread.java:840) ~[na:na]

15:49:12:381 DEBUG 25496 --- [http-nio-8080-exec-4] c.l.h.m.D.selectById                     : ==>  Preparing: SELECT id,patient_id,doctor_id,disease_name,disease_category,aimodel_id,result,create_time,status,id_card,name,score,remark FROM diagnosis_report WHERE id=?
15:49:12:382 DEBUG 25496 --- [http-nio-8080-exec-4] c.l.h.m.D.selectById                     : ==> Parameters: 1(Integer)
15:49:12:413 DEBUG 25496 --- [http-nio-8080-exec-4] c.l.h.m.D.selectById                     : <==      Total: 1
15:49:12:415 DEBUG 25496 --- [http-nio-8080-exec-4] c.l.h.mapper.PatientMapper.selectById    : ==>  Preparing: SELECT id,phone,id_card,name,verified,verified_by,verified_time,open_id,hospital_pid FROM patient WHERE id=?
15:49:12:416 DEBUG 25496 --- [http-nio-8080-exec-4] c.l.h.mapper.PatientMapper.selectById    : ==> Parameters: 1(Integer)
15:49:12:499 DEBUG 25496 --- [http-nio-8080-exec-4] c.l.h.mapper.PatientMapper.selectById    : <==      Total: 1
15:49:12:501 DEBUG 25496 --- [http-nio-8080-exec-4] c.l.h.mapper.DoctorMapper.selectById     : ==>  Preparing: SELECT id,phone,id_card,name,verified,verified_by,verified_time,license,department,hospital_pid FROM doctor WHERE id=?
15:49:12:502 DEBUG 25496 --- [http-nio-8080-exec-4] c.l.h.mapper.DoctorMapper.selectById     : ==> Parameters: 1(Integer)
15:49:12:531 DEBUG 25496 --- [http-nio-8080-exec-4] c.l.h.mapper.DoctorMapper.selectById     : <==      Total: 1
15:49:12:532 DEBUG 25496 --- [http-nio-8080-exec-4] c.l.h.m.E.selectListByDiagnosisId        : ==>  Preparing: select * from eye_images where dignosis_report_id = ?
15:49:12:532 DEBUG 25496 --- [http-nio-8080-exec-4] c.l.h.m.E.selectListByDiagnosisId        : ==> Parameters: 1(Integer)
15:49:12:562 DEBUG 25496 --- [http-nio-8080-exec-4] c.l.h.m.E.selectListByDiagnosisId        : <==      Total: 1
15:49:12:562 DEBUG 25496 --- [http-nio-8080-exec-4] c.l.h.m.T.selectByDiagnosisId            : ==>  Preparing: select * from treatment_plans where diagnosis_id = ?
15:49:12:563 DEBUG 25496 --- [http-nio-8080-exec-4] c.l.h.m.T.selectByDiagnosisId            : ==> Parameters: 1(Integer)
15:49:12:593 DEBUG 25496 --- [http-nio-8080-exec-4] c.l.h.m.T.selectByDiagnosisId            : <==      Total: 1
15:49:12:594 DEBUG 25496 --- [http-nio-8080-exec-4] c.l.h.m.M.selectByDiagnosisId            : ==>  Preparing: select * from medication_recommendations where diagnosis_id = ?
15:49:12:594 DEBUG 25496 --- [http-nio-8080-exec-4] c.l.h.m.M.selectByDiagnosisId            : ==> Parameters: 1(Integer)
15:49:12:624 DEBUG 25496 --- [http-nio-8080-exec-4] c.l.h.m.M.selectByDiagnosisId            : <==      Total: 1
15:49:12:625 DEBUG 25496 --- [http-nio-8080-exec-4] c.l.h.mapper.AiModelMapper.selectById    : ==>  Preparing: SELECT id,version,deploy_time,accuracy FROM ai_model WHERE id=?
15:49:12:625 DEBUG 25496 --- [http-nio-8080-exec-4] c.l.h.mapper.AiModelMapper.selectById    : ==> Parameters: 1(Integer)
15:49:12:655 DEBUG 25496 --- [http-nio-8080-exec-4] c.l.h.mapper.AiModelMapper.selectById    : <==      Total: 1
15:49:12:668 DEBUG 25496 --- [http-nio-8080-exec-4] c.l.api.client.FlaskAiDoctorClient       : [FlaskAiDoctorClient#uploadFile] ---> POST http://ai-service/api/chat/completions HTTP/1.1
15:49:12:669 DEBUG 25496 --- [http-nio-8080-exec-4] c.l.api.client.FlaskAiDoctorClient       : [FlaskAiDoctorClient#uploadFile] Content-Length: 726
15:49:12:669 DEBUG 25496 --- [http-nio-8080-exec-4] c.l.api.client.FlaskAiDoctorClient       : [FlaskAiDoctorClient#uploadFile] Content-Type: application/json
15:49:12:669 DEBUG 25496 --- [http-nio-8080-exec-4] c.l.api.client.FlaskAiDoctorClient       : [FlaskAiDoctorClient#uploadFile] 
15:49:12:669 DEBUG 25496 --- [http-nio-8080-exec-4] c.l.api.client.FlaskAiDoctorClient       : [FlaskAiDoctorClient#uploadFile] {"diagnosis_name":"","diagnosis_category":"","result":"A","remark":"A","treatment_plan":{"id":1,"treatmentType":1,"treatmentDetail":"","startTime":"2025-03-01 09:00:00","endDate":"2025-03-10 09:00:00","doctorId":1,"createdTime":[2025,3,1,9,0],"updatedTime":[2025,3,1,9,0]},"medications":[{"id":1,"diagnosisId":1,"medicationName":"A","dosage":"10mg","frequency":"","sideEffects":"","startTime":[2025,3,1,9,0],"endTime":[2025,3,10,9,0],"doctorId":1,"createdTime":"2025-03-01 09:00:00","updatedTime":"2025-03-01 09:00:00"}],"previous_conversations":[{"role":"pariatur tempor do","content":"sit cupidatat commodo"}],"question":"irure eu esse","stream":false}
15:49:12:669 DEBUG 25496 --- [http-nio-8080-exec-4] c.l.api.client.FlaskAiDoctorClient       : [FlaskAiDoctorClient#uploadFile] ---> END HTTP (726-byte body)
15:49:12:671  WARN 25496 --- [http-nio-8080-exec-4] o.s.c.l.core.RoundRobinLoadBalancer      : No servers available for service: ai-service
15:49:12:671  WARN 25496 --- [http-nio-8080-exec-4] .s.c.o.l.FeignBlockingLoadBalancerClient : Load balancer does not contain an instance for the service ai-service
15:49:12:671 DEBUG 25496 --- [http-nio-8080-exec-4] c.l.api.client.FlaskAiDoctorClient       : [FlaskAiDoctorClient#uploadFile] <--- HTTP/1.1 503 (1ms)
15:49:12:671 DEBUG 25496 --- [http-nio-8080-exec-4] c.l.api.client.FlaskAiDoctorClient       : [FlaskAiDoctorClient#uploadFile] 
15:49:12:671 DEBUG 25496 --- [http-nio-8080-exec-4] c.l.api.client.FlaskAiDoctorClient       : [FlaskAiDoctorClient#uploadFile] Load balancer does not contain an instance for the service ai-service
15:49:12:671 DEBUG 25496 --- [http-nio-8080-exec-4] c.l.api.client.FlaskAiDoctorClient       : [FlaskAiDoctorClient#uploadFile] <--- END HTTP (69-byte body)
15:49:12:673 ERROR 25496 --- [http-nio-8080-exec-4] o.a.c.c.C.[.[.[/].[dispatcherServlet]    : Servlet.service() for servlet [dispatcherServlet] in context with path [] threw exception [Request processing failed; nested exception is feign.FeignException$ServiceUnavailable: [503] during [POST] to [http://ai-service/api/chat/completions] [FlaskAiDoctorClient#uploadFile(ChatForm,String)]: [Load balancer does not contain an instance for the service ai-service]] with root cause

feign.FeignException$ServiceUnavailable: [503] during [POST] to [http://ai-service/api/chat/completions] [FlaskAiDoctorClient#uploadFile(ChatForm,String)]: [Load balancer does not contain an instance for the service ai-service]
	at feign.FeignException.serverErrorStatus(FeignException.java:256) ~[feign-core-11.10.jar:na]
	at feign.FeignException.errorStatus(FeignException.java:197) ~[feign-core-11.10.jar:na]
	at feign.FeignException.errorStatus(FeignException.java:185) ~[feign-core-11.10.jar:na]
	at feign.codec.ErrorDecoder$Default.decode(ErrorDecoder.java:92) ~[feign-core-11.10.jar:na]
	at feign.AsyncResponseHandler.handleResponse(AsyncResponseHandler.java:98) ~[feign-core-11.10.jar:na]
	at feign.SynchronousMethodHandler.executeAndDecode(SynchronousMethodHandler.java:141) ~[feign-core-11.10.jar:na]
	at feign.SynchronousMethodHandler.invoke(SynchronousMethodHandler.java:91) ~[feign-core-11.10.jar:na]
	at feign.ReflectiveFeign$FeignInvocationHandler.invoke(ReflectiveFeign.java:100) ~[feign-core-11.10.jar:na]
	at jdk.proxy2/jdk.proxy2.$Proxy134.uploadFile(Unknown Source) ~[na:na]
	at com.luojiawei.his_service.controller.ChatController.ask(ChatController.java:38) ~[classes/:na]
	at java.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke0(Native Method) ~[na:na]
	at java.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:77) ~[na:na]
	at java.base/jdk.internal.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43) ~[na:na]
	at java.base/java.lang.reflect.Method.invoke(Method.java:568) ~[na:na]
	at org.springframework.web.method.support.InvocableHandlerMethod.doInvoke(InvocableHandlerMethod.java:205) ~[spring-web-5.3.27.jar:5.3.27]
	at org.springframework.web.method.support.InvocableHandlerMethod.invokeForRequest(InvocableHandlerMethod.java:150) ~[spring-web-5.3.27.jar:5.3.27]
	at org.springframework.web.servlet.mvc.method.annotation.ServletInvocableHandlerMethod.invokeAndHandle(ServletInvocableHandlerMethod.java:117) ~[spring-webmvc-5.3.27.jar:5.3.27]
	at org.springframework.web.servlet.mvc.method.annotation.RequestMappingHandlerAdapter.invokeHandlerMethod(RequestMappingHandlerAdapter.java:895) ~[spring-webmvc-5.3.27.jar:5.3.27]
	at org.springframework.web.servlet.mvc.method.annotation.RequestMappingHandlerAdapter.handleInternal(RequestMappingHandlerAdapter.java:808) ~[spring-webmvc-5.3.27.jar:5.3.27]
	at org.springframework.web.servlet.mvc.method.AbstractHandlerMethodAdapter.handle(AbstractHandlerMethodAdapter.java:87) ~[spring-webmvc-5.3.27.jar:5.3.27]
	at org.springframework.web.servlet.DispatcherServlet.doDispatch(DispatcherServlet.java:1072) ~[spring-webmvc-5.3.27.jar:5.3.27]
	at org.springframework.web.servlet.DispatcherServlet.doService(DispatcherServlet.java:965) ~[spring-webmvc-5.3.27.jar:5.3.27]
	at org.springframework.web.servlet.FrameworkServlet.processRequest(FrameworkServlet.java:1006) ~[spring-webmvc-5.3.27.jar:5.3.27]
	at org.springframework.web.servlet.FrameworkServlet.doPost(FrameworkServlet.java:909) ~[spring-webmvc-5.3.27.jar:5.3.27]
	at javax.servlet.http.HttpServlet.service(HttpServlet.java:555) ~[tomcat-embed-core-9.0.75.jar:4.0.FR]
	at org.springframework.web.servlet.FrameworkServlet.service(FrameworkServlet.java:883) ~[spring-webmvc-5.3.27.jar:5.3.27]
	at javax.servlet.http.HttpServlet.service(HttpServlet.java:623) ~[tomcat-embed-core-9.0.75.jar:4.0.FR]
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:209) ~[tomcat-embed-core-9.0.75.jar:9.0.75]
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:153) ~[tomcat-embed-core-9.0.75.jar:9.0.75]
	at com.luojiawei.his_service.filter.RefreshTokenFilter.doFilterInternal(RefreshTokenFilter.java:58) ~[classes/:na]
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:117) ~[spring-web-5.3.27.jar:5.3.27]
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:178) ~[tomcat-embed-core-9.0.75.jar:9.0.75]
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:153) ~[tomcat-embed-core-9.0.75.jar:9.0.75]
	at org.springframework.web.filter.RequestContextFilter.doFilterInternal(RequestContextFilter.java:100) ~[spring-web-5.3.27.jar:5.3.27]
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:117) ~[spring-web-5.3.27.jar:5.3.27]
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:178) ~[tomcat-embed-core-9.0.75.jar:9.0.75]
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:153) ~[tomcat-embed-core-9.0.75.jar:9.0.75]
	at org.springframework.web.filter.FormContentFilter.doFilterInternal(FormContentFilter.java:93) ~[spring-web-5.3.27.jar:5.3.27]
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:117) ~[spring-web-5.3.27.jar:5.3.27]
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:178) ~[tomcat-embed-core-9.0.75.jar:9.0.75]
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:153) ~[tomcat-embed-core-9.0.75.jar:9.0.75]
	at org.springframework.boot.actuate.metrics.web.servlet.WebMvcMetricsFilter.doFilterInternal(WebMvcMetricsFilter.java:96) ~[spring-boot-actuator-2.7.12.jar:2.7.12]
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:117) ~[spring-web-5.3.27.jar:5.3.27]
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:178) ~[tomcat-embed-core-9.0.75.jar:9.0.75]
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:153) ~[tomcat-embed-core-9.0.75.jar:9.0.75]
	at org.springframework.web.filter.CharacterEncodingFilter.doFilterInternal(CharacterEncodingFilter.java:201) ~[spring-web-5.3.27.jar:5.3.27]
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:117) ~[spring-web-5.3.27.jar:5.3.27]
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:178) ~[tomcat-embed-core-9.0.75.jar:9.0.75]
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:153) ~[tomcat-embed-core-9.0.75.jar:9.0.75]
	at org.apache.catalina.core.StandardWrapperValve.invoke(StandardWrapperValve.java:167) ~[tomcat-embed-core-9.0.75.jar:9.0.75]
	at org.apache.catalina.core.StandardContextValve.invoke(StandardContextValve.java:90) ~[tomcat-embed-core-9.0.75.jar:9.0.75]
	at org.apache.catalina.authenticator.AuthenticatorBase.invoke(AuthenticatorBase.java:481) ~[tomcat-embed-core-9.0.75.jar:9.0.75]
	at org.apache.catalina.core.StandardHostValve.invoke(StandardHostValve.java:130) ~[tomcat-embed-core-9.0.75.jar:9.0.75]
	at org.apache.catalina.valves.ErrorReportValve.invoke(ErrorReportValve.java:93) ~[tomcat-embed-core-9.0.75.jar:9.0.75]
	at org.apache.catalina.core.StandardEngineValve.invoke(StandardEngineValve.java:74) ~[tomcat-embed-core-9.0.75.jar:9.0.75]
	at org.apache.catalina.connector.CoyoteAdapter.service(CoyoteAdapter.java:343) ~[tomcat-embed-core-9.0.75.jar:9.0.75]
	at org.apache.coyote.http11.Http11Processor.service(Http11Processor.java:390) ~[tomcat-embed-core-9.0.75.jar:9.0.75]
	at org.apache.coyote.AbstractProcessorLight.process(AbstractProcessorLight.java:63) ~[tomcat-embed-core-9.0.75.jar:9.0.75]
	at org.apache.coyote.AbstractProtocol$ConnectionHandler.process(AbstractProtocol.java:926) ~[tomcat-embed-core-9.0.75.jar:9.0.75]
	at org.apache.tomcat.util.net.NioEndpoint$SocketProcessor.doRun(NioEndpoint.java:1791) ~[tomcat-embed-core-9.0.75.jar:9.0.75]
	at org.apache.tomcat.util.net.SocketProcessorBase.run(SocketProcessorBase.java:52) ~[tomcat-embed-core-9.0.75.jar:9.0.75]
	at org.apache.tomcat.util.threads.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1191) ~[tomcat-embed-core-9.0.75.jar:9.0.75]
	at org.apache.tomcat.util.threads.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:659) ~[tomcat-embed-core-9.0.75.jar:9.0.75]
	at org.apache.tomcat.util.threads.TaskThread$WrappingRunnable.run(TaskThread.java:61) ~[tomcat-embed-core-9.0.75.jar:9.0.75]
	at java.base/java.lang.Thread.run(Thread.java:840) ~[na:na]

15:49:14:206 DEBUG 25496 --- [http-nio-8080-exec-5] c.l.h.m.D.selectById                     : ==>  Preparing: SELECT id,patient_id,doctor_id,disease_name,disease_category,aimodel_id,result,create_time,status,id_card,name,score,remark FROM diagnosis_report WHERE id=?
15:49:14:206 DEBUG 25496 --- [http-nio-8080-exec-5] c.l.h.m.D.selectById                     : ==> Parameters: 1(Integer)
15:49:14:237 DEBUG 25496 --- [http-nio-8080-exec-5] c.l.h.m.D.selectById                     : <==      Total: 1
15:49:14:237 DEBUG 25496 --- [http-nio-8080-exec-5] c.l.h.mapper.PatientMapper.selectById    : ==>  Preparing: SELECT id,phone,id_card,name,verified,verified_by,verified_time,open_id,hospital_pid FROM patient WHERE id=?
15:49:14:238 DEBUG 25496 --- [http-nio-8080-exec-5] c.l.h.mapper.PatientMapper.selectById    : ==> Parameters: 1(Integer)
15:49:14:267 DEBUG 25496 --- [http-nio-8080-exec-5] c.l.h.mapper.PatientMapper.selectById    : <==      Total: 1
15:49:14:268 DEBUG 25496 --- [http-nio-8080-exec-5] c.l.h.mapper.DoctorMapper.selectById     : ==>  Preparing: SELECT id,phone,id_card,name,verified,verified_by,verified_time,license,department,hospital_pid FROM doctor WHERE id=?
15:49:14:268 DEBUG 25496 --- [http-nio-8080-exec-5] c.l.h.mapper.DoctorMapper.selectById     : ==> Parameters: 1(Integer)
15:49:14:298 DEBUG 25496 --- [http-nio-8080-exec-5] c.l.h.mapper.DoctorMapper.selectById     : <==      Total: 1
15:49:14:298 DEBUG 25496 --- [http-nio-8080-exec-5] c.l.h.m.E.selectListByDiagnosisId        : ==>  Preparing: select * from eye_images where dignosis_report_id = ?
15:49:14:299 DEBUG 25496 --- [http-nio-8080-exec-5] c.l.h.m.E.selectListByDiagnosisId        : ==> Parameters: 1(Integer)
15:49:14:328 DEBUG 25496 --- [http-nio-8080-exec-5] c.l.h.m.E.selectListByDiagnosisId        : <==      Total: 1
15:49:14:329 DEBUG 25496 --- [http-nio-8080-exec-5] c.l.h.m.T.selectByDiagnosisId            : ==>  Preparing: select * from treatment_plans where diagnosis_id = ?
15:49:14:329 DEBUG 25496 --- [http-nio-8080-exec-5] c.l.h.m.T.selectByDiagnosisId            : ==> Parameters: 1(Integer)
15:49:14:360 DEBUG 25496 --- [http-nio-8080-exec-5] c.l.h.m.T.selectByDiagnosisId            : <==      Total: 1
15:49:14:361 DEBUG 25496 --- [http-nio-8080-exec-5] c.l.h.m.M.selectByDiagnosisId            : ==>  Preparing: select * from medication_recommendations where diagnosis_id = ?
15:49:14:361 DEBUG 25496 --- [http-nio-8080-exec-5] c.l.h.m.M.selectByDiagnosisId            : ==> Parameters: 1(Integer)
15:49:14:392 DEBUG 25496 --- [http-nio-8080-exec-5] c.l.h.m.M.selectByDiagnosisId            : <==      Total: 1
15:49:14:393 DEBUG 25496 --- [http-nio-8080-exec-5] c.l.h.mapper.AiModelMapper.selectById    : ==>  Preparing: SELECT id,version,deploy_time,accuracy FROM ai_model WHERE id=?
15:49:14:393 DEBUG 25496 --- [http-nio-8080-exec-5] c.l.h.mapper.AiModelMapper.selectById    : ==> Parameters: 1(Integer)
15:49:14:424 DEBUG 25496 --- [http-nio-8080-exec-5] c.l.h.mapper.AiModelMapper.selectById    : <==      Total: 1
15:49:14:436 DEBUG 25496 --- [http-nio-8080-exec-5] c.l.api.client.FlaskAiDoctorClient       : [FlaskAiDoctorClient#uploadFile] ---> POST http://ai-service/api/chat/completions HTTP/1.1
15:49:14:436 DEBUG 25496 --- [http-nio-8080-exec-5] c.l.api.client.FlaskAiDoctorClient       : [FlaskAiDoctorClient#uploadFile] Content-Length: 726
15:49:14:436 DEBUG 25496 --- [http-nio-8080-exec-5] c.l.api.client.FlaskAiDoctorClient       : [FlaskAiDoctorClient#uploadFile] Content-Type: application/json
15:49:14:436 DEBUG 25496 --- [http-nio-8080-exec-5] c.l.api.client.FlaskAiDoctorClient       : [FlaskAiDoctorClient#uploadFile] 
15:49:14:436 DEBUG 25496 --- [http-nio-8080-exec-5] c.l.api.client.FlaskAiDoctorClient       : [FlaskAiDoctorClient#uploadFile] {"diagnosis_name":"","diagnosis_category":"","result":"A","remark":"A","treatment_plan":{"id":1,"treatmentType":1,"treatmentDetail":"","startTime":"2025-03-01 09:00:00","endDate":"2025-03-10 09:00:00","doctorId":1,"createdTime":[2025,3,1,9,0],"updatedTime":[2025,3,1,9,0]},"medications":[{"id":1,"diagnosisId":1,"medicationName":"A","dosage":"10mg","frequency":"","sideEffects":"","startTime":[2025,3,1,9,0],"endTime":[2025,3,10,9,0],"doctorId":1,"createdTime":"2025-03-01 09:00:00","updatedTime":"2025-03-01 09:00:00"}],"previous_conversations":[{"role":"pariatur tempor do","content":"sit cupidatat commodo"}],"question":"irure eu esse","stream":false}
15:49:14:437 DEBUG 25496 --- [http-nio-8080-exec-5] c.l.api.client.FlaskAiDoctorClient       : [FlaskAiDoctorClient#uploadFile] ---> END HTTP (726-byte body)
15:49:14:437  WARN 25496 --- [http-nio-8080-exec-5] o.s.c.l.core.RoundRobinLoadBalancer      : No servers available for service: ai-service
15:49:14:437  WARN 25496 --- [http-nio-8080-exec-5] .s.c.o.l.FeignBlockingLoadBalancerClient : Load balancer does not contain an instance for the service ai-service
15:49:14:438 DEBUG 25496 --- [http-nio-8080-exec-5] c.l.api.client.FlaskAiDoctorClient       : [FlaskAiDoctorClient#uploadFile] <--- HTTP/1.1 503 (0ms)
15:49:14:438 DEBUG 25496 --- [http-nio-8080-exec-5] c.l.api.client.FlaskAiDoctorClient       : [FlaskAiDoctorClient#uploadFile] 
15:49:14:438 DEBUG 25496 --- [http-nio-8080-exec-5] c.l.api.client.FlaskAiDoctorClient       : [FlaskAiDoctorClient#uploadFile] Load balancer does not contain an instance for the service ai-service
15:49:14:438 DEBUG 25496 --- [http-nio-8080-exec-5] c.l.api.client.FlaskAiDoctorClient       : [FlaskAiDoctorClient#uploadFile] <--- END HTTP (69-byte body)
15:49:14:440 ERROR 25496 --- [http-nio-8080-exec-5] o.a.c.c.C.[.[.[/].[dispatcherServlet]    : Servlet.service() for servlet [dispatcherServlet] in context with path [] threw exception [Request processing failed; nested exception is feign.FeignException$ServiceUnavailable: [503] during [POST] to [http://ai-service/api/chat/completions] [FlaskAiDoctorClient#uploadFile(ChatForm,String)]: [Load balancer does not contain an instance for the service ai-service]] with root cause

feign.FeignException$ServiceUnavailable: [503] during [POST] to [http://ai-service/api/chat/completions] [FlaskAiDoctorClient#uploadFile(ChatForm,String)]: [Load balancer does not contain an instance for the service ai-service]
	at feign.FeignException.serverErrorStatus(FeignException.java:256) ~[feign-core-11.10.jar:na]
	at feign.FeignException.errorStatus(FeignException.java:197) ~[feign-core-11.10.jar:na]
	at feign.FeignException.errorStatus(FeignException.java:185) ~[feign-core-11.10.jar:na]
	at feign.codec.ErrorDecoder$Default.decode(ErrorDecoder.java:92) ~[feign-core-11.10.jar:na]
	at feign.AsyncResponseHandler.handleResponse(AsyncResponseHandler.java:98) ~[feign-core-11.10.jar:na]
	at feign.SynchronousMethodHandler.executeAndDecode(SynchronousMethodHandler.java:141) ~[feign-core-11.10.jar:na]
	at feign.SynchronousMethodHandler.invoke(SynchronousMethodHandler.java:91) ~[feign-core-11.10.jar:na]
	at feign.ReflectiveFeign$FeignInvocationHandler.invoke(ReflectiveFeign.java:100) ~[feign-core-11.10.jar:na]
	at jdk.proxy2/jdk.proxy2.$Proxy134.uploadFile(Unknown Source) ~[na:na]
	at com.luojiawei.his_service.controller.ChatController.ask(ChatController.java:38) ~[classes/:na]
	at java.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke0(Native Method) ~[na:na]
	at java.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:77) ~[na:na]
	at java.base/jdk.internal.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43) ~[na:na]
	at java.base/java.lang.reflect.Method.invoke(Method.java:568) ~[na:na]
	at org.springframework.web.method.support.InvocableHandlerMethod.doInvoke(InvocableHandlerMethod.java:205) ~[spring-web-5.3.27.jar:5.3.27]
	at org.springframework.web.method.support.InvocableHandlerMethod.invokeForRequest(InvocableHandlerMethod.java:150) ~[spring-web-5.3.27.jar:5.3.27]
	at org.springframework.web.servlet.mvc.method.annotation.ServletInvocableHandlerMethod.invokeAndHandle(ServletInvocableHandlerMethod.java:117) ~[spring-webmvc-5.3.27.jar:5.3.27]
	at org.springframework.web.servlet.mvc.method.annotation.RequestMappingHandlerAdapter.invokeHandlerMethod(RequestMappingHandlerAdapter.java:895) ~[spring-webmvc-5.3.27.jar:5.3.27]
	at org.springframework.web.servlet.mvc.method.annotation.RequestMappingHandlerAdapter.handleInternal(RequestMappingHandlerAdapter.java:808) ~[spring-webmvc-5.3.27.jar:5.3.27]
	at org.springframework.web.servlet.mvc.method.AbstractHandlerMethodAdapter.handle(AbstractHandlerMethodAdapter.java:87) ~[spring-webmvc-5.3.27.jar:5.3.27]
	at org.springframework.web.servlet.DispatcherServlet.doDispatch(DispatcherServlet.java:1072) ~[spring-webmvc-5.3.27.jar:5.3.27]
	at org.springframework.web.servlet.DispatcherServlet.doService(DispatcherServlet.java:965) ~[spring-webmvc-5.3.27.jar:5.3.27]
	at org.springframework.web.servlet.FrameworkServlet.processRequest(FrameworkServlet.java:1006) ~[spring-webmvc-5.3.27.jar:5.3.27]
	at org.springframework.web.servlet.FrameworkServlet.doPost(FrameworkServlet.java:909) ~[spring-webmvc-5.3.27.jar:5.3.27]
	at javax.servlet.http.HttpServlet.service(HttpServlet.java:555) ~[tomcat-embed-core-9.0.75.jar:4.0.FR]
	at org.springframework.web.servlet.FrameworkServlet.service(FrameworkServlet.java:883) ~[spring-webmvc-5.3.27.jar:5.3.27]
	at javax.servlet.http.HttpServlet.service(HttpServlet.java:623) ~[tomcat-embed-core-9.0.75.jar:4.0.FR]
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:209) ~[tomcat-embed-core-9.0.75.jar:9.0.75]
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:153) ~[tomcat-embed-core-9.0.75.jar:9.0.75]
	at com.luojiawei.his_service.filter.RefreshTokenFilter.doFilterInternal(RefreshTokenFilter.java:58) ~[classes/:na]
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:117) ~[spring-web-5.3.27.jar:5.3.27]
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:178) ~[tomcat-embed-core-9.0.75.jar:9.0.75]
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:153) ~[tomcat-embed-core-9.0.75.jar:9.0.75]
	at org.springframework.web.filter.RequestContextFilter.doFilterInternal(RequestContextFilter.java:100) ~[spring-web-5.3.27.jar:5.3.27]
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:117) ~[spring-web-5.3.27.jar:5.3.27]
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:178) ~[tomcat-embed-core-9.0.75.jar:9.0.75]
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:153) ~[tomcat-embed-core-9.0.75.jar:9.0.75]
	at org.springframework.web.filter.FormContentFilter.doFilterInternal(FormContentFilter.java:93) ~[spring-web-5.3.27.jar:5.3.27]
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:117) ~[spring-web-5.3.27.jar:5.3.27]
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:178) ~[tomcat-embed-core-9.0.75.jar:9.0.75]
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:153) ~[tomcat-embed-core-9.0.75.jar:9.0.75]
	at org.springframework.boot.actuate.metrics.web.servlet.WebMvcMetricsFilter.doFilterInternal(WebMvcMetricsFilter.java:96) ~[spring-boot-actuator-2.7.12.jar:2.7.12]
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:117) ~[spring-web-5.3.27.jar:5.3.27]
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:178) ~[tomcat-embed-core-9.0.75.jar:9.0.75]
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:153) ~[tomcat-embed-core-9.0.75.jar:9.0.75]
	at org.springframework.web.filter.CharacterEncodingFilter.doFilterInternal(CharacterEncodingFilter.java:201) ~[spring-web-5.3.27.jar:5.3.27]
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:117) ~[spring-web-5.3.27.jar:5.3.27]
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:178) ~[tomcat-embed-core-9.0.75.jar:9.0.75]
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:153) ~[tomcat-embed-core-9.0.75.jar:9.0.75]
	at org.apache.catalina.core.StandardWrapperValve.invoke(StandardWrapperValve.java:167) ~[tomcat-embed-core-9.0.75.jar:9.0.75]
	at org.apache.catalina.core.StandardContextValve.invoke(StandardContextValve.java:90) ~[tomcat-embed-core-9.0.75.jar:9.0.75]
	at org.apache.catalina.authenticator.AuthenticatorBase.invoke(AuthenticatorBase.java:481) ~[tomcat-embed-core-9.0.75.jar:9.0.75]
	at org.apache.catalina.core.StandardHostValve.invoke(StandardHostValve.java:130) ~[tomcat-embed-core-9.0.75.jar:9.0.75]
	at org.apache.catalina.valves.ErrorReportValve.invoke(ErrorReportValve.java:93) ~[tomcat-embed-core-9.0.75.jar:9.0.75]
	at org.apache.catalina.core.StandardEngineValve.invoke(StandardEngineValve.java:74) ~[tomcat-embed-core-9.0.75.jar:9.0.75]
	at org.apache.catalina.connector.CoyoteAdapter.service(CoyoteAdapter.java:343) ~[tomcat-embed-core-9.0.75.jar:9.0.75]
	at org.apache.coyote.http11.Http11Processor.service(Http11Processor.java:390) ~[tomcat-embed-core-9.0.75.jar:9.0.75]
	at org.apache.coyote.AbstractProcessorLight.process(AbstractProcessorLight.java:63) ~[tomcat-embed-core-9.0.75.jar:9.0.75]
	at org.apache.coyote.AbstractProtocol$ConnectionHandler.process(AbstractProtocol.java:926) ~[tomcat-embed-core-9.0.75.jar:9.0.75]
	at org.apache.tomcat.util.net.NioEndpoint$SocketProcessor.doRun(NioEndpoint.java:1791) ~[tomcat-embed-core-9.0.75.jar:9.0.75]
	at org.apache.tomcat.util.net.SocketProcessorBase.run(SocketProcessorBase.java:52) ~[tomcat-embed-core-9.0.75.jar:9.0.75]
	at org.apache.tomcat.util.threads.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1191) ~[tomcat-embed-core-9.0.75.jar:9.0.75]
	at org.apache.tomcat.util.threads.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:659) ~[tomcat-embed-core-9.0.75.jar:9.0.75]
	at org.apache.tomcat.util.threads.TaskThread$WrappingRunnable.run(TaskThread.java:61) ~[tomcat-embed-core-9.0.75.jar:9.0.75]
	at java.base/java.lang.Thread.run(Thread.java:840) ~[na:na]

15:54:10:177  INFO 25496 --- [SpringApplicationShutdownHook] com.zaxxer.hikari.HikariDataSource       : HikariPool-1 - Shutdown initiated...
15:54:10:195  INFO 25496 --- [SpringApplicationShutdownHook] com.zaxxer.hikari.HikariDataSource       : HikariPool-1 - Shutdown completed.
15:54:14:927  INFO 34200 --- [main] c.l.his_service.HisServiceApplication    : Starting HisServiceApplication using Java 17.0.11 on luo with PID 34200 (A:\Desktop\workspace\HIS\his_service\target\classes started by 22407 in A:\Desktop\workspace\HIS)
15:54:14:928 DEBUG 34200 --- [main] c.l.his_service.HisServiceApplication    : Running with Spring Boot v2.7.12, Spring v5.3.27
15:54:14:929  INFO 34200 --- [main] c.l.his_service.HisServiceApplication    : The following 1 profile is active: "dev"
15:54:16:023  INFO 34200 --- [main] .s.d.r.c.RepositoryConfigurationDelegate : Multiple Spring Data modules found, entering strict repository configuration mode
15:54:16:027  INFO 34200 --- [main] .s.d.r.c.RepositoryConfigurationDelegate : Bootstrapping Spring Data Redis repositories in DEFAULT mode.
15:54:16:054  INFO 34200 --- [main] .s.d.r.c.RepositoryConfigurationDelegate : Finished Spring Data repository scanning in 14 ms. Found 0 Redis repository interfaces.
15:54:16:346  INFO 34200 --- [main] o.s.cloud.context.scope.GenericScope     : BeanFactory id=6223b6d6-9ee6-3c52-951c-fcc2980a1fa1
15:54:17:911  INFO 34200 --- [main] o.s.b.w.embedded.tomcat.TomcatWebServer  : Tomcat initialized with port(s): 8080 (http)
15:54:17:936  INFO 34200 --- [main] o.apache.catalina.core.StandardService   : Starting service [Tomcat]
15:54:17:936  INFO 34200 --- [main] org.apache.catalina.core.StandardEngine  : Starting Servlet engine: [Apache Tomcat/9.0.75]
15:54:18:144  INFO 34200 --- [main] o.a.c.c.C.[Tomcat].[localhost].[/]       : Initializing Spring embedded WebApplicationContext
15:54:18:144  INFO 34200 --- [main] w.s.c.ServletWebServerApplicationContext : Root WebApplicationContext: initialization completed in 3159 ms
15:54:18:388  INFO 34200 --- [main] org.redisson.Version                     : Redisson 3.17.7
15:54:18:770  INFO 34200 --- [redisson-netty-2-9] o.r.c.pool.MasterPubSubConnectionPool    : 1 connections initialized for 111.230.32.147/111.230.32.147:9631
15:54:19:477  INFO 34200 --- [redisson-netty-2-19] o.r.c.pool.MasterConnectionPool          : 24 connections initialized for 111.230.32.147/111.230.32.147:9631
15:54:19:741 DEBUG 34200 --- [main] c.l.h.filter.RefreshTokenFilter          : Filter 'refreshTokenFilter' configured for use
15:54:20:632  INFO 34200 --- [main] o.s.c.openfeign.FeignClientFactoryBean   : For 'flask-service' URL not provided. Will try picking an instance via load-balancing.
15:54:20:733  INFO 34200 --- [main] o.s.c.openfeign.FeignClientFactoryBean   : For 'ai-service' URL not provided. Will try picking an instance via load-balancing.
15:54:20:783  WARN 34200 --- [main] c.b.m.core.metadata.TableInfoHelper      : Can not find table primary key in Class: "java.lang.Object".
15:54:20:784  WARN 34200 --- [main] c.b.m.core.injector.DefaultSqlInjector   : class java.lang.Object ,Not found @TableId annotation, Cannot use Mybatis-Plus 'xxById' Method.
15:54:21:827  WARN 34200 --- [main] iguration$LoadBalancerCaffeineWarnLogger : Spring Cloud LoadBalancer is currently working with the default cache. While this cache implementation is useful for development and tests, it's recommended to use Caffeine cache in production.You can switch to using Caffeine cache, by adding it and org.springframework.cache.caffeine.CaffeineCacheManager to the classpath.
15:54:21:832  INFO 34200 --- [main] o.s.b.a.e.web.EndpointLinksResolver      : Exposing 1 endpoint(s) beneath base path '/actuator'
15:54:21:909  INFO 34200 --- [main] o.s.b.w.embedded.tomcat.TomcatWebServer  : Tomcat started on port(s): 8080 (http) with context path ''
15:54:22:191  INFO 34200 --- [main] c.l.his_service.HisServiceApplication    : Started HisServiceApplication in 8.149 seconds (JVM running for 9.76)
15:55:45:837  INFO 34356 --- [main] c.l.his_service.HisServiceApplication    : Starting HisServiceApplication using Java 17.0.11 on luo with PID 34356 (A:\Desktop\workspace\HIS\his_service\target\classes started by 22407 in A:\Desktop\workspace\HIS)
15:55:45:838 DEBUG 34356 --- [main] c.l.his_service.HisServiceApplication    : Running with Spring Boot v2.7.12, Spring v5.3.27
15:55:45:838  INFO 34356 --- [main] c.l.his_service.HisServiceApplication    : The following 1 profile is active: "dev"
15:55:46:842  INFO 34356 --- [main] .s.d.r.c.RepositoryConfigurationDelegate : Multiple Spring Data modules found, entering strict repository configuration mode
15:55:46:845  INFO 34356 --- [main] .s.d.r.c.RepositoryConfigurationDelegate : Bootstrapping Spring Data Redis repositories in DEFAULT mode.
15:55:46:875  INFO 34356 --- [main] .s.d.r.c.RepositoryConfigurationDelegate : Finished Spring Data repository scanning in 17 ms. Found 0 Redis repository interfaces.
15:55:47:155  INFO 34356 --- [main] o.s.cloud.context.scope.GenericScope     : BeanFactory id=6223b6d6-9ee6-3c52-951c-fcc2980a1fa1
15:55:47:779  INFO 34356 --- [main] o.s.b.w.embedded.tomcat.TomcatWebServer  : Tomcat initialized with port(s): 8080 (http)
15:55:47:788  INFO 34356 --- [main] o.apache.catalina.core.StandardService   : Starting service [Tomcat]
15:55:47:788  INFO 34356 --- [main] org.apache.catalina.core.StandardEngine  : Starting Servlet engine: [Apache Tomcat/9.0.75]
15:55:47:929  INFO 34356 --- [main] o.a.c.c.C.[Tomcat].[localhost].[/]       : Initializing Spring embedded WebApplicationContext
15:55:47:935  INFO 34356 --- [main] w.s.c.ServletWebServerApplicationContext : Root WebApplicationContext: initialization completed in 2042 ms
15:55:48:177  INFO 34356 --- [main] org.redisson.Version                     : Redisson 3.17.7
15:55:48:563  INFO 34356 --- [redisson-netty-2-9] o.r.c.pool.MasterPubSubConnectionPool    : 1 connections initialized for 111.230.32.147/111.230.32.147:9631
15:55:49:266  INFO 34356 --- [redisson-netty-2-19] o.r.c.pool.MasterConnectionPool          : 24 connections initialized for 111.230.32.147/111.230.32.147:9631
15:55:49:562 DEBUG 34356 --- [main] c.l.h.filter.RefreshTokenFilter          : Filter 'refreshTokenFilter' configured for use
15:55:50:373  INFO 34356 --- [main] o.s.c.openfeign.FeignClientFactoryBean   : For 'flask-service' URL not provided. Will try picking an instance via load-balancing.
15:55:50:540  INFO 34356 --- [main] o.s.c.openfeign.FeignClientFactoryBean   : For 'ai-service' URL not provided. Will try picking an instance via load-balancing.
15:55:50:597  WARN 34356 --- [main] c.b.m.core.metadata.TableInfoHelper      : Can not find table primary key in Class: "java.lang.Object".
15:55:50:597  WARN 34356 --- [main] c.b.m.core.injector.DefaultSqlInjector   : class java.lang.Object ,Not found @TableId annotation, Cannot use Mybatis-Plus 'xxById' Method.
15:55:51:801  WARN 34356 --- [main] iguration$LoadBalancerCaffeineWarnLogger : Spring Cloud LoadBalancer is currently working with the default cache. While this cache implementation is useful for development and tests, it's recommended to use Caffeine cache in production.You can switch to using Caffeine cache, by adding it and org.springframework.cache.caffeine.CaffeineCacheManager to the classpath.
15:55:51:812  INFO 34356 --- [main] o.s.b.a.e.web.EndpointLinksResolver      : Exposing 1 endpoint(s) beneath base path '/actuator'
15:55:51:917  INFO 34356 --- [main] o.s.b.w.embedded.tomcat.TomcatWebServer  : Tomcat started on port(s): 8080 (http) with context path ''
15:55:52:187  INFO 34356 --- [main] c.l.his_service.HisServiceApplication    : Started HisServiceApplication in 7.105 seconds (JVM running for 8.025)
15:55:52:586  INFO 34356 --- [RMI TCP Connection(3)-10.21.93.70] o.a.c.c.C.[Tomcat].[localhost].[/]       : Initializing Spring DispatcherServlet 'dispatcherServlet'
15:55:52:587  INFO 34356 --- [RMI TCP Connection(3)-10.21.93.70] o.s.web.servlet.DispatcherServlet        : Initializing Servlet 'dispatcherServlet'
15:55:52:589  INFO 34356 --- [RMI TCP Connection(3)-10.21.93.70] o.s.web.servlet.DispatcherServlet        : Completed initialization in 2 ms
15:55:52:592  INFO 34356 --- [RMI TCP Connection(2)-10.21.93.70] com.zaxxer.hikari.HikariDataSource       : HikariPool-1 - Starting...
15:55:53:276  INFO 34356 --- [RMI TCP Connection(2)-10.21.93.70] com.zaxxer.hikari.HikariDataSource       : HikariPool-1 - Start completed.
15:57:55:630  INFO 34356 --- [SpringApplicationShutdownHook] com.zaxxer.hikari.HikariDataSource       : HikariPool-1 - Shutdown initiated...
15:57:55:959  INFO 34356 --- [SpringApplicationShutdownHook] com.zaxxer.hikari.HikariDataSource       : HikariPool-1 - Shutdown completed.
16:03:09:911  INFO 3040 --- [main] c.l.his_service.HisServiceApplication    : Starting HisServiceApplication using Java 17.0.11 on luo with PID 3040 (A:\Desktop\workspace\HIS\his_service\target\classes started by 22407 in A:\Desktop\workspace\HIS)
16:03:09:914 DEBUG 3040 --- [main] c.l.his_service.HisServiceApplication    : Running with Spring Boot v2.7.12, Spring v5.3.27
16:03:09:914  INFO 3040 --- [main] c.l.his_service.HisServiceApplication    : The following 1 profile is active: "dev"
16:03:11:221  INFO 3040 --- [main] .s.d.r.c.RepositoryConfigurationDelegate : Multiple Spring Data modules found, entering strict repository configuration mode
16:03:11:223  INFO 3040 --- [main] .s.d.r.c.RepositoryConfigurationDelegate : Bootstrapping Spring Data Redis repositories in DEFAULT mode.
16:03:11:249  INFO 3040 --- [main] .s.d.r.c.RepositoryConfigurationDelegate : Finished Spring Data repository scanning in 14 ms. Found 0 Redis repository interfaces.
16:03:11:531  INFO 3040 --- [main] o.s.cloud.context.scope.GenericScope     : BeanFactory id=9fca246b-b3ed-3cc4-8b15-71e2900c9910
16:03:13:148  INFO 3040 --- [main] o.s.b.w.embedded.tomcat.TomcatWebServer  : Tomcat initialized with port(s): 8080 (http)
16:03:13:176  INFO 3040 --- [main] o.apache.catalina.core.StandardService   : Starting service [Tomcat]
16:03:13:176  INFO 3040 --- [main] org.apache.catalina.core.StandardEngine  : Starting Servlet engine: [Apache Tomcat/9.0.75]
16:03:13:447  INFO 3040 --- [main] o.a.c.c.C.[Tomcat].[localhost].[/]       : Initializing Spring embedded WebApplicationContext
16:03:13:448  INFO 3040 --- [main] w.s.c.ServletWebServerApplicationContext : Root WebApplicationContext: initialization completed in 3486 ms
16:03:13:674  INFO 3040 --- [main] org.redisson.Version                     : Redisson 3.17.7
16:03:14:086  INFO 3040 --- [redisson-netty-2-9] o.r.c.pool.MasterPubSubConnectionPool    : 1 connections initialized for 111.230.32.147/111.230.32.147:9631
16:03:14:763  INFO 3040 --- [redisson-netty-2-19] o.r.c.pool.MasterConnectionPool          : 24 connections initialized for 111.230.32.147/111.230.32.147:9631
16:03:15:061 DEBUG 3040 --- [main] c.l.h.filter.RefreshTokenFilter          : Filter 'refreshTokenFilter' configured for use
16:03:15:888  INFO 3040 --- [main] o.s.c.openfeign.FeignClientFactoryBean   : For 'flask-service' URL not provided. Will try picking an instance via load-balancing.
16:03:15:998  INFO 3040 --- [main] o.s.c.openfeign.FeignClientFactoryBean   : For 'ai-service' URL not provided. Will try picking an instance via load-balancing.
16:03:16:045  WARN 3040 --- [main] c.b.m.core.metadata.TableInfoHelper      : Can not find table primary key in Class: "java.lang.Object".
16:03:16:045  WARN 3040 --- [main] c.b.m.core.injector.DefaultSqlInjector   : class java.lang.Object ,Not found @TableId annotation, Cannot use Mybatis-Plus 'xxById' Method.
16:03:16:613  INFO 3040 --- [main] c.a.n.client.env.SearchableProperties    : properties search order:PROPERTIES->JVM->ENV->DEFAULT_SETTING
16:03:16:613  INFO 3040 --- [main] c.a.n.client.env.SearchableProperties    : properties search order:PROPERTIES->JVM->ENV->DEFAULT_SETTING
16:03:16:696  INFO 3040 --- [main] c.a.n.p.a.s.c.ClientAuthPluginManager    : [ClientAuthPluginManager] Load ClientAuthService com.alibaba.nacos.client.auth.impl.NacosClientAuthServiceImpl success.
16:03:16:696  INFO 3040 --- [main] c.a.n.p.a.s.c.ClientAuthPluginManager    : [ClientAuthPluginManager] Load ClientAuthService com.alibaba.nacos.client.auth.ram.RamClientAuthServiceImpl success.
16:03:27:610  INFO 3040 --- [main] o.s.b.a.e.web.EndpointLinksResolver      : Exposing 1 endpoint(s) beneath base path '/actuator'
16:03:27:994 ERROR 3040 --- [main] c.a.cloud.nacos.discovery.NacosWatch     : namingService subscribe failed, properties:NacosDiscoveryProperties{serverAddr='81.71.3.20', endpoint='', namespace='', watchDelay=30000, logName='', service='his-service', weight=1.0, clusterName='DEFAULT', group='DEFAULT_GROUP', namingLoadCacheAtStart='false', metadata={preserved.register.source=SPRING_CLOUD}, registerEnabled=true, ip='10.21.93.70', networkInterface='', port=8848, secure=false, accessKey='', secretKey='', heartBeatInterval=null, heartBeatTimeout=null, ipDeleteTimeout=null}

com.alibaba.nacos.api.exception.NacosException: Client not connected, current status:STARTING
	at com.alibaba.nacos.common.remote.client.RpcClient.request(RpcClient.java:639) ~[nacos-client-2.2.0.jar:na]
	at com.alibaba.nacos.common.remote.client.RpcClient.request(RpcClient.java:619) ~[nacos-client-2.2.0.jar:na]
	at com.alibaba.nacos.client.naming.remote.gprc.NamingGrpcClientProxy.requestToServer(NamingGrpcClientProxy.java:356) ~[nacos-client-2.2.0.jar:na]
	at com.alibaba.nacos.client.naming.remote.gprc.NamingGrpcClientProxy.doSubscribe(NamingGrpcClientProxy.java:310) ~[nacos-client-2.2.0.jar:na]
	at com.alibaba.nacos.client.naming.remote.gprc.NamingGrpcClientProxy.subscribe(NamingGrpcClientProxy.java:295) ~[nacos-client-2.2.0.jar:na]
	at com.alibaba.nacos.client.naming.remote.NamingClientProxyDelegate.subscribe(NamingClientProxyDelegate.java:173) ~[nacos-client-2.2.0.jar:na]
	at com.alibaba.nacos.client.naming.NacosNamingService.subscribe(NacosNamingService.java:414) ~[nacos-client-2.2.0.jar:na]
	at com.alibaba.cloud.nacos.discovery.NacosWatch.start(NacosWatch.java:123) ~[spring-cloud-starter-alibaba-nacos-discovery-2021.1.jar:2021.1]
	at org.springframework.context.support.DefaultLifecycleProcessor.doStart(DefaultLifecycleProcessor.java:178) ~[spring-context-5.3.27.jar:5.3.27]
	at org.springframework.context.support.DefaultLifecycleProcessor.access$200(DefaultLifecycleProcessor.java:54) ~[spring-context-5.3.27.jar:5.3.27]
	at org.springframework.context.support.DefaultLifecycleProcessor$LifecycleGroup.start(DefaultLifecycleProcessor.java:356) ~[spring-context-5.3.27.jar:5.3.27]
	at java.base/java.lang.Iterable.forEach(Iterable.java:75) ~[na:na]
	at org.springframework.context.support.DefaultLifecycleProcessor.startBeans(DefaultLifecycleProcessor.java:155) ~[spring-context-5.3.27.jar:5.3.27]
	at org.springframework.context.support.DefaultLifecycleProcessor.onRefresh(DefaultLifecycleProcessor.java:123) ~[spring-context-5.3.27.jar:5.3.27]
	at org.springframework.context.support.AbstractApplicationContext.finishRefresh(AbstractApplicationContext.java:937) ~[spring-context-5.3.27.jar:5.3.27]
	at org.springframework.context.support.AbstractApplicationContext.refresh(AbstractApplicationContext.java:586) ~[spring-context-5.3.27.jar:5.3.27]
	at org.springframework.boot.web.servlet.context.ServletWebServerApplicationContext.refresh(ServletWebServerApplicationContext.java:147) ~[spring-boot-2.7.12.jar:2.7.12]
	at org.springframework.boot.SpringApplication.refresh(SpringApplication.java:731) ~[spring-boot-2.7.12.jar:2.7.12]
	at org.springframework.boot.SpringApplication.refreshContext(SpringApplication.java:408) ~[spring-boot-2.7.12.jar:2.7.12]
	at org.springframework.boot.SpringApplication.run(SpringApplication.java:307) ~[spring-boot-2.7.12.jar:2.7.12]
	at org.springframework.boot.SpringApplication.run(SpringApplication.java:1303) ~[spring-boot-2.7.12.jar:2.7.12]
	at org.springframework.boot.SpringApplication.run(SpringApplication.java:1292) ~[spring-boot-2.7.12.jar:2.7.12]
	at com.luojiawei.his_service.HisServiceApplication.main(HisServiceApplication.java:19) ~[classes/:na]

16:03:28:018  INFO 3040 --- [main] o.s.b.w.embedded.tomcat.TomcatWebServer  : Tomcat started on port(s): 8080 (http) with context path ''
16:03:28:346 ERROR 3040 --- [main] c.a.c.n.registry.NacosServiceRegistry    : nacos registry, his-service register failed...NacosRegistration{nacosDiscoveryProperties=NacosDiscoveryProperties{serverAddr='81.71.3.20', endpoint='', namespace='', watchDelay=30000, logName='', service='his-service', weight=1.0, clusterName='DEFAULT', group='DEFAULT_GROUP', namingLoadCacheAtStart='false', metadata={preserved.register.source=SPRING_CLOUD}, registerEnabled=true, ip='10.21.93.70', networkInterface='', port=8848, secure=false, accessKey='', secretKey='', heartBeatInterval=null, heartBeatTimeout=null, ipDeleteTimeout=null}},

com.alibaba.nacos.api.exception.NacosException: Client not connected, current status:STARTING
	at com.alibaba.nacos.common.remote.client.RpcClient.request(RpcClient.java:639) ~[nacos-client-2.2.0.jar:na]
	at com.alibaba.nacos.common.remote.client.RpcClient.request(RpcClient.java:619) ~[nacos-client-2.2.0.jar:na]
	at com.alibaba.nacos.client.naming.remote.gprc.NamingGrpcClientProxy.requestToServer(NamingGrpcClientProxy.java:356) ~[nacos-client-2.2.0.jar:na]
	at com.alibaba.nacos.client.naming.remote.gprc.NamingGrpcClientProxy.doRegisterService(NamingGrpcClientProxy.java:209) ~[nacos-client-2.2.0.jar:na]
	at com.alibaba.nacos.client.naming.remote.gprc.NamingGrpcClientProxy.registerService(NamingGrpcClientProxy.java:123) ~[nacos-client-2.2.0.jar:na]
	at com.alibaba.nacos.client.naming.remote.NamingClientProxyDelegate.registerService(NamingClientProxyDelegate.java:98) ~[nacos-client-2.2.0.jar:na]
	at com.alibaba.nacos.client.naming.NacosNamingService.registerInstance(NacosNamingService.java:152) ~[nacos-client-2.2.0.jar:na]
	at com.alibaba.cloud.nacos.registry.NacosServiceRegistry.register(NacosServiceRegistry.java:74) ~[spring-cloud-starter-alibaba-nacos-discovery-2021.1.jar:2021.1]
	at org.springframework.cloud.client.serviceregistry.AbstractAutoServiceRegistration.register(AbstractAutoServiceRegistration.java:232) ~[spring-cloud-commons-3.1.5.jar:3.1.5]
	at com.alibaba.cloud.nacos.registry.NacosAutoServiceRegistration.register(NacosAutoServiceRegistration.java:78) ~[spring-cloud-starter-alibaba-nacos-discovery-2021.1.jar:2021.1]
	at org.springframework.cloud.client.serviceregistry.AbstractAutoServiceRegistration.start(AbstractAutoServiceRegistration.java:133) ~[spring-cloud-commons-3.1.5.jar:3.1.5]
	at org.springframework.cloud.client.serviceregistry.AbstractAutoServiceRegistration.bind(AbstractAutoServiceRegistration.java:98) ~[spring-cloud-commons-3.1.5.jar:3.1.5]
	at org.springframework.cloud.client.serviceregistry.AbstractAutoServiceRegistration.onApplicationEvent(AbstractAutoServiceRegistration.java:86) ~[spring-cloud-commons-3.1.5.jar:3.1.5]
	at org.springframework.cloud.client.serviceregistry.AbstractAutoServiceRegistration.onApplicationEvent(AbstractAutoServiceRegistration.java:47) ~[spring-cloud-commons-3.1.5.jar:3.1.5]
	at org.springframework.context.event.SimpleApplicationEventMulticaster.doInvokeListener(SimpleApplicationEventMulticaster.java:176) ~[spring-context-5.3.27.jar:5.3.27]
	at org.springframework.context.event.SimpleApplicationEventMulticaster.invokeListener(SimpleApplicationEventMulticaster.java:169) ~[spring-context-5.3.27.jar:5.3.27]
	at org.springframework.context.event.SimpleApplicationEventMulticaster.multicastEvent(SimpleApplicationEventMulticaster.java:143) ~[spring-context-5.3.27.jar:5.3.27]
	at org.springframework.context.support.AbstractApplicationContext.publishEvent(AbstractApplicationContext.java:421) ~[spring-context-5.3.27.jar:5.3.27]
	at org.springframework.context.support.AbstractApplicationContext.publishEvent(AbstractApplicationContext.java:378) ~[spring-context-5.3.27.jar:5.3.27]
	at org.springframework.boot.web.servlet.context.WebServerStartStopLifecycle.start(WebServerStartStopLifecycle.java:46) ~[spring-boot-2.7.12.jar:2.7.12]
	at org.springframework.context.support.DefaultLifecycleProcessor.doStart(DefaultLifecycleProcessor.java:178) ~[spring-context-5.3.27.jar:5.3.27]
	at org.springframework.context.support.DefaultLifecycleProcessor.access$200(DefaultLifecycleProcessor.java:54) ~[spring-context-5.3.27.jar:5.3.27]
	at org.springframework.context.support.DefaultLifecycleProcessor$LifecycleGroup.start(DefaultLifecycleProcessor.java:356) ~[spring-context-5.3.27.jar:5.3.27]
	at java.base/java.lang.Iterable.forEach(Iterable.java:75) ~[na:na]
	at org.springframework.context.support.DefaultLifecycleProcessor.startBeans(DefaultLifecycleProcessor.java:155) ~[spring-context-5.3.27.jar:5.3.27]
	at org.springframework.context.support.DefaultLifecycleProcessor.onRefresh(DefaultLifecycleProcessor.java:123) ~[spring-context-5.3.27.jar:5.3.27]
	at org.springframework.context.support.AbstractApplicationContext.finishRefresh(AbstractApplicationContext.java:937) ~[spring-context-5.3.27.jar:5.3.27]
	at org.springframework.context.support.AbstractApplicationContext.refresh(AbstractApplicationContext.java:586) ~[spring-context-5.3.27.jar:5.3.27]
	at org.springframework.boot.web.servlet.context.ServletWebServerApplicationContext.refresh(ServletWebServerApplicationContext.java:147) ~[spring-boot-2.7.12.jar:2.7.12]
	at org.springframework.boot.SpringApplication.refresh(SpringApplication.java:731) ~[spring-boot-2.7.12.jar:2.7.12]
	at org.springframework.boot.SpringApplication.refreshContext(SpringApplication.java:408) ~[spring-boot-2.7.12.jar:2.7.12]
	at org.springframework.boot.SpringApplication.run(SpringApplication.java:307) ~[spring-boot-2.7.12.jar:2.7.12]
	at org.springframework.boot.SpringApplication.run(SpringApplication.java:1303) ~[spring-boot-2.7.12.jar:2.7.12]
	at org.springframework.boot.SpringApplication.run(SpringApplication.java:1292) ~[spring-boot-2.7.12.jar:2.7.12]
	at com.luojiawei.his_service.HisServiceApplication.main(HisServiceApplication.java:19) ~[classes/:na]

16:03:28:346  WARN 3040 --- [main] ConfigServletWebServerApplicationContext : Exception encountered during context initialization - cancelling refresh attempt: org.springframework.context.ApplicationContextException: Failed to start bean 'webServerStartStop'; nested exception is java.lang.reflect.UndeclaredThrowableException
16:03:28:429  INFO 3040 --- [main] o.apache.catalina.core.StandardService   : Stopping service [Tomcat]
16:03:28:435  WARN 3040 --- [main] o.a.c.loader.WebappClassLoaderBase       : The web application [ROOT] appears to have started a thread named [Thread-2] but has failed to stop it. This is very likely to create a memory leak. Stack trace of thread:
 java.base@17.0.11/sun.net.dns.ResolverConfigurationImpl.notifyAddrChange0(Native Method)
 java.base@17.0.11/sun.net.dns.ResolverConfigurationImpl$AddressChangeListener.run(ResolverConfigurationImpl.java:176)
16:03:28:454  INFO 3040 --- [main] ConditionEvaluationReportLoggingListener : 

Error starting ApplicationContext. To display the conditions report re-run your application with 'debug' enabled.
16:03:28:508 ERROR 3040 --- [main] o.s.boot.SpringApplication               : Application run failed

org.springframework.context.ApplicationContextException: Failed to start bean 'webServerStartStop'; nested exception is java.lang.reflect.UndeclaredThrowableException
	at org.springframework.context.support.DefaultLifecycleProcessor.doStart(DefaultLifecycleProcessor.java:181) ~[spring-context-5.3.27.jar:5.3.27]
	at org.springframework.context.support.DefaultLifecycleProcessor.access$200(DefaultLifecycleProcessor.java:54) ~[spring-context-5.3.27.jar:5.3.27]
	at org.springframework.context.support.DefaultLifecycleProcessor$LifecycleGroup.start(DefaultLifecycleProcessor.java:356) ~[spring-context-5.3.27.jar:5.3.27]
	at java.base/java.lang.Iterable.forEach(Iterable.java:75) ~[na:na]
	at org.springframework.context.support.DefaultLifecycleProcessor.startBeans(DefaultLifecycleProcessor.java:155) ~[spring-context-5.3.27.jar:5.3.27]
	at org.springframework.context.support.DefaultLifecycleProcessor.onRefresh(DefaultLifecycleProcessor.java:123) ~[spring-context-5.3.27.jar:5.3.27]
	at org.springframework.context.support.AbstractApplicationContext.finishRefresh(AbstractApplicationContext.java:937) ~[spring-context-5.3.27.jar:5.3.27]
	at org.springframework.context.support.AbstractApplicationContext.refresh(AbstractApplicationContext.java:586) ~[spring-context-5.3.27.jar:5.3.27]
	at org.springframework.boot.web.servlet.context.ServletWebServerApplicationContext.refresh(ServletWebServerApplicationContext.java:147) ~[spring-boot-2.7.12.jar:2.7.12]
	at org.springframework.boot.SpringApplication.refresh(SpringApplication.java:731) ~[spring-boot-2.7.12.jar:2.7.12]
	at org.springframework.boot.SpringApplication.refreshContext(SpringApplication.java:408) ~[spring-boot-2.7.12.jar:2.7.12]
	at org.springframework.boot.SpringApplication.run(SpringApplication.java:307) ~[spring-boot-2.7.12.jar:2.7.12]
	at org.springframework.boot.SpringApplication.run(SpringApplication.java:1303) ~[spring-boot-2.7.12.jar:2.7.12]
	at org.springframework.boot.SpringApplication.run(SpringApplication.java:1292) ~[spring-boot-2.7.12.jar:2.7.12]
	at com.luojiawei.his_service.HisServiceApplication.main(HisServiceApplication.java:19) ~[classes/:na]
Caused by: java.lang.reflect.UndeclaredThrowableException: null
	at org.springframework.util.ReflectionUtils.rethrowRuntimeException(ReflectionUtils.java:147) ~[spring-core-5.3.27.jar:5.3.27]
	at com.alibaba.cloud.nacos.registry.NacosServiceRegistry.register(NacosServiceRegistry.java:83) ~[spring-cloud-starter-alibaba-nacos-discovery-2021.1.jar:2021.1]
	at org.springframework.cloud.client.serviceregistry.AbstractAutoServiceRegistration.register(AbstractAutoServiceRegistration.java:232) ~[spring-cloud-commons-3.1.5.jar:3.1.5]
	at com.alibaba.cloud.nacos.registry.NacosAutoServiceRegistration.register(NacosAutoServiceRegistration.java:78) ~[spring-cloud-starter-alibaba-nacos-discovery-2021.1.jar:2021.1]
	at org.springframework.cloud.client.serviceregistry.AbstractAutoServiceRegistration.start(AbstractAutoServiceRegistration.java:133) ~[spring-cloud-commons-3.1.5.jar:3.1.5]
	at org.springframework.cloud.client.serviceregistry.AbstractAutoServiceRegistration.bind(AbstractAutoServiceRegistration.java:98) ~[spring-cloud-commons-3.1.5.jar:3.1.5]
	at org.springframework.cloud.client.serviceregistry.AbstractAutoServiceRegistration.onApplicationEvent(AbstractAutoServiceRegistration.java:86) ~[spring-cloud-commons-3.1.5.jar:3.1.5]
	at org.springframework.cloud.client.serviceregistry.AbstractAutoServiceRegistration.onApplicationEvent(AbstractAutoServiceRegistration.java:47) ~[spring-cloud-commons-3.1.5.jar:3.1.5]
	at org.springframework.context.event.SimpleApplicationEventMulticaster.doInvokeListener(SimpleApplicationEventMulticaster.java:176) ~[spring-context-5.3.27.jar:5.3.27]
	at org.springframework.context.event.SimpleApplicationEventMulticaster.invokeListener(SimpleApplicationEventMulticaster.java:169) ~[spring-context-5.3.27.jar:5.3.27]
	at org.springframework.context.event.SimpleApplicationEventMulticaster.multicastEvent(SimpleApplicationEventMulticaster.java:143) ~[spring-context-5.3.27.jar:5.3.27]
	at org.springframework.context.support.AbstractApplicationContext.publishEvent(AbstractApplicationContext.java:421) ~[spring-context-5.3.27.jar:5.3.27]
	at org.springframework.context.support.AbstractApplicationContext.publishEvent(AbstractApplicationContext.java:378) ~[spring-context-5.3.27.jar:5.3.27]
	at org.springframework.boot.web.servlet.context.WebServerStartStopLifecycle.start(WebServerStartStopLifecycle.java:46) ~[spring-boot-2.7.12.jar:2.7.12]
	at org.springframework.context.support.DefaultLifecycleProcessor.doStart(DefaultLifecycleProcessor.java:178) ~[spring-context-5.3.27.jar:5.3.27]
	... 14 common frames omitted
Caused by: com.alibaba.nacos.api.exception.NacosException: Client not connected, current status:STARTING
	at com.alibaba.nacos.common.remote.client.RpcClient.request(RpcClient.java:639) ~[nacos-client-2.2.0.jar:na]
	at com.alibaba.nacos.common.remote.client.RpcClient.request(RpcClient.java:619) ~[nacos-client-2.2.0.jar:na]
	at com.alibaba.nacos.client.naming.remote.gprc.NamingGrpcClientProxy.requestToServer(NamingGrpcClientProxy.java:356) ~[nacos-client-2.2.0.jar:na]
	at com.alibaba.nacos.client.naming.remote.gprc.NamingGrpcClientProxy.doRegisterService(NamingGrpcClientProxy.java:209) ~[nacos-client-2.2.0.jar:na]
	at com.alibaba.nacos.client.naming.remote.gprc.NamingGrpcClientProxy.registerService(NamingGrpcClientProxy.java:123) ~[nacos-client-2.2.0.jar:na]
	at com.alibaba.nacos.client.naming.remote.NamingClientProxyDelegate.registerService(NamingClientProxyDelegate.java:98) ~[nacos-client-2.2.0.jar:na]
	at com.alibaba.nacos.client.naming.NacosNamingService.registerInstance(NacosNamingService.java:152) ~[nacos-client-2.2.0.jar:na]
	at com.alibaba.cloud.nacos.registry.NacosServiceRegistry.register(NacosServiceRegistry.java:74) ~[spring-cloud-starter-alibaba-nacos-discovery-2021.1.jar:2021.1]
	... 27 common frames omitted

16:10:59:617  WARN 3040 --- [Thread-5] c.a.nacos.common.notify.NotifyCenter     : [NotifyCenter] Start destroying Publisher
16:10:59:615  WARN 3040 --- [Thread-8] c.a.n.common.http.HttpClientBeanHolder   : [HttpClientBeanHolder] Start destroying common HttpClient
16:11:10:468  INFO 27876 --- [main] c.l.his_service.HisServiceApplication    : Starting HisServiceApplication using Java 17.0.11 on luo with PID 27876 (A:\Desktop\workspace\HIS\his_service\target\classes started by 22407 in A:\Desktop\workspace\HIS)
16:11:10:471 DEBUG 27876 --- [main] c.l.his_service.HisServiceApplication    : Running with Spring Boot v2.7.12, Spring v5.3.27
16:11:10:471  INFO 27876 --- [main] c.l.his_service.HisServiceApplication    : The following 1 profile is active: "dev"
16:11:11:663  INFO 27876 --- [main] .s.d.r.c.RepositoryConfigurationDelegate : Multiple Spring Data modules found, entering strict repository configuration mode
16:11:11:666  INFO 27876 --- [main] .s.d.r.c.RepositoryConfigurationDelegate : Bootstrapping Spring Data Redis repositories in DEFAULT mode.
16:11:11:695  INFO 27876 --- [main] .s.d.r.c.RepositoryConfigurationDelegate : Finished Spring Data repository scanning in 14 ms. Found 0 Redis repository interfaces.
16:11:11:971  INFO 27876 --- [main] o.s.cloud.context.scope.GenericScope     : BeanFactory id=6223b6d6-9ee6-3c52-951c-fcc2980a1fa1
16:11:13:637  INFO 27876 --- [main] o.s.b.w.embedded.tomcat.TomcatWebServer  : Tomcat initialized with port(s): 8080 (http)
16:11:13:664  INFO 27876 --- [main] o.apache.catalina.core.StandardService   : Starting service [Tomcat]
16:11:13:668  INFO 27876 --- [main] org.apache.catalina.core.StandardEngine  : Starting Servlet engine: [Apache Tomcat/9.0.75]
16:11:13:942  INFO 27876 --- [main] o.a.c.c.C.[Tomcat].[localhost].[/]       : Initializing Spring embedded WebApplicationContext
16:11:13:942  INFO 27876 --- [main] w.s.c.ServletWebServerApplicationContext : Root WebApplicationContext: initialization completed in 3402 ms
16:11:14:170  INFO 27876 --- [main] org.redisson.Version                     : Redisson 3.17.7
16:11:14:575  INFO 27876 --- [redisson-netty-2-9] o.r.c.pool.MasterPubSubConnectionPool    : 1 connections initialized for 111.230.32.147/111.230.32.147:9631
16:11:15:311  INFO 27876 --- [redisson-netty-2-19] o.r.c.pool.MasterConnectionPool          : 24 connections initialized for 111.230.32.147/111.230.32.147:9631
16:11:15:587 DEBUG 27876 --- [main] c.l.h.filter.RefreshTokenFilter          : Filter 'refreshTokenFilter' configured for use
16:11:16:476  INFO 27876 --- [main] o.s.c.openfeign.FeignClientFactoryBean   : For 'flask-service' URL not provided. Will try picking an instance via load-balancing.
16:11:16:590  INFO 27876 --- [main] o.s.c.openfeign.FeignClientFactoryBean   : For 'ai-service' URL not provided. Will try picking an instance via load-balancing.
16:11:16:636  WARN 27876 --- [main] c.b.m.core.metadata.TableInfoHelper      : Can not find table primary key in Class: "java.lang.Object".
16:11:16:636  WARN 27876 --- [main] c.b.m.core.injector.DefaultSqlInjector   : class java.lang.Object ,Not found @TableId annotation, Cannot use Mybatis-Plus 'xxById' Method.
16:11:17:738  WARN 27876 --- [main] iguration$LoadBalancerCaffeineWarnLogger : Spring Cloud LoadBalancer is currently working with the default cache. While this cache implementation is useful for development and tests, it's recommended to use Caffeine cache in production.You can switch to using Caffeine cache, by adding it and org.springframework.cache.caffeine.CaffeineCacheManager to the classpath.
16:11:17:743  INFO 27876 --- [main] o.s.b.a.e.web.EndpointLinksResolver      : Exposing 1 endpoint(s) beneath base path '/actuator'
16:11:17:815  INFO 27876 --- [main] o.s.b.w.embedded.tomcat.TomcatWebServer  : Tomcat started on port(s): 8080 (http) with context path ''
16:11:18:102  INFO 27876 --- [main] c.l.his_service.HisServiceApplication    : Started HisServiceApplication in 8.47 seconds (JVM running for 9.639)
16:11:18:444  INFO 27876 --- [RMI TCP Connection(3)-10.21.93.70] o.a.c.c.C.[Tomcat].[localhost].[/]       : Initializing Spring DispatcherServlet 'dispatcherServlet'
16:11:18:445  INFO 27876 --- [RMI TCP Connection(3)-10.21.93.70] o.s.web.servlet.DispatcherServlet        : Initializing Servlet 'dispatcherServlet'
16:11:18:445  INFO 27876 --- [RMI TCP Connection(1)-10.21.93.70] com.zaxxer.hikari.HikariDataSource       : HikariPool-1 - Starting...
16:11:18:447  INFO 27876 --- [RMI TCP Connection(3)-10.21.93.70] o.s.web.servlet.DispatcherServlet        : Completed initialization in 2 ms
16:11:19:293  INFO 27876 --- [RMI TCP Connection(1)-10.21.93.70] com.zaxxer.hikari.HikariDataSource       : HikariPool-1 - Start completed.
16:13:37:046  INFO 27876 --- [SpringApplicationShutdownHook] com.zaxxer.hikari.HikariDataSource       : HikariPool-1 - Shutdown initiated...
16:13:37:387  INFO 27876 --- [SpringApplicationShutdownHook] com.zaxxer.hikari.HikariDataSource       : HikariPool-1 - Shutdown completed.
16:13:51:111  INFO 34576 --- [main] c.a.n.client.env.SearchableProperties    : properties search order:PROPERTIES->JVM->ENV->DEFAULT_SETTING
16:13:51:325  INFO 34576 --- [main] c.l.his_service.HisServiceApplication    : Starting HisServiceApplication using Java 17.0.11 on luo with PID 34576 (A:\Desktop\workspace\HIS\his_service\target\classes started by 22407 in A:\Desktop\workspace\HIS)
16:13:51:326 DEBUG 34576 --- [main] c.l.his_service.HisServiceApplication    : Running with Spring Boot v2.7.12, Spring v5.3.27
16:13:51:326  INFO 34576 --- [main] c.l.his_service.HisServiceApplication    : The following 1 profile is active: "dev"
16:13:52:394  INFO 34576 --- [main] .s.d.r.c.RepositoryConfigurationDelegate : Multiple Spring Data modules found, entering strict repository configuration mode
16:13:52:396  INFO 34576 --- [main] .s.d.r.c.RepositoryConfigurationDelegate : Bootstrapping Spring Data Redis repositories in DEFAULT mode.
16:13:52:424  INFO 34576 --- [main] .s.d.r.c.RepositoryConfigurationDelegate : Finished Spring Data repository scanning in 16 ms. Found 0 Redis repository interfaces.
16:13:52:718  INFO 34576 --- [main] o.s.cloud.context.scope.GenericScope     : BeanFactory id=ac61872e-faec-371d-922e-ad941e5407d7
16:13:53:293  INFO 34576 --- [main] o.s.b.w.embedded.tomcat.TomcatWebServer  : Tomcat initialized with port(s): 8080 (http)
16:13:53:300  INFO 34576 --- [main] o.apache.catalina.core.StandardService   : Starting service [Tomcat]
16:13:53:301  INFO 34576 --- [main] org.apache.catalina.core.StandardEngine  : Starting Servlet engine: [Apache Tomcat/9.0.75]
16:13:53:464  INFO 34576 --- [main] o.a.c.c.C.[Tomcat].[localhost].[/]       : Initializing Spring embedded WebApplicationContext
16:13:53:464  INFO 34576 --- [main] w.s.c.ServletWebServerApplicationContext : Root WebApplicationContext: initialization completed in 2089 ms
16:13:53:699  INFO 34576 --- [main] org.redisson.Version                     : Redisson 3.17.7
16:13:54:087  INFO 34576 --- [redisson-netty-2-9] o.r.c.pool.MasterPubSubConnectionPool    : 1 connections initialized for 111.230.32.147/111.230.32.147:9631
16:13:54:771  INFO 34576 --- [redisson-netty-2-19] o.r.c.pool.MasterConnectionPool          : 24 connections initialized for 111.230.32.147/111.230.32.147:9631
16:13:55:055 DEBUG 34576 --- [main] c.l.h.filter.RefreshTokenFilter          : Filter 'refreshTokenFilter' configured for use
16:13:55:755  INFO 34576 --- [main] o.s.c.openfeign.FeignClientFactoryBean   : For 'flask-service' URL not provided. Will try picking an instance via load-balancing.
16:13:55:869  INFO 34576 --- [main] o.s.c.openfeign.FeignClientFactoryBean   : For 'ai-service' URL not provided. Will try picking an instance via load-balancing.
16:13:55:914  WARN 34576 --- [main] c.b.m.core.metadata.TableInfoHelper      : Can not find table primary key in Class: "java.lang.Object".
16:13:55:915  WARN 34576 --- [main] c.b.m.core.injector.DefaultSqlInjector   : class java.lang.Object ,Not found @TableId annotation, Cannot use Mybatis-Plus 'xxById' Method.
16:13:57:692  WARN 34576 --- [main] iguration$LoadBalancerCaffeineWarnLogger : Spring Cloud LoadBalancer is currently working with the default cache. While this cache implementation is useful for development and tests, it's recommended to use Caffeine cache in production.You can switch to using Caffeine cache, by adding it and org.springframework.cache.caffeine.CaffeineCacheManager to the classpath.
16:13:57:700  INFO 34576 --- [main] o.s.b.a.e.web.EndpointLinksResolver      : Exposing 1 endpoint(s) beneath base path '/actuator'
16:13:57:791  INFO 34576 --- [main] o.s.b.w.embedded.tomcat.TomcatWebServer  : Tomcat started on port(s): 8080 (http) with context path ''
16:13:57:875  INFO 34576 --- [main] c.a.n.p.a.s.c.ClientAuthPluginManager    : [ClientAuthPluginManager] Load ClientAuthService com.alibaba.nacos.client.auth.impl.NacosClientAuthServiceImpl success.
16:13:57:875  INFO 34576 --- [main] c.a.n.p.a.s.c.ClientAuthPluginManager    : [ClientAuthPluginManager] Load ClientAuthService com.alibaba.nacos.client.auth.ram.RamClientAuthServiceImpl success.
16:14:09:011 ERROR 34576 --- [main] c.a.c.n.registry.NacosServiceRegistry    : nacos registry, his-service register failed...NacosRegistration{nacosDiscoveryProperties=NacosDiscoveryProperties{serverAddr='81.71.3.20', username='', password='', endpoint='', namespace='', watchDelay=30000, logName='', service='his-service', weight=1.0, clusterName='DEFAULT', group='DEFAULT_GROUP', namingLoadCacheAtStart='false', metadata={IPv6=null, preserved.register.source=SPRING_CLOUD}, registerEnabled=true, ip='10.21.93.70', networkInterface='', port=8848, secure=false, accessKey='', secretKey='', heartBeatInterval=null, heartBeatTimeout=null, ipDeleteTimeout=null, instanceEnabled=true, ephemeral=true, failureToleranceEnabled=false}, ipDeleteTimeout=null, failFast=true}},

com.alibaba.nacos.api.exception.NacosException: Client not connected, current status:STARTING
	at com.alibaba.nacos.common.remote.client.RpcClient.request(RpcClient.java:639) ~[nacos-client-2.2.0.jar:na]
	at com.alibaba.nacos.common.remote.client.RpcClient.request(RpcClient.java:619) ~[nacos-client-2.2.0.jar:na]
	at com.alibaba.nacos.client.naming.remote.gprc.NamingGrpcClientProxy.requestToServer(NamingGrpcClientProxy.java:356) ~[nacos-client-2.2.0.jar:na]
	at com.alibaba.nacos.client.naming.remote.gprc.NamingGrpcClientProxy.doRegisterService(NamingGrpcClientProxy.java:209) ~[nacos-client-2.2.0.jar:na]
	at com.alibaba.nacos.client.naming.remote.gprc.NamingGrpcClientProxy.registerService(NamingGrpcClientProxy.java:123) ~[nacos-client-2.2.0.jar:na]
	at com.alibaba.nacos.client.naming.remote.NamingClientProxyDelegate.registerService(NamingClientProxyDelegate.java:98) ~[nacos-client-2.2.0.jar:na]
	at com.alibaba.nacos.client.naming.NacosNamingService.registerInstance(NacosNamingService.java:152) ~[nacos-client-2.2.0.jar:na]
	at com.alibaba.cloud.nacos.registry.NacosServiceRegistry.register(NacosServiceRegistry.java:75) ~[spring-cloud-starter-alibaba-nacos-discovery-2021.0.5.0.jar:2021.0.5.0]
	at org.springframework.cloud.client.serviceregistry.AbstractAutoServiceRegistration.register(AbstractAutoServiceRegistration.java:232) ~[spring-cloud-commons-3.1.5.jar:3.1.5]
	at com.alibaba.cloud.nacos.registry.NacosAutoServiceRegistration.register(NacosAutoServiceRegistration.java:78) ~[spring-cloud-starter-alibaba-nacos-discovery-2021.0.5.0.jar:2021.0.5.0]
	at org.springframework.cloud.client.serviceregistry.AbstractAutoServiceRegistration.start(AbstractAutoServiceRegistration.java:133) ~[spring-cloud-commons-3.1.5.jar:3.1.5]
	at org.springframework.cloud.client.serviceregistry.AbstractAutoServiceRegistration.bind(AbstractAutoServiceRegistration.java:98) ~[spring-cloud-commons-3.1.5.jar:3.1.5]
	at org.springframework.cloud.client.serviceregistry.AbstractAutoServiceRegistration.onApplicationEvent(AbstractAutoServiceRegistration.java:86) ~[spring-cloud-commons-3.1.5.jar:3.1.5]
	at org.springframework.cloud.client.serviceregistry.AbstractAutoServiceRegistration.onApplicationEvent(AbstractAutoServiceRegistration.java:47) ~[spring-cloud-commons-3.1.5.jar:3.1.5]
	at org.springframework.context.event.SimpleApplicationEventMulticaster.doInvokeListener(SimpleApplicationEventMulticaster.java:176) ~[spring-context-5.3.27.jar:5.3.27]
	at org.springframework.context.event.SimpleApplicationEventMulticaster.invokeListener(SimpleApplicationEventMulticaster.java:169) ~[spring-context-5.3.27.jar:5.3.27]
	at org.springframework.context.event.SimpleApplicationEventMulticaster.multicastEvent(SimpleApplicationEventMulticaster.java:143) ~[spring-context-5.3.27.jar:5.3.27]
	at org.springframework.context.support.AbstractApplicationContext.publishEvent(AbstractApplicationContext.java:421) ~[spring-context-5.3.27.jar:5.3.27]
	at org.springframework.context.support.AbstractApplicationContext.publishEvent(AbstractApplicationContext.java:378) ~[spring-context-5.3.27.jar:5.3.27]
	at org.springframework.boot.web.servlet.context.WebServerStartStopLifecycle.start(WebServerStartStopLifecycle.java:46) ~[spring-boot-2.7.12.jar:2.7.12]
	at org.springframework.context.support.DefaultLifecycleProcessor.doStart(DefaultLifecycleProcessor.java:178) ~[spring-context-5.3.27.jar:5.3.27]
	at org.springframework.context.support.DefaultLifecycleProcessor.access$200(DefaultLifecycleProcessor.java:54) ~[spring-context-5.3.27.jar:5.3.27]
	at org.springframework.context.support.DefaultLifecycleProcessor$LifecycleGroup.start(DefaultLifecycleProcessor.java:356) ~[spring-context-5.3.27.jar:5.3.27]
	at java.base/java.lang.Iterable.forEach(Iterable.java:75) ~[na:na]
	at org.springframework.context.support.DefaultLifecycleProcessor.startBeans(DefaultLifecycleProcessor.java:155) ~[spring-context-5.3.27.jar:5.3.27]
	at org.springframework.context.support.DefaultLifecycleProcessor.onRefresh(DefaultLifecycleProcessor.java:123) ~[spring-context-5.3.27.jar:5.3.27]
	at org.springframework.context.support.AbstractApplicationContext.finishRefresh(AbstractApplicationContext.java:937) ~[spring-context-5.3.27.jar:5.3.27]
	at org.springframework.context.support.AbstractApplicationContext.refresh(AbstractApplicationContext.java:586) ~[spring-context-5.3.27.jar:5.3.27]
	at org.springframework.boot.web.servlet.context.ServletWebServerApplicationContext.refresh(ServletWebServerApplicationContext.java:147) ~[spring-boot-2.7.12.jar:2.7.12]
	at org.springframework.boot.SpringApplication.refresh(SpringApplication.java:731) ~[spring-boot-2.7.12.jar:2.7.12]
	at org.springframework.boot.SpringApplication.refreshContext(SpringApplication.java:408) ~[spring-boot-2.7.12.jar:2.7.12]
	at org.springframework.boot.SpringApplication.run(SpringApplication.java:307) ~[spring-boot-2.7.12.jar:2.7.12]
	at org.springframework.boot.SpringApplication.run(SpringApplication.java:1303) ~[spring-boot-2.7.12.jar:2.7.12]
	at org.springframework.boot.SpringApplication.run(SpringApplication.java:1292) ~[spring-boot-2.7.12.jar:2.7.12]
	at com.luojiawei.his_service.HisServiceApplication.main(HisServiceApplication.java:19) ~[classes/:na]

16:14:09:011  WARN 34576 --- [main] ConfigServletWebServerApplicationContext : Exception encountered during context initialization - cancelling refresh attempt: org.springframework.context.ApplicationContextException: Failed to start bean 'webServerStartStop'; nested exception is java.lang.reflect.UndeclaredThrowableException
16:14:09:096  INFO 34576 --- [main] o.apache.catalina.core.StandardService   : Stopping service [Tomcat]
16:14:09:099  WARN 34576 --- [main] o.a.c.loader.WebappClassLoaderBase       : The web application [ROOT] appears to have started a thread named [Thread-2] but has failed to stop it. This is very likely to create a memory leak. Stack trace of thread:
 java.base@17.0.11/sun.net.dns.ResolverConfigurationImpl.notifyAddrChange0(Native Method)
 java.base@17.0.11/sun.net.dns.ResolverConfigurationImpl$AddressChangeListener.run(ResolverConfigurationImpl.java:176)
16:14:09:119  INFO 34576 --- [main] ConditionEvaluationReportLoggingListener : 

Error starting ApplicationContext. To display the conditions report re-run your application with 'debug' enabled.
16:14:09:181 ERROR 34576 --- [main] o.s.boot.SpringApplication               : Application run failed

org.springframework.context.ApplicationContextException: Failed to start bean 'webServerStartStop'; nested exception is java.lang.reflect.UndeclaredThrowableException
	at org.springframework.context.support.DefaultLifecycleProcessor.doStart(DefaultLifecycleProcessor.java:181) ~[spring-context-5.3.27.jar:5.3.27]
	at org.springframework.context.support.DefaultLifecycleProcessor.access$200(DefaultLifecycleProcessor.java:54) ~[spring-context-5.3.27.jar:5.3.27]
	at org.springframework.context.support.DefaultLifecycleProcessor$LifecycleGroup.start(DefaultLifecycleProcessor.java:356) ~[spring-context-5.3.27.jar:5.3.27]
	at java.base/java.lang.Iterable.forEach(Iterable.java:75) ~[na:na]
	at org.springframework.context.support.DefaultLifecycleProcessor.startBeans(DefaultLifecycleProcessor.java:155) ~[spring-context-5.3.27.jar:5.3.27]
	at org.springframework.context.support.DefaultLifecycleProcessor.onRefresh(DefaultLifecycleProcessor.java:123) ~[spring-context-5.3.27.jar:5.3.27]
	at org.springframework.context.support.AbstractApplicationContext.finishRefresh(AbstractApplicationContext.java:937) ~[spring-context-5.3.27.jar:5.3.27]
	at org.springframework.context.support.AbstractApplicationContext.refresh(AbstractApplicationContext.java:586) ~[spring-context-5.3.27.jar:5.3.27]
	at org.springframework.boot.web.servlet.context.ServletWebServerApplicationContext.refresh(ServletWebServerApplicationContext.java:147) ~[spring-boot-2.7.12.jar:2.7.12]
	at org.springframework.boot.SpringApplication.refresh(SpringApplication.java:731) ~[spring-boot-2.7.12.jar:2.7.12]
	at org.springframework.boot.SpringApplication.refreshContext(SpringApplication.java:408) ~[spring-boot-2.7.12.jar:2.7.12]
	at org.springframework.boot.SpringApplication.run(SpringApplication.java:307) ~[spring-boot-2.7.12.jar:2.7.12]
	at org.springframework.boot.SpringApplication.run(SpringApplication.java:1303) ~[spring-boot-2.7.12.jar:2.7.12]
	at org.springframework.boot.SpringApplication.run(SpringApplication.java:1292) ~[spring-boot-2.7.12.jar:2.7.12]
	at com.luojiawei.his_service.HisServiceApplication.main(HisServiceApplication.java:19) ~[classes/:na]
Caused by: java.lang.reflect.UndeclaredThrowableException: null
	at org.springframework.util.ReflectionUtils.rethrowRuntimeException(ReflectionUtils.java:147) ~[spring-core-5.3.27.jar:5.3.27]
	at com.alibaba.cloud.nacos.registry.NacosServiceRegistry.register(NacosServiceRegistry.java:83) ~[spring-cloud-starter-alibaba-nacos-discovery-2021.0.5.0.jar:2021.0.5.0]
	at org.springframework.cloud.client.serviceregistry.AbstractAutoServiceRegistration.register(AbstractAutoServiceRegistration.java:232) ~[spring-cloud-commons-3.1.5.jar:3.1.5]
	at com.alibaba.cloud.nacos.registry.NacosAutoServiceRegistration.register(NacosAutoServiceRegistration.java:78) ~[spring-cloud-starter-alibaba-nacos-discovery-2021.0.5.0.jar:2021.0.5.0]
	at org.springframework.cloud.client.serviceregistry.AbstractAutoServiceRegistration.start(AbstractAutoServiceRegistration.java:133) ~[spring-cloud-commons-3.1.5.jar:3.1.5]
	at org.springframework.cloud.client.serviceregistry.AbstractAutoServiceRegistration.bind(AbstractAutoServiceRegistration.java:98) ~[spring-cloud-commons-3.1.5.jar:3.1.5]
	at org.springframework.cloud.client.serviceregistry.AbstractAutoServiceRegistration.onApplicationEvent(AbstractAutoServiceRegistration.java:86) ~[spring-cloud-commons-3.1.5.jar:3.1.5]
	at org.springframework.cloud.client.serviceregistry.AbstractAutoServiceRegistration.onApplicationEvent(AbstractAutoServiceRegistration.java:47) ~[spring-cloud-commons-3.1.5.jar:3.1.5]
	at org.springframework.context.event.SimpleApplicationEventMulticaster.doInvokeListener(SimpleApplicationEventMulticaster.java:176) ~[spring-context-5.3.27.jar:5.3.27]
	at org.springframework.context.event.SimpleApplicationEventMulticaster.invokeListener(SimpleApplicationEventMulticaster.java:169) ~[spring-context-5.3.27.jar:5.3.27]
	at org.springframework.context.event.SimpleApplicationEventMulticaster.multicastEvent(SimpleApplicationEventMulticaster.java:143) ~[spring-context-5.3.27.jar:5.3.27]
	at org.springframework.context.support.AbstractApplicationContext.publishEvent(AbstractApplicationContext.java:421) ~[spring-context-5.3.27.jar:5.3.27]
	at org.springframework.context.support.AbstractApplicationContext.publishEvent(AbstractApplicationContext.java:378) ~[spring-context-5.3.27.jar:5.3.27]
	at org.springframework.boot.web.servlet.context.WebServerStartStopLifecycle.start(WebServerStartStopLifecycle.java:46) ~[spring-boot-2.7.12.jar:2.7.12]
	at org.springframework.context.support.DefaultLifecycleProcessor.doStart(DefaultLifecycleProcessor.java:178) ~[spring-context-5.3.27.jar:5.3.27]
	... 14 common frames omitted
Caused by: com.alibaba.nacos.api.exception.NacosException: Client not connected, current status:STARTING
	at com.alibaba.nacos.common.remote.client.RpcClient.request(RpcClient.java:639) ~[nacos-client-2.2.0.jar:na]
	at com.alibaba.nacos.common.remote.client.RpcClient.request(RpcClient.java:619) ~[nacos-client-2.2.0.jar:na]
	at com.alibaba.nacos.client.naming.remote.gprc.NamingGrpcClientProxy.requestToServer(NamingGrpcClientProxy.java:356) ~[nacos-client-2.2.0.jar:na]
	at com.alibaba.nacos.client.naming.remote.gprc.NamingGrpcClientProxy.doRegisterService(NamingGrpcClientProxy.java:209) ~[nacos-client-2.2.0.jar:na]
	at com.alibaba.nacos.client.naming.remote.gprc.NamingGrpcClientProxy.registerService(NamingGrpcClientProxy.java:123) ~[nacos-client-2.2.0.jar:na]
	at com.alibaba.nacos.client.naming.remote.NamingClientProxyDelegate.registerService(NamingClientProxyDelegate.java:98) ~[nacos-client-2.2.0.jar:na]
	at com.alibaba.nacos.client.naming.NacosNamingService.registerInstance(NacosNamingService.java:152) ~[nacos-client-2.2.0.jar:na]
	at com.alibaba.cloud.nacos.registry.NacosServiceRegistry.register(NacosServiceRegistry.java:75) ~[spring-cloud-starter-alibaba-nacos-discovery-2021.0.5.0.jar:2021.0.5.0]
	... 27 common frames omitted

16:14:10:019  WARN 34576 --- [Thread-5] c.a.nacos.common.notify.NotifyCenter     : [NotifyCenter] Start destroying Publisher
16:14:10:019  WARN 34576 --- [Thread-5] c.a.nacos.common.notify.NotifyCenter     : [NotifyCenter] Destruction of the end
16:14:10:019  WARN 34576 --- [Thread-8] c.a.n.common.http.HttpClientBeanHolder   : [HttpClientBeanHolder] Start destroying common HttpClient
16:14:10:021  WARN 34576 --- [Thread-8] c.a.n.common.http.HttpClientBeanHolder   : [HttpClientBeanHolder] Destruction of the end
16:15:40:348  INFO 20944 --- [main] c.a.n.client.env.SearchableProperties    : properties search order:PROPERTIES->JVM->ENV->DEFAULT_SETTING
16:15:40:537  INFO 20944 --- [main] c.l.his_service.HisServiceApplication    : Starting HisServiceApplication using Java 17.0.11 on luo with PID 20944 (A:\Desktop\workspace\HIS\his_service\target\classes started by 22407 in A:\Desktop\workspace\HIS)
16:15:40:538 DEBUG 20944 --- [main] c.l.his_service.HisServiceApplication    : Running with Spring Boot v2.7.12, Spring v5.3.27
16:15:40:538  INFO 20944 --- [main] c.l.his_service.HisServiceApplication    : The following 1 profile is active: "dev"
16:15:41:535  INFO 20944 --- [main] .s.d.r.c.RepositoryConfigurationDelegate : Multiple Spring Data modules found, entering strict repository configuration mode
16:15:41:538  INFO 20944 --- [main] .s.d.r.c.RepositoryConfigurationDelegate : Bootstrapping Spring Data Redis repositories in DEFAULT mode.
16:15:41:580  INFO 20944 --- [main] .s.d.r.c.RepositoryConfigurationDelegate : Finished Spring Data repository scanning in 25 ms. Found 0 Redis repository interfaces.
16:15:41:886  INFO 20944 --- [main] o.s.cloud.context.scope.GenericScope     : BeanFactory id=ac61872e-faec-371d-922e-ad941e5407d7
16:15:42:478  INFO 20944 --- [main] o.s.b.w.embedded.tomcat.TomcatWebServer  : Tomcat initialized with port(s): 8080 (http)
16:15:42:486  INFO 20944 --- [main] o.apache.catalina.core.StandardService   : Starting service [Tomcat]
16:15:42:486  INFO 20944 --- [main] org.apache.catalina.core.StandardEngine  : Starting Servlet engine: [Apache Tomcat/9.0.75]
16:15:42:646  INFO 20944 --- [main] o.a.c.c.C.[Tomcat].[localhost].[/]       : Initializing Spring embedded WebApplicationContext
16:15:42:647  INFO 20944 --- [main] w.s.c.ServletWebServerApplicationContext : Root WebApplicationContext: initialization completed in 2064 ms
16:15:42:872  INFO 20944 --- [main] org.redisson.Version                     : Redisson 3.17.7
16:15:43:258  INFO 20944 --- [redisson-netty-2-9] o.r.c.pool.MasterPubSubConnectionPool    : 1 connections initialized for 111.230.32.147/111.230.32.147:9631
16:15:43:964  INFO 20944 --- [redisson-netty-2-19] o.r.c.pool.MasterConnectionPool          : 24 connections initialized for 111.230.32.147/111.230.32.147:9631
16:15:44:237 DEBUG 20944 --- [main] c.l.h.filter.RefreshTokenFilter          : Filter 'refreshTokenFilter' configured for use
16:15:44:961  INFO 20944 --- [main] o.s.c.openfeign.FeignClientFactoryBean   : For 'flask-service' URL not provided. Will try picking an instance via load-balancing.
16:15:45:072  INFO 20944 --- [main] o.s.c.openfeign.FeignClientFactoryBean   : For 'ai-service' URL not provided. Will try picking an instance via load-balancing.
16:15:45:113  WARN 20944 --- [main] c.b.m.core.metadata.TableInfoHelper      : Can not find table primary key in Class: "java.lang.Object".
16:15:45:113  WARN 20944 --- [main] c.b.m.core.injector.DefaultSqlInjector   : class java.lang.Object ,Not found @TableId annotation, Cannot use Mybatis-Plus 'xxById' Method.
16:15:46:646  WARN 20944 --- [main] iguration$LoadBalancerCaffeineWarnLogger : Spring Cloud LoadBalancer is currently working with the default cache. While this cache implementation is useful for development and tests, it's recommended to use Caffeine cache in production.You can switch to using Caffeine cache, by adding it and org.springframework.cache.caffeine.CaffeineCacheManager to the classpath.
16:15:46:653  INFO 20944 --- [main] o.s.b.a.e.web.EndpointLinksResolver      : Exposing 1 endpoint(s) beneath base path '/actuator'
16:15:46:717  INFO 20944 --- [main] o.s.b.w.embedded.tomcat.TomcatWebServer  : Tomcat started on port(s): 8080 (http) with context path ''
16:15:46:753  INFO 20944 --- [main] c.a.n.p.a.s.c.ClientAuthPluginManager    : [ClientAuthPluginManager] Load ClientAuthService com.alibaba.nacos.client.auth.impl.NacosClientAuthServiceImpl success.
16:15:46:754  INFO 20944 --- [main] c.a.n.p.a.s.c.ClientAuthPluginManager    : [ClientAuthPluginManager] Load ClientAuthService com.alibaba.nacos.client.auth.ram.RamClientAuthServiceImpl success.
16:15:56:680 ERROR 20944 --- [main] c.a.c.n.registry.NacosServiceRegistry    : nacos registry, his-service register failed...NacosRegistration{nacosDiscoveryProperties=NacosDiscoveryProperties{serverAddr='81.71.3.20', username='', password='', endpoint='', namespace='public', watchDelay=30000, logName='', service='his-service', weight=1.0, clusterName='DEFAULT', group='DEFAULT_GROUP', namingLoadCacheAtStart='false', metadata={IPv6=null, preserved.register.source=SPRING_CLOUD}, registerEnabled=true, ip='10.21.93.70', networkInterface='', port=8848, secure=false, accessKey='', secretKey='', heartBeatInterval=null, heartBeatTimeout=null, ipDeleteTimeout=null, instanceEnabled=true, ephemeral=true, failureToleranceEnabled=false}, ipDeleteTimeout=null, failFast=true}},

com.alibaba.nacos.api.exception.NacosException: Client not connected, current status:STARTING
	at com.alibaba.nacos.common.remote.client.RpcClient.request(RpcClient.java:639) ~[nacos-client-2.2.0.jar:na]
	at com.alibaba.nacos.common.remote.client.RpcClient.request(RpcClient.java:619) ~[nacos-client-2.2.0.jar:na]
	at com.alibaba.nacos.client.naming.remote.gprc.NamingGrpcClientProxy.requestToServer(NamingGrpcClientProxy.java:356) ~[nacos-client-2.2.0.jar:na]
	at com.alibaba.nacos.client.naming.remote.gprc.NamingGrpcClientProxy.doRegisterService(NamingGrpcClientProxy.java:209) ~[nacos-client-2.2.0.jar:na]
	at com.alibaba.nacos.client.naming.remote.gprc.NamingGrpcClientProxy.registerService(NamingGrpcClientProxy.java:123) ~[nacos-client-2.2.0.jar:na]
	at com.alibaba.nacos.client.naming.remote.NamingClientProxyDelegate.registerService(NamingClientProxyDelegate.java:98) ~[nacos-client-2.2.0.jar:na]
	at com.alibaba.nacos.client.naming.NacosNamingService.registerInstance(NacosNamingService.java:152) ~[nacos-client-2.2.0.jar:na]
	at com.alibaba.cloud.nacos.registry.NacosServiceRegistry.register(NacosServiceRegistry.java:75) ~[spring-cloud-starter-alibaba-nacos-discovery-2021.0.5.0.jar:2021.0.5.0]
	at org.springframework.cloud.client.serviceregistry.AbstractAutoServiceRegistration.register(AbstractAutoServiceRegistration.java:232) ~[spring-cloud-commons-3.1.5.jar:3.1.5]
	at com.alibaba.cloud.nacos.registry.NacosAutoServiceRegistration.register(NacosAutoServiceRegistration.java:78) ~[spring-cloud-starter-alibaba-nacos-discovery-2021.0.5.0.jar:2021.0.5.0]
	at org.springframework.cloud.client.serviceregistry.AbstractAutoServiceRegistration.start(AbstractAutoServiceRegistration.java:133) ~[spring-cloud-commons-3.1.5.jar:3.1.5]
	at org.springframework.cloud.client.serviceregistry.AbstractAutoServiceRegistration.bind(AbstractAutoServiceRegistration.java:98) ~[spring-cloud-commons-3.1.5.jar:3.1.5]
	at org.springframework.cloud.client.serviceregistry.AbstractAutoServiceRegistration.onApplicationEvent(AbstractAutoServiceRegistration.java:86) ~[spring-cloud-commons-3.1.5.jar:3.1.5]
	at org.springframework.cloud.client.serviceregistry.AbstractAutoServiceRegistration.onApplicationEvent(AbstractAutoServiceRegistration.java:47) ~[spring-cloud-commons-3.1.5.jar:3.1.5]
	at org.springframework.context.event.SimpleApplicationEventMulticaster.doInvokeListener(SimpleApplicationEventMulticaster.java:176) ~[spring-context-5.3.27.jar:5.3.27]
	at org.springframework.context.event.SimpleApplicationEventMulticaster.invokeListener(SimpleApplicationEventMulticaster.java:169) ~[spring-context-5.3.27.jar:5.3.27]
	at org.springframework.context.event.SimpleApplicationEventMulticaster.multicastEvent(SimpleApplicationEventMulticaster.java:143) ~[spring-context-5.3.27.jar:5.3.27]
	at org.springframework.context.support.AbstractApplicationContext.publishEvent(AbstractApplicationContext.java:421) ~[spring-context-5.3.27.jar:5.3.27]
	at org.springframework.context.support.AbstractApplicationContext.publishEvent(AbstractApplicationContext.java:378) ~[spring-context-5.3.27.jar:5.3.27]
	at org.springframework.boot.web.servlet.context.WebServerStartStopLifecycle.start(WebServerStartStopLifecycle.java:46) ~[spring-boot-2.7.12.jar:2.7.12]
	at org.springframework.context.support.DefaultLifecycleProcessor.doStart(DefaultLifecycleProcessor.java:178) ~[spring-context-5.3.27.jar:5.3.27]
	at org.springframework.context.support.DefaultLifecycleProcessor.access$200(DefaultLifecycleProcessor.java:54) ~[spring-context-5.3.27.jar:5.3.27]
	at org.springframework.context.support.DefaultLifecycleProcessor$LifecycleGroup.start(DefaultLifecycleProcessor.java:356) ~[spring-context-5.3.27.jar:5.3.27]
	at java.base/java.lang.Iterable.forEach(Iterable.java:75) ~[na:na]
	at org.springframework.context.support.DefaultLifecycleProcessor.startBeans(DefaultLifecycleProcessor.java:155) ~[spring-context-5.3.27.jar:5.3.27]
	at org.springframework.context.support.DefaultLifecycleProcessor.onRefresh(DefaultLifecycleProcessor.java:123) ~[spring-context-5.3.27.jar:5.3.27]
	at org.springframework.context.support.AbstractApplicationContext.finishRefresh(AbstractApplicationContext.java:937) ~[spring-context-5.3.27.jar:5.3.27]
	at org.springframework.context.support.AbstractApplicationContext.refresh(AbstractApplicationContext.java:586) ~[spring-context-5.3.27.jar:5.3.27]
	at org.springframework.boot.web.servlet.context.ServletWebServerApplicationContext.refresh(ServletWebServerApplicationContext.java:147) ~[spring-boot-2.7.12.jar:2.7.12]
	at org.springframework.boot.SpringApplication.refresh(SpringApplication.java:731) ~[spring-boot-2.7.12.jar:2.7.12]
	at org.springframework.boot.SpringApplication.refreshContext(SpringApplication.java:408) ~[spring-boot-2.7.12.jar:2.7.12]
	at org.springframework.boot.SpringApplication.run(SpringApplication.java:307) ~[spring-boot-2.7.12.jar:2.7.12]
	at org.springframework.boot.SpringApplication.run(SpringApplication.java:1303) ~[spring-boot-2.7.12.jar:2.7.12]
	at org.springframework.boot.SpringApplication.run(SpringApplication.java:1292) ~[spring-boot-2.7.12.jar:2.7.12]
	at com.luojiawei.his_service.HisServiceApplication.main(HisServiceApplication.java:19) ~[classes/:na]

16:15:56:681  WARN 20944 --- [main] ConfigServletWebServerApplicationContext : Exception encountered during context initialization - cancelling refresh attempt: org.springframework.context.ApplicationContextException: Failed to start bean 'webServerStartStop'; nested exception is java.lang.reflect.UndeclaredThrowableException
16:15:56:810  INFO 20944 --- [main] o.apache.catalina.core.StandardService   : Stopping service [Tomcat]
16:15:56:814  WARN 20944 --- [main] o.a.c.loader.WebappClassLoaderBase       : The web application [ROOT] appears to have started a thread named [Thread-2] but has failed to stop it. This is very likely to create a memory leak. Stack trace of thread:
 java.base@17.0.11/sun.net.dns.ResolverConfigurationImpl.notifyAddrChange0(Native Method)
 java.base@17.0.11/sun.net.dns.ResolverConfigurationImpl$AddressChangeListener.run(ResolverConfigurationImpl.java:176)
16:15:56:830  INFO 20944 --- [main] ConditionEvaluationReportLoggingListener : 

Error starting ApplicationContext. To display the conditions report re-run your application with 'debug' enabled.
16:15:56:847 ERROR 20944 --- [main] o.s.boot.SpringApplication               : Application run failed

org.springframework.context.ApplicationContextException: Failed to start bean 'webServerStartStop'; nested exception is java.lang.reflect.UndeclaredThrowableException
	at org.springframework.context.support.DefaultLifecycleProcessor.doStart(DefaultLifecycleProcessor.java:181) ~[spring-context-5.3.27.jar:5.3.27]
	at org.springframework.context.support.DefaultLifecycleProcessor.access$200(DefaultLifecycleProcessor.java:54) ~[spring-context-5.3.27.jar:5.3.27]
	at org.springframework.context.support.DefaultLifecycleProcessor$LifecycleGroup.start(DefaultLifecycleProcessor.java:356) ~[spring-context-5.3.27.jar:5.3.27]
	at java.base/java.lang.Iterable.forEach(Iterable.java:75) ~[na:na]
	at org.springframework.context.support.DefaultLifecycleProcessor.startBeans(DefaultLifecycleProcessor.java:155) ~[spring-context-5.3.27.jar:5.3.27]
	at org.springframework.context.support.DefaultLifecycleProcessor.onRefresh(DefaultLifecycleProcessor.java:123) ~[spring-context-5.3.27.jar:5.3.27]
	at org.springframework.context.support.AbstractApplicationContext.finishRefresh(AbstractApplicationContext.java:937) ~[spring-context-5.3.27.jar:5.3.27]
	at org.springframework.context.support.AbstractApplicationContext.refresh(AbstractApplicationContext.java:586) ~[spring-context-5.3.27.jar:5.3.27]
	at org.springframework.boot.web.servlet.context.ServletWebServerApplicationContext.refresh(ServletWebServerApplicationContext.java:147) ~[spring-boot-2.7.12.jar:2.7.12]
	at org.springframework.boot.SpringApplication.refresh(SpringApplication.java:731) ~[spring-boot-2.7.12.jar:2.7.12]
	at org.springframework.boot.SpringApplication.refreshContext(SpringApplication.java:408) ~[spring-boot-2.7.12.jar:2.7.12]
	at org.springframework.boot.SpringApplication.run(SpringApplication.java:307) ~[spring-boot-2.7.12.jar:2.7.12]
	at org.springframework.boot.SpringApplication.run(SpringApplication.java:1303) ~[spring-boot-2.7.12.jar:2.7.12]
	at org.springframework.boot.SpringApplication.run(SpringApplication.java:1292) ~[spring-boot-2.7.12.jar:2.7.12]
	at com.luojiawei.his_service.HisServiceApplication.main(HisServiceApplication.java:19) ~[classes/:na]
Caused by: java.lang.reflect.UndeclaredThrowableException: null
	at org.springframework.util.ReflectionUtils.rethrowRuntimeException(ReflectionUtils.java:147) ~[spring-core-5.3.27.jar:5.3.27]
	at com.alibaba.cloud.nacos.registry.NacosServiceRegistry.register(NacosServiceRegistry.java:83) ~[spring-cloud-starter-alibaba-nacos-discovery-2021.0.5.0.jar:2021.0.5.0]
	at org.springframework.cloud.client.serviceregistry.AbstractAutoServiceRegistration.register(AbstractAutoServiceRegistration.java:232) ~[spring-cloud-commons-3.1.5.jar:3.1.5]
	at com.alibaba.cloud.nacos.registry.NacosAutoServiceRegistration.register(NacosAutoServiceRegistration.java:78) ~[spring-cloud-starter-alibaba-nacos-discovery-2021.0.5.0.jar:2021.0.5.0]
	at org.springframework.cloud.client.serviceregistry.AbstractAutoServiceRegistration.start(AbstractAutoServiceRegistration.java:133) ~[spring-cloud-commons-3.1.5.jar:3.1.5]
	at org.springframework.cloud.client.serviceregistry.AbstractAutoServiceRegistration.bind(AbstractAutoServiceRegistration.java:98) ~[spring-cloud-commons-3.1.5.jar:3.1.5]
	at org.springframework.cloud.client.serviceregistry.AbstractAutoServiceRegistration.onApplicationEvent(AbstractAutoServiceRegistration.java:86) ~[spring-cloud-commons-3.1.5.jar:3.1.5]
	at org.springframework.cloud.client.serviceregistry.AbstractAutoServiceRegistration.onApplicationEvent(AbstractAutoServiceRegistration.java:47) ~[spring-cloud-commons-3.1.5.jar:3.1.5]
	at org.springframework.context.event.SimpleApplicationEventMulticaster.doInvokeListener(SimpleApplicationEventMulticaster.java:176) ~[spring-context-5.3.27.jar:5.3.27]
	at org.springframework.context.event.SimpleApplicationEventMulticaster.invokeListener(SimpleApplicationEventMulticaster.java:169) ~[spring-context-5.3.27.jar:5.3.27]
	at org.springframework.context.event.SimpleApplicationEventMulticaster.multicastEvent(SimpleApplicationEventMulticaster.java:143) ~[spring-context-5.3.27.jar:5.3.27]
	at org.springframework.context.support.AbstractApplicationContext.publishEvent(AbstractApplicationContext.java:421) ~[spring-context-5.3.27.jar:5.3.27]
	at org.springframework.context.support.AbstractApplicationContext.publishEvent(AbstractApplicationContext.java:378) ~[spring-context-5.3.27.jar:5.3.27]
	at org.springframework.boot.web.servlet.context.WebServerStartStopLifecycle.start(WebServerStartStopLifecycle.java:46) ~[spring-boot-2.7.12.jar:2.7.12]
	at org.springframework.context.support.DefaultLifecycleProcessor.doStart(DefaultLifecycleProcessor.java:178) ~[spring-context-5.3.27.jar:5.3.27]
	... 14 common frames omitted
Caused by: com.alibaba.nacos.api.exception.NacosException: Client not connected, current status:STARTING
	at com.alibaba.nacos.common.remote.client.RpcClient.request(RpcClient.java:639) ~[nacos-client-2.2.0.jar:na]
	at com.alibaba.nacos.common.remote.client.RpcClient.request(RpcClient.java:619) ~[nacos-client-2.2.0.jar:na]
	at com.alibaba.nacos.client.naming.remote.gprc.NamingGrpcClientProxy.requestToServer(NamingGrpcClientProxy.java:356) ~[nacos-client-2.2.0.jar:na]
	at com.alibaba.nacos.client.naming.remote.gprc.NamingGrpcClientProxy.doRegisterService(NamingGrpcClientProxy.java:209) ~[nacos-client-2.2.0.jar:na]
	at com.alibaba.nacos.client.naming.remote.gprc.NamingGrpcClientProxy.registerService(NamingGrpcClientProxy.java:123) ~[nacos-client-2.2.0.jar:na]
	at com.alibaba.nacos.client.naming.remote.NamingClientProxyDelegate.registerService(NamingClientProxyDelegate.java:98) ~[nacos-client-2.2.0.jar:na]
	at com.alibaba.nacos.client.naming.NacosNamingService.registerInstance(NacosNamingService.java:152) ~[nacos-client-2.2.0.jar:na]
	at com.alibaba.cloud.nacos.registry.NacosServiceRegistry.register(NacosServiceRegistry.java:75) ~[spring-cloud-starter-alibaba-nacos-discovery-2021.0.5.0.jar:2021.0.5.0]
	... 27 common frames omitted

16:15:57:687  WARN 20944 --- [Thread-8] c.a.n.common.http.HttpClientBeanHolder   : [HttpClientBeanHolder] Start destroying common HttpClient
16:15:57:687  WARN 20944 --- [Thread-5] c.a.nacos.common.notify.NotifyCenter     : [NotifyCenter] Start destroying Publisher
16:15:57:687  WARN 20944 --- [Thread-5] c.a.nacos.common.notify.NotifyCenter     : [NotifyCenter] Destruction of the end
16:19:10:694  INFO 37748 --- [main] c.a.n.client.env.SearchableProperties    : properties search order:PROPERTIES->JVM->ENV->DEFAULT_SETTING
16:19:11:418  INFO 37748 --- [main] c.l.his_service.HisServiceApplication    : Starting HisServiceApplication using Java 17.0.11 on luo with PID 37748 (A:\Desktop\workspace\HIS\his_service\target\classes started by 22407 in A:\Desktop\workspace\HIS)
16:19:11:418 DEBUG 37748 --- [main] c.l.his_service.HisServiceApplication    : Running with Spring Boot v2.7.12, Spring v5.3.27
16:19:11:418  INFO 37748 --- [main] c.l.his_service.HisServiceApplication    : The following 1 profile is active: "dev"
16:19:14:316  INFO 37748 --- [main] .s.d.r.c.RepositoryConfigurationDelegate : Multiple Spring Data modules found, entering strict repository configuration mode
16:19:14:320  INFO 37748 --- [main] .s.d.r.c.RepositoryConfigurationDelegate : Bootstrapping Spring Data Redis repositories in DEFAULT mode.
16:19:14:433  INFO 37748 --- [main] .s.d.r.c.RepositoryConfigurationDelegate : Finished Spring Data repository scanning in 25 ms. Found 0 Redis repository interfaces.
16:19:15:055  INFO 37748 --- [main] o.s.cloud.context.scope.GenericScope     : BeanFactory id=ac61872e-faec-371d-922e-ad941e5407d7
16:19:17:792  INFO 37748 --- [main] o.s.b.w.embedded.tomcat.TomcatWebServer  : Tomcat initialized with port(s): 8080 (http)
16:19:17:828  INFO 37748 --- [main] o.apache.catalina.core.StandardService   : Starting service [Tomcat]
16:19:17:828  INFO 37748 --- [main] org.apache.catalina.core.StandardEngine  : Starting Servlet engine: [Apache Tomcat/9.0.75]
16:19:18:116  INFO 37748 --- [main] o.a.c.c.C.[Tomcat].[localhost].[/]       : Initializing Spring embedded WebApplicationContext
16:19:18:118  INFO 37748 --- [main] w.s.c.ServletWebServerApplicationContext : Root WebApplicationContext: initialization completed in 6564 ms
16:19:18:853  INFO 37748 --- [main] org.redisson.Version                     : Redisson 3.17.7
16:19:19:718  INFO 37748 --- [redisson-netty-2-9] o.r.c.pool.MasterPubSubConnectionPool    : 1 connections initialized for 111.230.32.147/111.230.32.147:9631
16:19:20:434  INFO 37748 --- [redisson-netty-2-18] o.r.c.pool.MasterConnectionPool          : 24 connections initialized for 111.230.32.147/111.230.32.147:9631
16:19:21:145 DEBUG 37748 --- [main] c.l.h.filter.RefreshTokenFilter          : Filter 'refreshTokenFilter' configured for use
16:19:22:575  INFO 37748 --- [main] o.s.c.openfeign.FeignClientFactoryBean   : For 'flask-service' URL not provided. Will try picking an instance via load-balancing.
16:19:22:713  INFO 37748 --- [main] o.s.c.openfeign.FeignClientFactoryBean   : For 'ai-service' URL not provided. Will try picking an instance via load-balancing.
16:19:22:774  WARN 37748 --- [main] c.b.m.core.metadata.TableInfoHelper      : Can not find table primary key in Class: "java.lang.Object".
16:19:22:775  WARN 37748 --- [main] c.b.m.core.injector.DefaultSqlInjector   : class java.lang.Object ,Not found @TableId annotation, Cannot use Mybatis-Plus 'xxById' Method.
16:19:25:678  WARN 37748 --- [main] iguration$LoadBalancerCaffeineWarnLogger : Spring Cloud LoadBalancer is currently working with the default cache. While this cache implementation is useful for development and tests, it's recommended to use Caffeine cache in production.You can switch to using Caffeine cache, by adding it and org.springframework.cache.caffeine.CaffeineCacheManager to the classpath.
16:19:25:692  INFO 37748 --- [main] o.s.b.a.e.web.EndpointLinksResolver      : Exposing 1 endpoint(s) beneath base path '/actuator'
16:19:25:820  INFO 37748 --- [main] o.s.b.w.embedded.tomcat.TomcatWebServer  : Tomcat started on port(s): 8080 (http) with context path ''
16:19:25:909  INFO 37748 --- [main] c.a.n.p.a.s.c.ClientAuthPluginManager    : [ClientAuthPluginManager] Load ClientAuthService com.alibaba.nacos.client.auth.impl.NacosClientAuthServiceImpl success.
16:19:25:909  INFO 37748 --- [main] c.a.n.p.a.s.c.ClientAuthPluginManager    : [ClientAuthPluginManager] Load ClientAuthService com.alibaba.nacos.client.auth.ram.RamClientAuthServiceImpl success.
16:19:37:299 ERROR 37748 --- [main] c.a.c.n.registry.NacosServiceRegistry    : nacos registry, his-service register failed...NacosRegistration{nacosDiscoveryProperties=NacosDiscoveryProperties{serverAddr='81.71.3.20', username='', password='', endpoint='', namespace='', watchDelay=30000, logName='', service='his-service', weight=1.0, clusterName='DEFAULT', group='DEFAULT_GROUP', namingLoadCacheAtStart='false', metadata={IPv6=null, preserved.register.source=SPRING_CLOUD}, registerEnabled=true, ip='10.21.93.70', networkInterface='', port=8848, secure=false, accessKey='', secretKey='', heartBeatInterval=null, heartBeatTimeout=null, ipDeleteTimeout=null, instanceEnabled=true, ephemeral=true, failureToleranceEnabled=false}, ipDeleteTimeout=null, failFast=true}},

com.alibaba.nacos.api.exception.NacosException: Client not connected, current status:STARTING
	at com.alibaba.nacos.common.remote.client.RpcClient.request(RpcClient.java:639) ~[nacos-client-2.2.0.jar:na]
	at com.alibaba.nacos.common.remote.client.RpcClient.request(RpcClient.java:619) ~[nacos-client-2.2.0.jar:na]
	at com.alibaba.nacos.client.naming.remote.gprc.NamingGrpcClientProxy.requestToServer(NamingGrpcClientProxy.java:356) ~[nacos-client-2.2.0.jar:na]
	at com.alibaba.nacos.client.naming.remote.gprc.NamingGrpcClientProxy.doRegisterService(NamingGrpcClientProxy.java:209) ~[nacos-client-2.2.0.jar:na]
	at com.alibaba.nacos.client.naming.remote.gprc.NamingGrpcClientProxy.registerService(NamingGrpcClientProxy.java:123) ~[nacos-client-2.2.0.jar:na]
	at com.alibaba.nacos.client.naming.remote.NamingClientProxyDelegate.registerService(NamingClientProxyDelegate.java:98) ~[nacos-client-2.2.0.jar:na]
	at com.alibaba.nacos.client.naming.NacosNamingService.registerInstance(NacosNamingService.java:152) ~[nacos-client-2.2.0.jar:na]
	at com.alibaba.cloud.nacos.registry.NacosServiceRegistry.register(NacosServiceRegistry.java:75) ~[spring-cloud-starter-alibaba-nacos-discovery-2021.0.5.0.jar:2021.0.5.0]
	at org.springframework.cloud.client.serviceregistry.AbstractAutoServiceRegistration.register(AbstractAutoServiceRegistration.java:232) ~[spring-cloud-commons-3.1.5.jar:3.1.5]
	at com.alibaba.cloud.nacos.registry.NacosAutoServiceRegistration.register(NacosAutoServiceRegistration.java:78) ~[spring-cloud-starter-alibaba-nacos-discovery-2021.0.5.0.jar:2021.0.5.0]
	at org.springframework.cloud.client.serviceregistry.AbstractAutoServiceRegistration.start(AbstractAutoServiceRegistration.java:133) ~[spring-cloud-commons-3.1.5.jar:3.1.5]
	at org.springframework.cloud.client.serviceregistry.AbstractAutoServiceRegistration.bind(AbstractAutoServiceRegistration.java:98) ~[spring-cloud-commons-3.1.5.jar:3.1.5]
	at org.springframework.cloud.client.serviceregistry.AbstractAutoServiceRegistration.onApplicationEvent(AbstractAutoServiceRegistration.java:86) ~[spring-cloud-commons-3.1.5.jar:3.1.5]
	at org.springframework.cloud.client.serviceregistry.AbstractAutoServiceRegistration.onApplicationEvent(AbstractAutoServiceRegistration.java:47) ~[spring-cloud-commons-3.1.5.jar:3.1.5]
	at org.springframework.context.event.SimpleApplicationEventMulticaster.doInvokeListener(SimpleApplicationEventMulticaster.java:176) ~[spring-context-5.3.27.jar:5.3.27]
	at org.springframework.context.event.SimpleApplicationEventMulticaster.invokeListener(SimpleApplicationEventMulticaster.java:169) ~[spring-context-5.3.27.jar:5.3.27]
	at org.springframework.context.event.SimpleApplicationEventMulticaster.multicastEvent(SimpleApplicationEventMulticaster.java:143) ~[spring-context-5.3.27.jar:5.3.27]
	at org.springframework.context.support.AbstractApplicationContext.publishEvent(AbstractApplicationContext.java:421) ~[spring-context-5.3.27.jar:5.3.27]
	at org.springframework.context.support.AbstractApplicationContext.publishEvent(AbstractApplicationContext.java:378) ~[spring-context-5.3.27.jar:5.3.27]
	at org.springframework.boot.web.servlet.context.WebServerStartStopLifecycle.start(WebServerStartStopLifecycle.java:46) ~[spring-boot-2.7.12.jar:2.7.12]
	at org.springframework.context.support.DefaultLifecycleProcessor.doStart(DefaultLifecycleProcessor.java:178) ~[spring-context-5.3.27.jar:5.3.27]
	at org.springframework.context.support.DefaultLifecycleProcessor.access$200(DefaultLifecycleProcessor.java:54) ~[spring-context-5.3.27.jar:5.3.27]
	at org.springframework.context.support.DefaultLifecycleProcessor$LifecycleGroup.start(DefaultLifecycleProcessor.java:356) ~[spring-context-5.3.27.jar:5.3.27]
	at java.base/java.lang.Iterable.forEach(Iterable.java:75) ~[na:na]
	at org.springframework.context.support.DefaultLifecycleProcessor.startBeans(DefaultLifecycleProcessor.java:155) ~[spring-context-5.3.27.jar:5.3.27]
	at org.springframework.context.support.DefaultLifecycleProcessor.onRefresh(DefaultLifecycleProcessor.java:123) ~[spring-context-5.3.27.jar:5.3.27]
	at org.springframework.context.support.AbstractApplicationContext.finishRefresh(AbstractApplicationContext.java:937) ~[spring-context-5.3.27.jar:5.3.27]
	at org.springframework.context.support.AbstractApplicationContext.refresh(AbstractApplicationContext.java:586) ~[spring-context-5.3.27.jar:5.3.27]
	at org.springframework.boot.web.servlet.context.ServletWebServerApplicationContext.refresh(ServletWebServerApplicationContext.java:147) ~[spring-boot-2.7.12.jar:2.7.12]
	at org.springframework.boot.SpringApplication.refresh(SpringApplication.java:731) ~[spring-boot-2.7.12.jar:2.7.12]
	at org.springframework.boot.SpringApplication.refreshContext(SpringApplication.java:408) ~[spring-boot-2.7.12.jar:2.7.12]
	at org.springframework.boot.SpringApplication.run(SpringApplication.java:307) ~[spring-boot-2.7.12.jar:2.7.12]
	at org.springframework.boot.SpringApplication.run(SpringApplication.java:1303) ~[spring-boot-2.7.12.jar:2.7.12]
	at org.springframework.boot.SpringApplication.run(SpringApplication.java:1292) ~[spring-boot-2.7.12.jar:2.7.12]
	at com.luojiawei.his_service.HisServiceApplication.main(HisServiceApplication.java:19) ~[classes/:na]

16:19:37:300  WARN 37748 --- [main] ConfigServletWebServerApplicationContext : Exception encountered during context initialization - cancelling refresh attempt: org.springframework.context.ApplicationContextException: Failed to start bean 'webServerStartStop'; nested exception is java.lang.reflect.UndeclaredThrowableException
16:19:37:405  INFO 37748 --- [main] o.apache.catalina.core.StandardService   : Stopping service [Tomcat]
16:19:37:411  WARN 37748 --- [main] o.a.c.loader.WebappClassLoaderBase       : The web application [ROOT] appears to have started a thread named [Thread-2] but has failed to stop it. This is very likely to create a memory leak. Stack trace of thread:
 java.base@17.0.11/sun.net.dns.ResolverConfigurationImpl.notifyAddrChange0(Native Method)
 java.base@17.0.11/sun.net.dns.ResolverConfigurationImpl$AddressChangeListener.run(ResolverConfigurationImpl.java:176)
16:19:37:429  INFO 37748 --- [main] ConditionEvaluationReportLoggingListener : 

Error starting ApplicationContext. To display the conditions report re-run your application with 'debug' enabled.
16:19:37:459 ERROR 37748 --- [main] o.s.boot.SpringApplication               : Application run failed

org.springframework.context.ApplicationContextException: Failed to start bean 'webServerStartStop'; nested exception is java.lang.reflect.UndeclaredThrowableException
	at org.springframework.context.support.DefaultLifecycleProcessor.doStart(DefaultLifecycleProcessor.java:181) ~[spring-context-5.3.27.jar:5.3.27]
	at org.springframework.context.support.DefaultLifecycleProcessor.access$200(DefaultLifecycleProcessor.java:54) ~[spring-context-5.3.27.jar:5.3.27]
	at org.springframework.context.support.DefaultLifecycleProcessor$LifecycleGroup.start(DefaultLifecycleProcessor.java:356) ~[spring-context-5.3.27.jar:5.3.27]
	at java.base/java.lang.Iterable.forEach(Iterable.java:75) ~[na:na]
	at org.springframework.context.support.DefaultLifecycleProcessor.startBeans(DefaultLifecycleProcessor.java:155) ~[spring-context-5.3.27.jar:5.3.27]
	at org.springframework.context.support.DefaultLifecycleProcessor.onRefresh(DefaultLifecycleProcessor.java:123) ~[spring-context-5.3.27.jar:5.3.27]
	at org.springframework.context.support.AbstractApplicationContext.finishRefresh(AbstractApplicationContext.java:937) ~[spring-context-5.3.27.jar:5.3.27]
	at org.springframework.context.support.AbstractApplicationContext.refresh(AbstractApplicationContext.java:586) ~[spring-context-5.3.27.jar:5.3.27]
	at org.springframework.boot.web.servlet.context.ServletWebServerApplicationContext.refresh(ServletWebServerApplicationContext.java:147) ~[spring-boot-2.7.12.jar:2.7.12]
	at org.springframework.boot.SpringApplication.refresh(SpringApplication.java:731) ~[spring-boot-2.7.12.jar:2.7.12]
	at org.springframework.boot.SpringApplication.refreshContext(SpringApplication.java:408) ~[spring-boot-2.7.12.jar:2.7.12]
	at org.springframework.boot.SpringApplication.run(SpringApplication.java:307) ~[spring-boot-2.7.12.jar:2.7.12]
	at org.springframework.boot.SpringApplication.run(SpringApplication.java:1303) ~[spring-boot-2.7.12.jar:2.7.12]
	at org.springframework.boot.SpringApplication.run(SpringApplication.java:1292) ~[spring-boot-2.7.12.jar:2.7.12]
	at com.luojiawei.his_service.HisServiceApplication.main(HisServiceApplication.java:19) ~[classes/:na]
Caused by: java.lang.reflect.UndeclaredThrowableException: null
	at org.springframework.util.ReflectionUtils.rethrowRuntimeException(ReflectionUtils.java:147) ~[spring-core-5.3.27.jar:5.3.27]
	at com.alibaba.cloud.nacos.registry.NacosServiceRegistry.register(NacosServiceRegistry.java:83) ~[spring-cloud-starter-alibaba-nacos-discovery-2021.0.5.0.jar:2021.0.5.0]
	at org.springframework.cloud.client.serviceregistry.AbstractAutoServiceRegistration.register(AbstractAutoServiceRegistration.java:232) ~[spring-cloud-commons-3.1.5.jar:3.1.5]
	at com.alibaba.cloud.nacos.registry.NacosAutoServiceRegistration.register(NacosAutoServiceRegistration.java:78) ~[spring-cloud-starter-alibaba-nacos-discovery-2021.0.5.0.jar:2021.0.5.0]
	at org.springframework.cloud.client.serviceregistry.AbstractAutoServiceRegistration.start(AbstractAutoServiceRegistration.java:133) ~[spring-cloud-commons-3.1.5.jar:3.1.5]
	at org.springframework.cloud.client.serviceregistry.AbstractAutoServiceRegistration.bind(AbstractAutoServiceRegistration.java:98) ~[spring-cloud-commons-3.1.5.jar:3.1.5]
	at org.springframework.cloud.client.serviceregistry.AbstractAutoServiceRegistration.onApplicationEvent(AbstractAutoServiceRegistration.java:86) ~[spring-cloud-commons-3.1.5.jar:3.1.5]
	at org.springframework.cloud.client.serviceregistry.AbstractAutoServiceRegistration.onApplicationEvent(AbstractAutoServiceRegistration.java:47) ~[spring-cloud-commons-3.1.5.jar:3.1.5]
	at org.springframework.context.event.SimpleApplicationEventMulticaster.doInvokeListener(SimpleApplicationEventMulticaster.java:176) ~[spring-context-5.3.27.jar:5.3.27]
	at org.springframework.context.event.SimpleApplicationEventMulticaster.invokeListener(SimpleApplicationEventMulticaster.java:169) ~[spring-context-5.3.27.jar:5.3.27]
	at org.springframework.context.event.SimpleApplicationEventMulticaster.multicastEvent(SimpleApplicationEventMulticaster.java:143) ~[spring-context-5.3.27.jar:5.3.27]
	at org.springframework.context.support.AbstractApplicationContext.publishEvent(AbstractApplicationContext.java:421) ~[spring-context-5.3.27.jar:5.3.27]
	at org.springframework.context.support.AbstractApplicationContext.publishEvent(AbstractApplicationContext.java:378) ~[spring-context-5.3.27.jar:5.3.27]
	at org.springframework.boot.web.servlet.context.WebServerStartStopLifecycle.start(WebServerStartStopLifecycle.java:46) ~[spring-boot-2.7.12.jar:2.7.12]
	at org.springframework.context.support.DefaultLifecycleProcessor.doStart(DefaultLifecycleProcessor.java:178) ~[spring-context-5.3.27.jar:5.3.27]
	... 14 common frames omitted
Caused by: com.alibaba.nacos.api.exception.NacosException: Client not connected, current status:STARTING
	at com.alibaba.nacos.common.remote.client.RpcClient.request(RpcClient.java:639) ~[nacos-client-2.2.0.jar:na]
	at com.alibaba.nacos.common.remote.client.RpcClient.request(RpcClient.java:619) ~[nacos-client-2.2.0.jar:na]
	at com.alibaba.nacos.client.naming.remote.gprc.NamingGrpcClientProxy.requestToServer(NamingGrpcClientProxy.java:356) ~[nacos-client-2.2.0.jar:na]
	at com.alibaba.nacos.client.naming.remote.gprc.NamingGrpcClientProxy.doRegisterService(NamingGrpcClientProxy.java:209) ~[nacos-client-2.2.0.jar:na]
	at com.alibaba.nacos.client.naming.remote.gprc.NamingGrpcClientProxy.registerService(NamingGrpcClientProxy.java:123) ~[nacos-client-2.2.0.jar:na]
	at com.alibaba.nacos.client.naming.remote.NamingClientProxyDelegate.registerService(NamingClientProxyDelegate.java:98) ~[nacos-client-2.2.0.jar:na]
	at com.alibaba.nacos.client.naming.NacosNamingService.registerInstance(NacosNamingService.java:152) ~[nacos-client-2.2.0.jar:na]
	at com.alibaba.cloud.nacos.registry.NacosServiceRegistry.register(NacosServiceRegistry.java:75) ~[spring-cloud-starter-alibaba-nacos-discovery-2021.0.5.0.jar:2021.0.5.0]
	... 27 common frames omitted

16:19:38:314  WARN 37748 --- [Thread-5] c.a.nacos.common.notify.NotifyCenter     : [NotifyCenter] Start destroying Publisher
16:19:38:314  WARN 37748 --- [Thread-8] c.a.n.common.http.HttpClientBeanHolder   : [HttpClientBeanHolder] Start destroying common HttpClient
16:19:38:315  WARN 37748 --- [Thread-5] c.a.nacos.common.notify.NotifyCenter     : [NotifyCenter] Destruction of the end
16:19:38:315  WARN 37748 --- [Thread-8] c.a.n.common.http.HttpClientBeanHolder   : [HttpClientBeanHolder] Destruction of the end
16:28:43:891  INFO 23756 --- [main] c.a.n.client.env.SearchableProperties    : properties search order:PROPERTIES->JVM->ENV->DEFAULT_SETTING
16:28:44:140  INFO 23756 --- [main] c.l.his_service.HisServiceApplication    : Starting HisServiceApplication using Java 17.0.11 on luo with PID 23756 (A:\Desktop\workspace\HIS\his_service\target\classes started by 22407 in A:\Desktop\workspace\HIS)
16:28:44:140 DEBUG 23756 --- [main] c.l.his_service.HisServiceApplication    : Running with Spring Boot v2.7.12, Spring v5.3.27
16:28:44:141  INFO 23756 --- [main] c.l.his_service.HisServiceApplication    : The following 1 profile is active: "dev"
16:28:45:545  INFO 23756 --- [main] .s.d.r.c.RepositoryConfigurationDelegate : Multiple Spring Data modules found, entering strict repository configuration mode
16:28:45:548  INFO 23756 --- [main] .s.d.r.c.RepositoryConfigurationDelegate : Bootstrapping Spring Data Redis repositories in DEFAULT mode.
16:28:45:578  INFO 23756 --- [main] .s.d.r.c.RepositoryConfigurationDelegate : Finished Spring Data repository scanning in 14 ms. Found 0 Redis repository interfaces.
16:28:45:871  INFO 23756 --- [main] o.s.cloud.context.scope.GenericScope     : BeanFactory id=ac61872e-faec-371d-922e-ad941e5407d7
16:28:47:617  INFO 23756 --- [main] o.s.b.w.embedded.tomcat.TomcatWebServer  : Tomcat initialized with port(s): 8080 (http)
16:28:47:645  INFO 23756 --- [main] o.apache.catalina.core.StandardService   : Starting service [Tomcat]
16:28:47:645  INFO 23756 --- [main] org.apache.catalina.core.StandardEngine  : Starting Servlet engine: [Apache Tomcat/9.0.75]
16:28:47:914  INFO 23756 --- [main] o.a.c.c.C.[Tomcat].[localhost].[/]       : Initializing Spring embedded WebApplicationContext
16:28:47:914  INFO 23756 --- [main] w.s.c.ServletWebServerApplicationContext : Root WebApplicationContext: initialization completed in 3719 ms
16:28:48:144  INFO 23756 --- [main] org.redisson.Version                     : Redisson 3.17.7
16:28:48:559  INFO 23756 --- [redisson-netty-2-9] o.r.c.pool.MasterPubSubConnectionPool    : 1 connections initialized for 111.230.32.147/111.230.32.147:9631
16:28:49:260  INFO 23756 --- [redisson-netty-2-19] o.r.c.pool.MasterConnectionPool          : 24 connections initialized for 111.230.32.147/111.230.32.147:9631
16:28:49:562 DEBUG 23756 --- [main] c.l.h.filter.RefreshTokenFilter          : Filter 'refreshTokenFilter' configured for use
16:28:50:604  INFO 23756 --- [main] o.s.c.openfeign.FeignClientFactoryBean   : For 'flask-service' URL not provided. Will try picking an instance via load-balancing.
16:28:50:791  INFO 23756 --- [main] o.s.c.openfeign.FeignClientFactoryBean   : For 'ai-service' URL not provided. Will try picking an instance via load-balancing.
16:28:50:849  WARN 23756 --- [main] c.b.m.core.metadata.TableInfoHelper      : Can not find table primary key in Class: "java.lang.Object".
16:28:50:849  WARN 23756 --- [main] c.b.m.core.injector.DefaultSqlInjector   : class java.lang.Object ,Not found @TableId annotation, Cannot use Mybatis-Plus 'xxById' Method.
16:28:53:335  WARN 23756 --- [main] iguration$LoadBalancerCaffeineWarnLogger : Spring Cloud LoadBalancer is currently working with the default cache. While this cache implementation is useful for development and tests, it's recommended to use Caffeine cache in production.You can switch to using Caffeine cache, by adding it and org.springframework.cache.caffeine.CaffeineCacheManager to the classpath.
16:28:53:343  INFO 23756 --- [main] o.s.b.a.e.web.EndpointLinksResolver      : Exposing 1 endpoint(s) beneath base path '/actuator'
16:28:53:435  INFO 23756 --- [main] o.s.b.w.embedded.tomcat.TomcatWebServer  : Tomcat started on port(s): 8080 (http) with context path ''
16:28:53:494  INFO 23756 --- [main] c.a.n.p.a.s.c.ClientAuthPluginManager    : [ClientAuthPluginManager] Load ClientAuthService com.alibaba.nacos.client.auth.impl.NacosClientAuthServiceImpl success.
16:28:53:494  INFO 23756 --- [main] c.a.n.p.a.s.c.ClientAuthPluginManager    : [ClientAuthPluginManager] Load ClientAuthService com.alibaba.nacos.client.auth.ram.RamClientAuthServiceImpl success.
16:29:03:941 ERROR 23756 --- [main] c.a.c.n.registry.NacosServiceRegistry    : nacos registry, his-service register failed...NacosRegistration{nacosDiscoveryProperties=NacosDiscoveryProperties{serverAddr='81.71.3.20', username='', password='', endpoint='', namespace='', watchDelay=30000, logName='', service='his-service', weight=1.0, clusterName='DEFAULT', group='DEFAULT_GROUP', namingLoadCacheAtStart='false', metadata={IPv6=null, preserved.register.source=SPRING_CLOUD}, registerEnabled=true, ip='10.21.93.70', networkInterface='', port=8848, secure=false, accessKey='', secretKey='', heartBeatInterval=null, heartBeatTimeout=null, ipDeleteTimeout=null, instanceEnabled=true, ephemeral=true, failureToleranceEnabled=false}, ipDeleteTimeout=null, failFast=true}},

com.alibaba.nacos.api.exception.NacosException: Client not connected, current status:STARTING
	at com.alibaba.nacos.common.remote.client.RpcClient.request(RpcClient.java:639) ~[nacos-client-2.2.0.jar:na]
	at com.alibaba.nacos.common.remote.client.RpcClient.request(RpcClient.java:619) ~[nacos-client-2.2.0.jar:na]
	at com.alibaba.nacos.client.naming.remote.gprc.NamingGrpcClientProxy.requestToServer(NamingGrpcClientProxy.java:356) ~[nacos-client-2.2.0.jar:na]
	at com.alibaba.nacos.client.naming.remote.gprc.NamingGrpcClientProxy.doRegisterService(NamingGrpcClientProxy.java:209) ~[nacos-client-2.2.0.jar:na]
	at com.alibaba.nacos.client.naming.remote.gprc.NamingGrpcClientProxy.registerService(NamingGrpcClientProxy.java:123) ~[nacos-client-2.2.0.jar:na]
	at com.alibaba.nacos.client.naming.remote.NamingClientProxyDelegate.registerService(NamingClientProxyDelegate.java:98) ~[nacos-client-2.2.0.jar:na]
	at com.alibaba.nacos.client.naming.NacosNamingService.registerInstance(NacosNamingService.java:152) ~[nacos-client-2.2.0.jar:na]
	at com.alibaba.cloud.nacos.registry.NacosServiceRegistry.register(NacosServiceRegistry.java:75) ~[spring-cloud-starter-alibaba-nacos-discovery-2021.0.5.0.jar:2021.0.5.0]
	at org.springframework.cloud.client.serviceregistry.AbstractAutoServiceRegistration.register(AbstractAutoServiceRegistration.java:232) ~[spring-cloud-commons-3.1.5.jar:3.1.5]
	at com.alibaba.cloud.nacos.registry.NacosAutoServiceRegistration.register(NacosAutoServiceRegistration.java:78) ~[spring-cloud-starter-alibaba-nacos-discovery-2021.0.5.0.jar:2021.0.5.0]
	at org.springframework.cloud.client.serviceregistry.AbstractAutoServiceRegistration.start(AbstractAutoServiceRegistration.java:133) ~[spring-cloud-commons-3.1.5.jar:3.1.5]
	at org.springframework.cloud.client.serviceregistry.AbstractAutoServiceRegistration.bind(AbstractAutoServiceRegistration.java:98) ~[spring-cloud-commons-3.1.5.jar:3.1.5]
	at org.springframework.cloud.client.serviceregistry.AbstractAutoServiceRegistration.onApplicationEvent(AbstractAutoServiceRegistration.java:86) ~[spring-cloud-commons-3.1.5.jar:3.1.5]
	at org.springframework.cloud.client.serviceregistry.AbstractAutoServiceRegistration.onApplicationEvent(AbstractAutoServiceRegistration.java:47) ~[spring-cloud-commons-3.1.5.jar:3.1.5]
	at org.springframework.context.event.SimpleApplicationEventMulticaster.doInvokeListener(SimpleApplicationEventMulticaster.java:176) ~[spring-context-5.3.27.jar:5.3.27]
	at org.springframework.context.event.SimpleApplicationEventMulticaster.invokeListener(SimpleApplicationEventMulticaster.java:169) ~[spring-context-5.3.27.jar:5.3.27]
	at org.springframework.context.event.SimpleApplicationEventMulticaster.multicastEvent(SimpleApplicationEventMulticaster.java:143) ~[spring-context-5.3.27.jar:5.3.27]
	at org.springframework.context.support.AbstractApplicationContext.publishEvent(AbstractApplicationContext.java:421) ~[spring-context-5.3.27.jar:5.3.27]
	at org.springframework.context.support.AbstractApplicationContext.publishEvent(AbstractApplicationContext.java:378) ~[spring-context-5.3.27.jar:5.3.27]
	at org.springframework.boot.web.servlet.context.WebServerStartStopLifecycle.start(WebServerStartStopLifecycle.java:46) ~[spring-boot-2.7.12.jar:2.7.12]
	at org.springframework.context.support.DefaultLifecycleProcessor.doStart(DefaultLifecycleProcessor.java:178) ~[spring-context-5.3.27.jar:5.3.27]
	at org.springframework.context.support.DefaultLifecycleProcessor.access$200(DefaultLifecycleProcessor.java:54) ~[spring-context-5.3.27.jar:5.3.27]
	at org.springframework.context.support.DefaultLifecycleProcessor$LifecycleGroup.start(DefaultLifecycleProcessor.java:356) ~[spring-context-5.3.27.jar:5.3.27]
	at java.base/java.lang.Iterable.forEach(Iterable.java:75) ~[na:na]
	at org.springframework.context.support.DefaultLifecycleProcessor.startBeans(DefaultLifecycleProcessor.java:155) ~[spring-context-5.3.27.jar:5.3.27]
	at org.springframework.context.support.DefaultLifecycleProcessor.onRefresh(DefaultLifecycleProcessor.java:123) ~[spring-context-5.3.27.jar:5.3.27]
	at org.springframework.context.support.AbstractApplicationContext.finishRefresh(AbstractApplicationContext.java:937) ~[spring-context-5.3.27.jar:5.3.27]
	at org.springframework.context.support.AbstractApplicationContext.refresh(AbstractApplicationContext.java:586) ~[spring-context-5.3.27.jar:5.3.27]
	at org.springframework.boot.web.servlet.context.ServletWebServerApplicationContext.refresh(ServletWebServerApplicationContext.java:147) ~[spring-boot-2.7.12.jar:2.7.12]
	at org.springframework.boot.SpringApplication.refresh(SpringApplication.java:731) ~[spring-boot-2.7.12.jar:2.7.12]
	at org.springframework.boot.SpringApplication.refreshContext(SpringApplication.java:408) ~[spring-boot-2.7.12.jar:2.7.12]
	at org.springframework.boot.SpringApplication.run(SpringApplication.java:307) ~[spring-boot-2.7.12.jar:2.7.12]
	at org.springframework.boot.SpringApplication.run(SpringApplication.java:1303) ~[spring-boot-2.7.12.jar:2.7.12]
	at org.springframework.boot.SpringApplication.run(SpringApplication.java:1292) ~[spring-boot-2.7.12.jar:2.7.12]
	at com.luojiawei.his_service.HisServiceApplication.main(HisServiceApplication.java:19) ~[classes/:na]

16:29:03:942  WARN 23756 --- [main] ConfigServletWebServerApplicationContext : Exception encountered during context initialization - cancelling refresh attempt: org.springframework.context.ApplicationContextException: Failed to start bean 'webServerStartStop'; nested exception is java.lang.reflect.UndeclaredThrowableException
16:29:04:127  INFO 23756 --- [main] o.apache.catalina.core.StandardService   : Stopping service [Tomcat]
16:29:04:137  WARN 23756 --- [main] o.a.c.loader.WebappClassLoaderBase       : The web application [ROOT] appears to have started a thread named [Thread-2] but has failed to stop it. This is very likely to create a memory leak. Stack trace of thread:
 java.base@17.0.11/sun.net.dns.ResolverConfigurationImpl.notifyAddrChange0(Native Method)
 java.base@17.0.11/sun.net.dns.ResolverConfigurationImpl$AddressChangeListener.run(ResolverConfigurationImpl.java:176)
16:29:04:168  INFO 23756 --- [main] ConditionEvaluationReportLoggingListener : 

Error starting ApplicationContext. To display the conditions report re-run your application with 'debug' enabled.
16:29:04:310 ERROR 23756 --- [main] o.s.boot.SpringApplication               : Application run failed

org.springframework.context.ApplicationContextException: Failed to start bean 'webServerStartStop'; nested exception is java.lang.reflect.UndeclaredThrowableException
	at org.springframework.context.support.DefaultLifecycleProcessor.doStart(DefaultLifecycleProcessor.java:181) ~[spring-context-5.3.27.jar:5.3.27]
	at org.springframework.context.support.DefaultLifecycleProcessor.access$200(DefaultLifecycleProcessor.java:54) ~[spring-context-5.3.27.jar:5.3.27]
	at org.springframework.context.support.DefaultLifecycleProcessor$LifecycleGroup.start(DefaultLifecycleProcessor.java:356) ~[spring-context-5.3.27.jar:5.3.27]
	at java.base/java.lang.Iterable.forEach(Iterable.java:75) ~[na:na]
	at org.springframework.context.support.DefaultLifecycleProcessor.startBeans(DefaultLifecycleProcessor.java:155) ~[spring-context-5.3.27.jar:5.3.27]
	at org.springframework.context.support.DefaultLifecycleProcessor.onRefresh(DefaultLifecycleProcessor.java:123) ~[spring-context-5.3.27.jar:5.3.27]
	at org.springframework.context.support.AbstractApplicationContext.finishRefresh(AbstractApplicationContext.java:937) ~[spring-context-5.3.27.jar:5.3.27]
	at org.springframework.context.support.AbstractApplicationContext.refresh(AbstractApplicationContext.java:586) ~[spring-context-5.3.27.jar:5.3.27]
	at org.springframework.boot.web.servlet.context.ServletWebServerApplicationContext.refresh(ServletWebServerApplicationContext.java:147) ~[spring-boot-2.7.12.jar:2.7.12]
	at org.springframework.boot.SpringApplication.refresh(SpringApplication.java:731) ~[spring-boot-2.7.12.jar:2.7.12]
	at org.springframework.boot.SpringApplication.refreshContext(SpringApplication.java:408) ~[spring-boot-2.7.12.jar:2.7.12]
	at org.springframework.boot.SpringApplication.run(SpringApplication.java:307) ~[spring-boot-2.7.12.jar:2.7.12]
	at org.springframework.boot.SpringApplication.run(SpringApplication.java:1303) ~[spring-boot-2.7.12.jar:2.7.12]
	at org.springframework.boot.SpringApplication.run(SpringApplication.java:1292) ~[spring-boot-2.7.12.jar:2.7.12]
	at com.luojiawei.his_service.HisServiceApplication.main(HisServiceApplication.java:19) ~[classes/:na]
Caused by: java.lang.reflect.UndeclaredThrowableException: null
	at org.springframework.util.ReflectionUtils.rethrowRuntimeException(ReflectionUtils.java:147) ~[spring-core-5.3.27.jar:5.3.27]
	at com.alibaba.cloud.nacos.registry.NacosServiceRegistry.register(NacosServiceRegistry.java:83) ~[spring-cloud-starter-alibaba-nacos-discovery-2021.0.5.0.jar:2021.0.5.0]
	at org.springframework.cloud.client.serviceregistry.AbstractAutoServiceRegistration.register(AbstractAutoServiceRegistration.java:232) ~[spring-cloud-commons-3.1.5.jar:3.1.5]
	at com.alibaba.cloud.nacos.registry.NacosAutoServiceRegistration.register(NacosAutoServiceRegistration.java:78) ~[spring-cloud-starter-alibaba-nacos-discovery-2021.0.5.0.jar:2021.0.5.0]
	at org.springframework.cloud.client.serviceregistry.AbstractAutoServiceRegistration.start(AbstractAutoServiceRegistration.java:133) ~[spring-cloud-commons-3.1.5.jar:3.1.5]
	at org.springframework.cloud.client.serviceregistry.AbstractAutoServiceRegistration.bind(AbstractAutoServiceRegistration.java:98) ~[spring-cloud-commons-3.1.5.jar:3.1.5]
	at org.springframework.cloud.client.serviceregistry.AbstractAutoServiceRegistration.onApplicationEvent(AbstractAutoServiceRegistration.java:86) ~[spring-cloud-commons-3.1.5.jar:3.1.5]
	at org.springframework.cloud.client.serviceregistry.AbstractAutoServiceRegistration.onApplicationEvent(AbstractAutoServiceRegistration.java:47) ~[spring-cloud-commons-3.1.5.jar:3.1.5]
	at org.springframework.context.event.SimpleApplicationEventMulticaster.doInvokeListener(SimpleApplicationEventMulticaster.java:176) ~[spring-context-5.3.27.jar:5.3.27]
	at org.springframework.context.event.SimpleApplicationEventMulticaster.invokeListener(SimpleApplicationEventMulticaster.java:169) ~[spring-context-5.3.27.jar:5.3.27]
	at org.springframework.context.event.SimpleApplicationEventMulticaster.multicastEvent(SimpleApplicationEventMulticaster.java:143) ~[spring-context-5.3.27.jar:5.3.27]
	at org.springframework.context.support.AbstractApplicationContext.publishEvent(AbstractApplicationContext.java:421) ~[spring-context-5.3.27.jar:5.3.27]
	at org.springframework.context.support.AbstractApplicationContext.publishEvent(AbstractApplicationContext.java:378) ~[spring-context-5.3.27.jar:5.3.27]
	at org.springframework.boot.web.servlet.context.WebServerStartStopLifecycle.start(WebServerStartStopLifecycle.java:46) ~[spring-boot-2.7.12.jar:2.7.12]
	at org.springframework.context.support.DefaultLifecycleProcessor.doStart(DefaultLifecycleProcessor.java:178) ~[spring-context-5.3.27.jar:5.3.27]
	... 14 common frames omitted
Caused by: com.alibaba.nacos.api.exception.NacosException: Client not connected, current status:STARTING
	at com.alibaba.nacos.common.remote.client.RpcClient.request(RpcClient.java:639) ~[nacos-client-2.2.0.jar:na]
	at com.alibaba.nacos.common.remote.client.RpcClient.request(RpcClient.java:619) ~[nacos-client-2.2.0.jar:na]
	at com.alibaba.nacos.client.naming.remote.gprc.NamingGrpcClientProxy.requestToServer(NamingGrpcClientProxy.java:356) ~[nacos-client-2.2.0.jar:na]
	at com.alibaba.nacos.client.naming.remote.gprc.NamingGrpcClientProxy.doRegisterService(NamingGrpcClientProxy.java:209) ~[nacos-client-2.2.0.jar:na]
	at com.alibaba.nacos.client.naming.remote.gprc.NamingGrpcClientProxy.registerService(NamingGrpcClientProxy.java:123) ~[nacos-client-2.2.0.jar:na]
	at com.alibaba.nacos.client.naming.remote.NamingClientProxyDelegate.registerService(NamingClientProxyDelegate.java:98) ~[nacos-client-2.2.0.jar:na]
	at com.alibaba.nacos.client.naming.NacosNamingService.registerInstance(NacosNamingService.java:152) ~[nacos-client-2.2.0.jar:na]
	at com.alibaba.cloud.nacos.registry.NacosServiceRegistry.register(NacosServiceRegistry.java:75) ~[spring-cloud-starter-alibaba-nacos-discovery-2021.0.5.0.jar:2021.0.5.0]
	... 27 common frames omitted

16:29:04:977  WARN 23756 --- [Thread-8] c.a.n.common.http.HttpClientBeanHolder   : [HttpClientBeanHolder] Start destroying common HttpClient
16:29:04:977  WARN 23756 --- [Thread-5] c.a.nacos.common.notify.NotifyCenter     : [NotifyCenter] Start destroying Publisher
16:29:04:977  WARN 23756 --- [Thread-5] c.a.nacos.common.notify.NotifyCenter     : [NotifyCenter] Destruction of the end
16:29:30:336  INFO 37564 --- [main] c.a.n.client.env.SearchableProperties    : properties search order:PROPERTIES->JVM->ENV->DEFAULT_SETTING
16:29:30:549  INFO 37564 --- [main] c.l.his_service.HisServiceApplication    : Starting HisServiceApplication using Java 17.0.11 on luo with PID 37564 (A:\Desktop\workspace\HIS\his_service\target\classes started by 22407 in A:\Desktop\workspace\HIS)
16:29:30:549 DEBUG 37564 --- [main] c.l.his_service.HisServiceApplication    : Running with Spring Boot v2.7.12, Spring v5.3.27
16:29:30:550  INFO 37564 --- [main] c.l.his_service.HisServiceApplication    : The following 1 profile is active: "dev"
16:29:31:791  INFO 37564 --- [main] .s.d.r.c.RepositoryConfigurationDelegate : Multiple Spring Data modules found, entering strict repository configuration mode
16:29:31:795  INFO 37564 --- [main] .s.d.r.c.RepositoryConfigurationDelegate : Bootstrapping Spring Data Redis repositories in DEFAULT mode.
16:29:31:825  INFO 37564 --- [main] .s.d.r.c.RepositoryConfigurationDelegate : Finished Spring Data repository scanning in 15 ms. Found 0 Redis repository interfaces.
16:29:32:099  INFO 37564 --- [main] o.s.cloud.context.scope.GenericScope     : BeanFactory id=ac61872e-faec-371d-922e-ad941e5407d7
16:29:32:767  INFO 37564 --- [main] o.s.b.w.embedded.tomcat.TomcatWebServer  : Tomcat initialized with port(s): 8080 (http)
16:29:32:775  INFO 37564 --- [main] o.apache.catalina.core.StandardService   : Starting service [Tomcat]
16:29:32:775  INFO 37564 --- [main] org.apache.catalina.core.StandardEngine  : Starting Servlet engine: [Apache Tomcat/9.0.75]
16:29:32:927  INFO 37564 --- [main] o.a.c.c.C.[Tomcat].[localhost].[/]       : Initializing Spring embedded WebApplicationContext
16:29:32:927  INFO 37564 --- [main] w.s.c.ServletWebServerApplicationContext : Root WebApplicationContext: initialization completed in 2307 ms
16:29:33:168  INFO 37564 --- [main] org.redisson.Version                     : Redisson 3.17.7
16:29:33:586  INFO 37564 --- [redisson-netty-2-9] o.r.c.pool.MasterPubSubConnectionPool    : 1 connections initialized for 111.230.32.147/111.230.32.147:9631
16:29:34:356  INFO 37564 --- [redisson-netty-2-19] o.r.c.pool.MasterConnectionPool          : 24 connections initialized for 111.230.32.147/111.230.32.147:9631
16:29:34:645 DEBUG 37564 --- [main] c.l.h.filter.RefreshTokenFilter          : Filter 'refreshTokenFilter' configured for use
16:29:35:353  INFO 37564 --- [main] o.s.c.openfeign.FeignClientFactoryBean   : For 'flask-service' URL not provided. Will try picking an instance via load-balancing.
16:29:35:469  INFO 37564 --- [main] o.s.c.openfeign.FeignClientFactoryBean   : For 'ai-service' URL not provided. Will try picking an instance via load-balancing.
16:29:35:510  WARN 37564 --- [main] c.b.m.core.metadata.TableInfoHelper      : Can not find table primary key in Class: "java.lang.Object".
16:29:35:510  WARN 37564 --- [main] c.b.m.core.injector.DefaultSqlInjector   : class java.lang.Object ,Not found @TableId annotation, Cannot use Mybatis-Plus 'xxById' Method.
16:29:37:134  WARN 37564 --- [main] iguration$LoadBalancerCaffeineWarnLogger : Spring Cloud LoadBalancer is currently working with the default cache. While this cache implementation is useful for development and tests, it's recommended to use Caffeine cache in production.You can switch to using Caffeine cache, by adding it and org.springframework.cache.caffeine.CaffeineCacheManager to the classpath.
16:29:37:141  INFO 37564 --- [main] o.s.b.a.e.web.EndpointLinksResolver      : Exposing 1 endpoint(s) beneath base path '/actuator'
16:29:37:231  INFO 37564 --- [main] o.s.b.w.embedded.tomcat.TomcatWebServer  : Tomcat started on port(s): 8080 (http) with context path ''
16:29:37:278  INFO 37564 --- [main] c.a.n.p.a.s.c.ClientAuthPluginManager    : [ClientAuthPluginManager] Load ClientAuthService com.alibaba.nacos.client.auth.impl.NacosClientAuthServiceImpl success.
16:29:37:278  INFO 37564 --- [main] c.a.n.p.a.s.c.ClientAuthPluginManager    : [ClientAuthPluginManager] Load ClientAuthService com.alibaba.nacos.client.auth.ram.RamClientAuthServiceImpl success.
16:29:47:274 ERROR 37564 --- [main] c.a.c.n.registry.NacosServiceRegistry    : nacos registry, his-service register failed...NacosRegistration{nacosDiscoveryProperties=NacosDiscoveryProperties{serverAddr='81.71.3.20', username='', password='', endpoint='', namespace='', watchDelay=30000, logName='', service='his-service', weight=1.0, clusterName='DEFAULT', group='DEFAULT_GROUP', namingLoadCacheAtStart='false', metadata={IPv6=null, preserved.register.source=SPRING_CLOUD}, registerEnabled=true, ip='10.21.93.70', networkInterface='', port=8848, secure=false, accessKey='', secretKey='', heartBeatInterval=null, heartBeatTimeout=null, ipDeleteTimeout=null, instanceEnabled=true, ephemeral=true, failureToleranceEnabled=false}, ipDeleteTimeout=null, failFast=true}},

com.alibaba.nacos.api.exception.NacosException: Client not connected, current status:STARTING
	at com.alibaba.nacos.common.remote.client.RpcClient.request(RpcClient.java:639) ~[nacos-client-2.2.0.jar:na]
	at com.alibaba.nacos.common.remote.client.RpcClient.request(RpcClient.java:619) ~[nacos-client-2.2.0.jar:na]
	at com.alibaba.nacos.client.naming.remote.gprc.NamingGrpcClientProxy.requestToServer(NamingGrpcClientProxy.java:356) ~[nacos-client-2.2.0.jar:na]
	at com.alibaba.nacos.client.naming.remote.gprc.NamingGrpcClientProxy.doRegisterService(NamingGrpcClientProxy.java:209) ~[nacos-client-2.2.0.jar:na]
	at com.alibaba.nacos.client.naming.remote.gprc.NamingGrpcClientProxy.registerService(NamingGrpcClientProxy.java:123) ~[nacos-client-2.2.0.jar:na]
	at com.alibaba.nacos.client.naming.remote.NamingClientProxyDelegate.registerService(NamingClientProxyDelegate.java:98) ~[nacos-client-2.2.0.jar:na]
	at com.alibaba.nacos.client.naming.NacosNamingService.registerInstance(NacosNamingService.java:152) ~[nacos-client-2.2.0.jar:na]
	at com.alibaba.cloud.nacos.registry.NacosServiceRegistry.register(NacosServiceRegistry.java:75) ~[spring-cloud-starter-alibaba-nacos-discovery-2021.0.5.0.jar:2021.0.5.0]
	at org.springframework.cloud.client.serviceregistry.AbstractAutoServiceRegistration.register(AbstractAutoServiceRegistration.java:232) ~[spring-cloud-commons-3.1.5.jar:3.1.5]
	at com.alibaba.cloud.nacos.registry.NacosAutoServiceRegistration.register(NacosAutoServiceRegistration.java:78) ~[spring-cloud-starter-alibaba-nacos-discovery-2021.0.5.0.jar:2021.0.5.0]
	at org.springframework.cloud.client.serviceregistry.AbstractAutoServiceRegistration.start(AbstractAutoServiceRegistration.java:133) ~[spring-cloud-commons-3.1.5.jar:3.1.5]
	at org.springframework.cloud.client.serviceregistry.AbstractAutoServiceRegistration.bind(AbstractAutoServiceRegistration.java:98) ~[spring-cloud-commons-3.1.5.jar:3.1.5]
	at org.springframework.cloud.client.serviceregistry.AbstractAutoServiceRegistration.onApplicationEvent(AbstractAutoServiceRegistration.java:86) ~[spring-cloud-commons-3.1.5.jar:3.1.5]
	at org.springframework.cloud.client.serviceregistry.AbstractAutoServiceRegistration.onApplicationEvent(AbstractAutoServiceRegistration.java:47) ~[spring-cloud-commons-3.1.5.jar:3.1.5]
	at org.springframework.context.event.SimpleApplicationEventMulticaster.doInvokeListener(SimpleApplicationEventMulticaster.java:176) ~[spring-context-5.3.27.jar:5.3.27]
	at org.springframework.context.event.SimpleApplicationEventMulticaster.invokeListener(SimpleApplicationEventMulticaster.java:169) ~[spring-context-5.3.27.jar:5.3.27]
	at org.springframework.context.event.SimpleApplicationEventMulticaster.multicastEvent(SimpleApplicationEventMulticaster.java:143) ~[spring-context-5.3.27.jar:5.3.27]
	at org.springframework.context.support.AbstractApplicationContext.publishEvent(AbstractApplicationContext.java:421) ~[spring-context-5.3.27.jar:5.3.27]
	at org.springframework.context.support.AbstractApplicationContext.publishEvent(AbstractApplicationContext.java:378) ~[spring-context-5.3.27.jar:5.3.27]
	at org.springframework.boot.web.servlet.context.WebServerStartStopLifecycle.start(WebServerStartStopLifecycle.java:46) ~[spring-boot-2.7.12.jar:2.7.12]
	at org.springframework.context.support.DefaultLifecycleProcessor.doStart(DefaultLifecycleProcessor.java:178) ~[spring-context-5.3.27.jar:5.3.27]
	at org.springframework.context.support.DefaultLifecycleProcessor.access$200(DefaultLifecycleProcessor.java:54) ~[spring-context-5.3.27.jar:5.3.27]
	at org.springframework.context.support.DefaultLifecycleProcessor$LifecycleGroup.start(DefaultLifecycleProcessor.java:356) ~[spring-context-5.3.27.jar:5.3.27]
	at java.base/java.lang.Iterable.forEach(Iterable.java:75) ~[na:na]
	at org.springframework.context.support.DefaultLifecycleProcessor.startBeans(DefaultLifecycleProcessor.java:155) ~[spring-context-5.3.27.jar:5.3.27]
	at org.springframework.context.support.DefaultLifecycleProcessor.onRefresh(DefaultLifecycleProcessor.java:123) ~[spring-context-5.3.27.jar:5.3.27]
	at org.springframework.context.support.AbstractApplicationContext.finishRefresh(AbstractApplicationContext.java:937) ~[spring-context-5.3.27.jar:5.3.27]
	at org.springframework.context.support.AbstractApplicationContext.refresh(AbstractApplicationContext.java:586) ~[spring-context-5.3.27.jar:5.3.27]
	at org.springframework.boot.web.servlet.context.ServletWebServerApplicationContext.refresh(ServletWebServerApplicationContext.java:147) ~[spring-boot-2.7.12.jar:2.7.12]
	at org.springframework.boot.SpringApplication.refresh(SpringApplication.java:731) ~[spring-boot-2.7.12.jar:2.7.12]
	at org.springframework.boot.SpringApplication.refreshContext(SpringApplication.java:408) ~[spring-boot-2.7.12.jar:2.7.12]
	at org.springframework.boot.SpringApplication.run(SpringApplication.java:307) ~[spring-boot-2.7.12.jar:2.7.12]
	at org.springframework.boot.SpringApplication.run(SpringApplication.java:1303) ~[spring-boot-2.7.12.jar:2.7.12]
	at org.springframework.boot.SpringApplication.run(SpringApplication.java:1292) ~[spring-boot-2.7.12.jar:2.7.12]
	at com.luojiawei.his_service.HisServiceApplication.main(HisServiceApplication.java:19) ~[classes/:na]

16:29:47:275  WARN 37564 --- [main] ConfigServletWebServerApplicationContext : Exception encountered during context initialization - cancelling refresh attempt: org.springframework.context.ApplicationContextException: Failed to start bean 'webServerStartStop'; nested exception is java.lang.reflect.UndeclaredThrowableException
16:29:47:366  INFO 37564 --- [main] o.apache.catalina.core.StandardService   : Stopping service [Tomcat]
16:29:47:373  WARN 37564 --- [main] o.a.c.loader.WebappClassLoaderBase       : The web application [ROOT] appears to have started a thread named [Thread-2] but has failed to stop it. This is very likely to create a memory leak. Stack trace of thread:
 java.base@17.0.11/sun.net.dns.ResolverConfigurationImpl.notifyAddrChange0(Native Method)
 java.base@17.0.11/sun.net.dns.ResolverConfigurationImpl$AddressChangeListener.run(ResolverConfigurationImpl.java:176)
16:29:47:391  INFO 37564 --- [main] ConditionEvaluationReportLoggingListener : 

Error starting ApplicationContext. To display the conditions report re-run your application with 'debug' enabled.
16:29:47:411 ERROR 37564 --- [main] o.s.boot.SpringApplication               : Application run failed

org.springframework.context.ApplicationContextException: Failed to start bean 'webServerStartStop'; nested exception is java.lang.reflect.UndeclaredThrowableException
	at org.springframework.context.support.DefaultLifecycleProcessor.doStart(DefaultLifecycleProcessor.java:181) ~[spring-context-5.3.27.jar:5.3.27]
	at org.springframework.context.support.DefaultLifecycleProcessor.access$200(DefaultLifecycleProcessor.java:54) ~[spring-context-5.3.27.jar:5.3.27]
	at org.springframework.context.support.DefaultLifecycleProcessor$LifecycleGroup.start(DefaultLifecycleProcessor.java:356) ~[spring-context-5.3.27.jar:5.3.27]
	at java.base/java.lang.Iterable.forEach(Iterable.java:75) ~[na:na]
	at org.springframework.context.support.DefaultLifecycleProcessor.startBeans(DefaultLifecycleProcessor.java:155) ~[spring-context-5.3.27.jar:5.3.27]
	at org.springframework.context.support.DefaultLifecycleProcessor.onRefresh(DefaultLifecycleProcessor.java:123) ~[spring-context-5.3.27.jar:5.3.27]
	at org.springframework.context.support.AbstractApplicationContext.finishRefresh(AbstractApplicationContext.java:937) ~[spring-context-5.3.27.jar:5.3.27]
	at org.springframework.context.support.AbstractApplicationContext.refresh(AbstractApplicationContext.java:586) ~[spring-context-5.3.27.jar:5.3.27]
	at org.springframework.boot.web.servlet.context.ServletWebServerApplicationContext.refresh(ServletWebServerApplicationContext.java:147) ~[spring-boot-2.7.12.jar:2.7.12]
	at org.springframework.boot.SpringApplication.refresh(SpringApplication.java:731) ~[spring-boot-2.7.12.jar:2.7.12]
	at org.springframework.boot.SpringApplication.refreshContext(SpringApplication.java:408) ~[spring-boot-2.7.12.jar:2.7.12]
	at org.springframework.boot.SpringApplication.run(SpringApplication.java:307) ~[spring-boot-2.7.12.jar:2.7.12]
	at org.springframework.boot.SpringApplication.run(SpringApplication.java:1303) ~[spring-boot-2.7.12.jar:2.7.12]
	at org.springframework.boot.SpringApplication.run(SpringApplication.java:1292) ~[spring-boot-2.7.12.jar:2.7.12]
	at com.luojiawei.his_service.HisServiceApplication.main(HisServiceApplication.java:19) ~[classes/:na]
Caused by: java.lang.reflect.UndeclaredThrowableException: null
	at org.springframework.util.ReflectionUtils.rethrowRuntimeException(ReflectionUtils.java:147) ~[spring-core-5.3.27.jar:5.3.27]
	at com.alibaba.cloud.nacos.registry.NacosServiceRegistry.register(NacosServiceRegistry.java:83) ~[spring-cloud-starter-alibaba-nacos-discovery-2021.0.5.0.jar:2021.0.5.0]
	at org.springframework.cloud.client.serviceregistry.AbstractAutoServiceRegistration.register(AbstractAutoServiceRegistration.java:232) ~[spring-cloud-commons-3.1.5.jar:3.1.5]
	at com.alibaba.cloud.nacos.registry.NacosAutoServiceRegistration.register(NacosAutoServiceRegistration.java:78) ~[spring-cloud-starter-alibaba-nacos-discovery-2021.0.5.0.jar:2021.0.5.0]
	at org.springframework.cloud.client.serviceregistry.AbstractAutoServiceRegistration.start(AbstractAutoServiceRegistration.java:133) ~[spring-cloud-commons-3.1.5.jar:3.1.5]
	at org.springframework.cloud.client.serviceregistry.AbstractAutoServiceRegistration.bind(AbstractAutoServiceRegistration.java:98) ~[spring-cloud-commons-3.1.5.jar:3.1.5]
	at org.springframework.cloud.client.serviceregistry.AbstractAutoServiceRegistration.onApplicationEvent(AbstractAutoServiceRegistration.java:86) ~[spring-cloud-commons-3.1.5.jar:3.1.5]
	at org.springframework.cloud.client.serviceregistry.AbstractAutoServiceRegistration.onApplicationEvent(AbstractAutoServiceRegistration.java:47) ~[spring-cloud-commons-3.1.5.jar:3.1.5]
	at org.springframework.context.event.SimpleApplicationEventMulticaster.doInvokeListener(SimpleApplicationEventMulticaster.java:176) ~[spring-context-5.3.27.jar:5.3.27]
	at org.springframework.context.event.SimpleApplicationEventMulticaster.invokeListener(SimpleApplicationEventMulticaster.java:169) ~[spring-context-5.3.27.jar:5.3.27]
	at org.springframework.context.event.SimpleApplicationEventMulticaster.multicastEvent(SimpleApplicationEventMulticaster.java:143) ~[spring-context-5.3.27.jar:5.3.27]
	at org.springframework.context.support.AbstractApplicationContext.publishEvent(AbstractApplicationContext.java:421) ~[spring-context-5.3.27.jar:5.3.27]
	at org.springframework.context.support.AbstractApplicationContext.publishEvent(AbstractApplicationContext.java:378) ~[spring-context-5.3.27.jar:5.3.27]
	at org.springframework.boot.web.servlet.context.WebServerStartStopLifecycle.start(WebServerStartStopLifecycle.java:46) ~[spring-boot-2.7.12.jar:2.7.12]
	at org.springframework.context.support.DefaultLifecycleProcessor.doStart(DefaultLifecycleProcessor.java:178) ~[spring-context-5.3.27.jar:5.3.27]
	... 14 common frames omitted
Caused by: com.alibaba.nacos.api.exception.NacosException: Client not connected, current status:STARTING
	at com.alibaba.nacos.common.remote.client.RpcClient.request(RpcClient.java:639) ~[nacos-client-2.2.0.jar:na]
	at com.alibaba.nacos.common.remote.client.RpcClient.request(RpcClient.java:619) ~[nacos-client-2.2.0.jar:na]
	at com.alibaba.nacos.client.naming.remote.gprc.NamingGrpcClientProxy.requestToServer(NamingGrpcClientProxy.java:356) ~[nacos-client-2.2.0.jar:na]
	at com.alibaba.nacos.client.naming.remote.gprc.NamingGrpcClientProxy.doRegisterService(NamingGrpcClientProxy.java:209) ~[nacos-client-2.2.0.jar:na]
	at com.alibaba.nacos.client.naming.remote.gprc.NamingGrpcClientProxy.registerService(NamingGrpcClientProxy.java:123) ~[nacos-client-2.2.0.jar:na]
	at com.alibaba.nacos.client.naming.remote.NamingClientProxyDelegate.registerService(NamingClientProxyDelegate.java:98) ~[nacos-client-2.2.0.jar:na]
	at com.alibaba.nacos.client.naming.NacosNamingService.registerInstance(NacosNamingService.java:152) ~[nacos-client-2.2.0.jar:na]
	at com.alibaba.cloud.nacos.registry.NacosServiceRegistry.register(NacosServiceRegistry.java:75) ~[spring-cloud-starter-alibaba-nacos-discovery-2021.0.5.0.jar:2021.0.5.0]
	... 27 common frames omitted

16:29:48:283  WARN 37564 --- [Thread-5] c.a.nacos.common.notify.NotifyCenter     : [NotifyCenter] Start destroying Publisher
16:29:48:284  WARN 37564 --- [Thread-8] c.a.n.common.http.HttpClientBeanHolder   : [HttpClientBeanHolder] Start destroying common HttpClient
16:29:48:284  WARN 37564 --- [Thread-5] c.a.nacos.common.notify.NotifyCenter     : [NotifyCenter] Destruction of the end
16:29:48:285  WARN 37564 --- [Thread-8] c.a.n.common.http.HttpClientBeanHolder   : [HttpClientBeanHolder] Destruction of the end
16:32:58:374  INFO 164 --- [main] c.a.n.client.env.SearchableProperties    : properties search order:PROPERTIES->JVM->ENV->DEFAULT_SETTING
16:32:58:530  INFO 164 --- [main] c.l.his_service.HisServiceApplication    : Starting HisServiceApplication using Java 17.0.11 on luo with PID 164 (A:\Desktop\workspace\HIS\his_service\target\classes started by 22407 in A:\Desktop\workspace\HIS)
16:32:58:531 DEBUG 164 --- [main] c.l.his_service.HisServiceApplication    : Running with Spring Boot v2.7.12, Spring v5.3.27
16:32:58:531  INFO 164 --- [main] c.l.his_service.HisServiceApplication    : The following 1 profile is active: "dev"
16:32:59:464  INFO 164 --- [main] .s.d.r.c.RepositoryConfigurationDelegate : Multiple Spring Data modules found, entering strict repository configuration mode
16:32:59:466  INFO 164 --- [main] .s.d.r.c.RepositoryConfigurationDelegate : Bootstrapping Spring Data Redis repositories in DEFAULT mode.
16:32:59:502  INFO 164 --- [main] .s.d.r.c.RepositoryConfigurationDelegate : Finished Spring Data repository scanning in 20 ms. Found 0 Redis repository interfaces.
16:32:59:751  INFO 164 --- [main] o.s.cloud.context.scope.GenericScope     : BeanFactory id=ac61872e-faec-371d-922e-ad941e5407d7
16:33:00:296  INFO 164 --- [main] o.s.b.w.embedded.tomcat.TomcatWebServer  : Tomcat initialized with port(s): 8080 (http)
16:33:00:307  INFO 164 --- [main] o.apache.catalina.core.StandardService   : Starting service [Tomcat]
16:33:00:307  INFO 164 --- [main] org.apache.catalina.core.StandardEngine  : Starting Servlet engine: [Apache Tomcat/9.0.75]
16:33:00:469  INFO 164 --- [main] o.a.c.c.C.[Tomcat].[localhost].[/]       : Initializing Spring embedded WebApplicationContext
16:33:00:469  INFO 164 --- [main] w.s.c.ServletWebServerApplicationContext : Root WebApplicationContext: initialization completed in 1896 ms
16:33:00:699  INFO 164 --- [main] org.redisson.Version                     : Redisson 3.17.7
16:33:01:052  INFO 164 --- [redisson-netty-2-9] o.r.c.pool.MasterPubSubConnectionPool    : 1 connections initialized for 111.230.32.147/111.230.32.147:9631
16:33:01:770  INFO 164 --- [redisson-netty-2-19] o.r.c.pool.MasterConnectionPool          : 24 connections initialized for 111.230.32.147/111.230.32.147:9631
16:33:02:032 DEBUG 164 --- [main] c.l.h.filter.RefreshTokenFilter          : Filter 'refreshTokenFilter' configured for use
16:33:02:712  INFO 164 --- [main] o.s.c.openfeign.FeignClientFactoryBean   : For 'flask-service' URL not provided. Will try picking an instance via load-balancing.
16:33:02:806  INFO 164 --- [main] o.s.c.openfeign.FeignClientFactoryBean   : For 'ai-service' URL not provided. Will try picking an instance via load-balancing.
16:33:02:842  WARN 164 --- [main] c.b.m.core.metadata.TableInfoHelper      : Can not find table primary key in Class: "java.lang.Object".
16:33:02:843  WARN 164 --- [main] c.b.m.core.injector.DefaultSqlInjector   : class java.lang.Object ,Not found @TableId annotation, Cannot use Mybatis-Plus 'xxById' Method.
16:33:04:273  WARN 164 --- [main] iguration$LoadBalancerCaffeineWarnLogger : Spring Cloud LoadBalancer is currently working with the default cache. While this cache implementation is useful for development and tests, it's recommended to use Caffeine cache in production.You can switch to using Caffeine cache, by adding it and org.springframework.cache.caffeine.CaffeineCacheManager to the classpath.
16:33:04:281  INFO 164 --- [main] o.s.b.a.e.web.EndpointLinksResolver      : Exposing 1 endpoint(s) beneath base path '/actuator'
16:33:04:363  INFO 164 --- [main] o.s.b.w.embedded.tomcat.TomcatWebServer  : Tomcat started on port(s): 8080 (http) with context path ''
16:33:04:400  INFO 164 --- [main] c.a.n.p.a.s.c.ClientAuthPluginManager    : [ClientAuthPluginManager] Load ClientAuthService com.alibaba.nacos.client.auth.impl.NacosClientAuthServiceImpl success.
16:33:04:401  INFO 164 --- [main] c.a.n.p.a.s.c.ClientAuthPluginManager    : [ClientAuthPluginManager] Load ClientAuthService com.alibaba.nacos.client.auth.ram.RamClientAuthServiceImpl success.
16:33:04:865 ERROR 164 --- [main] c.a.c.n.registry.NacosServiceRegistry    : nacos registry, his-service register failed...NacosRegistration{nacosDiscoveryProperties=NacosDiscoveryProperties{serverAddr='81.71.3.208848', username='', password='', endpoint='', namespace='', watchDelay=30000, logName='', service='his-service', weight=1.0, clusterName='DEFAULT', group='DEFAULT_GROUP', namingLoadCacheAtStart='false', metadata={IPv6=null, preserved.register.source=SPRING_CLOUD}, registerEnabled=true, ip='10.21.93.70', networkInterface='', port=8080, secure=false, accessKey='', secretKey='', heartBeatInterval=null, heartBeatTimeout=null, ipDeleteTimeout=null, instanceEnabled=true, ephemeral=true, failureToleranceEnabled=false}, ipDeleteTimeout=null, failFast=true}},

com.alibaba.nacos.api.exception.NacosException: Client not connected, current status:STARTING
	at com.alibaba.nacos.common.remote.client.RpcClient.request(RpcClient.java:639) ~[nacos-client-2.2.0.jar:na]
	at com.alibaba.nacos.common.remote.client.RpcClient.request(RpcClient.java:619) ~[nacos-client-2.2.0.jar:na]
	at com.alibaba.nacos.client.naming.remote.gprc.NamingGrpcClientProxy.requestToServer(NamingGrpcClientProxy.java:356) ~[nacos-client-2.2.0.jar:na]
	at com.alibaba.nacos.client.naming.remote.gprc.NamingGrpcClientProxy.doRegisterService(NamingGrpcClientProxy.java:209) ~[nacos-client-2.2.0.jar:na]
	at com.alibaba.nacos.client.naming.remote.gprc.NamingGrpcClientProxy.registerService(NamingGrpcClientProxy.java:123) ~[nacos-client-2.2.0.jar:na]
	at com.alibaba.nacos.client.naming.remote.NamingClientProxyDelegate.registerService(NamingClientProxyDelegate.java:98) ~[nacos-client-2.2.0.jar:na]
	at com.alibaba.nacos.client.naming.NacosNamingService.registerInstance(NacosNamingService.java:152) ~[nacos-client-2.2.0.jar:na]
	at com.alibaba.cloud.nacos.registry.NacosServiceRegistry.register(NacosServiceRegistry.java:75) ~[spring-cloud-starter-alibaba-nacos-discovery-2021.0.5.0.jar:2021.0.5.0]
	at org.springframework.cloud.client.serviceregistry.AbstractAutoServiceRegistration.register(AbstractAutoServiceRegistration.java:232) ~[spring-cloud-commons-3.1.5.jar:3.1.5]
	at com.alibaba.cloud.nacos.registry.NacosAutoServiceRegistration.register(NacosAutoServiceRegistration.java:78) ~[spring-cloud-starter-alibaba-nacos-discovery-2021.0.5.0.jar:2021.0.5.0]
	at org.springframework.cloud.client.serviceregistry.AbstractAutoServiceRegistration.start(AbstractAutoServiceRegistration.java:133) ~[spring-cloud-commons-3.1.5.jar:3.1.5]
	at org.springframework.cloud.client.serviceregistry.AbstractAutoServiceRegistration.bind(AbstractAutoServiceRegistration.java:98) ~[spring-cloud-commons-3.1.5.jar:3.1.5]
	at org.springframework.cloud.client.serviceregistry.AbstractAutoServiceRegistration.onApplicationEvent(AbstractAutoServiceRegistration.java:86) ~[spring-cloud-commons-3.1.5.jar:3.1.5]
	at org.springframework.cloud.client.serviceregistry.AbstractAutoServiceRegistration.onApplicationEvent(AbstractAutoServiceRegistration.java:47) ~[spring-cloud-commons-3.1.5.jar:3.1.5]
	at org.springframework.context.event.SimpleApplicationEventMulticaster.doInvokeListener(SimpleApplicationEventMulticaster.java:176) ~[spring-context-5.3.27.jar:5.3.27]
	at org.springframework.context.event.SimpleApplicationEventMulticaster.invokeListener(SimpleApplicationEventMulticaster.java:169) ~[spring-context-5.3.27.jar:5.3.27]
	at org.springframework.context.event.SimpleApplicationEventMulticaster.multicastEvent(SimpleApplicationEventMulticaster.java:143) ~[spring-context-5.3.27.jar:5.3.27]
	at org.springframework.context.support.AbstractApplicationContext.publishEvent(AbstractApplicationContext.java:421) ~[spring-context-5.3.27.jar:5.3.27]
	at org.springframework.context.support.AbstractApplicationContext.publishEvent(AbstractApplicationContext.java:378) ~[spring-context-5.3.27.jar:5.3.27]
	at org.springframework.boot.web.servlet.context.WebServerStartStopLifecycle.start(WebServerStartStopLifecycle.java:46) ~[spring-boot-2.7.12.jar:2.7.12]
	at org.springframework.context.support.DefaultLifecycleProcessor.doStart(DefaultLifecycleProcessor.java:178) ~[spring-context-5.3.27.jar:5.3.27]
	at org.springframework.context.support.DefaultLifecycleProcessor.access$200(DefaultLifecycleProcessor.java:54) ~[spring-context-5.3.27.jar:5.3.27]
	at org.springframework.context.support.DefaultLifecycleProcessor$LifecycleGroup.start(DefaultLifecycleProcessor.java:356) ~[spring-context-5.3.27.jar:5.3.27]
	at java.base/java.lang.Iterable.forEach(Iterable.java:75) ~[na:na]
	at org.springframework.context.support.DefaultLifecycleProcessor.startBeans(DefaultLifecycleProcessor.java:155) ~[spring-context-5.3.27.jar:5.3.27]
	at org.springframework.context.support.DefaultLifecycleProcessor.onRefresh(DefaultLifecycleProcessor.java:123) ~[spring-context-5.3.27.jar:5.3.27]
	at org.springframework.context.support.AbstractApplicationContext.finishRefresh(AbstractApplicationContext.java:937) ~[spring-context-5.3.27.jar:5.3.27]
	at org.springframework.context.support.AbstractApplicationContext.refresh(AbstractApplicationContext.java:586) ~[spring-context-5.3.27.jar:5.3.27]
	at org.springframework.boot.web.servlet.context.ServletWebServerApplicationContext.refresh(ServletWebServerApplicationContext.java:147) ~[spring-boot-2.7.12.jar:2.7.12]
	at org.springframework.boot.SpringApplication.refresh(SpringApplication.java:731) ~[spring-boot-2.7.12.jar:2.7.12]
	at org.springframework.boot.SpringApplication.refreshContext(SpringApplication.java:408) ~[spring-boot-2.7.12.jar:2.7.12]
	at org.springframework.boot.SpringApplication.run(SpringApplication.java:307) ~[spring-boot-2.7.12.jar:2.7.12]
	at org.springframework.boot.SpringApplication.run(SpringApplication.java:1303) ~[spring-boot-2.7.12.jar:2.7.12]
	at org.springframework.boot.SpringApplication.run(SpringApplication.java:1292) ~[spring-boot-2.7.12.jar:2.7.12]
	at com.luojiawei.his_service.HisServiceApplication.main(HisServiceApplication.java:19) ~[classes/:na]

16:33:04:867  WARN 164 --- [main] ConfigServletWebServerApplicationContext : Exception encountered during context initialization - cancelling refresh attempt: org.springframework.context.ApplicationContextException: Failed to start bean 'webServerStartStop'; nested exception is java.lang.reflect.UndeclaredThrowableException
16:33:05:261  INFO 164 --- [main] o.apache.catalina.core.StandardService   : Stopping service [Tomcat]
16:33:05:264  WARN 164 --- [main] o.a.c.loader.WebappClassLoaderBase       : The web application [ROOT] appears to have started a thread named [Thread-2] but has failed to stop it. This is very likely to create a memory leak. Stack trace of thread:
 java.base@17.0.11/sun.net.dns.ResolverConfigurationImpl.notifyAddrChange0(Native Method)
 java.base@17.0.11/sun.net.dns.ResolverConfigurationImpl$AddressChangeListener.run(ResolverConfigurationImpl.java:176)
16:33:05:287  INFO 164 --- [main] ConditionEvaluationReportLoggingListener : 

Error starting ApplicationContext. To display the conditions report re-run your application with 'debug' enabled.
16:33:05:306 ERROR 164 --- [main] o.s.boot.SpringApplication               : Application run failed

org.springframework.context.ApplicationContextException: Failed to start bean 'webServerStartStop'; nested exception is java.lang.reflect.UndeclaredThrowableException
	at org.springframework.context.support.DefaultLifecycleProcessor.doStart(DefaultLifecycleProcessor.java:181) ~[spring-context-5.3.27.jar:5.3.27]
	at org.springframework.context.support.DefaultLifecycleProcessor.access$200(DefaultLifecycleProcessor.java:54) ~[spring-context-5.3.27.jar:5.3.27]
	at org.springframework.context.support.DefaultLifecycleProcessor$LifecycleGroup.start(DefaultLifecycleProcessor.java:356) ~[spring-context-5.3.27.jar:5.3.27]
	at java.base/java.lang.Iterable.forEach(Iterable.java:75) ~[na:na]
	at org.springframework.context.support.DefaultLifecycleProcessor.startBeans(DefaultLifecycleProcessor.java:155) ~[spring-context-5.3.27.jar:5.3.27]
	at org.springframework.context.support.DefaultLifecycleProcessor.onRefresh(DefaultLifecycleProcessor.java:123) ~[spring-context-5.3.27.jar:5.3.27]
	at org.springframework.context.support.AbstractApplicationContext.finishRefresh(AbstractApplicationContext.java:937) ~[spring-context-5.3.27.jar:5.3.27]
	at org.springframework.context.support.AbstractApplicationContext.refresh(AbstractApplicationContext.java:586) ~[spring-context-5.3.27.jar:5.3.27]
	at org.springframework.boot.web.servlet.context.ServletWebServerApplicationContext.refresh(ServletWebServerApplicationContext.java:147) ~[spring-boot-2.7.12.jar:2.7.12]
	at org.springframework.boot.SpringApplication.refresh(SpringApplication.java:731) ~[spring-boot-2.7.12.jar:2.7.12]
	at org.springframework.boot.SpringApplication.refreshContext(SpringApplication.java:408) ~[spring-boot-2.7.12.jar:2.7.12]
	at org.springframework.boot.SpringApplication.run(SpringApplication.java:307) ~[spring-boot-2.7.12.jar:2.7.12]
	at org.springframework.boot.SpringApplication.run(SpringApplication.java:1303) ~[spring-boot-2.7.12.jar:2.7.12]
	at org.springframework.boot.SpringApplication.run(SpringApplication.java:1292) ~[spring-boot-2.7.12.jar:2.7.12]
	at com.luojiawei.his_service.HisServiceApplication.main(HisServiceApplication.java:19) ~[classes/:na]
Caused by: java.lang.reflect.UndeclaredThrowableException: null
	at org.springframework.util.ReflectionUtils.rethrowRuntimeException(ReflectionUtils.java:147) ~[spring-core-5.3.27.jar:5.3.27]
	at com.alibaba.cloud.nacos.registry.NacosServiceRegistry.register(NacosServiceRegistry.java:83) ~[spring-cloud-starter-alibaba-nacos-discovery-2021.0.5.0.jar:2021.0.5.0]
	at org.springframework.cloud.client.serviceregistry.AbstractAutoServiceRegistration.register(AbstractAutoServiceRegistration.java:232) ~[spring-cloud-commons-3.1.5.jar:3.1.5]
	at com.alibaba.cloud.nacos.registry.NacosAutoServiceRegistration.register(NacosAutoServiceRegistration.java:78) ~[spring-cloud-starter-alibaba-nacos-discovery-2021.0.5.0.jar:2021.0.5.0]
	at org.springframework.cloud.client.serviceregistry.AbstractAutoServiceRegistration.start(AbstractAutoServiceRegistration.java:133) ~[spring-cloud-commons-3.1.5.jar:3.1.5]
	at org.springframework.cloud.client.serviceregistry.AbstractAutoServiceRegistration.bind(AbstractAutoServiceRegistration.java:98) ~[spring-cloud-commons-3.1.5.jar:3.1.5]
	at org.springframework.cloud.client.serviceregistry.AbstractAutoServiceRegistration.onApplicationEvent(AbstractAutoServiceRegistration.java:86) ~[spring-cloud-commons-3.1.5.jar:3.1.5]
	at org.springframework.cloud.client.serviceregistry.AbstractAutoServiceRegistration.onApplicationEvent(AbstractAutoServiceRegistration.java:47) ~[spring-cloud-commons-3.1.5.jar:3.1.5]
	at org.springframework.context.event.SimpleApplicationEventMulticaster.doInvokeListener(SimpleApplicationEventMulticaster.java:176) ~[spring-context-5.3.27.jar:5.3.27]
	at org.springframework.context.event.SimpleApplicationEventMulticaster.invokeListener(SimpleApplicationEventMulticaster.java:169) ~[spring-context-5.3.27.jar:5.3.27]
	at org.springframework.context.event.SimpleApplicationEventMulticaster.multicastEvent(SimpleApplicationEventMulticaster.java:143) ~[spring-context-5.3.27.jar:5.3.27]
	at org.springframework.context.support.AbstractApplicationContext.publishEvent(AbstractApplicationContext.java:421) ~[spring-context-5.3.27.jar:5.3.27]
	at org.springframework.context.support.AbstractApplicationContext.publishEvent(AbstractApplicationContext.java:378) ~[spring-context-5.3.27.jar:5.3.27]
	at org.springframework.boot.web.servlet.context.WebServerStartStopLifecycle.start(WebServerStartStopLifecycle.java:46) ~[spring-boot-2.7.12.jar:2.7.12]
	at org.springframework.context.support.DefaultLifecycleProcessor.doStart(DefaultLifecycleProcessor.java:178) ~[spring-context-5.3.27.jar:5.3.27]
	... 14 common frames omitted
Caused by: com.alibaba.nacos.api.exception.NacosException: Client not connected, current status:STARTING
	at com.alibaba.nacos.common.remote.client.RpcClient.request(RpcClient.java:639) ~[nacos-client-2.2.0.jar:na]
	at com.alibaba.nacos.common.remote.client.RpcClient.request(RpcClient.java:619) ~[nacos-client-2.2.0.jar:na]
	at com.alibaba.nacos.client.naming.remote.gprc.NamingGrpcClientProxy.requestToServer(NamingGrpcClientProxy.java:356) ~[nacos-client-2.2.0.jar:na]
	at com.alibaba.nacos.client.naming.remote.gprc.NamingGrpcClientProxy.doRegisterService(NamingGrpcClientProxy.java:209) ~[nacos-client-2.2.0.jar:na]
	at com.alibaba.nacos.client.naming.remote.gprc.NamingGrpcClientProxy.registerService(NamingGrpcClientProxy.java:123) ~[nacos-client-2.2.0.jar:na]
	at com.alibaba.nacos.client.naming.remote.NamingClientProxyDelegate.registerService(NamingClientProxyDelegate.java:98) ~[nacos-client-2.2.0.jar:na]
	at com.alibaba.nacos.client.naming.NacosNamingService.registerInstance(NacosNamingService.java:152) ~[nacos-client-2.2.0.jar:na]
	at com.alibaba.cloud.nacos.registry.NacosServiceRegistry.register(NacosServiceRegistry.java:75) ~[spring-cloud-starter-alibaba-nacos-discovery-2021.0.5.0.jar:2021.0.5.0]
	... 27 common frames omitted

16:33:05:875  WARN 164 --- [Thread-8] c.a.n.common.http.HttpClientBeanHolder   : [HttpClientBeanHolder] Start destroying common HttpClient
16:33:05:875  WARN 164 --- [Thread-5] c.a.nacos.common.notify.NotifyCenter     : [NotifyCenter] Start destroying Publisher
16:33:05:875  WARN 164 --- [Thread-5] c.a.nacos.common.notify.NotifyCenter     : [NotifyCenter] Destruction of the end
16:34:52:740  INFO 37116 --- [main] c.l.his_service.HisServiceApplication    : Starting HisServiceApplication using Java 17.0.11 on luo with PID 37116 (A:\Desktop\workspace\HIS\his_service\target\classes started by 22407 in A:\Desktop\workspace\HIS)
16:34:52:740 DEBUG 37116 --- [main] c.l.his_service.HisServiceApplication    : Running with Spring Boot v2.7.12, Spring v5.3.27
16:34:52:741  INFO 37116 --- [main] c.l.his_service.HisServiceApplication    : The following 1 profile is active: "dev"
16:34:53:879  INFO 37116 --- [main] .s.d.r.c.RepositoryConfigurationDelegate : Multiple Spring Data modules found, entering strict repository configuration mode
16:34:53:882  INFO 37116 --- [main] .s.d.r.c.RepositoryConfigurationDelegate : Bootstrapping Spring Data Redis repositories in DEFAULT mode.
16:34:53:908  INFO 37116 --- [main] .s.d.r.c.RepositoryConfigurationDelegate : Finished Spring Data repository scanning in 14 ms. Found 0 Redis repository interfaces.
16:34:54:180  INFO 37116 --- [main] o.s.cloud.context.scope.GenericScope     : BeanFactory id=ac61872e-faec-371d-922e-ad941e5407d7
16:34:54:774  INFO 37116 --- [main] o.s.b.w.embedded.tomcat.TomcatWebServer  : Tomcat initialized with port(s): 8080 (http)
16:34:54:783  INFO 37116 --- [main] o.apache.catalina.core.StandardService   : Starting service [Tomcat]
16:34:54:783  INFO 37116 --- [main] org.apache.catalina.core.StandardEngine  : Starting Servlet engine: [Apache Tomcat/9.0.75]
16:34:54:924  INFO 37116 --- [main] o.a.c.c.C.[Tomcat].[localhost].[/]       : Initializing Spring embedded WebApplicationContext
16:34:54:924  INFO 37116 --- [main] w.s.c.ServletWebServerApplicationContext : Root WebApplicationContext: initialization completed in 2137 ms
16:34:55:169  INFO 37116 --- [main] org.redisson.Version                     : Redisson 3.17.7
16:34:55:562  INFO 37116 --- [redisson-netty-2-9] o.r.c.pool.MasterPubSubConnectionPool    : 1 connections initialized for 111.230.32.147/111.230.32.147:9631
16:34:56:304  INFO 37116 --- [redisson-netty-2-19] o.r.c.pool.MasterConnectionPool          : 24 connections initialized for 111.230.32.147/111.230.32.147:9631
16:34:56:597 DEBUG 37116 --- [main] c.l.h.filter.RefreshTokenFilter          : Filter 'refreshTokenFilter' configured for use
16:34:57:347  INFO 37116 --- [main] o.s.c.openfeign.FeignClientFactoryBean   : For 'flask-service' URL not provided. Will try picking an instance via load-balancing.
16:34:57:461  INFO 37116 --- [main] o.s.c.openfeign.FeignClientFactoryBean   : For 'ai-service' URL not provided. Will try picking an instance via load-balancing.
16:34:57:509  WARN 37116 --- [main] c.b.m.core.metadata.TableInfoHelper      : Can not find table primary key in Class: "java.lang.Object".
16:34:57:510  WARN 37116 --- [main] c.b.m.core.injector.DefaultSqlInjector   : class java.lang.Object ,Not found @TableId annotation, Cannot use Mybatis-Plus 'xxById' Method.
16:34:59:151  WARN 37116 --- [main] iguration$LoadBalancerCaffeineWarnLogger : Spring Cloud LoadBalancer is currently working with the default cache. While this cache implementation is useful for development and tests, it's recommended to use Caffeine cache in production.You can switch to using Caffeine cache, by adding it and org.springframework.cache.caffeine.CaffeineCacheManager to the classpath.
16:34:59:156  INFO 37116 --- [main] o.s.b.a.e.web.EndpointLinksResolver      : Exposing 1 endpoint(s) beneath base path '/actuator'
16:34:59:245  INFO 37116 --- [main] o.s.b.w.embedded.tomcat.TomcatWebServer  : Tomcat started on port(s): 8080 (http) with context path ''
16:34:59:307  INFO 37116 --- [main] c.a.n.p.a.s.c.ClientAuthPluginManager    : [ClientAuthPluginManager] Load ClientAuthService com.alibaba.nacos.client.auth.impl.NacosClientAuthServiceImpl success.
16:34:59:307  INFO 37116 --- [main] c.a.n.p.a.s.c.ClientAuthPluginManager    : [ClientAuthPluginManager] Load ClientAuthService com.alibaba.nacos.client.auth.ram.RamClientAuthServiceImpl success.
16:34:59:937 ERROR 37116 --- [main] c.a.c.n.registry.NacosServiceRegistry    : nacos registry, his-service register failed...NacosRegistration{nacosDiscoveryProperties=NacosDiscoveryProperties{serverAddr='81.71.3.208848', username='', password='', endpoint='', namespace='', watchDelay=30000, logName='', service='his-service', weight=1.0, clusterName='DEFAULT', group='DEFAULT_GROUP', namingLoadCacheAtStart='false', metadata={IPv6=null, preserved.register.source=SPRING_CLOUD}, registerEnabled=true, ip='10.21.93.70', networkInterface='', port=8080, secure=false, accessKey='', secretKey='', heartBeatInterval=null, heartBeatTimeout=null, ipDeleteTimeout=null, instanceEnabled=true, ephemeral=true, failureToleranceEnabled=false}, ipDeleteTimeout=null, failFast=true}},

com.alibaba.nacos.api.exception.NacosException: Client not connected, current status:STARTING
	at com.alibaba.nacos.common.remote.client.RpcClient.request(RpcClient.java:647) ~[nacos-client-2.3.0.jar:na]
	at com.alibaba.nacos.common.remote.client.RpcClient.request(RpcClient.java:626) ~[nacos-client-2.3.0.jar:na]
	at com.alibaba.nacos.client.naming.remote.gprc.NamingGrpcClientProxy.requestToServer(NamingGrpcClientProxy.java:450) ~[nacos-client-2.3.0.jar:na]
	at com.alibaba.nacos.client.naming.remote.gprc.NamingGrpcClientProxy.doRegisterService(NamingGrpcClientProxy.java:249) ~[nacos-client-2.3.0.jar:na]
	at com.alibaba.nacos.client.naming.remote.gprc.NamingGrpcClientProxy.registerServiceForEphemeral(NamingGrpcClientProxy.java:144) ~[nacos-client-2.3.0.jar:na]
	at com.alibaba.nacos.client.naming.remote.gprc.NamingGrpcClientProxy.registerService(NamingGrpcClientProxy.java:136) ~[nacos-client-2.3.0.jar:na]
	at com.alibaba.nacos.client.naming.remote.NamingClientProxyDelegate.registerService(NamingClientProxyDelegate.java:98) ~[nacos-client-2.3.0.jar:na]
	at com.alibaba.nacos.client.naming.NacosNamingService.registerInstance(NacosNamingService.java:146) ~[nacos-client-2.3.0.jar:na]
	at com.alibaba.cloud.nacos.registry.NacosServiceRegistry.register(NacosServiceRegistry.java:75) ~[spring-cloud-starter-alibaba-nacos-discovery-2021.0.5.0.jar:2021.0.5.0]
	at org.springframework.cloud.client.serviceregistry.AbstractAutoServiceRegistration.register(AbstractAutoServiceRegistration.java:232) ~[spring-cloud-commons-3.1.5.jar:3.1.5]
	at com.alibaba.cloud.nacos.registry.NacosAutoServiceRegistration.register(NacosAutoServiceRegistration.java:78) ~[spring-cloud-starter-alibaba-nacos-discovery-2021.0.5.0.jar:2021.0.5.0]
	at org.springframework.cloud.client.serviceregistry.AbstractAutoServiceRegistration.start(AbstractAutoServiceRegistration.java:133) ~[spring-cloud-commons-3.1.5.jar:3.1.5]
	at org.springframework.cloud.client.serviceregistry.AbstractAutoServiceRegistration.bind(AbstractAutoServiceRegistration.java:98) ~[spring-cloud-commons-3.1.5.jar:3.1.5]
	at org.springframework.cloud.client.serviceregistry.AbstractAutoServiceRegistration.onApplicationEvent(AbstractAutoServiceRegistration.java:86) ~[spring-cloud-commons-3.1.5.jar:3.1.5]
	at org.springframework.cloud.client.serviceregistry.AbstractAutoServiceRegistration.onApplicationEvent(AbstractAutoServiceRegistration.java:47) ~[spring-cloud-commons-3.1.5.jar:3.1.5]
	at org.springframework.context.event.SimpleApplicationEventMulticaster.doInvokeListener(SimpleApplicationEventMulticaster.java:176) ~[spring-context-5.3.27.jar:5.3.27]
	at org.springframework.context.event.SimpleApplicationEventMulticaster.invokeListener(SimpleApplicationEventMulticaster.java:169) ~[spring-context-5.3.27.jar:5.3.27]
	at org.springframework.context.event.SimpleApplicationEventMulticaster.multicastEvent(SimpleApplicationEventMulticaster.java:143) ~[spring-context-5.3.27.jar:5.3.27]
	at org.springframework.context.support.AbstractApplicationContext.publishEvent(AbstractApplicationContext.java:421) ~[spring-context-5.3.27.jar:5.3.27]
	at org.springframework.context.support.AbstractApplicationContext.publishEvent(AbstractApplicationContext.java:378) ~[spring-context-5.3.27.jar:5.3.27]
	at org.springframework.boot.web.servlet.context.WebServerStartStopLifecycle.start(WebServerStartStopLifecycle.java:46) ~[spring-boot-2.7.12.jar:2.7.12]
	at org.springframework.context.support.DefaultLifecycleProcessor.doStart(DefaultLifecycleProcessor.java:178) ~[spring-context-5.3.27.jar:5.3.27]
	at org.springframework.context.support.DefaultLifecycleProcessor.access$200(DefaultLifecycleProcessor.java:54) ~[spring-context-5.3.27.jar:5.3.27]
	at org.springframework.context.support.DefaultLifecycleProcessor$LifecycleGroup.start(DefaultLifecycleProcessor.java:356) ~[spring-context-5.3.27.jar:5.3.27]
	at java.base/java.lang.Iterable.forEach(Iterable.java:75) ~[na:na]
	at org.springframework.context.support.DefaultLifecycleProcessor.startBeans(DefaultLifecycleProcessor.java:155) ~[spring-context-5.3.27.jar:5.3.27]
	at org.springframework.context.support.DefaultLifecycleProcessor.onRefresh(DefaultLifecycleProcessor.java:123) ~[spring-context-5.3.27.jar:5.3.27]
	at org.springframework.context.support.AbstractApplicationContext.finishRefresh(AbstractApplicationContext.java:937) ~[spring-context-5.3.27.jar:5.3.27]
	at org.springframework.context.support.AbstractApplicationContext.refresh(AbstractApplicationContext.java:586) ~[spring-context-5.3.27.jar:5.3.27]
	at org.springframework.boot.web.servlet.context.ServletWebServerApplicationContext.refresh(ServletWebServerApplicationContext.java:147) ~[spring-boot-2.7.12.jar:2.7.12]
	at org.springframework.boot.SpringApplication.refresh(SpringApplication.java:731) ~[spring-boot-2.7.12.jar:2.7.12]
	at org.springframework.boot.SpringApplication.refreshContext(SpringApplication.java:408) ~[spring-boot-2.7.12.jar:2.7.12]
	at org.springframework.boot.SpringApplication.run(SpringApplication.java:307) ~[spring-boot-2.7.12.jar:2.7.12]
	at org.springframework.boot.SpringApplication.run(SpringApplication.java:1303) ~[spring-boot-2.7.12.jar:2.7.12]
	at org.springframework.boot.SpringApplication.run(SpringApplication.java:1292) ~[spring-boot-2.7.12.jar:2.7.12]
	at com.luojiawei.his_service.HisServiceApplication.main(HisServiceApplication.java:19) ~[classes/:na]

16:34:59:939  WARN 37116 --- [main] ConfigServletWebServerApplicationContext : Exception encountered during context initialization - cancelling refresh attempt: org.springframework.context.ApplicationContextException: Failed to start bean 'webServerStartStop'; nested exception is java.lang.reflect.UndeclaredThrowableException
16:35:00:348  INFO 37116 --- [main] o.apache.catalina.core.StandardService   : Stopping service [Tomcat]
16:35:00:351  WARN 37116 --- [main] o.a.c.loader.WebappClassLoaderBase       : The web application [ROOT] appears to have started a thread named [Thread-8] but has failed to stop it. This is very likely to create a memory leak. Stack trace of thread:
 java.base@17.0.11/sun.net.dns.ResolverConfigurationImpl.notifyAddrChange0(Native Method)
 java.base@17.0.11/sun.net.dns.ResolverConfigurationImpl$AddressChangeListener.run(ResolverConfigurationImpl.java:176)
16:35:00:369  INFO 37116 --- [main] ConditionEvaluationReportLoggingListener : 

Error starting ApplicationContext. To display the conditions report re-run your application with 'debug' enabled.
16:35:00:390 ERROR 37116 --- [main] o.s.boot.SpringApplication               : Application run failed

org.springframework.context.ApplicationContextException: Failed to start bean 'webServerStartStop'; nested exception is java.lang.reflect.UndeclaredThrowableException
	at org.springframework.context.support.DefaultLifecycleProcessor.doStart(DefaultLifecycleProcessor.java:181) ~[spring-context-5.3.27.jar:5.3.27]
	at org.springframework.context.support.DefaultLifecycleProcessor.access$200(DefaultLifecycleProcessor.java:54) ~[spring-context-5.3.27.jar:5.3.27]
	at org.springframework.context.support.DefaultLifecycleProcessor$LifecycleGroup.start(DefaultLifecycleProcessor.java:356) ~[spring-context-5.3.27.jar:5.3.27]
	at java.base/java.lang.Iterable.forEach(Iterable.java:75) ~[na:na]
	at org.springframework.context.support.DefaultLifecycleProcessor.startBeans(DefaultLifecycleProcessor.java:155) ~[spring-context-5.3.27.jar:5.3.27]
	at org.springframework.context.support.DefaultLifecycleProcessor.onRefresh(DefaultLifecycleProcessor.java:123) ~[spring-context-5.3.27.jar:5.3.27]
	at org.springframework.context.support.AbstractApplicationContext.finishRefresh(AbstractApplicationContext.java:937) ~[spring-context-5.3.27.jar:5.3.27]
	at org.springframework.context.support.AbstractApplicationContext.refresh(AbstractApplicationContext.java:586) ~[spring-context-5.3.27.jar:5.3.27]
	at org.springframework.boot.web.servlet.context.ServletWebServerApplicationContext.refresh(ServletWebServerApplicationContext.java:147) ~[spring-boot-2.7.12.jar:2.7.12]
	at org.springframework.boot.SpringApplication.refresh(SpringApplication.java:731) ~[spring-boot-2.7.12.jar:2.7.12]
	at org.springframework.boot.SpringApplication.refreshContext(SpringApplication.java:408) ~[spring-boot-2.7.12.jar:2.7.12]
	at org.springframework.boot.SpringApplication.run(SpringApplication.java:307) ~[spring-boot-2.7.12.jar:2.7.12]
	at org.springframework.boot.SpringApplication.run(SpringApplication.java:1303) ~[spring-boot-2.7.12.jar:2.7.12]
	at org.springframework.boot.SpringApplication.run(SpringApplication.java:1292) ~[spring-boot-2.7.12.jar:2.7.12]
	at com.luojiawei.his_service.HisServiceApplication.main(HisServiceApplication.java:19) ~[classes/:na]
Caused by: java.lang.reflect.UndeclaredThrowableException: null
	at org.springframework.util.ReflectionUtils.rethrowRuntimeException(ReflectionUtils.java:147) ~[spring-core-5.3.27.jar:5.3.27]
	at com.alibaba.cloud.nacos.registry.NacosServiceRegistry.register(NacosServiceRegistry.java:83) ~[spring-cloud-starter-alibaba-nacos-discovery-2021.0.5.0.jar:2021.0.5.0]
	at org.springframework.cloud.client.serviceregistry.AbstractAutoServiceRegistration.register(AbstractAutoServiceRegistration.java:232) ~[spring-cloud-commons-3.1.5.jar:3.1.5]
	at com.alibaba.cloud.nacos.registry.NacosAutoServiceRegistration.register(NacosAutoServiceRegistration.java:78) ~[spring-cloud-starter-alibaba-nacos-discovery-2021.0.5.0.jar:2021.0.5.0]
	at org.springframework.cloud.client.serviceregistry.AbstractAutoServiceRegistration.start(AbstractAutoServiceRegistration.java:133) ~[spring-cloud-commons-3.1.5.jar:3.1.5]
	at org.springframework.cloud.client.serviceregistry.AbstractAutoServiceRegistration.bind(AbstractAutoServiceRegistration.java:98) ~[spring-cloud-commons-3.1.5.jar:3.1.5]
	at org.springframework.cloud.client.serviceregistry.AbstractAutoServiceRegistration.onApplicationEvent(AbstractAutoServiceRegistration.java:86) ~[spring-cloud-commons-3.1.5.jar:3.1.5]
	at org.springframework.cloud.client.serviceregistry.AbstractAutoServiceRegistration.onApplicationEvent(AbstractAutoServiceRegistration.java:47) ~[spring-cloud-commons-3.1.5.jar:3.1.5]
	at org.springframework.context.event.SimpleApplicationEventMulticaster.doInvokeListener(SimpleApplicationEventMulticaster.java:176) ~[spring-context-5.3.27.jar:5.3.27]
	at org.springframework.context.event.SimpleApplicationEventMulticaster.invokeListener(SimpleApplicationEventMulticaster.java:169) ~[spring-context-5.3.27.jar:5.3.27]
	at org.springframework.context.event.SimpleApplicationEventMulticaster.multicastEvent(SimpleApplicationEventMulticaster.java:143) ~[spring-context-5.3.27.jar:5.3.27]
	at org.springframework.context.support.AbstractApplicationContext.publishEvent(AbstractApplicationContext.java:421) ~[spring-context-5.3.27.jar:5.3.27]
	at org.springframework.context.support.AbstractApplicationContext.publishEvent(AbstractApplicationContext.java:378) ~[spring-context-5.3.27.jar:5.3.27]
	at org.springframework.boot.web.servlet.context.WebServerStartStopLifecycle.start(WebServerStartStopLifecycle.java:46) ~[spring-boot-2.7.12.jar:2.7.12]
	at org.springframework.context.support.DefaultLifecycleProcessor.doStart(DefaultLifecycleProcessor.java:178) ~[spring-context-5.3.27.jar:5.3.27]
	... 14 common frames omitted
Caused by: com.alibaba.nacos.api.exception.NacosException: Client not connected, current status:STARTING
	at com.alibaba.nacos.common.remote.client.RpcClient.request(RpcClient.java:647) ~[nacos-client-2.3.0.jar:na]
	at com.alibaba.nacos.common.remote.client.RpcClient.request(RpcClient.java:626) ~[nacos-client-2.3.0.jar:na]
	at com.alibaba.nacos.client.naming.remote.gprc.NamingGrpcClientProxy.requestToServer(NamingGrpcClientProxy.java:450) ~[nacos-client-2.3.0.jar:na]
	at com.alibaba.nacos.client.naming.remote.gprc.NamingGrpcClientProxy.doRegisterService(NamingGrpcClientProxy.java:249) ~[nacos-client-2.3.0.jar:na]
	at com.alibaba.nacos.client.naming.remote.gprc.NamingGrpcClientProxy.registerServiceForEphemeral(NamingGrpcClientProxy.java:144) ~[nacos-client-2.3.0.jar:na]
	at com.alibaba.nacos.client.naming.remote.gprc.NamingGrpcClientProxy.registerService(NamingGrpcClientProxy.java:136) ~[nacos-client-2.3.0.jar:na]
	at com.alibaba.nacos.client.naming.remote.NamingClientProxyDelegate.registerService(NamingClientProxyDelegate.java:98) ~[nacos-client-2.3.0.jar:na]
	at com.alibaba.nacos.client.naming.NacosNamingService.registerInstance(NacosNamingService.java:146) ~[nacos-client-2.3.0.jar:na]
	at com.alibaba.cloud.nacos.registry.NacosServiceRegistry.register(NacosServiceRegistry.java:75) ~[spring-cloud-starter-alibaba-nacos-discovery-2021.0.5.0.jar:2021.0.5.0]
	... 27 common frames omitted

16:35:00:960  WARN 37116 --- [Thread-18] c.a.n.common.http.HttpClientBeanHolder   : [HttpClientBeanHolder] Start destroying common HttpClient
16:35:00:960  WARN 37116 --- [Thread-15] c.a.nacos.common.notify.NotifyCenter     : [NotifyCenter] Start destroying Publisher
16:35:00:961  WARN 37116 --- [Thread-15] c.a.nacos.common.notify.NotifyCenter     : [NotifyCenter] Destruction of the end
16:40:38:431  INFO 24152 --- [main] c.l.his_service.HisServiceApplication    : Starting HisServiceApplication using Java 17.0.11 on luo with PID 24152 (A:\Desktop\workspace\HIS\his_service\target\classes started by 22407 in A:\Desktop\workspace\HIS)
16:40:38:436 DEBUG 24152 --- [main] c.l.his_service.HisServiceApplication    : Running with Spring Boot v2.7.12, Spring v5.3.27
16:40:38:437  INFO 24152 --- [main] c.l.his_service.HisServiceApplication    : The following 1 profile is active: "dev"
16:40:41:104  INFO 24152 --- [main] .s.d.r.c.RepositoryConfigurationDelegate : Multiple Spring Data modules found, entering strict repository configuration mode
16:40:41:107  INFO 24152 --- [main] .s.d.r.c.RepositoryConfigurationDelegate : Bootstrapping Spring Data Redis repositories in DEFAULT mode.
16:40:41:205  INFO 24152 --- [main] .s.d.r.c.RepositoryConfigurationDelegate : Finished Spring Data repository scanning in 25 ms. Found 0 Redis repository interfaces.
16:40:41:795  INFO 24152 --- [main] o.s.cloud.context.scope.GenericScope     : BeanFactory id=ac61872e-faec-371d-922e-ad941e5407d7
16:40:44:597  INFO 24152 --- [main] o.s.b.w.embedded.tomcat.TomcatWebServer  : Tomcat initialized with port(s): 8080 (http)
16:40:44:632  INFO 24152 --- [main] o.apache.catalina.core.StandardService   : Starting service [Tomcat]
16:40:44:633  INFO 24152 --- [main] org.apache.catalina.core.StandardEngine  : Starting Servlet engine: [Apache Tomcat/9.0.75]
16:40:44:922  INFO 24152 --- [main] o.a.c.c.C.[Tomcat].[localhost].[/]       : Initializing Spring embedded WebApplicationContext
16:40:44:922  INFO 24152 --- [main] w.s.c.ServletWebServerApplicationContext : Root WebApplicationContext: initialization completed in 6372 ms
16:40:45:623  INFO 24152 --- [main] org.redisson.Version                     : Redisson 3.17.7
16:40:46:460  INFO 24152 --- [redisson-netty-2-9] o.r.c.pool.MasterPubSubConnectionPool    : 1 connections initialized for 111.230.32.147/111.230.32.147:9631
16:40:47:225  INFO 24152 --- [redisson-netty-2-19] o.r.c.pool.MasterConnectionPool          : 24 connections initialized for 111.230.32.147/111.230.32.147:9631
16:40:47:885 DEBUG 24152 --- [main] c.l.h.filter.RefreshTokenFilter          : Filter 'refreshTokenFilter' configured for use
16:40:49:093  INFO 24152 --- [main] o.s.c.openfeign.FeignClientFactoryBean   : For 'flask-service' URL not provided. Will try picking an instance via load-balancing.
16:40:49:210  INFO 24152 --- [main] o.s.c.openfeign.FeignClientFactoryBean   : For 'ai-service' URL not provided. Will try picking an instance via load-balancing.
16:40:49:261  WARN 24152 --- [main] c.b.m.core.metadata.TableInfoHelper      : Can not find table primary key in Class: "java.lang.Object".
16:40:49:262  WARN 24152 --- [main] c.b.m.core.injector.DefaultSqlInjector   : class java.lang.Object ,Not found @TableId annotation, Cannot use Mybatis-Plus 'xxById' Method.
16:40:52:004  WARN 24152 --- [main] iguration$LoadBalancerCaffeineWarnLogger : Spring Cloud LoadBalancer is currently working with the default cache. While this cache implementation is useful for development and tests, it's recommended to use Caffeine cache in production.You can switch to using Caffeine cache, by adding it and org.springframework.cache.caffeine.CaffeineCacheManager to the classpath.
16:40:52:011  INFO 24152 --- [main] o.s.b.a.e.web.EndpointLinksResolver      : Exposing 1 endpoint(s) beneath base path '/actuator'
16:40:52:106  INFO 24152 --- [main] o.s.b.w.embedded.tomcat.TomcatWebServer  : Tomcat started on port(s): 8080 (http) with context path ''
16:40:52:169  INFO 24152 --- [main] c.a.n.p.a.s.c.ClientAuthPluginManager    : [ClientAuthPluginManager] Load ClientAuthService com.alibaba.nacos.client.auth.impl.NacosClientAuthServiceImpl success.
16:40:52:169  INFO 24152 --- [main] c.a.n.p.a.s.c.ClientAuthPluginManager    : [ClientAuthPluginManager] Load ClientAuthService com.alibaba.nacos.client.auth.ram.RamClientAuthServiceImpl success.
16:40:54:530  INFO 24152 --- [main] c.a.n.c.a.AbstractAbilityControlManager  : Ready to get current node abilities...
16:40:54:531  INFO 24152 --- [main] c.a.n.c.a.AbstractAbilityControlManager  : Ready to initialize current node abilities, support modes: [SDK_CLIENT]
16:40:54:531  INFO 24152 --- [main] c.a.n.c.a.AbstractAbilityControlManager  : Initialize current abilities finish...
16:40:54:532  INFO 24152 --- [main] c.a.n.c.a.d.NacosAbilityManagerHolder    : [AbilityControlManager] Successfully initialize AbilityControlManager
16:40:54:834  INFO 24152 --- [main] c.a.c.n.registry.NacosServiceRegistry    : nacos registry, DEFAULT_GROUP his-service 10.21.93.70:8848 register finished
16:40:55:153  INFO 24152 --- [main] c.l.his_service.HisServiceApplication    : Started HisServiceApplication in 18.563 seconds (JVM running for 21.528)
16:41:50:000  WARN 24152 --- [Thread-15] c.a.nacos.common.notify.NotifyCenter     : [NotifyCenter] Start destroying Publisher
16:41:50:000  WARN 24152 --- [Thread-18] c.a.n.common.http.HttpClientBeanHolder   : [HttpClientBeanHolder] Start destroying common HttpClient
16:41:50:000  WARN 24152 --- [Thread-15] c.a.nacos.common.notify.NotifyCenter     : [NotifyCenter] Destruction of the end
16:41:50:001  WARN 24152 --- [Thread-18] c.a.n.common.http.HttpClientBeanHolder   : [HttpClientBeanHolder] Destruction of the end
16:41:50:048  INFO 24152 --- [SpringApplicationShutdownHook] c.a.c.n.registry.NacosServiceRegistry    : De-registering from Nacos Server now...
16:41:50:062  INFO 24152 --- [SpringApplicationShutdownHook] c.a.c.n.registry.NacosServiceRegistry    : De-registration finished.
16:41:56:012  INFO 37740 --- [main] c.l.his_service.HisServiceApplication    : Starting HisServiceApplication using Java 17.0.11 on luo with PID 37740 (A:\Desktop\workspace\HIS\his_service\target\classes started by 22407 in A:\Desktop\workspace\HIS)
16:41:56:014 DEBUG 37740 --- [main] c.l.his_service.HisServiceApplication    : Running with Spring Boot v2.7.12, Spring v5.3.27
16:41:56:014  INFO 37740 --- [main] c.l.his_service.HisServiceApplication    : The following 1 profile is active: "dev"
16:41:57:144  INFO 37740 --- [main] .s.d.r.c.RepositoryConfigurationDelegate : Multiple Spring Data modules found, entering strict repository configuration mode
16:41:57:147  INFO 37740 --- [main] .s.d.r.c.RepositoryConfigurationDelegate : Bootstrapping Spring Data Redis repositories in DEFAULT mode.
16:41:57:179  INFO 37740 --- [main] .s.d.r.c.RepositoryConfigurationDelegate : Finished Spring Data repository scanning in 17 ms. Found 0 Redis repository interfaces.
16:41:57:495  INFO 37740 --- [main] o.s.cloud.context.scope.GenericScope     : BeanFactory id=ac61872e-faec-371d-922e-ad941e5407d7
16:41:58:120  INFO 37740 --- [main] o.s.b.w.embedded.tomcat.TomcatWebServer  : Tomcat initialized with port(s): 8080 (http)
16:41:58:131  INFO 37740 --- [main] o.apache.catalina.core.StandardService   : Starting service [Tomcat]
16:41:58:132  INFO 37740 --- [main] org.apache.catalina.core.StandardEngine  : Starting Servlet engine: [Apache Tomcat/9.0.75]
16:41:58:294  INFO 37740 --- [main] o.a.c.c.C.[Tomcat].[localhost].[/]       : Initializing Spring embedded WebApplicationContext
16:41:58:295  INFO 37740 --- [main] w.s.c.ServletWebServerApplicationContext : Root WebApplicationContext: initialization completed in 2223 ms
16:41:58:642  INFO 37740 --- [main] org.redisson.Version                     : Redisson 3.17.7
16:41:59:044  INFO 37740 --- [redisson-netty-2-9] o.r.c.pool.MasterPubSubConnectionPool    : 1 connections initialized for 111.230.32.147/111.230.32.147:9631
16:41:59:760  INFO 37740 --- [redisson-netty-2-19] o.r.c.pool.MasterConnectionPool          : 24 connections initialized for 111.230.32.147/111.230.32.147:9631
16:42:00:095 DEBUG 37740 --- [main] c.l.h.filter.RefreshTokenFilter          : Filter 'refreshTokenFilter' configured for use
16:42:00:931  INFO 37740 --- [main] o.s.c.openfeign.FeignClientFactoryBean   : For 'flask-service' URL not provided. Will try picking an instance via load-balancing.
16:42:01:044  INFO 37740 --- [main] o.s.c.openfeign.FeignClientFactoryBean   : For 'ai-service' URL not provided. Will try picking an instance via load-balancing.
16:42:01:101  WARN 37740 --- [main] c.b.m.core.metadata.TableInfoHelper      : Can not find table primary key in Class: "java.lang.Object".
16:42:01:101  WARN 37740 --- [main] c.b.m.core.injector.DefaultSqlInjector   : class java.lang.Object ,Not found @TableId annotation, Cannot use Mybatis-Plus 'xxById' Method.
16:42:02:863  WARN 37740 --- [main] iguration$LoadBalancerCaffeineWarnLogger : Spring Cloud LoadBalancer is currently working with the default cache. While this cache implementation is useful for development and tests, it's recommended to use Caffeine cache in production.You can switch to using Caffeine cache, by adding it and org.springframework.cache.caffeine.CaffeineCacheManager to the classpath.
16:42:02:869  INFO 37740 --- [main] o.s.b.a.e.web.EndpointLinksResolver      : Exposing 1 endpoint(s) beneath base path '/actuator'
16:42:02:986  INFO 37740 --- [main] o.s.b.w.embedded.tomcat.TomcatWebServer  : Tomcat started on port(s): 8080 (http) with context path ''
16:42:03:037  INFO 37740 --- [main] c.a.n.p.a.s.c.ClientAuthPluginManager    : [ClientAuthPluginManager] Load ClientAuthService com.alibaba.nacos.client.auth.impl.NacosClientAuthServiceImpl success.
16:42:03:038  INFO 37740 --- [main] c.a.n.p.a.s.c.ClientAuthPluginManager    : [ClientAuthPluginManager] Load ClientAuthService com.alibaba.nacos.client.auth.ram.RamClientAuthServiceImpl success.
16:42:03:984  INFO 37740 --- [main] c.a.n.c.a.AbstractAbilityControlManager  : Ready to get current node abilities...
16:42:03:985  INFO 37740 --- [main] c.a.n.c.a.AbstractAbilityControlManager  : Ready to initialize current node abilities, support modes: [SDK_CLIENT]
16:42:03:986  INFO 37740 --- [main] c.a.n.c.a.AbstractAbilityControlManager  : Initialize current abilities finish...
16:42:03:987  INFO 37740 --- [main] c.a.n.c.a.d.NacosAbilityManagerHolder    : [AbilityControlManager] Successfully initialize AbilityControlManager
16:42:04:034  INFO 37740 --- [main] c.a.c.n.registry.NacosServiceRegistry    : nacos registry, DEFAULT_GROUP his-service 10.21.93.70:8848 register finished
16:42:04:332  INFO 37740 --- [main] c.l.his_service.HisServiceApplication    : Started HisServiceApplication in 9.36 seconds (JVM running for 10.636)
16:42:04:759  INFO 37740 --- [RMI TCP Connection(1)-10.21.93.70] o.a.c.c.C.[Tomcat].[localhost].[/]       : Initializing Spring DispatcherServlet 'dispatcherServlet'
16:42:04:759  INFO 37740 --- [RMI TCP Connection(1)-10.21.93.70] o.s.web.servlet.DispatcherServlet        : Initializing Servlet 'dispatcherServlet'
16:42:04:760  INFO 37740 --- [RMI TCP Connection(2)-10.21.93.70] com.zaxxer.hikari.HikariDataSource       : HikariPool-1 - Starting...
16:42:04:761  INFO 37740 --- [RMI TCP Connection(1)-10.21.93.70] o.s.web.servlet.DispatcherServlet        : Completed initialization in 1 ms
16:42:05:624  INFO 37740 --- [RMI TCP Connection(2)-10.21.93.70] com.zaxxer.hikari.HikariDataSource       : HikariPool-1 - Start completed.
16:42:24:578  WARN 37740 --- [Thread-15] c.a.nacos.common.notify.NotifyCenter     : [NotifyCenter] Start destroying Publisher
16:42:24:578  WARN 37740 --- [Thread-18] c.a.n.common.http.HttpClientBeanHolder   : [HttpClientBeanHolder] Start destroying common HttpClient
16:42:24:578  WARN 37740 --- [Thread-15] c.a.nacos.common.notify.NotifyCenter     : [NotifyCenter] Destruction of the end
16:42:24:579  WARN 37740 --- [Thread-18] c.a.n.common.http.HttpClientBeanHolder   : [HttpClientBeanHolder] Destruction of the end
16:42:24:631  INFO 37740 --- [SpringApplicationShutdownHook] c.a.c.n.registry.NacosServiceRegistry    : De-registering from Nacos Server now...
16:42:24:643  INFO 37740 --- [SpringApplicationShutdownHook] c.a.c.n.registry.NacosServiceRegistry    : De-registration finished.
16:42:24:660  INFO 37740 --- [SpringApplicationShutdownHook] com.zaxxer.hikari.HikariDataSource       : HikariPool-1 - Shutdown initiated...
16:42:24:970  INFO 37740 --- [SpringApplicationShutdownHook] com.zaxxer.hikari.HikariDataSource       : HikariPool-1 - Shutdown completed.
16:42:30:802  INFO 35860 --- [main] c.l.his_service.HisServiceApplication    : Starting HisServiceApplication using Java 17.0.11 on luo with PID 35860 (A:\Desktop\workspace\HIS\his_service\target\classes started by 22407 in A:\Desktop\workspace\HIS)
16:42:30:803 DEBUG 35860 --- [main] c.l.his_service.HisServiceApplication    : Running with Spring Boot v2.7.12, Spring v5.3.27
16:42:30:804  INFO 35860 --- [main] c.l.his_service.HisServiceApplication    : The following 1 profile is active: "dev"
16:42:32:361  INFO 35860 --- [main] .s.d.r.c.RepositoryConfigurationDelegate : Multiple Spring Data modules found, entering strict repository configuration mode
16:42:32:364  INFO 35860 --- [main] .s.d.r.c.RepositoryConfigurationDelegate : Bootstrapping Spring Data Redis repositories in DEFAULT mode.
16:42:32:426  INFO 35860 --- [main] .s.d.r.c.RepositoryConfigurationDelegate : Finished Spring Data repository scanning in 38 ms. Found 0 Redis repository interfaces.
16:42:32:854  INFO 35860 --- [main] o.s.cloud.context.scope.GenericScope     : BeanFactory id=ac61872e-faec-371d-922e-ad941e5407d7
16:42:34:914  INFO 35860 --- [main] o.s.b.w.embedded.tomcat.TomcatWebServer  : Tomcat initialized with port(s): 8080 (http)
16:42:34:945  INFO 35860 --- [main] o.apache.catalina.core.StandardService   : Starting service [Tomcat]
16:42:34:945  INFO 35860 --- [main] org.apache.catalina.core.StandardEngine  : Starting Servlet engine: [Apache Tomcat/9.0.75]
16:42:35:229  INFO 35860 --- [main] o.a.c.c.C.[Tomcat].[localhost].[/]       : Initializing Spring embedded WebApplicationContext
16:42:35:229  INFO 35860 --- [main] w.s.c.ServletWebServerApplicationContext : Root WebApplicationContext: initialization completed in 4347 ms
16:42:35:530  INFO 35860 --- [main] org.redisson.Version                     : Redisson 3.17.7
16:42:36:339  INFO 35860 --- [redisson-netty-2-9] o.r.c.pool.MasterPubSubConnectionPool    : 1 connections initialized for 111.230.32.147/111.230.32.147:9631
16:42:37:111  INFO 35860 --- [redisson-netty-2-19] o.r.c.pool.MasterConnectionPool          : 24 connections initialized for 111.230.32.147/111.230.32.147:9631
16:42:38:048 DEBUG 35860 --- [main] c.l.h.filter.RefreshTokenFilter          : Filter 'refreshTokenFilter' configured for use
16:42:39:795  INFO 35860 --- [main] o.s.c.openfeign.FeignClientFactoryBean   : For 'flask-service' URL not provided. Will try picking an instance via load-balancing.
16:42:40:037  INFO 35860 --- [main] o.s.c.openfeign.FeignClientFactoryBean   : For 'ai-service' URL not provided. Will try picking an instance via load-balancing.
16:42:40:091  WARN 35860 --- [main] c.b.m.core.metadata.TableInfoHelper      : Can not find table primary key in Class: "java.lang.Object".
16:42:40:091  WARN 35860 --- [main] c.b.m.core.injector.DefaultSqlInjector   : class java.lang.Object ,Not found @TableId annotation, Cannot use Mybatis-Plus 'xxById' Method.
16:42:43:352  WARN 35860 --- [main] iguration$LoadBalancerCaffeineWarnLogger : Spring Cloud LoadBalancer is currently working with the default cache. While this cache implementation is useful for development and tests, it's recommended to use Caffeine cache in production.You can switch to using Caffeine cache, by adding it and org.springframework.cache.caffeine.CaffeineCacheManager to the classpath.
16:42:43:361  INFO 35860 --- [main] o.s.b.a.e.web.EndpointLinksResolver      : Exposing 1 endpoint(s) beneath base path '/actuator'
16:42:43:555  INFO 35860 --- [main] o.s.b.w.embedded.tomcat.TomcatWebServer  : Tomcat started on port(s): 8080 (http) with context path ''
16:42:43:730  INFO 35860 --- [main] c.a.n.p.a.s.c.ClientAuthPluginManager    : [ClientAuthPluginManager] Load ClientAuthService com.alibaba.nacos.client.auth.impl.NacosClientAuthServiceImpl success.
16:42:43:731  INFO 35860 --- [main] c.a.n.p.a.s.c.ClientAuthPluginManager    : [ClientAuthPluginManager] Load ClientAuthService com.alibaba.nacos.client.auth.ram.RamClientAuthServiceImpl success.
16:42:58:204 ERROR 35860 --- [main] c.a.c.n.registry.NacosServiceRegistry    : nacos registry, his-service register failed...NacosRegistration{nacosDiscoveryProperties=NacosDiscoveryProperties{serverAddr='81.71.3.20', username='', password='', endpoint='', namespace='', watchDelay=30000, logName='', service='his-service', weight=1.0, clusterName='DEFAULT', group='DEFAULT_GROUP', namingLoadCacheAtStart='false', metadata={IPv6=null, preserved.register.source=SPRING_CLOUD}, registerEnabled=true, ip='10.21.93.70', networkInterface='', port=8848, secure=false, accessKey='', secretKey='', heartBeatInterval=null, heartBeatTimeout=null, ipDeleteTimeout=null, instanceEnabled=true, ephemeral=true, failureToleranceEnabled=false}, ipDeleteTimeout=null, failFast=true}},

com.alibaba.nacos.api.exception.NacosException: Client not connected, current status:STARTING
	at com.alibaba.nacos.common.remote.client.RpcClient.request(RpcClient.java:647) ~[nacos-client-2.3.0.jar:na]
	at com.alibaba.nacos.common.remote.client.RpcClient.request(RpcClient.java:626) ~[nacos-client-2.3.0.jar:na]
	at com.alibaba.nacos.client.naming.remote.gprc.NamingGrpcClientProxy.requestToServer(NamingGrpcClientProxy.java:450) ~[nacos-client-2.3.0.jar:na]
	at com.alibaba.nacos.client.naming.remote.gprc.NamingGrpcClientProxy.doRegisterService(NamingGrpcClientProxy.java:249) ~[nacos-client-2.3.0.jar:na]
	at com.alibaba.nacos.client.naming.remote.gprc.NamingGrpcClientProxy.registerServiceForEphemeral(NamingGrpcClientProxy.java:144) ~[nacos-client-2.3.0.jar:na]
	at com.alibaba.nacos.client.naming.remote.gprc.NamingGrpcClientProxy.registerService(NamingGrpcClientProxy.java:136) ~[nacos-client-2.3.0.jar:na]
	at com.alibaba.nacos.client.naming.remote.NamingClientProxyDelegate.registerService(NamingClientProxyDelegate.java:98) ~[nacos-client-2.3.0.jar:na]
	at com.alibaba.nacos.client.naming.NacosNamingService.registerInstance(NacosNamingService.java:146) ~[nacos-client-2.3.0.jar:na]
	at com.alibaba.cloud.nacos.registry.NacosServiceRegistry.register(NacosServiceRegistry.java:75) ~[spring-cloud-starter-alibaba-nacos-discovery-2021.0.5.0.jar:2021.0.5.0]
	at org.springframework.cloud.client.serviceregistry.AbstractAutoServiceRegistration.register(AbstractAutoServiceRegistration.java:232) ~[spring-cloud-commons-3.1.5.jar:3.1.5]
	at com.alibaba.cloud.nacos.registry.NacosAutoServiceRegistration.register(NacosAutoServiceRegistration.java:78) ~[spring-cloud-starter-alibaba-nacos-discovery-2021.0.5.0.jar:2021.0.5.0]
	at org.springframework.cloud.client.serviceregistry.AbstractAutoServiceRegistration.start(AbstractAutoServiceRegistration.java:133) ~[spring-cloud-commons-3.1.5.jar:3.1.5]
	at org.springframework.cloud.client.serviceregistry.AbstractAutoServiceRegistration.bind(AbstractAutoServiceRegistration.java:98) ~[spring-cloud-commons-3.1.5.jar:3.1.5]
	at org.springframework.cloud.client.serviceregistry.AbstractAutoServiceRegistration.onApplicationEvent(AbstractAutoServiceRegistration.java:86) ~[spring-cloud-commons-3.1.5.jar:3.1.5]
	at org.springframework.cloud.client.serviceregistry.AbstractAutoServiceRegistration.onApplicationEvent(AbstractAutoServiceRegistration.java:47) ~[spring-cloud-commons-3.1.5.jar:3.1.5]
	at org.springframework.context.event.SimpleApplicationEventMulticaster.doInvokeListener(SimpleApplicationEventMulticaster.java:176) ~[spring-context-5.3.27.jar:5.3.27]
	at org.springframework.context.event.SimpleApplicationEventMulticaster.invokeListener(SimpleApplicationEventMulticaster.java:169) ~[spring-context-5.3.27.jar:5.3.27]
	at org.springframework.context.event.SimpleApplicationEventMulticaster.multicastEvent(SimpleApplicationEventMulticaster.java:143) ~[spring-context-5.3.27.jar:5.3.27]
	at org.springframework.context.support.AbstractApplicationContext.publishEvent(AbstractApplicationContext.java:421) ~[spring-context-5.3.27.jar:5.3.27]
	at org.springframework.context.support.AbstractApplicationContext.publishEvent(AbstractApplicationContext.java:378) ~[spring-context-5.3.27.jar:5.3.27]
	at org.springframework.boot.web.servlet.context.WebServerStartStopLifecycle.start(WebServerStartStopLifecycle.java:46) ~[spring-boot-2.7.12.jar:2.7.12]
	at org.springframework.context.support.DefaultLifecycleProcessor.doStart(DefaultLifecycleProcessor.java:178) ~[spring-context-5.3.27.jar:5.3.27]
	at org.springframework.context.support.DefaultLifecycleProcessor.access$200(DefaultLifecycleProcessor.java:54) ~[spring-context-5.3.27.jar:5.3.27]
	at org.springframework.context.support.DefaultLifecycleProcessor$LifecycleGroup.start(DefaultLifecycleProcessor.java:356) ~[spring-context-5.3.27.jar:5.3.27]
	at java.base/java.lang.Iterable.forEach(Iterable.java:75) ~[na:na]
	at org.springframework.context.support.DefaultLifecycleProcessor.startBeans(DefaultLifecycleProcessor.java:155) ~[spring-context-5.3.27.jar:5.3.27]
	at org.springframework.context.support.DefaultLifecycleProcessor.onRefresh(DefaultLifecycleProcessor.java:123) ~[spring-context-5.3.27.jar:5.3.27]
	at org.springframework.context.support.AbstractApplicationContext.finishRefresh(AbstractApplicationContext.java:937) ~[spring-context-5.3.27.jar:5.3.27]
	at org.springframework.context.support.AbstractApplicationContext.refresh(AbstractApplicationContext.java:586) ~[spring-context-5.3.27.jar:5.3.27]
	at org.springframework.boot.web.servlet.context.ServletWebServerApplicationContext.refresh(ServletWebServerApplicationContext.java:147) ~[spring-boot-2.7.12.jar:2.7.12]
	at org.springframework.boot.SpringApplication.refresh(SpringApplication.java:731) ~[spring-boot-2.7.12.jar:2.7.12]
	at org.springframework.boot.SpringApplication.refreshContext(SpringApplication.java:408) ~[spring-boot-2.7.12.jar:2.7.12]
	at org.springframework.boot.SpringApplication.run(SpringApplication.java:307) ~[spring-boot-2.7.12.jar:2.7.12]
	at org.springframework.boot.SpringApplication.run(SpringApplication.java:1303) ~[spring-boot-2.7.12.jar:2.7.12]
	at org.springframework.boot.SpringApplication.run(SpringApplication.java:1292) ~[spring-boot-2.7.12.jar:2.7.12]
	at com.luojiawei.his_service.HisServiceApplication.main(HisServiceApplication.java:19) ~[classes/:na]

16:42:58:206  WARN 35860 --- [main] ConfigServletWebServerApplicationContext : Exception encountered during context initialization - cancelling refresh attempt: org.springframework.context.ApplicationContextException: Failed to start bean 'webServerStartStop'; nested exception is java.lang.reflect.UndeclaredThrowableException
16:42:58:359  INFO 35860 --- [main] o.apache.catalina.core.StandardService   : Stopping service [Tomcat]
16:42:58:366  WARN 35860 --- [main] o.a.c.loader.WebappClassLoaderBase       : The web application [ROOT] appears to have started a thread named [Thread-8] but has failed to stop it. This is very likely to create a memory leak. Stack trace of thread:
 java.base@17.0.11/sun.net.dns.ResolverConfigurationImpl.notifyAddrChange0(Native Method)
 java.base@17.0.11/sun.net.dns.ResolverConfigurationImpl$AddressChangeListener.run(ResolverConfigurationImpl.java:176)
16:42:58:394  INFO 35860 --- [main] ConditionEvaluationReportLoggingListener : 

Error starting ApplicationContext. To display the conditions report re-run your application with 'debug' enabled.
16:42:58:511 ERROR 35860 --- [main] o.s.boot.SpringApplication               : Application run failed

org.springframework.context.ApplicationContextException: Failed to start bean 'webServerStartStop'; nested exception is java.lang.reflect.UndeclaredThrowableException
	at org.springframework.context.support.DefaultLifecycleProcessor.doStart(DefaultLifecycleProcessor.java:181) ~[spring-context-5.3.27.jar:5.3.27]
	at org.springframework.context.support.DefaultLifecycleProcessor.access$200(DefaultLifecycleProcessor.java:54) ~[spring-context-5.3.27.jar:5.3.27]
	at org.springframework.context.support.DefaultLifecycleProcessor$LifecycleGroup.start(DefaultLifecycleProcessor.java:356) ~[spring-context-5.3.27.jar:5.3.27]
	at java.base/java.lang.Iterable.forEach(Iterable.java:75) ~[na:na]
	at org.springframework.context.support.DefaultLifecycleProcessor.startBeans(DefaultLifecycleProcessor.java:155) ~[spring-context-5.3.27.jar:5.3.27]
	at org.springframework.context.support.DefaultLifecycleProcessor.onRefresh(DefaultLifecycleProcessor.java:123) ~[spring-context-5.3.27.jar:5.3.27]
	at org.springframework.context.support.AbstractApplicationContext.finishRefresh(AbstractApplicationContext.java:937) ~[spring-context-5.3.27.jar:5.3.27]
	at org.springframework.context.support.AbstractApplicationContext.refresh(AbstractApplicationContext.java:586) ~[spring-context-5.3.27.jar:5.3.27]
	at org.springframework.boot.web.servlet.context.ServletWebServerApplicationContext.refresh(ServletWebServerApplicationContext.java:147) ~[spring-boot-2.7.12.jar:2.7.12]
	at org.springframework.boot.SpringApplication.refresh(SpringApplication.java:731) ~[spring-boot-2.7.12.jar:2.7.12]
	at org.springframework.boot.SpringApplication.refreshContext(SpringApplication.java:408) ~[spring-boot-2.7.12.jar:2.7.12]
	at org.springframework.boot.SpringApplication.run(SpringApplication.java:307) ~[spring-boot-2.7.12.jar:2.7.12]
	at org.springframework.boot.SpringApplication.run(SpringApplication.java:1303) ~[spring-boot-2.7.12.jar:2.7.12]
	at org.springframework.boot.SpringApplication.run(SpringApplication.java:1292) ~[spring-boot-2.7.12.jar:2.7.12]
	at com.luojiawei.his_service.HisServiceApplication.main(HisServiceApplication.java:19) ~[classes/:na]
Caused by: java.lang.reflect.UndeclaredThrowableException: null
	at org.springframework.util.ReflectionUtils.rethrowRuntimeException(ReflectionUtils.java:147) ~[spring-core-5.3.27.jar:5.3.27]
	at com.alibaba.cloud.nacos.registry.NacosServiceRegistry.register(NacosServiceRegistry.java:83) ~[spring-cloud-starter-alibaba-nacos-discovery-2021.0.5.0.jar:2021.0.5.0]
	at org.springframework.cloud.client.serviceregistry.AbstractAutoServiceRegistration.register(AbstractAutoServiceRegistration.java:232) ~[spring-cloud-commons-3.1.5.jar:3.1.5]
	at com.alibaba.cloud.nacos.registry.NacosAutoServiceRegistration.register(NacosAutoServiceRegistration.java:78) ~[spring-cloud-starter-alibaba-nacos-discovery-2021.0.5.0.jar:2021.0.5.0]
	at org.springframework.cloud.client.serviceregistry.AbstractAutoServiceRegistration.start(AbstractAutoServiceRegistration.java:133) ~[spring-cloud-commons-3.1.5.jar:3.1.5]
	at org.springframework.cloud.client.serviceregistry.AbstractAutoServiceRegistration.bind(AbstractAutoServiceRegistration.java:98) ~[spring-cloud-commons-3.1.5.jar:3.1.5]
	at org.springframework.cloud.client.serviceregistry.AbstractAutoServiceRegistration.onApplicationEvent(AbstractAutoServiceRegistration.java:86) ~[spring-cloud-commons-3.1.5.jar:3.1.5]
	at org.springframework.cloud.client.serviceregistry.AbstractAutoServiceRegistration.onApplicationEvent(AbstractAutoServiceRegistration.java:47) ~[spring-cloud-commons-3.1.5.jar:3.1.5]
	at org.springframework.context.event.SimpleApplicationEventMulticaster.doInvokeListener(SimpleApplicationEventMulticaster.java:176) ~[spring-context-5.3.27.jar:5.3.27]
	at org.springframework.context.event.SimpleApplicationEventMulticaster.invokeListener(SimpleApplicationEventMulticaster.java:169) ~[spring-context-5.3.27.jar:5.3.27]
	at org.springframework.context.event.SimpleApplicationEventMulticaster.multicastEvent(SimpleApplicationEventMulticaster.java:143) ~[spring-context-5.3.27.jar:5.3.27]
	at org.springframework.context.support.AbstractApplicationContext.publishEvent(AbstractApplicationContext.java:421) ~[spring-context-5.3.27.jar:5.3.27]
	at org.springframework.context.support.AbstractApplicationContext.publishEvent(AbstractApplicationContext.java:378) ~[spring-context-5.3.27.jar:5.3.27]
	at org.springframework.boot.web.servlet.context.WebServerStartStopLifecycle.start(WebServerStartStopLifecycle.java:46) ~[spring-boot-2.7.12.jar:2.7.12]
	at org.springframework.context.support.DefaultLifecycleProcessor.doStart(DefaultLifecycleProcessor.java:178) ~[spring-context-5.3.27.jar:5.3.27]
	... 14 common frames omitted
Caused by: com.alibaba.nacos.api.exception.NacosException: Client not connected, current status:STARTING
	at com.alibaba.nacos.common.remote.client.RpcClient.request(RpcClient.java:647) ~[nacos-client-2.3.0.jar:na]
	at com.alibaba.nacos.common.remote.client.RpcClient.request(RpcClient.java:626) ~[nacos-client-2.3.0.jar:na]
	at com.alibaba.nacos.client.naming.remote.gprc.NamingGrpcClientProxy.requestToServer(NamingGrpcClientProxy.java:450) ~[nacos-client-2.3.0.jar:na]
	at com.alibaba.nacos.client.naming.remote.gprc.NamingGrpcClientProxy.doRegisterService(NamingGrpcClientProxy.java:249) ~[nacos-client-2.3.0.jar:na]
	at com.alibaba.nacos.client.naming.remote.gprc.NamingGrpcClientProxy.registerServiceForEphemeral(NamingGrpcClientProxy.java:144) ~[nacos-client-2.3.0.jar:na]
	at com.alibaba.nacos.client.naming.remote.gprc.NamingGrpcClientProxy.registerService(NamingGrpcClientProxy.java:136) ~[nacos-client-2.3.0.jar:na]
	at com.alibaba.nacos.client.naming.remote.NamingClientProxyDelegate.registerService(NamingClientProxyDelegate.java:98) ~[nacos-client-2.3.0.jar:na]
	at com.alibaba.nacos.client.naming.NacosNamingService.registerInstance(NacosNamingService.java:146) ~[nacos-client-2.3.0.jar:na]
	at com.alibaba.cloud.nacos.registry.NacosServiceRegistry.register(NacosServiceRegistry.java:75) ~[spring-cloud-starter-alibaba-nacos-discovery-2021.0.5.0.jar:2021.0.5.0]
	... 27 common frames omitted

16:42:59:249  WARN 35860 --- [Thread-18] c.a.n.common.http.HttpClientBeanHolder   : [HttpClientBeanHolder] Start destroying common HttpClient
16:42:59:249  WARN 35860 --- [Thread-15] c.a.nacos.common.notify.NotifyCenter     : [NotifyCenter] Start destroying Publisher
16:42:59:249  WARN 35860 --- [Thread-15] c.a.nacos.common.notify.NotifyCenter     : [NotifyCenter] Destruction of the end
16:44:26:519  INFO 4556 --- [main] c.l.his_service.HisServiceApplication    : Starting HisServiceApplication using Java 17.0.11 on luo with PID 4556 (A:\Desktop\workspace\HIS\his_service\target\classes started by 22407 in A:\Desktop\workspace\HIS)
16:44:26:520 DEBUG 4556 --- [main] c.l.his_service.HisServiceApplication    : Running with Spring Boot v2.7.12, Spring v5.3.27
16:44:26:521  INFO 4556 --- [main] c.l.his_service.HisServiceApplication    : The following 1 profile is active: "dev"
16:44:27:619  INFO 4556 --- [main] .s.d.r.c.RepositoryConfigurationDelegate : Multiple Spring Data modules found, entering strict repository configuration mode
16:44:27:622  INFO 4556 --- [main] .s.d.r.c.RepositoryConfigurationDelegate : Bootstrapping Spring Data Redis repositories in DEFAULT mode.
16:44:27:665  INFO 4556 --- [main] .s.d.r.c.RepositoryConfigurationDelegate : Finished Spring Data repository scanning in 20 ms. Found 0 Redis repository interfaces.
16:44:27:977  INFO 4556 --- [main] o.s.cloud.context.scope.GenericScope     : BeanFactory id=ac61872e-faec-371d-922e-ad941e5407d7
16:44:28:646  INFO 4556 --- [main] o.s.b.w.embedded.tomcat.TomcatWebServer  : Tomcat initialized with port(s): 8080 (http)
16:44:28:656  INFO 4556 --- [main] o.apache.catalina.core.StandardService   : Starting service [Tomcat]
16:44:28:657  INFO 4556 --- [main] org.apache.catalina.core.StandardEngine  : Starting Servlet engine: [Apache Tomcat/9.0.75]
16:44:28:809  INFO 4556 --- [main] o.a.c.c.C.[Tomcat].[localhost].[/]       : Initializing Spring embedded WebApplicationContext
16:44:28:810  INFO 4556 --- [main] w.s.c.ServletWebServerApplicationContext : Root WebApplicationContext: initialization completed in 2241 ms
16:44:29:051  INFO 4556 --- [main] org.redisson.Version                     : Redisson 3.17.7
16:44:29:443  INFO 4556 --- [redisson-netty-2-9] o.r.c.pool.MasterPubSubConnectionPool    : 1 connections initialized for 111.230.32.147/111.230.32.147:9631
16:44:30:128  INFO 4556 --- [redisson-netty-2-19] o.r.c.pool.MasterConnectionPool          : 24 connections initialized for 111.230.32.147/111.230.32.147:9631
16:44:30:449 DEBUG 4556 --- [main] c.l.h.filter.RefreshTokenFilter          : Filter 'refreshTokenFilter' configured for use
16:44:31:210  INFO 4556 --- [main] o.s.c.openfeign.FeignClientFactoryBean   : For 'flask-service' URL not provided. Will try picking an instance via load-balancing.
16:44:31:347  INFO 4556 --- [main] o.s.c.openfeign.FeignClientFactoryBean   : For 'ai-service' URL not provided. Will try picking an instance via load-balancing.
16:44:31:396  WARN 4556 --- [main] c.b.m.core.metadata.TableInfoHelper      : Can not find table primary key in Class: "java.lang.Object".
16:44:31:396  WARN 4556 --- [main] c.b.m.core.injector.DefaultSqlInjector   : class java.lang.Object ,Not found @TableId annotation, Cannot use Mybatis-Plus 'xxById' Method.
16:44:33:090  WARN 4556 --- [main] iguration$LoadBalancerCaffeineWarnLogger : Spring Cloud LoadBalancer is currently working with the default cache. While this cache implementation is useful for development and tests, it's recommended to use Caffeine cache in production.You can switch to using Caffeine cache, by adding it and org.springframework.cache.caffeine.CaffeineCacheManager to the classpath.
16:44:33:097  INFO 4556 --- [main] o.s.b.a.e.web.EndpointLinksResolver      : Exposing 1 endpoint(s) beneath base path '/actuator'
16:44:33:178  INFO 4556 --- [main] o.s.b.w.embedded.tomcat.TomcatWebServer  : Tomcat started on port(s): 8080 (http) with context path ''
16:44:33:218  INFO 4556 --- [main] c.a.n.p.a.s.c.ClientAuthPluginManager    : [ClientAuthPluginManager] Load ClientAuthService com.alibaba.nacos.client.auth.impl.NacosClientAuthServiceImpl success.
16:44:33:218  INFO 4556 --- [main] c.a.n.p.a.s.c.ClientAuthPluginManager    : [ClientAuthPluginManager] Load ClientAuthService com.alibaba.nacos.client.auth.ram.RamClientAuthServiceImpl success.
16:44:34:374  INFO 4556 --- [main] c.a.n.c.a.AbstractAbilityControlManager  : Ready to get current node abilities...
16:44:34:376  INFO 4556 --- [main] c.a.n.c.a.AbstractAbilityControlManager  : Ready to initialize current node abilities, support modes: [SDK_CLIENT]
16:44:34:377  INFO 4556 --- [main] c.a.n.c.a.AbstractAbilityControlManager  : Initialize current abilities finish...
16:44:34:377  INFO 4556 --- [main] c.a.n.c.a.d.NacosAbilityManagerHolder    : [AbilityControlManager] Successfully initialize AbilityControlManager
16:44:34:507  INFO 4556 --- [main] c.a.c.n.registry.NacosServiceRegistry    : nacos registry, DEFAULT_GROUP his-service 10.21.93.70:8848 register finished
16:44:34:850  INFO 4556 --- [main] c.l.his_service.HisServiceApplication    : Started HisServiceApplication in 9.334 seconds (JVM running for 10.48)
16:44:35:389  INFO 4556 --- [RMI TCP Connection(4)-10.21.93.70] o.a.c.c.C.[Tomcat].[localhost].[/]       : Initializing Spring DispatcherServlet 'dispatcherServlet'
16:44:35:390  INFO 4556 --- [RMI TCP Connection(4)-10.21.93.70] o.s.web.servlet.DispatcherServlet        : Initializing Servlet 'dispatcherServlet'
16:44:35:391  INFO 4556 --- [RMI TCP Connection(5)-10.21.93.70] com.zaxxer.hikari.HikariDataSource       : HikariPool-1 - Starting...
16:44:35:392  INFO 4556 --- [RMI TCP Connection(4)-10.21.93.70] o.s.web.servlet.DispatcherServlet        : Completed initialization in 2 ms
16:44:36:273  INFO 4556 --- [RMI TCP Connection(5)-10.21.93.70] com.zaxxer.hikari.HikariDataSource       : HikariPool-1 - Start completed.
16:45:00:196 DEBUG 4556 --- [http-nio-8080-exec-2] c.l.h.m.D.selectById                     : ==>  Preparing: SELECT id,patient_id,doctor_id,disease_name,disease_category,aimodel_id,result,create_time,status,id_card,name,score,remark FROM diagnosis_report WHERE id=?
16:45:00:239 DEBUG 4556 --- [http-nio-8080-exec-2] c.l.h.m.D.selectById                     : ==> Parameters: 1(Integer)
16:45:00:333 DEBUG 4556 --- [http-nio-8080-exec-2] c.l.h.m.D.selectById                     : <==      Total: 1
16:45:00:336 DEBUG 4556 --- [http-nio-8080-exec-2] c.l.h.mapper.PatientMapper.selectById    : ==>  Preparing: SELECT id,phone,id_card,name,verified,verified_by,verified_time,open_id,hospital_pid FROM patient WHERE id=?
16:45:00:337 DEBUG 4556 --- [http-nio-8080-exec-2] c.l.h.mapper.PatientMapper.selectById    : ==> Parameters: 1(Integer)
16:45:00:368 DEBUG 4556 --- [http-nio-8080-exec-2] c.l.h.mapper.PatientMapper.selectById    : <==      Total: 1
16:45:00:373 DEBUG 4556 --- [http-nio-8080-exec-2] c.l.h.mapper.DoctorMapper.selectById     : ==>  Preparing: SELECT id,phone,id_card,name,verified,verified_by,verified_time,license,department,hospital_pid FROM doctor WHERE id=?
16:45:00:374 DEBUG 4556 --- [http-nio-8080-exec-2] c.l.h.mapper.DoctorMapper.selectById     : ==> Parameters: 1(Integer)
16:45:00:407 DEBUG 4556 --- [http-nio-8080-exec-2] c.l.h.mapper.DoctorMapper.selectById     : <==      Total: 1
16:45:00:413 DEBUG 4556 --- [http-nio-8080-exec-2] c.l.h.m.E.selectListByDiagnosisId        : ==>  Preparing: select * from eye_images where dignosis_report_id = ?
16:45:00:414 DEBUG 4556 --- [http-nio-8080-exec-2] c.l.h.m.E.selectListByDiagnosisId        : ==> Parameters: 1(Integer)
16:45:00:444 DEBUG 4556 --- [http-nio-8080-exec-2] c.l.h.m.E.selectListByDiagnosisId        : <==      Total: 1
16:45:00:445 DEBUG 4556 --- [http-nio-8080-exec-2] c.l.h.m.T.selectByDiagnosisId            : ==>  Preparing: select * from treatment_plans where diagnosis_id = ?
16:45:00:445 DEBUG 4556 --- [http-nio-8080-exec-2] c.l.h.m.T.selectByDiagnosisId            : ==> Parameters: 1(Integer)
16:45:00:477 DEBUG 4556 --- [http-nio-8080-exec-2] c.l.h.m.T.selectByDiagnosisId            : <==      Total: 1
16:45:00:478 DEBUG 4556 --- [http-nio-8080-exec-2] c.l.h.m.M.selectByDiagnosisId            : ==>  Preparing: select * from medication_recommendations where diagnosis_id = ?
16:45:00:479 DEBUG 4556 --- [http-nio-8080-exec-2] c.l.h.m.M.selectByDiagnosisId            : ==> Parameters: 1(Integer)
16:45:00:512 DEBUG 4556 --- [http-nio-8080-exec-2] c.l.h.m.M.selectByDiagnosisId            : <==      Total: 1
16:45:00:513 DEBUG 4556 --- [http-nio-8080-exec-2] c.l.h.mapper.AiModelMapper.selectById    : ==>  Preparing: SELECT id,version,deploy_time,accuracy FROM ai_model WHERE id=?
16:45:00:513 DEBUG 4556 --- [http-nio-8080-exec-2] c.l.h.mapper.AiModelMapper.selectById    : ==> Parameters: 1(Integer)
16:45:00:548 DEBUG 4556 --- [http-nio-8080-exec-2] c.l.h.mapper.AiModelMapper.selectById    : <==      Total: 1
16:45:00:612 DEBUG 4556 --- [http-nio-8080-exec-2] c.l.api.client.FlaskAiDoctorClient       : [FlaskAiDoctorClient#uploadFile] ---> POST http://ai-service/api/chat/completions HTTP/1.1
16:45:00:613 DEBUG 4556 --- [http-nio-8080-exec-2] c.l.api.client.FlaskAiDoctorClient       : [FlaskAiDoctorClient#uploadFile] Content-Length: 726
16:45:00:613 DEBUG 4556 --- [http-nio-8080-exec-2] c.l.api.client.FlaskAiDoctorClient       : [FlaskAiDoctorClient#uploadFile] Content-Type: application/json
16:45:00:613 DEBUG 4556 --- [http-nio-8080-exec-2] c.l.api.client.FlaskAiDoctorClient       : [FlaskAiDoctorClient#uploadFile] 
16:45:00:613 DEBUG 4556 --- [http-nio-8080-exec-2] c.l.api.client.FlaskAiDoctorClient       : [FlaskAiDoctorClient#uploadFile] {"diagnosis_name":"","diagnosis_category":"","result":"A","remark":"A","treatment_plan":{"id":1,"treatmentType":1,"treatmentDetail":"","startTime":"2025-03-01 09:00:00","endDate":"2025-03-10 09:00:00","doctorId":1,"createdTime":[2025,3,1,9,0],"updatedTime":[2025,3,1,9,0]},"medications":[{"id":1,"diagnosisId":1,"medicationName":"A","dosage":"10mg","frequency":"","sideEffects":"","startTime":[2025,3,1,9,0],"endTime":[2025,3,10,9,0],"doctorId":1,"createdTime":"2025-03-01 09:00:00","updatedTime":"2025-03-01 09:00:00"}],"previous_conversations":[{"role":"pariatur tempor do","content":"sit cupidatat commodo"}],"question":"irure eu esse","stream":false}
16:45:00:614 DEBUG 4556 --- [http-nio-8080-exec-2] c.l.api.client.FlaskAiDoctorClient       : [FlaskAiDoctorClient#uploadFile] ---> END HTTP (726-byte body)
16:45:02:877 DEBUG 4556 --- [http-nio-8080-exec-2] c.l.api.client.FlaskAiDoctorClient       : [FlaskAiDoctorClient#uploadFile] <--- ERROR ConnectException: Connection refused: getsockopt (2263ms)
16:45:02:878 DEBUG 4556 --- [http-nio-8080-exec-2] c.l.api.client.FlaskAiDoctorClient       : [FlaskAiDoctorClient#uploadFile] java.net.ConnectException: Connection refused: getsockopt
	at java.base/sun.nio.ch.Net.pollConnect(Native Method)
	at java.base/sun.nio.ch.Net.pollConnectNow(Net.java:672)
	at java.base/sun.nio.ch.NioSocketImpl.timedFinishConnect(NioSocketImpl.java:554)
	at java.base/sun.nio.ch.NioSocketImpl.connect(NioSocketImpl.java:602)
	at java.base/java.net.Socket.connect(Socket.java:633)
	at java.base/sun.net.NetworkClient.doConnect(NetworkClient.java:178)
	at java.base/sun.net.www.http.HttpClient.openServer(HttpClient.java:533)
	at java.base/sun.net.www.http.HttpClient.openServer(HttpClient.java:638)
	at java.base/sun.net.www.http.HttpClient.<init>(HttpClient.java:281)
	at java.base/sun.net.www.http.HttpClient.New(HttpClient.java:386)
	at java.base/sun.net.www.http.HttpClient.New(HttpClient.java:408)
	at java.base/sun.net.www.protocol.http.HttpURLConnection.getNewHttpClient(HttpURLConnection.java:1309)
	at java.base/sun.net.www.protocol.http.HttpURLConnection.plainConnect0(HttpURLConnection.java:1242)
	at java.base/sun.net.www.protocol.http.HttpURLConnection.plainConnect(HttpURLConnection.java:1128)
	at java.base/sun.net.www.protocol.http.HttpURLConnection.connect(HttpURLConnection.java:1057)
	at java.base/sun.net.www.protocol.http.HttpURLConnection.getOutputStream0(HttpURLConnection.java:1451)
	at java.base/sun.net.www.protocol.http.HttpURLConnection.getOutputStream(HttpURLConnection.java:1422)
	at feign.Client$Default.convertAndSend(Client.java:208)
	at feign.Client$Default.execute(Client.java:105)
	at org.springframework.cloud.openfeign.loadbalancer.LoadBalancerUtils.executeWithLoadBalancerLifecycleProcessing(LoadBalancerUtils.java:57)
	at org.springframework.cloud.openfeign.loadbalancer.LoadBalancerUtils.executeWithLoadBalancerLifecycleProcessing(LoadBalancerUtils.java:95)
	at org.springframework.cloud.openfeign.loadbalancer.FeignBlockingLoadBalancerClient.execute(FeignBlockingLoadBalancerClient.java:114)
	at feign.SynchronousMethodHandler.executeAndDecode(SynchronousMethodHandler.java:121)
	at feign.SynchronousMethodHandler.invoke(SynchronousMethodHandler.java:91)
	at feign.ReflectiveFeign$FeignInvocationHandler.invoke(ReflectiveFeign.java:100)
	at jdk.proxy2/jdk.proxy2.$Proxy135.uploadFile(Unknown Source)
	at com.luojiawei.his_service.controller.ChatController.ask(ChatController.java:38)
	at java.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at java.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:77)
	at java.base/jdk.internal.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.base/java.lang.reflect.Method.invoke(Method.java:568)
	at org.springframework.web.method.support.InvocableHandlerMethod.doInvoke(InvocableHandlerMethod.java:205)
	at org.springframework.web.method.support.InvocableHandlerMethod.invokeForRequest(InvocableHandlerMethod.java:150)
	at org.springframework.web.servlet.mvc.method.annotation.ServletInvocableHandlerMethod.invokeAndHandle(ServletInvocableHandlerMethod.java:117)
	at org.springframework.web.servlet.mvc.method.annotation.RequestMappingHandlerAdapter.invokeHandlerMethod(RequestMappingHandlerAdapter.java:895)
	at org.springframework.web.servlet.mvc.method.annotation.RequestMappingHandlerAdapter.handleInternal(RequestMappingHandlerAdapter.java:808)
	at org.springframework.web.servlet.mvc.method.AbstractHandlerMethodAdapter.handle(AbstractHandlerMethodAdapter.java:87)
	at org.springframework.web.servlet.DispatcherServlet.doDispatch(DispatcherServlet.java:1072)
	at org.springframework.web.servlet.DispatcherServlet.doService(DispatcherServlet.java:965)
	at org.springframework.web.servlet.FrameworkServlet.processRequest(FrameworkServlet.java:1006)
	at org.springframework.web.servlet.FrameworkServlet.doPost(FrameworkServlet.java:909)
	at javax.servlet.http.HttpServlet.service(HttpServlet.java:555)
	at org.springframework.web.servlet.FrameworkServlet.service(FrameworkServlet.java:883)
	at javax.servlet.http.HttpServlet.service(HttpServlet.java:623)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:209)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:153)
	at com.luojiawei.his_service.filter.RefreshTokenFilter.doFilterInternal(RefreshTokenFilter.java:58)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:117)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:178)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:153)
	at org.springframework.web.filter.RequestContextFilter.doFilterInternal(RequestContextFilter.java:100)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:117)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:178)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:153)
	at org.springframework.web.filter.FormContentFilter.doFilterInternal(FormContentFilter.java:93)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:117)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:178)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:153)
	at org.springframework.boot.actuate.metrics.web.servlet.WebMvcMetricsFilter.doFilterInternal(WebMvcMetricsFilter.java:96)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:117)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:178)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:153)
	at org.springframework.web.filter.CharacterEncodingFilter.doFilterInternal(CharacterEncodingFilter.java:201)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:117)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:178)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:153)
	at org.apache.catalina.core.StandardWrapperValve.invoke(StandardWrapperValve.java:167)
	at org.apache.catalina.core.StandardContextValve.invoke(StandardContextValve.java:90)
	at org.apache.catalina.authenticator.AuthenticatorBase.invoke(AuthenticatorBase.java:481)
	at org.apache.catalina.core.StandardHostValve.invoke(StandardHostValve.java:130)
	at org.apache.catalina.valves.ErrorReportValve.invoke(ErrorReportValve.java:93)
	at org.apache.catalina.core.StandardEngineValve.invoke(StandardEngineValve.java:74)
	at org.apache.catalina.connector.CoyoteAdapter.service(CoyoteAdapter.java:343)
	at org.apache.coyote.http11.Http11Processor.service(Http11Processor.java:390)
	at org.apache.coyote.AbstractProcessorLight.process(AbstractProcessorLight.java:63)
	at org.apache.coyote.AbstractProtocol$ConnectionHandler.process(AbstractProtocol.java:926)
	at org.apache.tomcat.util.net.NioEndpoint$SocketProcessor.doRun(NioEndpoint.java:1791)
	at org.apache.tomcat.util.net.SocketProcessorBase.run(SocketProcessorBase.java:52)
	at org.apache.tomcat.util.threads.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1191)
	at org.apache.tomcat.util.threads.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:659)
	at org.apache.tomcat.util.threads.TaskThread$WrappingRunnable.run(TaskThread.java:61)
	at java.base/java.lang.Thread.run(Thread.java:840)

16:45:02:879 DEBUG 4556 --- [http-nio-8080-exec-2] c.l.api.client.FlaskAiDoctorClient       : [FlaskAiDoctorClient#uploadFile] <--- END ERROR
16:45:02:904 ERROR 4556 --- [http-nio-8080-exec-2] o.a.c.c.C.[.[.[/].[dispatcherServlet]    : Servlet.service() for servlet [dispatcherServlet] in context with path [] threw exception [Request processing failed; nested exception is feign.RetryableException: Connection refused: getsockopt executing POST http://ai-service/api/chat/completions] with root cause

java.net.ConnectException: Connection refused: getsockopt
	at java.base/sun.nio.ch.Net.pollConnect(Native Method) ~[na:na]
	at java.base/sun.nio.ch.Net.pollConnectNow(Net.java:672) ~[na:na]
	at java.base/sun.nio.ch.NioSocketImpl.timedFinishConnect(NioSocketImpl.java:554) ~[na:na]
	at java.base/sun.nio.ch.NioSocketImpl.connect(NioSocketImpl.java:602) ~[na:na]
	at java.base/java.net.Socket.connect(Socket.java:633) ~[na:na]
	at java.base/sun.net.NetworkClient.doConnect(NetworkClient.java:178) ~[na:na]
	at java.base/sun.net.www.http.HttpClient.openServer(HttpClient.java:533) ~[na:na]
	at java.base/sun.net.www.http.HttpClient.openServer(HttpClient.java:638) ~[na:na]
	at java.base/sun.net.www.http.HttpClient.<init>(HttpClient.java:281) ~[na:na]
	at java.base/sun.net.www.http.HttpClient.New(HttpClient.java:386) ~[na:na]
	at java.base/sun.net.www.http.HttpClient.New(HttpClient.java:408) ~[na:na]
	at java.base/sun.net.www.protocol.http.HttpURLConnection.getNewHttpClient(HttpURLConnection.java:1309) ~[na:na]
	at java.base/sun.net.www.protocol.http.HttpURLConnection.plainConnect0(HttpURLConnection.java:1242) ~[na:na]
	at java.base/sun.net.www.protocol.http.HttpURLConnection.plainConnect(HttpURLConnection.java:1128) ~[na:na]
	at java.base/sun.net.www.protocol.http.HttpURLConnection.connect(HttpURLConnection.java:1057) ~[na:na]
	at java.base/sun.net.www.protocol.http.HttpURLConnection.getOutputStream0(HttpURLConnection.java:1451) ~[na:na]
	at java.base/sun.net.www.protocol.http.HttpURLConnection.getOutputStream(HttpURLConnection.java:1422) ~[na:na]
	at feign.Client$Default.convertAndSend(Client.java:208) ~[feign-core-11.10.jar:na]
	at feign.Client$Default.execute(Client.java:105) ~[feign-core-11.10.jar:na]
	at org.springframework.cloud.openfeign.loadbalancer.LoadBalancerUtils.executeWithLoadBalancerLifecycleProcessing(LoadBalancerUtils.java:57) ~[spring-cloud-openfeign-core-3.1.5.jar:3.1.5]
	at org.springframework.cloud.openfeign.loadbalancer.LoadBalancerUtils.executeWithLoadBalancerLifecycleProcessing(LoadBalancerUtils.java:95) ~[spring-cloud-openfeign-core-3.1.5.jar:3.1.5]
	at org.springframework.cloud.openfeign.loadbalancer.FeignBlockingLoadBalancerClient.execute(FeignBlockingLoadBalancerClient.java:114) ~[spring-cloud-openfeign-core-3.1.5.jar:3.1.5]
	at feign.SynchronousMethodHandler.executeAndDecode(SynchronousMethodHandler.java:121) ~[feign-core-11.10.jar:na]
	at feign.SynchronousMethodHandler.invoke(SynchronousMethodHandler.java:91) ~[feign-core-11.10.jar:na]
	at feign.ReflectiveFeign$FeignInvocationHandler.invoke(ReflectiveFeign.java:100) ~[feign-core-11.10.jar:na]
	at jdk.proxy2/jdk.proxy2.$Proxy135.uploadFile(Unknown Source) ~[na:na]
	at com.luojiawei.his_service.controller.ChatController.ask(ChatController.java:38) ~[classes/:na]
	at java.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke0(Native Method) ~[na:na]
	at java.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:77) ~[na:na]
	at java.base/jdk.internal.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43) ~[na:na]
	at java.base/java.lang.reflect.Method.invoke(Method.java:568) ~[na:na]
	at org.springframework.web.method.support.InvocableHandlerMethod.doInvoke(InvocableHandlerMethod.java:205) ~[spring-web-5.3.27.jar:5.3.27]
	at org.springframework.web.method.support.InvocableHandlerMethod.invokeForRequest(InvocableHandlerMethod.java:150) ~[spring-web-5.3.27.jar:5.3.27]
	at org.springframework.web.servlet.mvc.method.annotation.ServletInvocableHandlerMethod.invokeAndHandle(ServletInvocableHandlerMethod.java:117) ~[spring-webmvc-5.3.27.jar:5.3.27]
	at org.springframework.web.servlet.mvc.method.annotation.RequestMappingHandlerAdapter.invokeHandlerMethod(RequestMappingHandlerAdapter.java:895) ~[spring-webmvc-5.3.27.jar:5.3.27]
	at org.springframework.web.servlet.mvc.method.annotation.RequestMappingHandlerAdapter.handleInternal(RequestMappingHandlerAdapter.java:808) ~[spring-webmvc-5.3.27.jar:5.3.27]
	at org.springframework.web.servlet.mvc.method.AbstractHandlerMethodAdapter.handle(AbstractHandlerMethodAdapter.java:87) ~[spring-webmvc-5.3.27.jar:5.3.27]
	at org.springframework.web.servlet.DispatcherServlet.doDispatch(DispatcherServlet.java:1072) ~[spring-webmvc-5.3.27.jar:5.3.27]
	at org.springframework.web.servlet.DispatcherServlet.doService(DispatcherServlet.java:965) ~[spring-webmvc-5.3.27.jar:5.3.27]
	at org.springframework.web.servlet.FrameworkServlet.processRequest(FrameworkServlet.java:1006) ~[spring-webmvc-5.3.27.jar:5.3.27]
	at org.springframework.web.servlet.FrameworkServlet.doPost(FrameworkServlet.java:909) ~[spring-webmvc-5.3.27.jar:5.3.27]
	at javax.servlet.http.HttpServlet.service(HttpServlet.java:555) ~[tomcat-embed-core-9.0.75.jar:4.0.FR]
	at org.springframework.web.servlet.FrameworkServlet.service(FrameworkServlet.java:883) ~[spring-webmvc-5.3.27.jar:5.3.27]
	at javax.servlet.http.HttpServlet.service(HttpServlet.java:623) ~[tomcat-embed-core-9.0.75.jar:4.0.FR]
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:209) ~[tomcat-embed-core-9.0.75.jar:9.0.75]
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:153) ~[tomcat-embed-core-9.0.75.jar:9.0.75]
	at com.luojiawei.his_service.filter.RefreshTokenFilter.doFilterInternal(RefreshTokenFilter.java:58) ~[classes/:na]
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:117) ~[spring-web-5.3.27.jar:5.3.27]
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:178) ~[tomcat-embed-core-9.0.75.jar:9.0.75]
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:153) ~[tomcat-embed-core-9.0.75.jar:9.0.75]
	at org.springframework.web.filter.RequestContextFilter.doFilterInternal(RequestContextFilter.java:100) ~[spring-web-5.3.27.jar:5.3.27]
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:117) ~[spring-web-5.3.27.jar:5.3.27]
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:178) ~[tomcat-embed-core-9.0.75.jar:9.0.75]
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:153) ~[tomcat-embed-core-9.0.75.jar:9.0.75]
	at org.springframework.web.filter.FormContentFilter.doFilterInternal(FormContentFilter.java:93) ~[spring-web-5.3.27.jar:5.3.27]
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:117) ~[spring-web-5.3.27.jar:5.3.27]
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:178) ~[tomcat-embed-core-9.0.75.jar:9.0.75]
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:153) ~[tomcat-embed-core-9.0.75.jar:9.0.75]
	at org.springframework.boot.actuate.metrics.web.servlet.WebMvcMetricsFilter.doFilterInternal(WebMvcMetricsFilter.java:96) ~[spring-boot-actuator-2.7.12.jar:2.7.12]
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:117) ~[spring-web-5.3.27.jar:5.3.27]
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:178) ~[tomcat-embed-core-9.0.75.jar:9.0.75]
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:153) ~[tomcat-embed-core-9.0.75.jar:9.0.75]
	at org.springframework.web.filter.CharacterEncodingFilter.doFilterInternal(CharacterEncodingFilter.java:201) ~[spring-web-5.3.27.jar:5.3.27]
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:117) ~[spring-web-5.3.27.jar:5.3.27]
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:178) ~[tomcat-embed-core-9.0.75.jar:9.0.75]
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:153) ~[tomcat-embed-core-9.0.75.jar:9.0.75]
	at org.apache.catalina.core.StandardWrapperValve.invoke(StandardWrapperValve.java:167) ~[tomcat-embed-core-9.0.75.jar:9.0.75]
	at org.apache.catalina.core.StandardContextValve.invoke(StandardContextValve.java:90) ~[tomcat-embed-core-9.0.75.jar:9.0.75]
	at org.apache.catalina.authenticator.AuthenticatorBase.invoke(AuthenticatorBase.java:481) ~[tomcat-embed-core-9.0.75.jar:9.0.75]
	at org.apache.catalina.core.StandardHostValve.invoke(StandardHostValve.java:130) ~[tomcat-embed-core-9.0.75.jar:9.0.75]
	at org.apache.catalina.valves.ErrorReportValve.invoke(ErrorReportValve.java:93) ~[tomcat-embed-core-9.0.75.jar:9.0.75]
	at org.apache.catalina.core.StandardEngineValve.invoke(StandardEngineValve.java:74) ~[tomcat-embed-core-9.0.75.jar:9.0.75]
	at org.apache.catalina.connector.CoyoteAdapter.service(CoyoteAdapter.java:343) ~[tomcat-embed-core-9.0.75.jar:9.0.75]
	at org.apache.coyote.http11.Http11Processor.service(Http11Processor.java:390) ~[tomcat-embed-core-9.0.75.jar:9.0.75]
	at org.apache.coyote.AbstractProcessorLight.process(AbstractProcessorLight.java:63) ~[tomcat-embed-core-9.0.75.jar:9.0.75]
	at org.apache.coyote.AbstractProtocol$ConnectionHandler.process(AbstractProtocol.java:926) ~[tomcat-embed-core-9.0.75.jar:9.0.75]
	at org.apache.tomcat.util.net.NioEndpoint$SocketProcessor.doRun(NioEndpoint.java:1791) ~[tomcat-embed-core-9.0.75.jar:9.0.75]
	at org.apache.tomcat.util.net.SocketProcessorBase.run(SocketProcessorBase.java:52) ~[tomcat-embed-core-9.0.75.jar:9.0.75]
	at org.apache.tomcat.util.threads.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1191) ~[tomcat-embed-core-9.0.75.jar:9.0.75]
	at org.apache.tomcat.util.threads.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:659) ~[tomcat-embed-core-9.0.75.jar:9.0.75]
	at org.apache.tomcat.util.threads.TaskThread$WrappingRunnable.run(TaskThread.java:61) ~[tomcat-embed-core-9.0.75.jar:9.0.75]
	at java.base/java.lang.Thread.run(Thread.java:840) ~[na:na]

16:45:59:764 DEBUG 4556 --- [http-nio-8080-exec-3] c.l.h.m.D.selectById                     : ==>  Preparing: SELECT id,patient_id,doctor_id,disease_name,disease_category,aimodel_id,result,create_time,status,id_card,name,score,remark FROM diagnosis_report WHERE id=?
16:45:59:764 DEBUG 4556 --- [http-nio-8080-exec-3] c.l.h.m.D.selectById                     : ==> Parameters: 1(Integer)
16:45:59:796 DEBUG 4556 --- [http-nio-8080-exec-3] c.l.h.m.D.selectById                     : <==      Total: 1
16:45:59:797 DEBUG 4556 --- [http-nio-8080-exec-3] c.l.h.mapper.PatientMapper.selectById    : ==>  Preparing: SELECT id,phone,id_card,name,verified,verified_by,verified_time,open_id,hospital_pid FROM patient WHERE id=?
16:45:59:798 DEBUG 4556 --- [http-nio-8080-exec-3] c.l.h.mapper.PatientMapper.selectById    : ==> Parameters: 1(Integer)
16:45:59:829 DEBUG 4556 --- [http-nio-8080-exec-3] c.l.h.mapper.PatientMapper.selectById    : <==      Total: 1
16:45:59:830 DEBUG 4556 --- [http-nio-8080-exec-3] c.l.h.mapper.DoctorMapper.selectById     : ==>  Preparing: SELECT id,phone,id_card,name,verified,verified_by,verified_time,license,department,hospital_pid FROM doctor WHERE id=?
16:45:59:830 DEBUG 4556 --- [http-nio-8080-exec-3] c.l.h.mapper.DoctorMapper.selectById     : ==> Parameters: 1(Integer)
16:45:59:861 DEBUG 4556 --- [http-nio-8080-exec-3] c.l.h.mapper.DoctorMapper.selectById     : <==      Total: 1
16:45:59:861 DEBUG 4556 --- [http-nio-8080-exec-3] c.l.h.m.E.selectListByDiagnosisId        : ==>  Preparing: select * from eye_images where dignosis_report_id = ?
16:45:59:861 DEBUG 4556 --- [http-nio-8080-exec-3] c.l.h.m.E.selectListByDiagnosisId        : ==> Parameters: 1(Integer)
16:45:59:891 DEBUG 4556 --- [http-nio-8080-exec-3] c.l.h.m.E.selectListByDiagnosisId        : <==      Total: 1
16:45:59:891 DEBUG 4556 --- [http-nio-8080-exec-3] c.l.h.m.T.selectByDiagnosisId            : ==>  Preparing: select * from treatment_plans where diagnosis_id = ?
16:45:59:892 DEBUG 4556 --- [http-nio-8080-exec-3] c.l.h.m.T.selectByDiagnosisId            : ==> Parameters: 1(Integer)
16:45:59:923 DEBUG 4556 --- [http-nio-8080-exec-3] c.l.h.m.T.selectByDiagnosisId            : <==      Total: 1
16:45:59:925 DEBUG 4556 --- [http-nio-8080-exec-3] c.l.h.m.M.selectByDiagnosisId            : ==>  Preparing: select * from medication_recommendations where diagnosis_id = ?
16:45:59:925 DEBUG 4556 --- [http-nio-8080-exec-3] c.l.h.m.M.selectByDiagnosisId            : ==> Parameters: 1(Integer)
16:45:59:956 DEBUG 4556 --- [http-nio-8080-exec-3] c.l.h.m.M.selectByDiagnosisId            : <==      Total: 1
16:45:59:958 DEBUG 4556 --- [http-nio-8080-exec-3] c.l.h.mapper.AiModelMapper.selectById    : ==>  Preparing: SELECT id,version,deploy_time,accuracy FROM ai_model WHERE id=?
16:45:59:958 DEBUG 4556 --- [http-nio-8080-exec-3] c.l.h.mapper.AiModelMapper.selectById    : ==> Parameters: 1(Integer)
16:45:59:987 DEBUG 4556 --- [http-nio-8080-exec-3] c.l.h.mapper.AiModelMapper.selectById    : <==      Total: 1
16:46:02:268 DEBUG 4556 --- [http-nio-8080-exec-3] c.l.api.client.FlaskAiDoctorClient       : [FlaskAiDoctorClient#uploadFile] ---> POST http://ai-service/api/chat/completions HTTP/1.1
16:46:02:268 DEBUG 4556 --- [http-nio-8080-exec-3] c.l.api.client.FlaskAiDoctorClient       : [FlaskAiDoctorClient#uploadFile] Content-Length: 726
16:46:02:268 DEBUG 4556 --- [http-nio-8080-exec-3] c.l.api.client.FlaskAiDoctorClient       : [FlaskAiDoctorClient#uploadFile] Content-Type: application/json
16:46:02:268 DEBUG 4556 --- [http-nio-8080-exec-3] c.l.api.client.FlaskAiDoctorClient       : [FlaskAiDoctorClient#uploadFile] 
16:46:02:269 DEBUG 4556 --- [http-nio-8080-exec-3] c.l.api.client.FlaskAiDoctorClient       : [FlaskAiDoctorClient#uploadFile] {"diagnosis_name":"","diagnosis_category":"","result":"A","remark":"A","treatment_plan":{"id":1,"treatmentType":1,"treatmentDetail":"","startTime":"2025-03-01 09:00:00","endDate":"2025-03-10 09:00:00","doctorId":1,"createdTime":[2025,3,1,9,0],"updatedTime":[2025,3,1,9,0]},"medications":[{"id":1,"diagnosisId":1,"medicationName":"A","dosage":"10mg","frequency":"","sideEffects":"","startTime":[2025,3,1,9,0],"endTime":[2025,3,10,9,0],"doctorId":1,"createdTime":"2025-03-01 09:00:00","updatedTime":"2025-03-01 09:00:00"}],"previous_conversations":[{"role":"pariatur tempor do","content":"sit cupidatat commodo"}],"question":"irure eu esse","stream":false}
16:46:02:269 DEBUG 4556 --- [http-nio-8080-exec-3] c.l.api.client.FlaskAiDoctorClient       : [FlaskAiDoctorClient#uploadFile] ---> END HTTP (726-byte body)
16:46:04:316 DEBUG 4556 --- [http-nio-8080-exec-3] c.l.api.client.FlaskAiDoctorClient       : [FlaskAiDoctorClient#uploadFile] <--- ERROR ConnectException: Connection refused: getsockopt (2046ms)
16:46:04:317 DEBUG 4556 --- [http-nio-8080-exec-3] c.l.api.client.FlaskAiDoctorClient       : [FlaskAiDoctorClient#uploadFile] java.net.ConnectException: Connection refused: getsockopt
	at java.base/sun.nio.ch.Net.pollConnect(Native Method)
	at java.base/sun.nio.ch.Net.pollConnectNow(Net.java:672)
	at java.base/sun.nio.ch.NioSocketImpl.timedFinishConnect(NioSocketImpl.java:554)
	at java.base/sun.nio.ch.NioSocketImpl.connect(NioSocketImpl.java:602)
	at java.base/java.net.Socket.connect(Socket.java:633)
	at java.base/sun.net.NetworkClient.doConnect(NetworkClient.java:178)
	at java.base/sun.net.www.http.HttpClient.openServer(HttpClient.java:533)
	at java.base/sun.net.www.http.HttpClient.openServer(HttpClient.java:638)
	at java.base/sun.net.www.http.HttpClient.<init>(HttpClient.java:281)
	at java.base/sun.net.www.http.HttpClient.New(HttpClient.java:386)
	at java.base/sun.net.www.http.HttpClient.New(HttpClient.java:408)
	at java.base/sun.net.www.protocol.http.HttpURLConnection.getNewHttpClient(HttpURLConnection.java:1309)
	at java.base/sun.net.www.protocol.http.HttpURLConnection.plainConnect0(HttpURLConnection.java:1242)
	at java.base/sun.net.www.protocol.http.HttpURLConnection.plainConnect(HttpURLConnection.java:1128)
	at java.base/sun.net.www.protocol.http.HttpURLConnection.connect(HttpURLConnection.java:1057)
	at java.base/sun.net.www.protocol.http.HttpURLConnection.getOutputStream0(HttpURLConnection.java:1451)
	at java.base/sun.net.www.protocol.http.HttpURLConnection.getOutputStream(HttpURLConnection.java:1422)
	at feign.Client$Default.convertAndSend(Client.java:208)
	at feign.Client$Default.execute(Client.java:105)
	at org.springframework.cloud.openfeign.loadbalancer.LoadBalancerUtils.executeWithLoadBalancerLifecycleProcessing(LoadBalancerUtils.java:57)
	at org.springframework.cloud.openfeign.loadbalancer.LoadBalancerUtils.executeWithLoadBalancerLifecycleProcessing(LoadBalancerUtils.java:95)
	at org.springframework.cloud.openfeign.loadbalancer.FeignBlockingLoadBalancerClient.execute(FeignBlockingLoadBalancerClient.java:114)
	at feign.SynchronousMethodHandler.executeAndDecode(SynchronousMethodHandler.java:121)
	at feign.SynchronousMethodHandler.invoke(SynchronousMethodHandler.java:91)
	at feign.ReflectiveFeign$FeignInvocationHandler.invoke(ReflectiveFeign.java:100)
	at jdk.proxy2/jdk.proxy2.$Proxy135.uploadFile(Unknown Source)
	at com.luojiawei.his_service.controller.ChatController.ask(ChatController.java:38)
	at java.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at java.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:77)
	at java.base/jdk.internal.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.base/java.lang.reflect.Method.invoke(Method.java:568)
	at org.springframework.web.method.support.InvocableHandlerMethod.doInvoke(InvocableHandlerMethod.java:205)
	at org.springframework.web.method.support.InvocableHandlerMethod.invokeForRequest(InvocableHandlerMethod.java:150)
	at org.springframework.web.servlet.mvc.method.annotation.ServletInvocableHandlerMethod.invokeAndHandle(ServletInvocableHandlerMethod.java:117)
	at org.springframework.web.servlet.mvc.method.annotation.RequestMappingHandlerAdapter.invokeHandlerMethod(RequestMappingHandlerAdapter.java:895)
	at org.springframework.web.servlet.mvc.method.annotation.RequestMappingHandlerAdapter.handleInternal(RequestMappingHandlerAdapter.java:808)
	at org.springframework.web.servlet.mvc.method.AbstractHandlerMethodAdapter.handle(AbstractHandlerMethodAdapter.java:87)
	at org.springframework.web.servlet.DispatcherServlet.doDispatch(DispatcherServlet.java:1072)
	at org.springframework.web.servlet.DispatcherServlet.doService(DispatcherServlet.java:965)
	at org.springframework.web.servlet.FrameworkServlet.processRequest(FrameworkServlet.java:1006)
	at org.springframework.web.servlet.FrameworkServlet.doPost(FrameworkServlet.java:909)
	at javax.servlet.http.HttpServlet.service(HttpServlet.java:555)
	at org.springframework.web.servlet.FrameworkServlet.service(FrameworkServlet.java:883)
	at javax.servlet.http.HttpServlet.service(HttpServlet.java:623)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:209)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:153)
	at com.luojiawei.his_service.filter.RefreshTokenFilter.doFilterInternal(RefreshTokenFilter.java:58)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:117)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:178)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:153)
	at org.springframework.web.filter.RequestContextFilter.doFilterInternal(RequestContextFilter.java:100)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:117)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:178)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:153)
	at org.springframework.web.filter.FormContentFilter.doFilterInternal(FormContentFilter.java:93)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:117)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:178)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:153)
	at org.springframework.boot.actuate.metrics.web.servlet.WebMvcMetricsFilter.doFilterInternal(WebMvcMetricsFilter.java:96)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:117)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:178)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:153)
	at org.springframework.web.filter.CharacterEncodingFilter.doFilterInternal(CharacterEncodingFilter.java:201)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:117)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:178)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:153)
	at org.apache.catalina.core.StandardWrapperValve.invoke(StandardWrapperValve.java:167)
	at org.apache.catalina.core.StandardContextValve.invoke(StandardContextValve.java:90)
	at org.apache.catalina.authenticator.AuthenticatorBase.invoke(AuthenticatorBase.java:481)
	at org.apache.catalina.core.StandardHostValve.invoke(StandardHostValve.java:130)
	at org.apache.catalina.valves.ErrorReportValve.invoke(ErrorReportValve.java:93)
	at org.apache.catalina.core.StandardEngineValve.invoke(StandardEngineValve.java:74)
	at org.apache.catalina.connector.CoyoteAdapter.service(CoyoteAdapter.java:343)
	at org.apache.coyote.http11.Http11Processor.service(Http11Processor.java:390)
	at org.apache.coyote.AbstractProcessorLight.process(AbstractProcessorLight.java:63)
	at org.apache.coyote.AbstractProtocol$ConnectionHandler.process(AbstractProtocol.java:926)
	at org.apache.tomcat.util.net.NioEndpoint$SocketProcessor.doRun(NioEndpoint.java:1791)
	at org.apache.tomcat.util.net.SocketProcessorBase.run(SocketProcessorBase.java:52)
	at org.apache.tomcat.util.threads.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1191)
	at org.apache.tomcat.util.threads.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:659)
	at org.apache.tomcat.util.threads.TaskThread$WrappingRunnable.run(TaskThread.java:61)
	at java.base/java.lang.Thread.run(Thread.java:840)

16:46:04:317 DEBUG 4556 --- [http-nio-8080-exec-3] c.l.api.client.FlaskAiDoctorClient       : [FlaskAiDoctorClient#uploadFile] <--- END ERROR
16:46:04:318 ERROR 4556 --- [http-nio-8080-exec-3] o.a.c.c.C.[.[.[/].[dispatcherServlet]    : Servlet.service() for servlet [dispatcherServlet] in context with path [] threw exception [Request processing failed; nested exception is feign.RetryableException: Connection refused: getsockopt executing POST http://ai-service/api/chat/completions] with root cause

java.net.ConnectException: Connection refused: getsockopt
	at java.base/sun.nio.ch.Net.pollConnect(Native Method) ~[na:na]
	at java.base/sun.nio.ch.Net.pollConnectNow(Net.java:672) ~[na:na]
	at java.base/sun.nio.ch.NioSocketImpl.timedFinishConnect(NioSocketImpl.java:554) ~[na:na]
	at java.base/sun.nio.ch.NioSocketImpl.connect(NioSocketImpl.java:602) ~[na:na]
	at java.base/java.net.Socket.connect(Socket.java:633) ~[na:na]
	at java.base/sun.net.NetworkClient.doConnect(NetworkClient.java:178) ~[na:na]
	at java.base/sun.net.www.http.HttpClient.openServer(HttpClient.java:533) ~[na:na]
	at java.base/sun.net.www.http.HttpClient.openServer(HttpClient.java:638) ~[na:na]
	at java.base/sun.net.www.http.HttpClient.<init>(HttpClient.java:281) ~[na:na]
	at java.base/sun.net.www.http.HttpClient.New(HttpClient.java:386) ~[na:na]
	at java.base/sun.net.www.http.HttpClient.New(HttpClient.java:408) ~[na:na]
	at java.base/sun.net.www.protocol.http.HttpURLConnection.getNewHttpClient(HttpURLConnection.java:1309) ~[na:na]
	at java.base/sun.net.www.protocol.http.HttpURLConnection.plainConnect0(HttpURLConnection.java:1242) ~[na:na]
	at java.base/sun.net.www.protocol.http.HttpURLConnection.plainConnect(HttpURLConnection.java:1128) ~[na:na]
	at java.base/sun.net.www.protocol.http.HttpURLConnection.connect(HttpURLConnection.java:1057) ~[na:na]
	at java.base/sun.net.www.protocol.http.HttpURLConnection.getOutputStream0(HttpURLConnection.java:1451) ~[na:na]
	at java.base/sun.net.www.protocol.http.HttpURLConnection.getOutputStream(HttpURLConnection.java:1422) ~[na:na]
	at feign.Client$Default.convertAndSend(Client.java:208) ~[feign-core-11.10.jar:na]
	at feign.Client$Default.execute(Client.java:105) ~[feign-core-11.10.jar:na]
	at org.springframework.cloud.openfeign.loadbalancer.LoadBalancerUtils.executeWithLoadBalancerLifecycleProcessing(LoadBalancerUtils.java:57) ~[spring-cloud-openfeign-core-3.1.5.jar:3.1.5]
	at org.springframework.cloud.openfeign.loadbalancer.LoadBalancerUtils.executeWithLoadBalancerLifecycleProcessing(LoadBalancerUtils.java:95) ~[spring-cloud-openfeign-core-3.1.5.jar:3.1.5]
	at org.springframework.cloud.openfeign.loadbalancer.FeignBlockingLoadBalancerClient.execute(FeignBlockingLoadBalancerClient.java:114) ~[spring-cloud-openfeign-core-3.1.5.jar:3.1.5]
	at feign.SynchronousMethodHandler.executeAndDecode(SynchronousMethodHandler.java:121) ~[feign-core-11.10.jar:na]
	at feign.SynchronousMethodHandler.invoke(SynchronousMethodHandler.java:91) ~[feign-core-11.10.jar:na]
	at feign.ReflectiveFeign$FeignInvocationHandler.invoke(ReflectiveFeign.java:100) ~[feign-core-11.10.jar:na]
	at jdk.proxy2/jdk.proxy2.$Proxy135.uploadFile(Unknown Source) ~[na:na]
	at com.luojiawei.his_service.controller.ChatController.ask(ChatController.java:38) ~[classes/:na]
	at java.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke0(Native Method) ~[na:na]
	at java.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:77) ~[na:na]
	at java.base/jdk.internal.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43) ~[na:na]
	at java.base/java.lang.reflect.Method.invoke(Method.java:568) ~[na:na]
	at org.springframework.web.method.support.InvocableHandlerMethod.doInvoke(InvocableHandlerMethod.java:205) ~[spring-web-5.3.27.jar:5.3.27]
	at org.springframework.web.method.support.InvocableHandlerMethod.invokeForRequest(InvocableHandlerMethod.java:150) ~[spring-web-5.3.27.jar:5.3.27]
	at org.springframework.web.servlet.mvc.method.annotation.ServletInvocableHandlerMethod.invokeAndHandle(ServletInvocableHandlerMethod.java:117) ~[spring-webmvc-5.3.27.jar:5.3.27]
	at org.springframework.web.servlet.mvc.method.annotation.RequestMappingHandlerAdapter.invokeHandlerMethod(RequestMappingHandlerAdapter.java:895) ~[spring-webmvc-5.3.27.jar:5.3.27]
	at org.springframework.web.servlet.mvc.method.annotation.RequestMappingHandlerAdapter.handleInternal(RequestMappingHandlerAdapter.java:808) ~[spring-webmvc-5.3.27.jar:5.3.27]
	at org.springframework.web.servlet.mvc.method.AbstractHandlerMethodAdapter.handle(AbstractHandlerMethodAdapter.java:87) ~[spring-webmvc-5.3.27.jar:5.3.27]
	at org.springframework.web.servlet.DispatcherServlet.doDispatch(DispatcherServlet.java:1072) ~[spring-webmvc-5.3.27.jar:5.3.27]
	at org.springframework.web.servlet.DispatcherServlet.doService(DispatcherServlet.java:965) ~[spring-webmvc-5.3.27.jar:5.3.27]
	at org.springframework.web.servlet.FrameworkServlet.processRequest(FrameworkServlet.java:1006) ~[spring-webmvc-5.3.27.jar:5.3.27]
	at org.springframework.web.servlet.FrameworkServlet.doPost(FrameworkServlet.java:909) ~[spring-webmvc-5.3.27.jar:5.3.27]
	at javax.servlet.http.HttpServlet.service(HttpServlet.java:555) ~[tomcat-embed-core-9.0.75.jar:4.0.FR]
	at org.springframework.web.servlet.FrameworkServlet.service(FrameworkServlet.java:883) ~[spring-webmvc-5.3.27.jar:5.3.27]
	at javax.servlet.http.HttpServlet.service(HttpServlet.java:623) ~[tomcat-embed-core-9.0.75.jar:4.0.FR]
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:209) ~[tomcat-embed-core-9.0.75.jar:9.0.75]
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:153) ~[tomcat-embed-core-9.0.75.jar:9.0.75]
	at com.luojiawei.his_service.filter.RefreshTokenFilter.doFilterInternal(RefreshTokenFilter.java:58) ~[classes/:na]
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:117) ~[spring-web-5.3.27.jar:5.3.27]
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:178) ~[tomcat-embed-core-9.0.75.jar:9.0.75]
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:153) ~[tomcat-embed-core-9.0.75.jar:9.0.75]
	at org.springframework.web.filter.RequestContextFilter.doFilterInternal(RequestContextFilter.java:100) ~[spring-web-5.3.27.jar:5.3.27]
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:117) ~[spring-web-5.3.27.jar:5.3.27]
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:178) ~[tomcat-embed-core-9.0.75.jar:9.0.75]
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:153) ~[tomcat-embed-core-9.0.75.jar:9.0.75]
	at org.springframework.web.filter.FormContentFilter.doFilterInternal(FormContentFilter.java:93) ~[spring-web-5.3.27.jar:5.3.27]
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:117) ~[spring-web-5.3.27.jar:5.3.27]
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:178) ~[tomcat-embed-core-9.0.75.jar:9.0.75]
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:153) ~[tomcat-embed-core-9.0.75.jar:9.0.75]
	at org.springframework.boot.actuate.metrics.web.servlet.WebMvcMetricsFilter.doFilterInternal(WebMvcMetricsFilter.java:96) ~[spring-boot-actuator-2.7.12.jar:2.7.12]
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:117) ~[spring-web-5.3.27.jar:5.3.27]
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:178) ~[tomcat-embed-core-9.0.75.jar:9.0.75]
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:153) ~[tomcat-embed-core-9.0.75.jar:9.0.75]
	at org.springframework.web.filter.CharacterEncodingFilter.doFilterInternal(CharacterEncodingFilter.java:201) ~[spring-web-5.3.27.jar:5.3.27]
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:117) ~[spring-web-5.3.27.jar:5.3.27]
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:178) ~[tomcat-embed-core-9.0.75.jar:9.0.75]
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:153) ~[tomcat-embed-core-9.0.75.jar:9.0.75]
	at org.apache.catalina.core.StandardWrapperValve.invoke(StandardWrapperValve.java:167) ~[tomcat-embed-core-9.0.75.jar:9.0.75]
	at org.apache.catalina.core.StandardContextValve.invoke(StandardContextValve.java:90) ~[tomcat-embed-core-9.0.75.jar:9.0.75]
	at org.apache.catalina.authenticator.AuthenticatorBase.invoke(AuthenticatorBase.java:481) ~[tomcat-embed-core-9.0.75.jar:9.0.75]
	at org.apache.catalina.core.StandardHostValve.invoke(StandardHostValve.java:130) ~[tomcat-embed-core-9.0.75.jar:9.0.75]
	at org.apache.catalina.valves.ErrorReportValve.invoke(ErrorReportValve.java:93) ~[tomcat-embed-core-9.0.75.jar:9.0.75]
	at org.apache.catalina.core.StandardEngineValve.invoke(StandardEngineValve.java:74) ~[tomcat-embed-core-9.0.75.jar:9.0.75]
	at org.apache.catalina.connector.CoyoteAdapter.service(CoyoteAdapter.java:343) ~[tomcat-embed-core-9.0.75.jar:9.0.75]
	at org.apache.coyote.http11.Http11Processor.service(Http11Processor.java:390) ~[tomcat-embed-core-9.0.75.jar:9.0.75]
	at org.apache.coyote.AbstractProcessorLight.process(AbstractProcessorLight.java:63) ~[tomcat-embed-core-9.0.75.jar:9.0.75]
	at org.apache.coyote.AbstractProtocol$ConnectionHandler.process(AbstractProtocol.java:926) ~[tomcat-embed-core-9.0.75.jar:9.0.75]
	at org.apache.tomcat.util.net.NioEndpoint$SocketProcessor.doRun(NioEndpoint.java:1791) ~[tomcat-embed-core-9.0.75.jar:9.0.75]
	at org.apache.tomcat.util.net.SocketProcessorBase.run(SocketProcessorBase.java:52) ~[tomcat-embed-core-9.0.75.jar:9.0.75]
	at org.apache.tomcat.util.threads.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1191) ~[tomcat-embed-core-9.0.75.jar:9.0.75]
	at org.apache.tomcat.util.threads.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:659) ~[tomcat-embed-core-9.0.75.jar:9.0.75]
	at org.apache.tomcat.util.threads.TaskThread$WrappingRunnable.run(TaskThread.java:61) ~[tomcat-embed-core-9.0.75.jar:9.0.75]
	at java.base/java.lang.Thread.run(Thread.java:840) ~[na:na]

16:47:49:079 DEBUG 4556 --- [http-nio-8080-exec-6] c.l.h.m.D.selectById                     : ==>  Preparing: SELECT id,patient_id,doctor_id,disease_name,disease_category,aimodel_id,result,create_time,status,id_card,name,score,remark FROM diagnosis_report WHERE id=?
16:47:49:083 DEBUG 4556 --- [http-nio-8080-exec-6] c.l.h.m.D.selectById                     : ==> Parameters: 1(Integer)
16:47:49:113 DEBUG 4556 --- [http-nio-8080-exec-6] c.l.h.m.D.selectById                     : <==      Total: 1
16:47:49:114 DEBUG 4556 --- [http-nio-8080-exec-6] c.l.h.mapper.PatientMapper.selectById    : ==>  Preparing: SELECT id,phone,id_card,name,verified,verified_by,verified_time,open_id,hospital_pid FROM patient WHERE id=?
16:47:49:116 DEBUG 4556 --- [http-nio-8080-exec-6] c.l.h.mapper.PatientMapper.selectById    : ==> Parameters: 1(Integer)
16:47:49:151 DEBUG 4556 --- [http-nio-8080-exec-6] c.l.h.mapper.PatientMapper.selectById    : <==      Total: 1
16:47:49:154 DEBUG 4556 --- [http-nio-8080-exec-6] c.l.h.mapper.DoctorMapper.selectById     : ==>  Preparing: SELECT id,phone,id_card,name,verified,verified_by,verified_time,license,department,hospital_pid FROM doctor WHERE id=?
16:47:49:154 DEBUG 4556 --- [http-nio-8080-exec-6] c.l.h.mapper.DoctorMapper.selectById     : ==> Parameters: 1(Integer)
16:47:49:186 DEBUG 4556 --- [http-nio-8080-exec-6] c.l.h.mapper.DoctorMapper.selectById     : <==      Total: 1
16:47:49:187 DEBUG 4556 --- [http-nio-8080-exec-6] c.l.h.m.E.selectListByDiagnosisId        : ==>  Preparing: select * from eye_images where dignosis_report_id = ?
16:47:49:187 DEBUG 4556 --- [http-nio-8080-exec-6] c.l.h.m.E.selectListByDiagnosisId        : ==> Parameters: 1(Integer)
16:47:49:218 DEBUG 4556 --- [http-nio-8080-exec-6] c.l.h.m.E.selectListByDiagnosisId        : <==      Total: 1
16:47:49:219 DEBUG 4556 --- [http-nio-8080-exec-6] c.l.h.m.T.selectByDiagnosisId            : ==>  Preparing: select * from treatment_plans where diagnosis_id = ?
16:47:49:219 DEBUG 4556 --- [http-nio-8080-exec-6] c.l.h.m.T.selectByDiagnosisId            : ==> Parameters: 1(Integer)
16:47:49:250 DEBUG 4556 --- [http-nio-8080-exec-6] c.l.h.m.T.selectByDiagnosisId            : <==      Total: 1
16:47:49:251 DEBUG 4556 --- [http-nio-8080-exec-6] c.l.h.m.M.selectByDiagnosisId            : ==>  Preparing: select * from medication_recommendations where diagnosis_id = ?
16:47:49:252 DEBUG 4556 --- [http-nio-8080-exec-6] c.l.h.m.M.selectByDiagnosisId            : ==> Parameters: 1(Integer)
16:47:49:283 DEBUG 4556 --- [http-nio-8080-exec-6] c.l.h.m.M.selectByDiagnosisId            : <==      Total: 1
16:47:49:283 DEBUG 4556 --- [http-nio-8080-exec-6] c.l.h.mapper.AiModelMapper.selectById    : ==>  Preparing: SELECT id,version,deploy_time,accuracy FROM ai_model WHERE id=?
16:47:49:284 DEBUG 4556 --- [http-nio-8080-exec-6] c.l.h.mapper.AiModelMapper.selectById    : ==> Parameters: 1(Integer)
16:47:49:314 DEBUG 4556 --- [http-nio-8080-exec-6] c.l.h.mapper.AiModelMapper.selectById    : <==      Total: 1
16:47:53:857 DEBUG 4556 --- [http-nio-8080-exec-6] c.l.api.client.FlaskAiDoctorClient       : [FlaskAiDoctorClient#uploadFile] ---> POST http://ai-service/api/chat/completions HTTP/1.1
16:47:53:858 DEBUG 4556 --- [http-nio-8080-exec-6] c.l.api.client.FlaskAiDoctorClient       : [FlaskAiDoctorClient#uploadFile] Content-Length: 726
16:47:53:858 DEBUG 4556 --- [http-nio-8080-exec-6] c.l.api.client.FlaskAiDoctorClient       : [FlaskAiDoctorClient#uploadFile] Content-Type: application/json
16:47:53:858 DEBUG 4556 --- [http-nio-8080-exec-6] c.l.api.client.FlaskAiDoctorClient       : [FlaskAiDoctorClient#uploadFile] 
16:47:53:858 DEBUG 4556 --- [http-nio-8080-exec-6] c.l.api.client.FlaskAiDoctorClient       : [FlaskAiDoctorClient#uploadFile] {"diagnosis_name":"","diagnosis_category":"","result":"A","remark":"A","treatment_plan":{"id":1,"treatmentType":1,"treatmentDetail":"","startTime":"2025-03-01 09:00:00","endDate":"2025-03-10 09:00:00","doctorId":1,"createdTime":[2025,3,1,9,0],"updatedTime":[2025,3,1,9,0]},"medications":[{"id":1,"diagnosisId":1,"medicationName":"A","dosage":"10mg","frequency":"","sideEffects":"","startTime":[2025,3,1,9,0],"endTime":[2025,3,10,9,0],"doctorId":1,"createdTime":"2025-03-01 09:00:00","updatedTime":"2025-03-01 09:00:00"}],"previous_conversations":[{"role":"pariatur tempor do","content":"sit cupidatat commodo"}],"question":"irure eu esse","stream":false}
16:47:53:858 DEBUG 4556 --- [http-nio-8080-exec-6] c.l.api.client.FlaskAiDoctorClient       : [FlaskAiDoctorClient#uploadFile] ---> END HTTP (726-byte body)
16:47:55:901 DEBUG 4556 --- [http-nio-8080-exec-6] c.l.api.client.FlaskAiDoctorClient       : [FlaskAiDoctorClient#uploadFile] <--- ERROR ConnectException: Connection refused: getsockopt (2042ms)
16:47:55:902 DEBUG 4556 --- [http-nio-8080-exec-6] c.l.api.client.FlaskAiDoctorClient       : [FlaskAiDoctorClient#uploadFile] java.net.ConnectException: Connection refused: getsockopt
	at java.base/sun.nio.ch.Net.pollConnect(Native Method)
	at java.base/sun.nio.ch.Net.pollConnectNow(Net.java:672)
	at java.base/sun.nio.ch.NioSocketImpl.timedFinishConnect(NioSocketImpl.java:554)
	at java.base/sun.nio.ch.NioSocketImpl.connect(NioSocketImpl.java:602)
	at java.base/java.net.Socket.connect(Socket.java:633)
	at java.base/sun.net.NetworkClient.doConnect(NetworkClient.java:178)
	at java.base/sun.net.www.http.HttpClient.openServer(HttpClient.java:533)
	at java.base/sun.net.www.http.HttpClient.openServer(HttpClient.java:638)
	at java.base/sun.net.www.http.HttpClient.<init>(HttpClient.java:281)
	at java.base/sun.net.www.http.HttpClient.New(HttpClient.java:386)
	at java.base/sun.net.www.http.HttpClient.New(HttpClient.java:408)
	at java.base/sun.net.www.protocol.http.HttpURLConnection.getNewHttpClient(HttpURLConnection.java:1309)
	at java.base/sun.net.www.protocol.http.HttpURLConnection.plainConnect0(HttpURLConnection.java:1242)
	at java.base/sun.net.www.protocol.http.HttpURLConnection.plainConnect(HttpURLConnection.java:1128)
	at java.base/sun.net.www.protocol.http.HttpURLConnection.connect(HttpURLConnection.java:1057)
	at java.base/sun.net.www.protocol.http.HttpURLConnection.getOutputStream0(HttpURLConnection.java:1451)
	at java.base/sun.net.www.protocol.http.HttpURLConnection.getOutputStream(HttpURLConnection.java:1422)
	at feign.Client$Default.convertAndSend(Client.java:208)
	at feign.Client$Default.execute(Client.java:105)
	at org.springframework.cloud.openfeign.loadbalancer.LoadBalancerUtils.executeWithLoadBalancerLifecycleProcessing(LoadBalancerUtils.java:57)
	at org.springframework.cloud.openfeign.loadbalancer.LoadBalancerUtils.executeWithLoadBalancerLifecycleProcessing(LoadBalancerUtils.java:95)
	at org.springframework.cloud.openfeign.loadbalancer.FeignBlockingLoadBalancerClient.execute(FeignBlockingLoadBalancerClient.java:114)
	at feign.SynchronousMethodHandler.executeAndDecode(SynchronousMethodHandler.java:121)
	at feign.SynchronousMethodHandler.invoke(SynchronousMethodHandler.java:91)
	at feign.ReflectiveFeign$FeignInvocationHandler.invoke(ReflectiveFeign.java:100)
	at jdk.proxy2/jdk.proxy2.$Proxy135.uploadFile(Unknown Source)
	at com.luojiawei.his_service.controller.ChatController.ask(ChatController.java:38)
	at java.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at java.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:77)
	at java.base/jdk.internal.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.base/java.lang.reflect.Method.invoke(Method.java:568)
	at org.springframework.web.method.support.InvocableHandlerMethod.doInvoke(InvocableHandlerMethod.java:205)
	at org.springframework.web.method.support.InvocableHandlerMethod.invokeForRequest(InvocableHandlerMethod.java:150)
	at org.springframework.web.servlet.mvc.method.annotation.ServletInvocableHandlerMethod.invokeAndHandle(ServletInvocableHandlerMethod.java:117)
	at org.springframework.web.servlet.mvc.method.annotation.RequestMappingHandlerAdapter.invokeHandlerMethod(RequestMappingHandlerAdapter.java:895)
	at org.springframework.web.servlet.mvc.method.annotation.RequestMappingHandlerAdapter.handleInternal(RequestMappingHandlerAdapter.java:808)
	at org.springframework.web.servlet.mvc.method.AbstractHandlerMethodAdapter.handle(AbstractHandlerMethodAdapter.java:87)
	at org.springframework.web.servlet.DispatcherServlet.doDispatch(DispatcherServlet.java:1072)
	at org.springframework.web.servlet.DispatcherServlet.doService(DispatcherServlet.java:965)
	at org.springframework.web.servlet.FrameworkServlet.processRequest(FrameworkServlet.java:1006)
	at org.springframework.web.servlet.FrameworkServlet.doPost(FrameworkServlet.java:909)
	at javax.servlet.http.HttpServlet.service(HttpServlet.java:555)
	at org.springframework.web.servlet.FrameworkServlet.service(FrameworkServlet.java:883)
	at javax.servlet.http.HttpServlet.service(HttpServlet.java:623)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:209)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:153)
	at com.luojiawei.his_service.filter.RefreshTokenFilter.doFilterInternal(RefreshTokenFilter.java:58)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:117)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:178)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:153)
	at org.springframework.web.filter.RequestContextFilter.doFilterInternal(RequestContextFilter.java:100)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:117)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:178)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:153)
	at org.springframework.web.filter.FormContentFilter.doFilterInternal(FormContentFilter.java:93)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:117)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:178)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:153)
	at org.springframework.boot.actuate.metrics.web.servlet.WebMvcMetricsFilter.doFilterInternal(WebMvcMetricsFilter.java:96)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:117)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:178)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:153)
	at org.springframework.web.filter.CharacterEncodingFilter.doFilterInternal(CharacterEncodingFilter.java:201)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:117)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:178)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:153)
	at org.apache.catalina.core.StandardWrapperValve.invoke(StandardWrapperValve.java:167)
	at org.apache.catalina.core.StandardContextValve.invoke(StandardContextValve.java:90)
	at org.apache.catalina.authenticator.AuthenticatorBase.invoke(AuthenticatorBase.java:481)
	at org.apache.catalina.core.StandardHostValve.invoke(StandardHostValve.java:130)
	at org.apache.catalina.valves.ErrorReportValve.invoke(ErrorReportValve.java:93)
	at org.apache.catalina.core.StandardEngineValve.invoke(StandardEngineValve.java:74)
	at org.apache.catalina.connector.CoyoteAdapter.service(CoyoteAdapter.java:343)
	at org.apache.coyote.http11.Http11Processor.service(Http11Processor.java:390)
	at org.apache.coyote.AbstractProcessorLight.process(AbstractProcessorLight.java:63)
	at org.apache.coyote.AbstractProtocol$ConnectionHandler.process(AbstractProtocol.java:926)
	at org.apache.tomcat.util.net.NioEndpoint$SocketProcessor.doRun(NioEndpoint.java:1791)
	at org.apache.tomcat.util.net.SocketProcessorBase.run(SocketProcessorBase.java:52)
	at org.apache.tomcat.util.threads.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1191)
	at org.apache.tomcat.util.threads.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:659)
	at org.apache.tomcat.util.threads.TaskThread$WrappingRunnable.run(TaskThread.java:61)
	at java.base/java.lang.Thread.run(Thread.java:840)

16:47:55:902 DEBUG 4556 --- [http-nio-8080-exec-6] c.l.api.client.FlaskAiDoctorClient       : [FlaskAiDoctorClient#uploadFile] <--- END ERROR
16:47:55:904 ERROR 4556 --- [http-nio-8080-exec-6] o.a.c.c.C.[.[.[/].[dispatcherServlet]    : Servlet.service() for servlet [dispatcherServlet] in context with path [] threw exception [Request processing failed; nested exception is feign.RetryableException: Connection refused: getsockopt executing POST http://ai-service/api/chat/completions] with root cause

java.net.ConnectException: Connection refused: getsockopt
	at java.base/sun.nio.ch.Net.pollConnect(Native Method) ~[na:na]
	at java.base/sun.nio.ch.Net.pollConnectNow(Net.java:672) ~[na:na]
	at java.base/sun.nio.ch.NioSocketImpl.timedFinishConnect(NioSocketImpl.java:554) ~[na:na]
	at java.base/sun.nio.ch.NioSocketImpl.connect(NioSocketImpl.java:602) ~[na:na]
	at java.base/java.net.Socket.connect(Socket.java:633) ~[na:na]
	at java.base/sun.net.NetworkClient.doConnect(NetworkClient.java:178) ~[na:na]
	at java.base/sun.net.www.http.HttpClient.openServer(HttpClient.java:533) ~[na:na]
	at java.base/sun.net.www.http.HttpClient.openServer(HttpClient.java:638) ~[na:na]
	at java.base/sun.net.www.http.HttpClient.<init>(HttpClient.java:281) ~[na:na]
	at java.base/sun.net.www.http.HttpClient.New(HttpClient.java:386) ~[na:na]
	at java.base/sun.net.www.http.HttpClient.New(HttpClient.java:408) ~[na:na]
	at java.base/sun.net.www.protocol.http.HttpURLConnection.getNewHttpClient(HttpURLConnection.java:1309) ~[na:na]
	at java.base/sun.net.www.protocol.http.HttpURLConnection.plainConnect0(HttpURLConnection.java:1242) ~[na:na]
	at java.base/sun.net.www.protocol.http.HttpURLConnection.plainConnect(HttpURLConnection.java:1128) ~[na:na]
	at java.base/sun.net.www.protocol.http.HttpURLConnection.connect(HttpURLConnection.java:1057) ~[na:na]
	at java.base/sun.net.www.protocol.http.HttpURLConnection.getOutputStream0(HttpURLConnection.java:1451) ~[na:na]
	at java.base/sun.net.www.protocol.http.HttpURLConnection.getOutputStream(HttpURLConnection.java:1422) ~[na:na]
	at feign.Client$Default.convertAndSend(Client.java:208) ~[feign-core-11.10.jar:na]
	at feign.Client$Default.execute(Client.java:105) ~[feign-core-11.10.jar:na]
	at org.springframework.cloud.openfeign.loadbalancer.LoadBalancerUtils.executeWithLoadBalancerLifecycleProcessing(LoadBalancerUtils.java:57) ~[spring-cloud-openfeign-core-3.1.5.jar:3.1.5]
	at org.springframework.cloud.openfeign.loadbalancer.LoadBalancerUtils.executeWithLoadBalancerLifecycleProcessing(LoadBalancerUtils.java:95) ~[spring-cloud-openfeign-core-3.1.5.jar:3.1.5]
	at org.springframework.cloud.openfeign.loadbalancer.FeignBlockingLoadBalancerClient.execute(FeignBlockingLoadBalancerClient.java:114) ~[spring-cloud-openfeign-core-3.1.5.jar:3.1.5]
	at feign.SynchronousMethodHandler.executeAndDecode(SynchronousMethodHandler.java:121) ~[feign-core-11.10.jar:na]
	at feign.SynchronousMethodHandler.invoke(SynchronousMethodHandler.java:91) ~[feign-core-11.10.jar:na]
	at feign.ReflectiveFeign$FeignInvocationHandler.invoke(ReflectiveFeign.java:100) ~[feign-core-11.10.jar:na]
	at jdk.proxy2/jdk.proxy2.$Proxy135.uploadFile(Unknown Source) ~[na:na]
	at com.luojiawei.his_service.controller.ChatController.ask(ChatController.java:38) ~[classes/:na]
	at java.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke0(Native Method) ~[na:na]
	at java.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:77) ~[na:na]
	at java.base/jdk.internal.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43) ~[na:na]
	at java.base/java.lang.reflect.Method.invoke(Method.java:568) ~[na:na]
	at org.springframework.web.method.support.InvocableHandlerMethod.doInvoke(InvocableHandlerMethod.java:205) ~[spring-web-5.3.27.jar:5.3.27]
	at org.springframework.web.method.support.InvocableHandlerMethod.invokeForRequest(InvocableHandlerMethod.java:150) ~[spring-web-5.3.27.jar:5.3.27]
	at org.springframework.web.servlet.mvc.method.annotation.ServletInvocableHandlerMethod.invokeAndHandle(ServletInvocableHandlerMethod.java:117) ~[spring-webmvc-5.3.27.jar:5.3.27]
	at org.springframework.web.servlet.mvc.method.annotation.RequestMappingHandlerAdapter.invokeHandlerMethod(RequestMappingHandlerAdapter.java:895) ~[spring-webmvc-5.3.27.jar:5.3.27]
	at org.springframework.web.servlet.mvc.method.annotation.RequestMappingHandlerAdapter.handleInternal(RequestMappingHandlerAdapter.java:808) ~[spring-webmvc-5.3.27.jar:5.3.27]
	at org.springframework.web.servlet.mvc.method.AbstractHandlerMethodAdapter.handle(AbstractHandlerMethodAdapter.java:87) ~[spring-webmvc-5.3.27.jar:5.3.27]
	at org.springframework.web.servlet.DispatcherServlet.doDispatch(DispatcherServlet.java:1072) ~[spring-webmvc-5.3.27.jar:5.3.27]
	at org.springframework.web.servlet.DispatcherServlet.doService(DispatcherServlet.java:965) ~[spring-webmvc-5.3.27.jar:5.3.27]
	at org.springframework.web.servlet.FrameworkServlet.processRequest(FrameworkServlet.java:1006) ~[spring-webmvc-5.3.27.jar:5.3.27]
	at org.springframework.web.servlet.FrameworkServlet.doPost(FrameworkServlet.java:909) ~[spring-webmvc-5.3.27.jar:5.3.27]
	at javax.servlet.http.HttpServlet.service(HttpServlet.java:555) ~[tomcat-embed-core-9.0.75.jar:4.0.FR]
	at org.springframework.web.servlet.FrameworkServlet.service(FrameworkServlet.java:883) ~[spring-webmvc-5.3.27.jar:5.3.27]
	at javax.servlet.http.HttpServlet.service(HttpServlet.java:623) ~[tomcat-embed-core-9.0.75.jar:4.0.FR]
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:209) ~[tomcat-embed-core-9.0.75.jar:9.0.75]
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:153) ~[tomcat-embed-core-9.0.75.jar:9.0.75]
	at com.luojiawei.his_service.filter.RefreshTokenFilter.doFilterInternal(RefreshTokenFilter.java:58) ~[classes/:na]
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:117) ~[spring-web-5.3.27.jar:5.3.27]
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:178) ~[tomcat-embed-core-9.0.75.jar:9.0.75]
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:153) ~[tomcat-embed-core-9.0.75.jar:9.0.75]
	at org.springframework.web.filter.RequestContextFilter.doFilterInternal(RequestContextFilter.java:100) ~[spring-web-5.3.27.jar:5.3.27]
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:117) ~[spring-web-5.3.27.jar:5.3.27]
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:178) ~[tomcat-embed-core-9.0.75.jar:9.0.75]
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:153) ~[tomcat-embed-core-9.0.75.jar:9.0.75]
	at org.springframework.web.filter.FormContentFilter.doFilterInternal(FormContentFilter.java:93) ~[spring-web-5.3.27.jar:5.3.27]
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:117) ~[spring-web-5.3.27.jar:5.3.27]
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:178) ~[tomcat-embed-core-9.0.75.jar:9.0.75]
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:153) ~[tomcat-embed-core-9.0.75.jar:9.0.75]
	at org.springframework.boot.actuate.metrics.web.servlet.WebMvcMetricsFilter.doFilterInternal(WebMvcMetricsFilter.java:96) ~[spring-boot-actuator-2.7.12.jar:2.7.12]
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:117) ~[spring-web-5.3.27.jar:5.3.27]
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:178) ~[tomcat-embed-core-9.0.75.jar:9.0.75]
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:153) ~[tomcat-embed-core-9.0.75.jar:9.0.75]
	at org.springframework.web.filter.CharacterEncodingFilter.doFilterInternal(CharacterEncodingFilter.java:201) ~[spring-web-5.3.27.jar:5.3.27]
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:117) ~[spring-web-5.3.27.jar:5.3.27]
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:178) ~[tomcat-embed-core-9.0.75.jar:9.0.75]
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:153) ~[tomcat-embed-core-9.0.75.jar:9.0.75]
	at org.apache.catalina.core.StandardWrapperValve.invoke(StandardWrapperValve.java:167) ~[tomcat-embed-core-9.0.75.jar:9.0.75]
	at org.apache.catalina.core.StandardContextValve.invoke(StandardContextValve.java:90) ~[tomcat-embed-core-9.0.75.jar:9.0.75]
	at org.apache.catalina.authenticator.AuthenticatorBase.invoke(AuthenticatorBase.java:481) ~[tomcat-embed-core-9.0.75.jar:9.0.75]
	at org.apache.catalina.core.StandardHostValve.invoke(StandardHostValve.java:130) ~[tomcat-embed-core-9.0.75.jar:9.0.75]
	at org.apache.catalina.valves.ErrorReportValve.invoke(ErrorReportValve.java:93) ~[tomcat-embed-core-9.0.75.jar:9.0.75]
	at org.apache.catalina.core.StandardEngineValve.invoke(StandardEngineValve.java:74) ~[tomcat-embed-core-9.0.75.jar:9.0.75]
	at org.apache.catalina.connector.CoyoteAdapter.service(CoyoteAdapter.java:343) ~[tomcat-embed-core-9.0.75.jar:9.0.75]
	at org.apache.coyote.http11.Http11Processor.service(Http11Processor.java:390) ~[tomcat-embed-core-9.0.75.jar:9.0.75]
	at org.apache.coyote.AbstractProcessorLight.process(AbstractProcessorLight.java:63) ~[tomcat-embed-core-9.0.75.jar:9.0.75]
	at org.apache.coyote.AbstractProtocol$ConnectionHandler.process(AbstractProtocol.java:926) ~[tomcat-embed-core-9.0.75.jar:9.0.75]
	at org.apache.tomcat.util.net.NioEndpoint$SocketProcessor.doRun(NioEndpoint.java:1791) ~[tomcat-embed-core-9.0.75.jar:9.0.75]
	at org.apache.tomcat.util.net.SocketProcessorBase.run(SocketProcessorBase.java:52) ~[tomcat-embed-core-9.0.75.jar:9.0.75]
	at org.apache.tomcat.util.threads.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1191) ~[tomcat-embed-core-9.0.75.jar:9.0.75]
	at org.apache.tomcat.util.threads.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:659) ~[tomcat-embed-core-9.0.75.jar:9.0.75]
	at org.apache.tomcat.util.threads.TaskThread$WrappingRunnable.run(TaskThread.java:61) ~[tomcat-embed-core-9.0.75.jar:9.0.75]
	at java.base/java.lang.Thread.run(Thread.java:840) ~[na:na]

16:50:13:086  WARN 4556 --- [Thread-18] c.a.n.common.http.HttpClientBeanHolder   : [HttpClientBeanHolder] Start destroying common HttpClient
16:50:13:093  WARN 4556 --- [Thread-15] c.a.nacos.common.notify.NotifyCenter     : [NotifyCenter] Start destroying Publisher
16:50:13:094  WARN 4556 --- [Thread-15] c.a.nacos.common.notify.NotifyCenter     : [NotifyCenter] Destruction of the end
16:50:13:102  WARN 4556 --- [Thread-18] c.a.n.common.http.HttpClientBeanHolder   : [HttpClientBeanHolder] Destruction of the end
16:50:13:184  INFO 4556 --- [SpringApplicationShutdownHook] c.a.c.n.registry.NacosServiceRegistry    : De-registering from Nacos Server now...
16:50:13:219  INFO 4556 --- [SpringApplicationShutdownHook] c.a.c.n.registry.NacosServiceRegistry    : De-registration finished.
16:50:13:264  INFO 4556 --- [SpringApplicationShutdownHook] com.zaxxer.hikari.HikariDataSource       : HikariPool-1 - Shutdown initiated...
16:50:13:638  INFO 4556 --- [SpringApplicationShutdownHook] com.zaxxer.hikari.HikariDataSource       : HikariPool-1 - Shutdown completed.
16:50:21:405  INFO 21660 --- [main] c.l.his_service.HisServiceApplication    : Starting HisServiceApplication using Java 17.0.11 on luo with PID 21660 (A:\Desktop\workspace\HIS\his_service\target\classes started by 22407 in A:\Desktop\workspace\HIS)
16:50:21:406 DEBUG 21660 --- [main] c.l.his_service.HisServiceApplication    : Running with Spring Boot v2.7.12, Spring v5.3.27
16:50:21:406  INFO 21660 --- [main] c.l.his_service.HisServiceApplication    : The following 1 profile is active: "dev"
16:50:22:520  INFO 21660 --- [main] .s.d.r.c.RepositoryConfigurationDelegate : Multiple Spring Data modules found, entering strict repository configuration mode
16:50:22:522  INFO 21660 --- [main] .s.d.r.c.RepositoryConfigurationDelegate : Bootstrapping Spring Data Redis repositories in DEFAULT mode.
16:50:22:554  INFO 21660 --- [main] .s.d.r.c.RepositoryConfigurationDelegate : Finished Spring Data repository scanning in 15 ms. Found 0 Redis repository interfaces.
16:50:22:852  INFO 21660 --- [main] o.s.cloud.context.scope.GenericScope     : BeanFactory id=ac61872e-faec-371d-922e-ad941e5407d7
16:50:23:613  INFO 21660 --- [main] o.s.b.w.embedded.tomcat.TomcatWebServer  : Tomcat initialized with port(s): 8080 (http)
16:50:23:627  INFO 21660 --- [main] o.apache.catalina.core.StandardService   : Starting service [Tomcat]
16:50:23:628  INFO 21660 --- [main] org.apache.catalina.core.StandardEngine  : Starting Servlet engine: [Apache Tomcat/9.0.75]
16:50:23:808  INFO 21660 --- [main] o.a.c.c.C.[Tomcat].[localhost].[/]       : Initializing Spring embedded WebApplicationContext
16:50:23:808  INFO 21660 --- [main] w.s.c.ServletWebServerApplicationContext : Root WebApplicationContext: initialization completed in 2347 ms
16:50:24:073  INFO 21660 --- [main] org.redisson.Version                     : Redisson 3.17.7
16:50:24:565  INFO 21660 --- [redisson-netty-2-9] o.r.c.pool.MasterPubSubConnectionPool    : 1 connections initialized for 111.230.32.147/111.230.32.147:9631
16:50:25:276  INFO 21660 --- [redisson-netty-2-19] o.r.c.pool.MasterConnectionPool          : 24 connections initialized for 111.230.32.147/111.230.32.147:9631
16:50:25:646 DEBUG 21660 --- [main] c.l.h.filter.RefreshTokenFilter          : Filter 'refreshTokenFilter' configured for use
16:50:26:542  INFO 21660 --- [main] o.s.c.openfeign.FeignClientFactoryBean   : For 'flask-service' URL not provided. Will try picking an instance via load-balancing.
16:50:26:667  INFO 21660 --- [main] o.s.c.openfeign.FeignClientFactoryBean   : For 'ai-service' URL not provided. Will try picking an instance via load-balancing.
16:50:26:714  WARN 21660 --- [main] c.b.m.core.metadata.TableInfoHelper      : Can not find table primary key in Class: "java.lang.Object".
16:50:26:714  WARN 21660 --- [main] c.b.m.core.injector.DefaultSqlInjector   : class java.lang.Object ,Not found @TableId annotation, Cannot use Mybatis-Plus 'xxById' Method.
16:50:28:563  WARN 21660 --- [main] iguration$LoadBalancerCaffeineWarnLogger : Spring Cloud LoadBalancer is currently working with the default cache. While this cache implementation is useful for development and tests, it's recommended to use Caffeine cache in production.You can switch to using Caffeine cache, by adding it and org.springframework.cache.caffeine.CaffeineCacheManager to the classpath.
16:50:28:569  INFO 21660 --- [main] o.s.b.a.e.web.EndpointLinksResolver      : Exposing 1 endpoint(s) beneath base path '/actuator'
16:50:28:654  INFO 21660 --- [main] o.s.b.w.embedded.tomcat.TomcatWebServer  : Tomcat started on port(s): 8080 (http) with context path ''
16:50:28:692  INFO 21660 --- [main] c.a.n.p.a.s.c.ClientAuthPluginManager    : [ClientAuthPluginManager] Load ClientAuthService com.alibaba.nacos.client.auth.impl.NacosClientAuthServiceImpl success.
16:50:28:692  INFO 21660 --- [main] c.a.n.p.a.s.c.ClientAuthPluginManager    : [ClientAuthPluginManager] Load ClientAuthService com.alibaba.nacos.client.auth.ram.RamClientAuthServiceImpl success.
16:50:30:316  INFO 21660 --- [main] c.a.n.c.a.AbstractAbilityControlManager  : Ready to get current node abilities...
16:50:30:317  INFO 21660 --- [main] c.a.n.c.a.AbstractAbilityControlManager  : Ready to initialize current node abilities, support modes: [SDK_CLIENT]
16:50:30:318  INFO 21660 --- [main] c.a.n.c.a.AbstractAbilityControlManager  : Initialize current abilities finish...
16:50:30:318  INFO 21660 --- [main] c.a.n.c.a.d.NacosAbilityManagerHolder    : [AbilityControlManager] Successfully initialize AbilityControlManager
16:50:30:429  INFO 21660 --- [main] c.a.c.n.registry.NacosServiceRegistry    : nacos registry, DEFAULT_GROUP his-service 10.21.93.70:8848 register finished
16:50:30:743  INFO 21660 --- [main] c.l.his_service.HisServiceApplication    : Started HisServiceApplication in 10.417 seconds (JVM running for 11.749)
16:50:30:937  INFO 21660 --- [RMI TCP Connection(1)-10.21.93.70] o.a.c.c.C.[Tomcat].[localhost].[/]       : Initializing Spring DispatcherServlet 'dispatcherServlet'
16:50:30:938  INFO 21660 --- [RMI TCP Connection(1)-10.21.93.70] o.s.web.servlet.DispatcherServlet        : Initializing Servlet 'dispatcherServlet'
16:50:30:941  INFO 21660 --- [RMI TCP Connection(1)-10.21.93.70] o.s.web.servlet.DispatcherServlet        : Completed initialization in 3 ms
16:50:30:946  INFO 21660 --- [RMI TCP Connection(3)-10.21.93.70] com.zaxxer.hikari.HikariDataSource       : HikariPool-1 - Starting...
16:50:31:676  INFO 21660 --- [RMI TCP Connection(3)-10.21.93.70] com.zaxxer.hikari.HikariDataSource       : HikariPool-1 - Start completed.
17:01:27:514 DEBUG 21660 --- [http-nio-8080-exec-2] c.l.h.m.D.selectById                     : ==>  Preparing: SELECT id,patient_id,doctor_id,disease_name,disease_category,aimodel_id,result,create_time,status,id_card,name,score,remark FROM diagnosis_report WHERE id=?
17:01:27:576 DEBUG 21660 --- [http-nio-8080-exec-2] c.l.h.m.D.selectById                     : ==> Parameters: 1(Integer)
17:01:27:683 DEBUG 21660 --- [http-nio-8080-exec-2] c.l.h.m.D.selectById                     : <==      Total: 1
17:01:27:685 DEBUG 21660 --- [http-nio-8080-exec-2] c.l.h.mapper.PatientMapper.selectById    : ==>  Preparing: SELECT id,phone,id_card,name,verified,verified_by,verified_time,open_id,hospital_pid FROM patient WHERE id=?
17:01:27:686 DEBUG 21660 --- [http-nio-8080-exec-2] c.l.h.mapper.PatientMapper.selectById    : ==> Parameters: 1(Integer)
17:01:27:720 DEBUG 21660 --- [http-nio-8080-exec-2] c.l.h.mapper.PatientMapper.selectById    : <==      Total: 1
17:01:27:726 DEBUG 21660 --- [http-nio-8080-exec-2] c.l.h.mapper.DoctorMapper.selectById     : ==>  Preparing: SELECT id,phone,id_card,name,verified,verified_by,verified_time,license,department,hospital_pid FROM doctor WHERE id=?
17:01:27:726 DEBUG 21660 --- [http-nio-8080-exec-2] c.l.h.mapper.DoctorMapper.selectById     : ==> Parameters: 1(Integer)
17:01:27:762 DEBUG 21660 --- [http-nio-8080-exec-2] c.l.h.mapper.DoctorMapper.selectById     : <==      Total: 1
17:01:27:767 DEBUG 21660 --- [http-nio-8080-exec-2] c.l.h.m.E.selectListByDiagnosisId        : ==>  Preparing: select * from eye_images where dignosis_report_id = ?
17:01:27:768 DEBUG 21660 --- [http-nio-8080-exec-2] c.l.h.m.E.selectListByDiagnosisId        : ==> Parameters: 1(Integer)
17:01:27:802 DEBUG 21660 --- [http-nio-8080-exec-2] c.l.h.m.E.selectListByDiagnosisId        : <==      Total: 1
17:01:27:804 DEBUG 21660 --- [http-nio-8080-exec-2] c.l.h.m.T.selectByDiagnosisId            : ==>  Preparing: select * from treatment_plans where diagnosis_id = ?
17:01:27:804 DEBUG 21660 --- [http-nio-8080-exec-2] c.l.h.m.T.selectByDiagnosisId            : ==> Parameters: 1(Integer)
17:01:27:839 DEBUG 21660 --- [http-nio-8080-exec-2] c.l.h.m.T.selectByDiagnosisId            : <==      Total: 1
17:01:27:840 DEBUG 21660 --- [http-nio-8080-exec-2] c.l.h.m.M.selectByDiagnosisId            : ==>  Preparing: select * from medication_recommendations where diagnosis_id = ?
17:01:27:840 DEBUG 21660 --- [http-nio-8080-exec-2] c.l.h.m.M.selectByDiagnosisId            : ==> Parameters: 1(Integer)
17:01:27:878 DEBUG 21660 --- [http-nio-8080-exec-2] c.l.h.m.M.selectByDiagnosisId            : <==      Total: 1
17:01:27:879 DEBUG 21660 --- [http-nio-8080-exec-2] c.l.h.mapper.AiModelMapper.selectById    : ==>  Preparing: SELECT id,version,deploy_time,accuracy FROM ai_model WHERE id=?
17:01:27:880 DEBUG 21660 --- [http-nio-8080-exec-2] c.l.h.mapper.AiModelMapper.selectById    : ==> Parameters: 1(Integer)
17:01:27:915 DEBUG 21660 --- [http-nio-8080-exec-2] c.l.h.mapper.AiModelMapper.selectById    : <==      Total: 1
17:01:28:076 DEBUG 21660 --- [http-nio-8080-exec-2] c.l.api.client.FlaskAiDoctorClient       : [FlaskAiDoctorClient#uploadFile] ---> POST http://ai-service/api/eye-doctor/completions HTTP/1.1
17:01:28:077 DEBUG 21660 --- [http-nio-8080-exec-2] c.l.api.client.FlaskAiDoctorClient       : [FlaskAiDoctorClient#uploadFile] Content-Length: 726
17:01:28:077 DEBUG 21660 --- [http-nio-8080-exec-2] c.l.api.client.FlaskAiDoctorClient       : [FlaskAiDoctorClient#uploadFile] Content-Type: application/json
17:01:28:077 DEBUG 21660 --- [http-nio-8080-exec-2] c.l.api.client.FlaskAiDoctorClient       : [FlaskAiDoctorClient#uploadFile] 
17:01:28:077 DEBUG 21660 --- [http-nio-8080-exec-2] c.l.api.client.FlaskAiDoctorClient       : [FlaskAiDoctorClient#uploadFile] {"diagnosis_name":"","diagnosis_category":"","result":"A","remark":"A","treatment_plan":{"id":1,"treatmentType":1,"treatmentDetail":"","startTime":"2025-03-01 09:00:00","endDate":"2025-03-10 09:00:00","doctorId":1,"createdTime":[2025,3,1,9,0],"updatedTime":[2025,3,1,9,0]},"medications":[{"id":1,"diagnosisId":1,"medicationName":"A","dosage":"10mg","frequency":"","sideEffects":"","startTime":[2025,3,1,9,0],"endTime":[2025,3,10,9,0],"doctorId":1,"createdTime":"2025-03-01 09:00:00","updatedTime":"2025-03-01 09:00:00"}],"previous_conversations":[{"role":"pariatur tempor do","content":"sit cupidatat commodo"}],"question":"irure eu esse","stream":false}
17:01:28:079 DEBUG 21660 --- [http-nio-8080-exec-2] c.l.api.client.FlaskAiDoctorClient       : [FlaskAiDoctorClient#uploadFile] ---> END HTTP (726-byte body)
17:01:30:435 DEBUG 21660 --- [http-nio-8080-exec-2] c.l.api.client.FlaskAiDoctorClient       : [FlaskAiDoctorClient#uploadFile] <--- ERROR ConnectException: Connection refused: getsockopt (2354ms)
17:01:30:436 DEBUG 21660 --- [http-nio-8080-exec-2] c.l.api.client.FlaskAiDoctorClient       : [FlaskAiDoctorClient#uploadFile] java.net.ConnectException: Connection refused: getsockopt
	at java.base/sun.nio.ch.Net.pollConnect(Native Method)
	at java.base/sun.nio.ch.Net.pollConnectNow(Net.java:672)
	at java.base/sun.nio.ch.NioSocketImpl.timedFinishConnect(NioSocketImpl.java:554)
	at java.base/sun.nio.ch.NioSocketImpl.connect(NioSocketImpl.java:602)
	at java.base/java.net.Socket.connect(Socket.java:633)
	at java.base/sun.net.NetworkClient.doConnect(NetworkClient.java:178)
	at java.base/sun.net.www.http.HttpClient.openServer(HttpClient.java:533)
	at java.base/sun.net.www.http.HttpClient.openServer(HttpClient.java:638)
	at java.base/sun.net.www.http.HttpClient.<init>(HttpClient.java:281)
	at java.base/sun.net.www.http.HttpClient.New(HttpClient.java:386)
	at java.base/sun.net.www.http.HttpClient.New(HttpClient.java:408)
	at java.base/sun.net.www.protocol.http.HttpURLConnection.getNewHttpClient(HttpURLConnection.java:1309)
	at java.base/sun.net.www.protocol.http.HttpURLConnection.plainConnect0(HttpURLConnection.java:1242)
	at java.base/sun.net.www.protocol.http.HttpURLConnection.plainConnect(HttpURLConnection.java:1128)
	at java.base/sun.net.www.protocol.http.HttpURLConnection.connect(HttpURLConnection.java:1057)
	at java.base/sun.net.www.protocol.http.HttpURLConnection.getOutputStream0(HttpURLConnection.java:1451)
	at java.base/sun.net.www.protocol.http.HttpURLConnection.getOutputStream(HttpURLConnection.java:1422)
	at feign.Client$Default.convertAndSend(Client.java:208)
	at feign.Client$Default.execute(Client.java:105)
	at org.springframework.cloud.openfeign.loadbalancer.LoadBalancerUtils.executeWithLoadBalancerLifecycleProcessing(LoadBalancerUtils.java:57)
	at org.springframework.cloud.openfeign.loadbalancer.LoadBalancerUtils.executeWithLoadBalancerLifecycleProcessing(LoadBalancerUtils.java:95)
	at org.springframework.cloud.openfeign.loadbalancer.FeignBlockingLoadBalancerClient.execute(FeignBlockingLoadBalancerClient.java:114)
	at feign.SynchronousMethodHandler.executeAndDecode(SynchronousMethodHandler.java:121)
	at feign.SynchronousMethodHandler.invoke(SynchronousMethodHandler.java:91)
	at feign.ReflectiveFeign$FeignInvocationHandler.invoke(ReflectiveFeign.java:100)
	at jdk.proxy2/jdk.proxy2.$Proxy135.uploadFile(Unknown Source)
	at com.luojiawei.his_service.controller.ChatController.ask(ChatController.java:38)
	at java.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at java.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:77)
	at java.base/jdk.internal.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.base/java.lang.reflect.Method.invoke(Method.java:568)
	at org.springframework.web.method.support.InvocableHandlerMethod.doInvoke(InvocableHandlerMethod.java:205)
	at org.springframework.web.method.support.InvocableHandlerMethod.invokeForRequest(InvocableHandlerMethod.java:150)
	at org.springframework.web.servlet.mvc.method.annotation.ServletInvocableHandlerMethod.invokeAndHandle(ServletInvocableHandlerMethod.java:117)
	at org.springframework.web.servlet.mvc.method.annotation.RequestMappingHandlerAdapter.invokeHandlerMethod(RequestMappingHandlerAdapter.java:895)
	at org.springframework.web.servlet.mvc.method.annotation.RequestMappingHandlerAdapter.handleInternal(RequestMappingHandlerAdapter.java:808)
	at org.springframework.web.servlet.mvc.method.AbstractHandlerMethodAdapter.handle(AbstractHandlerMethodAdapter.java:87)
	at org.springframework.web.servlet.DispatcherServlet.doDispatch(DispatcherServlet.java:1072)
	at org.springframework.web.servlet.DispatcherServlet.doService(DispatcherServlet.java:965)
	at org.springframework.web.servlet.FrameworkServlet.processRequest(FrameworkServlet.java:1006)
	at org.springframework.web.servlet.FrameworkServlet.doPost(FrameworkServlet.java:909)
	at javax.servlet.http.HttpServlet.service(HttpServlet.java:555)
	at org.springframework.web.servlet.FrameworkServlet.service(FrameworkServlet.java:883)
	at javax.servlet.http.HttpServlet.service(HttpServlet.java:623)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:209)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:153)
	at com.luojiawei.his_service.filter.RefreshTokenFilter.doFilterInternal(RefreshTokenFilter.java:58)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:117)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:178)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:153)
	at org.springframework.web.filter.RequestContextFilter.doFilterInternal(RequestContextFilter.java:100)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:117)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:178)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:153)
	at org.springframework.web.filter.FormContentFilter.doFilterInternal(FormContentFilter.java:93)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:117)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:178)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:153)
	at org.springframework.boot.actuate.metrics.web.servlet.WebMvcMetricsFilter.doFilterInternal(WebMvcMetricsFilter.java:96)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:117)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:178)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:153)
	at org.springframework.web.filter.CharacterEncodingFilter.doFilterInternal(CharacterEncodingFilter.java:201)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:117)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:178)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:153)
	at org.apache.catalina.core.StandardWrapperValve.invoke(StandardWrapperValve.java:167)
	at org.apache.catalina.core.StandardContextValve.invoke(StandardContextValve.java:90)
	at org.apache.catalina.authenticator.AuthenticatorBase.invoke(AuthenticatorBase.java:481)
	at org.apache.catalina.core.StandardHostValve.invoke(StandardHostValve.java:130)
	at org.apache.catalina.valves.ErrorReportValve.invoke(ErrorReportValve.java:93)
	at org.apache.catalina.core.StandardEngineValve.invoke(StandardEngineValve.java:74)
	at org.apache.catalina.connector.CoyoteAdapter.service(CoyoteAdapter.java:343)
	at org.apache.coyote.http11.Http11Processor.service(Http11Processor.java:390)
	at org.apache.coyote.AbstractProcessorLight.process(AbstractProcessorLight.java:63)
	at org.apache.coyote.AbstractProtocol$ConnectionHandler.process(AbstractProtocol.java:926)
	at org.apache.tomcat.util.net.NioEndpoint$SocketProcessor.doRun(NioEndpoint.java:1791)
	at org.apache.tomcat.util.net.SocketProcessorBase.run(SocketProcessorBase.java:52)
	at org.apache.tomcat.util.threads.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1191)
	at org.apache.tomcat.util.threads.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:659)
	at org.apache.tomcat.util.threads.TaskThread$WrappingRunnable.run(TaskThread.java:61)
	at java.base/java.lang.Thread.run(Thread.java:840)

17:01:30:436 DEBUG 21660 --- [http-nio-8080-exec-2] c.l.api.client.FlaskAiDoctorClient       : [FlaskAiDoctorClient#uploadFile] <--- END ERROR
17:01:30:474 ERROR 21660 --- [http-nio-8080-exec-2] o.a.c.c.C.[.[.[/].[dispatcherServlet]    : Servlet.service() for servlet [dispatcherServlet] in context with path [] threw exception [Request processing failed; nested exception is feign.RetryableException: Connection refused: getsockopt executing POST http://ai-service/api/eye-doctor/completions] with root cause

java.net.ConnectException: Connection refused: getsockopt
	at java.base/sun.nio.ch.Net.pollConnect(Native Method) ~[na:na]
	at java.base/sun.nio.ch.Net.pollConnectNow(Net.java:672) ~[na:na]
	at java.base/sun.nio.ch.NioSocketImpl.timedFinishConnect(NioSocketImpl.java:554) ~[na:na]
	at java.base/sun.nio.ch.NioSocketImpl.connect(NioSocketImpl.java:602) ~[na:na]
	at java.base/java.net.Socket.connect(Socket.java:633) ~[na:na]
	at java.base/sun.net.NetworkClient.doConnect(NetworkClient.java:178) ~[na:na]
	at java.base/sun.net.www.http.HttpClient.openServer(HttpClient.java:533) ~[na:na]
	at java.base/sun.net.www.http.HttpClient.openServer(HttpClient.java:638) ~[na:na]
	at java.base/sun.net.www.http.HttpClient.<init>(HttpClient.java:281) ~[na:na]
	at java.base/sun.net.www.http.HttpClient.New(HttpClient.java:386) ~[na:na]
	at java.base/sun.net.www.http.HttpClient.New(HttpClient.java:408) ~[na:na]
	at java.base/sun.net.www.protocol.http.HttpURLConnection.getNewHttpClient(HttpURLConnection.java:1309) ~[na:na]
	at java.base/sun.net.www.protocol.http.HttpURLConnection.plainConnect0(HttpURLConnection.java:1242) ~[na:na]
	at java.base/sun.net.www.protocol.http.HttpURLConnection.plainConnect(HttpURLConnection.java:1128) ~[na:na]
	at java.base/sun.net.www.protocol.http.HttpURLConnection.connect(HttpURLConnection.java:1057) ~[na:na]
	at java.base/sun.net.www.protocol.http.HttpURLConnection.getOutputStream0(HttpURLConnection.java:1451) ~[na:na]
	at java.base/sun.net.www.protocol.http.HttpURLConnection.getOutputStream(HttpURLConnection.java:1422) ~[na:na]
	at feign.Client$Default.convertAndSend(Client.java:208) ~[feign-core-11.10.jar:na]
	at feign.Client$Default.execute(Client.java:105) ~[feign-core-11.10.jar:na]
	at org.springframework.cloud.openfeign.loadbalancer.LoadBalancerUtils.executeWithLoadBalancerLifecycleProcessing(LoadBalancerUtils.java:57) ~[spring-cloud-openfeign-core-3.1.5.jar:3.1.5]
	at org.springframework.cloud.openfeign.loadbalancer.LoadBalancerUtils.executeWithLoadBalancerLifecycleProcessing(LoadBalancerUtils.java:95) ~[spring-cloud-openfeign-core-3.1.5.jar:3.1.5]
	at org.springframework.cloud.openfeign.loadbalancer.FeignBlockingLoadBalancerClient.execute(FeignBlockingLoadBalancerClient.java:114) ~[spring-cloud-openfeign-core-3.1.5.jar:3.1.5]
	at feign.SynchronousMethodHandler.executeAndDecode(SynchronousMethodHandler.java:121) ~[feign-core-11.10.jar:na]
	at feign.SynchronousMethodHandler.invoke(SynchronousMethodHandler.java:91) ~[feign-core-11.10.jar:na]
	at feign.ReflectiveFeign$FeignInvocationHandler.invoke(ReflectiveFeign.java:100) ~[feign-core-11.10.jar:na]
	at jdk.proxy2/jdk.proxy2.$Proxy135.uploadFile(Unknown Source) ~[na:na]
	at com.luojiawei.his_service.controller.ChatController.ask(ChatController.java:38) ~[classes/:na]
	at java.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke0(Native Method) ~[na:na]
	at java.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:77) ~[na:na]
	at java.base/jdk.internal.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43) ~[na:na]
	at java.base/java.lang.reflect.Method.invoke(Method.java:568) ~[na:na]
	at org.springframework.web.method.support.InvocableHandlerMethod.doInvoke(InvocableHandlerMethod.java:205) ~[spring-web-5.3.27.jar:5.3.27]
	at org.springframework.web.method.support.InvocableHandlerMethod.invokeForRequest(InvocableHandlerMethod.java:150) ~[spring-web-5.3.27.jar:5.3.27]
	at org.springframework.web.servlet.mvc.method.annotation.ServletInvocableHandlerMethod.invokeAndHandle(ServletInvocableHandlerMethod.java:117) ~[spring-webmvc-5.3.27.jar:5.3.27]
	at org.springframework.web.servlet.mvc.method.annotation.RequestMappingHandlerAdapter.invokeHandlerMethod(RequestMappingHandlerAdapter.java:895) ~[spring-webmvc-5.3.27.jar:5.3.27]
	at org.springframework.web.servlet.mvc.method.annotation.RequestMappingHandlerAdapter.handleInternal(RequestMappingHandlerAdapter.java:808) ~[spring-webmvc-5.3.27.jar:5.3.27]
	at org.springframework.web.servlet.mvc.method.AbstractHandlerMethodAdapter.handle(AbstractHandlerMethodAdapter.java:87) ~[spring-webmvc-5.3.27.jar:5.3.27]
	at org.springframework.web.servlet.DispatcherServlet.doDispatch(DispatcherServlet.java:1072) ~[spring-webmvc-5.3.27.jar:5.3.27]
	at org.springframework.web.servlet.DispatcherServlet.doService(DispatcherServlet.java:965) ~[spring-webmvc-5.3.27.jar:5.3.27]
	at org.springframework.web.servlet.FrameworkServlet.processRequest(FrameworkServlet.java:1006) ~[spring-webmvc-5.3.27.jar:5.3.27]
	at org.springframework.web.servlet.FrameworkServlet.doPost(FrameworkServlet.java:909) ~[spring-webmvc-5.3.27.jar:5.3.27]
	at javax.servlet.http.HttpServlet.service(HttpServlet.java:555) ~[tomcat-embed-core-9.0.75.jar:4.0.FR]
	at org.springframework.web.servlet.FrameworkServlet.service(FrameworkServlet.java:883) ~[spring-webmvc-5.3.27.jar:5.3.27]
	at javax.servlet.http.HttpServlet.service(HttpServlet.java:623) ~[tomcat-embed-core-9.0.75.jar:4.0.FR]
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:209) ~[tomcat-embed-core-9.0.75.jar:9.0.75]
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:153) ~[tomcat-embed-core-9.0.75.jar:9.0.75]
	at com.luojiawei.his_service.filter.RefreshTokenFilter.doFilterInternal(RefreshTokenFilter.java:58) ~[classes/:na]
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:117) ~[spring-web-5.3.27.jar:5.3.27]
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:178) ~[tomcat-embed-core-9.0.75.jar:9.0.75]
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:153) ~[tomcat-embed-core-9.0.75.jar:9.0.75]
	at org.springframework.web.filter.RequestContextFilter.doFilterInternal(RequestContextFilter.java:100) ~[spring-web-5.3.27.jar:5.3.27]
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:117) ~[spring-web-5.3.27.jar:5.3.27]
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:178) ~[tomcat-embed-core-9.0.75.jar:9.0.75]
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:153) ~[tomcat-embed-core-9.0.75.jar:9.0.75]
	at org.springframework.web.filter.FormContentFilter.doFilterInternal(FormContentFilter.java:93) ~[spring-web-5.3.27.jar:5.3.27]
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:117) ~[spring-web-5.3.27.jar:5.3.27]
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:178) ~[tomcat-embed-core-9.0.75.jar:9.0.75]
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:153) ~[tomcat-embed-core-9.0.75.jar:9.0.75]
	at org.springframework.boot.actuate.metrics.web.servlet.WebMvcMetricsFilter.doFilterInternal(WebMvcMetricsFilter.java:96) ~[spring-boot-actuator-2.7.12.jar:2.7.12]
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:117) ~[spring-web-5.3.27.jar:5.3.27]
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:178) ~[tomcat-embed-core-9.0.75.jar:9.0.75]
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:153) ~[tomcat-embed-core-9.0.75.jar:9.0.75]
	at org.springframework.web.filter.CharacterEncodingFilter.doFilterInternal(CharacterEncodingFilter.java:201) ~[spring-web-5.3.27.jar:5.3.27]
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:117) ~[spring-web-5.3.27.jar:5.3.27]
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:178) ~[tomcat-embed-core-9.0.75.jar:9.0.75]
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:153) ~[tomcat-embed-core-9.0.75.jar:9.0.75]
	at org.apache.catalina.core.StandardWrapperValve.invoke(StandardWrapperValve.java:167) ~[tomcat-embed-core-9.0.75.jar:9.0.75]
	at org.apache.catalina.core.StandardContextValve.invoke(StandardContextValve.java:90) ~[tomcat-embed-core-9.0.75.jar:9.0.75]
	at org.apache.catalina.authenticator.AuthenticatorBase.invoke(AuthenticatorBase.java:481) ~[tomcat-embed-core-9.0.75.jar:9.0.75]
	at org.apache.catalina.core.StandardHostValve.invoke(StandardHostValve.java:130) ~[tomcat-embed-core-9.0.75.jar:9.0.75]
	at org.apache.catalina.valves.ErrorReportValve.invoke(ErrorReportValve.java:93) ~[tomcat-embed-core-9.0.75.jar:9.0.75]
	at org.apache.catalina.core.StandardEngineValve.invoke(StandardEngineValve.java:74) ~[tomcat-embed-core-9.0.75.jar:9.0.75]
	at org.apache.catalina.connector.CoyoteAdapter.service(CoyoteAdapter.java:343) ~[tomcat-embed-core-9.0.75.jar:9.0.75]
	at org.apache.coyote.http11.Http11Processor.service(Http11Processor.java:390) ~[tomcat-embed-core-9.0.75.jar:9.0.75]
	at org.apache.coyote.AbstractProcessorLight.process(AbstractProcessorLight.java:63) ~[tomcat-embed-core-9.0.75.jar:9.0.75]
	at org.apache.coyote.AbstractProtocol$ConnectionHandler.process(AbstractProtocol.java:926) ~[tomcat-embed-core-9.0.75.jar:9.0.75]
	at org.apache.tomcat.util.net.NioEndpoint$SocketProcessor.doRun(NioEndpoint.java:1791) ~[tomcat-embed-core-9.0.75.jar:9.0.75]
	at org.apache.tomcat.util.net.SocketProcessorBase.run(SocketProcessorBase.java:52) ~[tomcat-embed-core-9.0.75.jar:9.0.75]
	at org.apache.tomcat.util.threads.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1191) ~[tomcat-embed-core-9.0.75.jar:9.0.75]
	at org.apache.tomcat.util.threads.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:659) ~[tomcat-embed-core-9.0.75.jar:9.0.75]
	at org.apache.tomcat.util.threads.TaskThread$WrappingRunnable.run(TaskThread.java:61) ~[tomcat-embed-core-9.0.75.jar:9.0.75]
	at java.base/java.lang.Thread.run(Thread.java:840) ~[na:na]

17:01:55:642  WARN 21660 --- [Thread-18] c.a.n.common.http.HttpClientBeanHolder   : [HttpClientBeanHolder] Start destroying common HttpClient
17:01:55:642  WARN 21660 --- [Thread-15] c.a.nacos.common.notify.NotifyCenter     : [NotifyCenter] Start destroying Publisher
17:01:55:643  WARN 21660 --- [Thread-15] c.a.nacos.common.notify.NotifyCenter     : [NotifyCenter] Destruction of the end
17:01:55:647  WARN 21660 --- [Thread-18] c.a.n.common.http.HttpClientBeanHolder   : [HttpClientBeanHolder] Destruction of the end
17:01:55:711  INFO 21660 --- [SpringApplicationShutdownHook] c.a.c.n.registry.NacosServiceRegistry    : De-registering from Nacos Server now...
17:01:55:746  INFO 21660 --- [SpringApplicationShutdownHook] c.a.c.n.registry.NacosServiceRegistry    : De-registration finished.
17:01:55:786  INFO 21660 --- [SpringApplicationShutdownHook] com.zaxxer.hikari.HikariDataSource       : HikariPool-1 - Shutdown initiated...
17:01:56:123  INFO 21660 --- [SpringApplicationShutdownHook] com.zaxxer.hikari.HikariDataSource       : HikariPool-1 - Shutdown completed.
17:02:03:655  INFO 14568 --- [main] c.l.his_service.HisServiceApplication    : Starting HisServiceApplication using Java 17.0.11 on luo with PID 14568 (A:\Desktop\workspace\HIS\his_service\target\classes started by 22407 in A:\Desktop\workspace\HIS)
17:02:03:656 DEBUG 14568 --- [main] c.l.his_service.HisServiceApplication    : Running with Spring Boot v2.7.12, Spring v5.3.27
17:02:03:657  INFO 14568 --- [main] c.l.his_service.HisServiceApplication    : The following 1 profile is active: "dev"
17:02:04:932  INFO 14568 --- [main] .s.d.r.c.RepositoryConfigurationDelegate : Multiple Spring Data modules found, entering strict repository configuration mode
17:02:04:935  INFO 14568 --- [main] .s.d.r.c.RepositoryConfigurationDelegate : Bootstrapping Spring Data Redis repositories in DEFAULT mode.
17:02:04:965  INFO 14568 --- [main] .s.d.r.c.RepositoryConfigurationDelegate : Finished Spring Data repository scanning in 16 ms. Found 0 Redis repository interfaces.
17:02:05:295  INFO 14568 --- [main] o.s.cloud.context.scope.GenericScope     : BeanFactory id=ac61872e-faec-371d-922e-ad941e5407d7
17:02:06:898  INFO 14568 --- [main] o.s.b.w.embedded.tomcat.TomcatWebServer  : Tomcat initialized with port(s): 8080 (http)
17:02:06:926  INFO 14568 --- [main] o.apache.catalina.core.StandardService   : Starting service [Tomcat]
17:02:06:927  INFO 14568 --- [main] org.apache.catalina.core.StandardEngine  : Starting Servlet engine: [Apache Tomcat/9.0.75]
17:02:07:204  INFO 14568 --- [main] o.a.c.c.C.[Tomcat].[localhost].[/]       : Initializing Spring embedded WebApplicationContext
17:02:07:204  INFO 14568 --- [main] w.s.c.ServletWebServerApplicationContext : Root WebApplicationContext: initialization completed in 3499 ms
17:02:07:475  INFO 14568 --- [main] org.redisson.Version                     : Redisson 3.17.7
17:02:07:959  INFO 14568 --- [redisson-netty-2-9] o.r.c.pool.MasterPubSubConnectionPool    : 1 connections initialized for 111.230.32.147/111.230.32.147:9631
17:02:08:652  INFO 14568 --- [redisson-netty-2-19] o.r.c.pool.MasterConnectionPool          : 24 connections initialized for 111.230.32.147/111.230.32.147:9631
17:02:09:120 DEBUG 14568 --- [main] c.l.h.filter.RefreshTokenFilter          : Filter 'refreshTokenFilter' configured for use
17:02:10:095  INFO 14568 --- [main] o.s.c.openfeign.FeignClientFactoryBean   : For 'flask-service' URL not provided. Will try picking an instance via load-balancing.
17:02:10:244  INFO 14568 --- [main] o.s.c.openfeign.FeignClientFactoryBean   : For 'ai-service' URL not provided. Will try picking an instance via load-balancing.
17:02:10:321  WARN 14568 --- [main] c.b.m.core.metadata.TableInfoHelper      : Can not find table primary key in Class: "java.lang.Object".
17:02:10:321  WARN 14568 --- [main] c.b.m.core.injector.DefaultSqlInjector   : class java.lang.Object ,Not found @TableId annotation, Cannot use Mybatis-Plus 'xxById' Method.
17:02:12:319  WARN 14568 --- [main] iguration$LoadBalancerCaffeineWarnLogger : Spring Cloud LoadBalancer is currently working with the default cache. While this cache implementation is useful for development and tests, it's recommended to use Caffeine cache in production.You can switch to using Caffeine cache, by adding it and org.springframework.cache.caffeine.CaffeineCacheManager to the classpath.
17:02:12:327  INFO 14568 --- [main] o.s.b.a.e.web.EndpointLinksResolver      : Exposing 1 endpoint(s) beneath base path '/actuator'
17:02:12:418  INFO 14568 --- [main] o.s.b.w.embedded.tomcat.TomcatWebServer  : Tomcat started on port(s): 8080 (http) with context path ''
17:02:12:490  INFO 14568 --- [main] c.a.n.p.a.s.c.ClientAuthPluginManager    : [ClientAuthPluginManager] Load ClientAuthService com.alibaba.nacos.client.auth.impl.NacosClientAuthServiceImpl success.
17:02:12:490  INFO 14568 --- [main] c.a.n.p.a.s.c.ClientAuthPluginManager    : [ClientAuthPluginManager] Load ClientAuthService com.alibaba.nacos.client.auth.ram.RamClientAuthServiceImpl success.
17:02:13:710  INFO 14568 --- [main] c.a.n.c.a.AbstractAbilityControlManager  : Ready to get current node abilities...
17:02:13:711  INFO 14568 --- [main] c.a.n.c.a.AbstractAbilityControlManager  : Ready to initialize current node abilities, support modes: [SDK_CLIENT]
17:02:13:712  INFO 14568 --- [main] c.a.n.c.a.AbstractAbilityControlManager  : Initialize current abilities finish...
17:02:13:713  INFO 14568 --- [main] c.a.n.c.a.d.NacosAbilityManagerHolder    : [AbilityControlManager] Successfully initialize AbilityControlManager
17:02:13:803  INFO 14568 --- [main] c.a.c.n.registry.NacosServiceRegistry    : nacos registry, DEFAULT_GROUP his-service 10.21.93.70:8848 register finished
17:02:14:114  INFO 14568 --- [main] c.l.his_service.HisServiceApplication    : Started HisServiceApplication in 11.502 seconds (JVM running for 12.824)
17:02:14:331  INFO 14568 --- [RMI TCP Connection(5)-10.21.93.70] o.a.c.c.C.[Tomcat].[localhost].[/]       : Initializing Spring DispatcherServlet 'dispatcherServlet'
17:02:14:332  INFO 14568 --- [RMI TCP Connection(5)-10.21.93.70] o.s.web.servlet.DispatcherServlet        : Initializing Servlet 'dispatcherServlet'
17:02:14:335  INFO 14568 --- [RMI TCP Connection(4)-10.21.93.70] com.zaxxer.hikari.HikariDataSource       : HikariPool-1 - Starting...
17:02:14:336  INFO 14568 --- [RMI TCP Connection(5)-10.21.93.70] o.s.web.servlet.DispatcherServlet        : Completed initialization in 4 ms
17:02:15:169  INFO 14568 --- [RMI TCP Connection(4)-10.21.93.70] com.zaxxer.hikari.HikariDataSource       : HikariPool-1 - Start completed.
17:02:21:738 DEBUG 14568 --- [http-nio-8080-exec-2] c.l.h.m.D.selectById                     : ==>  Preparing: SELECT id,patient_id,doctor_id,disease_name,disease_category,aimodel_id,result,create_time,status,id_card,name,score,remark FROM diagnosis_report WHERE id=?
17:02:21:771 DEBUG 14568 --- [http-nio-8080-exec-2] c.l.h.m.D.selectById                     : ==> Parameters: 1(Integer)
17:02:21:843 DEBUG 14568 --- [http-nio-8080-exec-2] c.l.h.m.D.selectById                     : <==      Total: 1
17:02:21:845 DEBUG 14568 --- [http-nio-8080-exec-2] c.l.h.mapper.PatientMapper.selectById    : ==>  Preparing: SELECT id,phone,id_card,name,verified,verified_by,verified_time,open_id,hospital_pid FROM patient WHERE id=?
17:02:21:845 DEBUG 14568 --- [http-nio-8080-exec-2] c.l.h.mapper.PatientMapper.selectById    : ==> Parameters: 1(Integer)
17:02:21:880 DEBUG 14568 --- [http-nio-8080-exec-2] c.l.h.mapper.PatientMapper.selectById    : <==      Total: 1
17:02:21:881 DEBUG 14568 --- [http-nio-8080-exec-2] c.l.h.mapper.DoctorMapper.selectById     : ==>  Preparing: SELECT id,phone,id_card,name,verified,verified_by,verified_time,license,department,hospital_pid FROM doctor WHERE id=?
17:02:21:882 DEBUG 14568 --- [http-nio-8080-exec-2] c.l.h.mapper.DoctorMapper.selectById     : ==> Parameters: 1(Integer)
17:02:21:917 DEBUG 14568 --- [http-nio-8080-exec-2] c.l.h.mapper.DoctorMapper.selectById     : <==      Total: 1
17:02:21:921 DEBUG 14568 --- [http-nio-8080-exec-2] c.l.h.m.E.selectListByDiagnosisId        : ==>  Preparing: select * from eye_images where dignosis_report_id = ?
17:02:21:921 DEBUG 14568 --- [http-nio-8080-exec-2] c.l.h.m.E.selectListByDiagnosisId        : ==> Parameters: 1(Integer)
17:02:21:956 DEBUG 14568 --- [http-nio-8080-exec-2] c.l.h.m.E.selectListByDiagnosisId        : <==      Total: 1
17:02:21:956 DEBUG 14568 --- [http-nio-8080-exec-2] c.l.h.m.T.selectByDiagnosisId            : ==>  Preparing: select * from treatment_plans where diagnosis_id = ?
17:02:21:957 DEBUG 14568 --- [http-nio-8080-exec-2] c.l.h.m.T.selectByDiagnosisId            : ==> Parameters: 1(Integer)
17:02:21:991 DEBUG 14568 --- [http-nio-8080-exec-2] c.l.h.m.T.selectByDiagnosisId            : <==      Total: 1
17:02:21:992 DEBUG 14568 --- [http-nio-8080-exec-2] c.l.h.m.M.selectByDiagnosisId            : ==>  Preparing: select * from medication_recommendations where diagnosis_id = ?
17:02:21:992 DEBUG 14568 --- [http-nio-8080-exec-2] c.l.h.m.M.selectByDiagnosisId            : ==> Parameters: 1(Integer)
17:02:22:027 DEBUG 14568 --- [http-nio-8080-exec-2] c.l.h.m.M.selectByDiagnosisId            : <==      Total: 1
17:02:22:028 DEBUG 14568 --- [http-nio-8080-exec-2] c.l.h.mapper.AiModelMapper.selectById    : ==>  Preparing: SELECT id,version,deploy_time,accuracy FROM ai_model WHERE id=?
17:02:22:028 DEBUG 14568 --- [http-nio-8080-exec-2] c.l.h.mapper.AiModelMapper.selectById    : ==> Parameters: 1(Integer)
17:02:22:063 DEBUG 14568 --- [http-nio-8080-exec-2] c.l.h.mapper.AiModelMapper.selectById    : <==      Total: 1
17:02:22:098 DEBUG 14568 --- [http-nio-8080-exec-2] c.l.api.client.FlaskAiDoctorClient       : [FlaskAiDoctorClient#uploadFile] ---> POST http://ai-service/api/eye-doctor/chat HTTP/1.1
17:02:22:099 DEBUG 14568 --- [http-nio-8080-exec-2] c.l.api.client.FlaskAiDoctorClient       : [FlaskAiDoctorClient#uploadFile] Content-Length: 726
17:02:22:099 DEBUG 14568 --- [http-nio-8080-exec-2] c.l.api.client.FlaskAiDoctorClient       : [FlaskAiDoctorClient#uploadFile] Content-Type: application/json
17:02:22:099 DEBUG 14568 --- [http-nio-8080-exec-2] c.l.api.client.FlaskAiDoctorClient       : [FlaskAiDoctorClient#uploadFile] 
17:02:22:099 DEBUG 14568 --- [http-nio-8080-exec-2] c.l.api.client.FlaskAiDoctorClient       : [FlaskAiDoctorClient#uploadFile] {"diagnosis_name":"","diagnosis_category":"","result":"A","remark":"A","treatment_plan":{"id":1,"treatmentType":1,"treatmentDetail":"","startTime":"2025-03-01 09:00:00","endDate":"2025-03-10 09:00:00","doctorId":1,"createdTime":[2025,3,1,9,0],"updatedTime":[2025,3,1,9,0]},"medications":[{"id":1,"diagnosisId":1,"medicationName":"A","dosage":"10mg","frequency":"","sideEffects":"","startTime":[2025,3,1,9,0],"endTime":[2025,3,10,9,0],"doctorId":1,"createdTime":"2025-03-01 09:00:00","updatedTime":"2025-03-01 09:00:00"}],"previous_conversations":[{"role":"pariatur tempor do","content":"sit cupidatat commodo"}],"question":"irure eu esse","stream":false}
17:02:22:100 DEBUG 14568 --- [http-nio-8080-exec-2] c.l.api.client.FlaskAiDoctorClient       : [FlaskAiDoctorClient#uploadFile] ---> END HTTP (726-byte body)
17:02:24:312 DEBUG 14568 --- [http-nio-8080-exec-2] c.l.api.client.FlaskAiDoctorClient       : [FlaskAiDoctorClient#uploadFile] <--- ERROR ConnectException: Connection refused: getsockopt (2212ms)
17:02:24:313 DEBUG 14568 --- [http-nio-8080-exec-2] c.l.api.client.FlaskAiDoctorClient       : [FlaskAiDoctorClient#uploadFile] java.net.ConnectException: Connection refused: getsockopt
	at java.base/sun.nio.ch.Net.pollConnect(Native Method)
	at java.base/sun.nio.ch.Net.pollConnectNow(Net.java:672)
	at java.base/sun.nio.ch.NioSocketImpl.timedFinishConnect(NioSocketImpl.java:554)
	at java.base/sun.nio.ch.NioSocketImpl.connect(NioSocketImpl.java:602)
	at java.base/java.net.Socket.connect(Socket.java:633)
	at java.base/sun.net.NetworkClient.doConnect(NetworkClient.java:178)
	at java.base/sun.net.www.http.HttpClient.openServer(HttpClient.java:533)
	at java.base/sun.net.www.http.HttpClient.openServer(HttpClient.java:638)
	at java.base/sun.net.www.http.HttpClient.<init>(HttpClient.java:281)
	at java.base/sun.net.www.http.HttpClient.New(HttpClient.java:386)
	at java.base/sun.net.www.http.HttpClient.New(HttpClient.java:408)
	at java.base/sun.net.www.protocol.http.HttpURLConnection.getNewHttpClient(HttpURLConnection.java:1309)
	at java.base/sun.net.www.protocol.http.HttpURLConnection.plainConnect0(HttpURLConnection.java:1242)
	at java.base/sun.net.www.protocol.http.HttpURLConnection.plainConnect(HttpURLConnection.java:1128)
	at java.base/sun.net.www.protocol.http.HttpURLConnection.connect(HttpURLConnection.java:1057)
	at java.base/sun.net.www.protocol.http.HttpURLConnection.getOutputStream0(HttpURLConnection.java:1451)
	at java.base/sun.net.www.protocol.http.HttpURLConnection.getOutputStream(HttpURLConnection.java:1422)
	at feign.Client$Default.convertAndSend(Client.java:208)
	at feign.Client$Default.execute(Client.java:105)
	at org.springframework.cloud.openfeign.loadbalancer.LoadBalancerUtils.executeWithLoadBalancerLifecycleProcessing(LoadBalancerUtils.java:57)
	at org.springframework.cloud.openfeign.loadbalancer.LoadBalancerUtils.executeWithLoadBalancerLifecycleProcessing(LoadBalancerUtils.java:95)
	at org.springframework.cloud.openfeign.loadbalancer.FeignBlockingLoadBalancerClient.execute(FeignBlockingLoadBalancerClient.java:114)
	at feign.SynchronousMethodHandler.executeAndDecode(SynchronousMethodHandler.java:121)
	at feign.SynchronousMethodHandler.invoke(SynchronousMethodHandler.java:91)
	at feign.ReflectiveFeign$FeignInvocationHandler.invoke(ReflectiveFeign.java:100)
	at jdk.proxy2/jdk.proxy2.$Proxy135.uploadFile(Unknown Source)
	at com.luojiawei.his_service.controller.ChatController.ask(ChatController.java:38)
	at java.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at java.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:77)
	at java.base/jdk.internal.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.base/java.lang.reflect.Method.invoke(Method.java:568)
	at org.springframework.web.method.support.InvocableHandlerMethod.doInvoke(InvocableHandlerMethod.java:205)
	at org.springframework.web.method.support.InvocableHandlerMethod.invokeForRequest(InvocableHandlerMethod.java:150)
	at org.springframework.web.servlet.mvc.method.annotation.ServletInvocableHandlerMethod.invokeAndHandle(ServletInvocableHandlerMethod.java:117)
	at org.springframework.web.servlet.mvc.method.annotation.RequestMappingHandlerAdapter.invokeHandlerMethod(RequestMappingHandlerAdapter.java:895)
	at org.springframework.web.servlet.mvc.method.annotation.RequestMappingHandlerAdapter.handleInternal(RequestMappingHandlerAdapter.java:808)
	at org.springframework.web.servlet.mvc.method.AbstractHandlerMethodAdapter.handle(AbstractHandlerMethodAdapter.java:87)
	at org.springframework.web.servlet.DispatcherServlet.doDispatch(DispatcherServlet.java:1072)
	at org.springframework.web.servlet.DispatcherServlet.doService(DispatcherServlet.java:965)
	at org.springframework.web.servlet.FrameworkServlet.processRequest(FrameworkServlet.java:1006)
	at org.springframework.web.servlet.FrameworkServlet.doPost(FrameworkServlet.java:909)
	at javax.servlet.http.HttpServlet.service(HttpServlet.java:555)
	at org.springframework.web.servlet.FrameworkServlet.service(FrameworkServlet.java:883)
	at javax.servlet.http.HttpServlet.service(HttpServlet.java:623)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:209)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:153)
	at com.luojiawei.his_service.filter.RefreshTokenFilter.doFilterInternal(RefreshTokenFilter.java:58)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:117)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:178)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:153)
	at org.springframework.web.filter.RequestContextFilter.doFilterInternal(RequestContextFilter.java:100)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:117)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:178)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:153)
	at org.springframework.web.filter.FormContentFilter.doFilterInternal(FormContentFilter.java:93)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:117)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:178)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:153)
	at org.springframework.boot.actuate.metrics.web.servlet.WebMvcMetricsFilter.doFilterInternal(WebMvcMetricsFilter.java:96)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:117)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:178)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:153)
	at org.springframework.web.filter.CharacterEncodingFilter.doFilterInternal(CharacterEncodingFilter.java:201)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:117)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:178)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:153)
	at org.apache.catalina.core.StandardWrapperValve.invoke(StandardWrapperValve.java:167)
	at org.apache.catalina.core.StandardContextValve.invoke(StandardContextValve.java:90)
	at org.apache.catalina.authenticator.AuthenticatorBase.invoke(AuthenticatorBase.java:481)
	at org.apache.catalina.core.StandardHostValve.invoke(StandardHostValve.java:130)
	at org.apache.catalina.valves.ErrorReportValve.invoke(ErrorReportValve.java:93)
	at org.apache.catalina.core.StandardEngineValve.invoke(StandardEngineValve.java:74)
	at org.apache.catalina.connector.CoyoteAdapter.service(CoyoteAdapter.java:343)
	at org.apache.coyote.http11.Http11Processor.service(Http11Processor.java:390)
	at org.apache.coyote.AbstractProcessorLight.process(AbstractProcessorLight.java:63)
	at org.apache.coyote.AbstractProtocol$ConnectionHandler.process(AbstractProtocol.java:926)
	at org.apache.tomcat.util.net.NioEndpoint$SocketProcessor.doRun(NioEndpoint.java:1791)
	at org.apache.tomcat.util.net.SocketProcessorBase.run(SocketProcessorBase.java:52)
	at org.apache.tomcat.util.threads.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1191)
	at org.apache.tomcat.util.threads.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:659)
	at org.apache.tomcat.util.threads.TaskThread$WrappingRunnable.run(TaskThread.java:61)
	at java.base/java.lang.Thread.run(Thread.java:840)

17:02:24:313 DEBUG 14568 --- [http-nio-8080-exec-2] c.l.api.client.FlaskAiDoctorClient       : [FlaskAiDoctorClient#uploadFile] <--- END ERROR
17:02:24:325 ERROR 14568 --- [http-nio-8080-exec-2] o.a.c.c.C.[.[.[/].[dispatcherServlet]    : Servlet.service() for servlet [dispatcherServlet] in context with path [] threw exception [Request processing failed; nested exception is feign.RetryableException: Connection refused: getsockopt executing POST http://ai-service/api/eye-doctor/chat] with root cause

java.net.ConnectException: Connection refused: getsockopt
	at java.base/sun.nio.ch.Net.pollConnect(Native Method) ~[na:na]
	at java.base/sun.nio.ch.Net.pollConnectNow(Net.java:672) ~[na:na]
	at java.base/sun.nio.ch.NioSocketImpl.timedFinishConnect(NioSocketImpl.java:554) ~[na:na]
	at java.base/sun.nio.ch.NioSocketImpl.connect(NioSocketImpl.java:602) ~[na:na]
	at java.base/java.net.Socket.connect(Socket.java:633) ~[na:na]
	at java.base/sun.net.NetworkClient.doConnect(NetworkClient.java:178) ~[na:na]
	at java.base/sun.net.www.http.HttpClient.openServer(HttpClient.java:533) ~[na:na]
	at java.base/sun.net.www.http.HttpClient.openServer(HttpClient.java:638) ~[na:na]
	at java.base/sun.net.www.http.HttpClient.<init>(HttpClient.java:281) ~[na:na]
	at java.base/sun.net.www.http.HttpClient.New(HttpClient.java:386) ~[na:na]
	at java.base/sun.net.www.http.HttpClient.New(HttpClient.java:408) ~[na:na]
	at java.base/sun.net.www.protocol.http.HttpURLConnection.getNewHttpClient(HttpURLConnection.java:1309) ~[na:na]
	at java.base/sun.net.www.protocol.http.HttpURLConnection.plainConnect0(HttpURLConnection.java:1242) ~[na:na]
	at java.base/sun.net.www.protocol.http.HttpURLConnection.plainConnect(HttpURLConnection.java:1128) ~[na:na]
	at java.base/sun.net.www.protocol.http.HttpURLConnection.connect(HttpURLConnection.java:1057) ~[na:na]
	at java.base/sun.net.www.protocol.http.HttpURLConnection.getOutputStream0(HttpURLConnection.java:1451) ~[na:na]
	at java.base/sun.net.www.protocol.http.HttpURLConnection.getOutputStream(HttpURLConnection.java:1422) ~[na:na]
	at feign.Client$Default.convertAndSend(Client.java:208) ~[feign-core-11.10.jar:na]
	at feign.Client$Default.execute(Client.java:105) ~[feign-core-11.10.jar:na]
	at org.springframework.cloud.openfeign.loadbalancer.LoadBalancerUtils.executeWithLoadBalancerLifecycleProcessing(LoadBalancerUtils.java:57) ~[spring-cloud-openfeign-core-3.1.5.jar:3.1.5]
	at org.springframework.cloud.openfeign.loadbalancer.LoadBalancerUtils.executeWithLoadBalancerLifecycleProcessing(LoadBalancerUtils.java:95) ~[spring-cloud-openfeign-core-3.1.5.jar:3.1.5]
	at org.springframework.cloud.openfeign.loadbalancer.FeignBlockingLoadBalancerClient.execute(FeignBlockingLoadBalancerClient.java:114) ~[spring-cloud-openfeign-core-3.1.5.jar:3.1.5]
	at feign.SynchronousMethodHandler.executeAndDecode(SynchronousMethodHandler.java:121) ~[feign-core-11.10.jar:na]
	at feign.SynchronousMethodHandler.invoke(SynchronousMethodHandler.java:91) ~[feign-core-11.10.jar:na]
	at feign.ReflectiveFeign$FeignInvocationHandler.invoke(ReflectiveFeign.java:100) ~[feign-core-11.10.jar:na]
	at jdk.proxy2/jdk.proxy2.$Proxy135.uploadFile(Unknown Source) ~[na:na]
	at com.luojiawei.his_service.controller.ChatController.ask(ChatController.java:38) ~[classes/:na]
	at java.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke0(Native Method) ~[na:na]
	at java.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:77) ~[na:na]
	at java.base/jdk.internal.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43) ~[na:na]
	at java.base/java.lang.reflect.Method.invoke(Method.java:568) ~[na:na]
	at org.springframework.web.method.support.InvocableHandlerMethod.doInvoke(InvocableHandlerMethod.java:205) ~[spring-web-5.3.27.jar:5.3.27]
	at org.springframework.web.method.support.InvocableHandlerMethod.invokeForRequest(InvocableHandlerMethod.java:150) ~[spring-web-5.3.27.jar:5.3.27]
	at org.springframework.web.servlet.mvc.method.annotation.ServletInvocableHandlerMethod.invokeAndHandle(ServletInvocableHandlerMethod.java:117) ~[spring-webmvc-5.3.27.jar:5.3.27]
	at org.springframework.web.servlet.mvc.method.annotation.RequestMappingHandlerAdapter.invokeHandlerMethod(RequestMappingHandlerAdapter.java:895) ~[spring-webmvc-5.3.27.jar:5.3.27]
	at org.springframework.web.servlet.mvc.method.annotation.RequestMappingHandlerAdapter.handleInternal(RequestMappingHandlerAdapter.java:808) ~[spring-webmvc-5.3.27.jar:5.3.27]
	at org.springframework.web.servlet.mvc.method.AbstractHandlerMethodAdapter.handle(AbstractHandlerMethodAdapter.java:87) ~[spring-webmvc-5.3.27.jar:5.3.27]
	at org.springframework.web.servlet.DispatcherServlet.doDispatch(DispatcherServlet.java:1072) ~[spring-webmvc-5.3.27.jar:5.3.27]
	at org.springframework.web.servlet.DispatcherServlet.doService(DispatcherServlet.java:965) ~[spring-webmvc-5.3.27.jar:5.3.27]
	at org.springframework.web.servlet.FrameworkServlet.processRequest(FrameworkServlet.java:1006) ~[spring-webmvc-5.3.27.jar:5.3.27]
	at org.springframework.web.servlet.FrameworkServlet.doPost(FrameworkServlet.java:909) ~[spring-webmvc-5.3.27.jar:5.3.27]
	at javax.servlet.http.HttpServlet.service(HttpServlet.java:555) ~[tomcat-embed-core-9.0.75.jar:4.0.FR]
	at org.springframework.web.servlet.FrameworkServlet.service(FrameworkServlet.java:883) ~[spring-webmvc-5.3.27.jar:5.3.27]
	at javax.servlet.http.HttpServlet.service(HttpServlet.java:623) ~[tomcat-embed-core-9.0.75.jar:4.0.FR]
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:209) ~[tomcat-embed-core-9.0.75.jar:9.0.75]
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:153) ~[tomcat-embed-core-9.0.75.jar:9.0.75]
	at com.luojiawei.his_service.filter.RefreshTokenFilter.doFilterInternal(RefreshTokenFilter.java:58) ~[classes/:na]
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:117) ~[spring-web-5.3.27.jar:5.3.27]
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:178) ~[tomcat-embed-core-9.0.75.jar:9.0.75]
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:153) ~[tomcat-embed-core-9.0.75.jar:9.0.75]
	at org.springframework.web.filter.RequestContextFilter.doFilterInternal(RequestContextFilter.java:100) ~[spring-web-5.3.27.jar:5.3.27]
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:117) ~[spring-web-5.3.27.jar:5.3.27]
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:178) ~[tomcat-embed-core-9.0.75.jar:9.0.75]
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:153) ~[tomcat-embed-core-9.0.75.jar:9.0.75]
	at org.springframework.web.filter.FormContentFilter.doFilterInternal(FormContentFilter.java:93) ~[spring-web-5.3.27.jar:5.3.27]
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:117) ~[spring-web-5.3.27.jar:5.3.27]
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:178) ~[tomcat-embed-core-9.0.75.jar:9.0.75]
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:153) ~[tomcat-embed-core-9.0.75.jar:9.0.75]
	at org.springframework.boot.actuate.metrics.web.servlet.WebMvcMetricsFilter.doFilterInternal(WebMvcMetricsFilter.java:96) ~[spring-boot-actuator-2.7.12.jar:2.7.12]
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:117) ~[spring-web-5.3.27.jar:5.3.27]
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:178) ~[tomcat-embed-core-9.0.75.jar:9.0.75]
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:153) ~[tomcat-embed-core-9.0.75.jar:9.0.75]
	at org.springframework.web.filter.CharacterEncodingFilter.doFilterInternal(CharacterEncodingFilter.java:201) ~[spring-web-5.3.27.jar:5.3.27]
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:117) ~[spring-web-5.3.27.jar:5.3.27]
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:178) ~[tomcat-embed-core-9.0.75.jar:9.0.75]
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:153) ~[tomcat-embed-core-9.0.75.jar:9.0.75]
	at org.apache.catalina.core.StandardWrapperValve.invoke(StandardWrapperValve.java:167) ~[tomcat-embed-core-9.0.75.jar:9.0.75]
	at org.apache.catalina.core.StandardContextValve.invoke(StandardContextValve.java:90) ~[tomcat-embed-core-9.0.75.jar:9.0.75]
	at org.apache.catalina.authenticator.AuthenticatorBase.invoke(AuthenticatorBase.java:481) ~[tomcat-embed-core-9.0.75.jar:9.0.75]
	at org.apache.catalina.core.StandardHostValve.invoke(StandardHostValve.java:130) ~[tomcat-embed-core-9.0.75.jar:9.0.75]
	at org.apache.catalina.valves.ErrorReportValve.invoke(ErrorReportValve.java:93) ~[tomcat-embed-core-9.0.75.jar:9.0.75]
	at org.apache.catalina.core.StandardEngineValve.invoke(StandardEngineValve.java:74) ~[tomcat-embed-core-9.0.75.jar:9.0.75]
	at org.apache.catalina.connector.CoyoteAdapter.service(CoyoteAdapter.java:343) ~[tomcat-embed-core-9.0.75.jar:9.0.75]
	at org.apache.coyote.http11.Http11Processor.service(Http11Processor.java:390) ~[tomcat-embed-core-9.0.75.jar:9.0.75]
	at org.apache.coyote.AbstractProcessorLight.process(AbstractProcessorLight.java:63) ~[tomcat-embed-core-9.0.75.jar:9.0.75]
	at org.apache.coyote.AbstractProtocol$ConnectionHandler.process(AbstractProtocol.java:926) ~[tomcat-embed-core-9.0.75.jar:9.0.75]
	at org.apache.tomcat.util.net.NioEndpoint$SocketProcessor.doRun(NioEndpoint.java:1791) ~[tomcat-embed-core-9.0.75.jar:9.0.75]
	at org.apache.tomcat.util.net.SocketProcessorBase.run(SocketProcessorBase.java:52) ~[tomcat-embed-core-9.0.75.jar:9.0.75]
	at org.apache.tomcat.util.threads.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1191) ~[tomcat-embed-core-9.0.75.jar:9.0.75]
	at org.apache.tomcat.util.threads.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:659) ~[tomcat-embed-core-9.0.75.jar:9.0.75]
	at org.apache.tomcat.util.threads.TaskThread$WrappingRunnable.run(TaskThread.java:61) ~[tomcat-embed-core-9.0.75.jar:9.0.75]
	at java.base/java.lang.Thread.run(Thread.java:840) ~[na:na]

17:04:07:614  WARN 14568 --- [Thread-18] c.a.n.common.http.HttpClientBeanHolder   : [HttpClientBeanHolder] Start destroying common HttpClient
17:04:07:615  WARN 14568 --- [Thread-18] c.a.n.common.http.HttpClientBeanHolder   : [HttpClientBeanHolder] Destruction of the end
17:04:07:615  WARN 14568 --- [Thread-15] c.a.nacos.common.notify.NotifyCenter     : [NotifyCenter] Start destroying Publisher
17:04:07:615  WARN 14568 --- [Thread-15] c.a.nacos.common.notify.NotifyCenter     : [NotifyCenter] Destruction of the end
17:04:07:677  INFO 14568 --- [SpringApplicationShutdownHook] c.a.c.n.registry.NacosServiceRegistry    : De-registering from Nacos Server now...
17:04:07:711  INFO 14568 --- [SpringApplicationShutdownHook] c.a.c.n.registry.NacosServiceRegistry    : De-registration finished.
17:04:07:724  INFO 14568 --- [SpringApplicationShutdownHook] com.zaxxer.hikari.HikariDataSource       : HikariPool-1 - Shutdown initiated...
17:04:08:025  INFO 14568 --- [SpringApplicationShutdownHook] com.zaxxer.hikari.HikariDataSource       : HikariPool-1 - Shutdown completed.
17:04:16:272  INFO 33972 --- [main] c.l.his_service.HisServiceApplication    : Starting HisServiceApplication using Java 17.0.11 on luo with PID 33972 (A:\Desktop\workspace\HIS\his_service\target\classes started by 22407 in A:\Desktop\workspace\HIS)
17:04:16:273 DEBUG 33972 --- [main] c.l.his_service.HisServiceApplication    : Running with Spring Boot v2.7.12, Spring v5.3.27
17:04:16:273  INFO 33972 --- [main] c.l.his_service.HisServiceApplication    : The following 1 profile is active: "dev"
17:04:17:432  INFO 33972 --- [main] .s.d.r.c.RepositoryConfigurationDelegate : Multiple Spring Data modules found, entering strict repository configuration mode
17:04:17:435  INFO 33972 --- [main] .s.d.r.c.RepositoryConfigurationDelegate : Bootstrapping Spring Data Redis repositories in DEFAULT mode.
17:04:17:461  INFO 33972 --- [main] .s.d.r.c.RepositoryConfigurationDelegate : Finished Spring Data repository scanning in 14 ms. Found 0 Redis repository interfaces.
17:04:17:732  INFO 33972 --- [main] o.s.cloud.context.scope.GenericScope     : BeanFactory id=ac61872e-faec-371d-922e-ad941e5407d7
17:04:18:442  INFO 33972 --- [main] o.s.b.w.embedded.tomcat.TomcatWebServer  : Tomcat initialized with port(s): 8080 (http)
17:04:18:452  INFO 33972 --- [main] o.apache.catalina.core.StandardService   : Starting service [Tomcat]
17:04:18:453  INFO 33972 --- [main] org.apache.catalina.core.StandardEngine  : Starting Servlet engine: [Apache Tomcat/9.0.75]
17:04:18:618  INFO 33972 --- [main] o.a.c.c.C.[Tomcat].[localhost].[/]       : Initializing Spring embedded WebApplicationContext
17:04:18:619  INFO 33972 --- [main] w.s.c.ServletWebServerApplicationContext : Root WebApplicationContext: initialization completed in 2299 ms
17:04:18:868  INFO 33972 --- [main] org.redisson.Version                     : Redisson 3.17.7
17:04:19:290  INFO 33972 --- [redisson-netty-2-9] o.r.c.pool.MasterPubSubConnectionPool    : 1 connections initialized for 111.230.32.147/111.230.32.147:9631
17:04:20:010  INFO 33972 --- [redisson-netty-2-19] o.r.c.pool.MasterConnectionPool          : 24 connections initialized for 111.230.32.147/111.230.32.147:9631
17:04:20:504 DEBUG 33972 --- [main] c.l.h.filter.RefreshTokenFilter          : Filter 'refreshTokenFilter' configured for use
17:04:21:443  INFO 33972 --- [main] o.s.c.openfeign.FeignClientFactoryBean   : For 'flask-service' URL not provided. Will try picking an instance via load-balancing.
17:04:21:619  INFO 33972 --- [main] o.s.c.openfeign.FeignClientFactoryBean   : For 'ai-service' URL not provided. Will try picking an instance via load-balancing.
17:04:21:679  WARN 33972 --- [main] c.b.m.core.metadata.TableInfoHelper      : Can not find table primary key in Class: "java.lang.Object".
17:04:21:679  WARN 33972 --- [main] c.b.m.core.injector.DefaultSqlInjector   : class java.lang.Object ,Not found @TableId annotation, Cannot use Mybatis-Plus 'xxById' Method.
17:04:23:807  WARN 33972 --- [main] iguration$LoadBalancerCaffeineWarnLogger : Spring Cloud LoadBalancer is currently working with the default cache. While this cache implementation is useful for development and tests, it's recommended to use Caffeine cache in production.You can switch to using Caffeine cache, by adding it and org.springframework.cache.caffeine.CaffeineCacheManager to the classpath.
17:04:23:818  INFO 33972 --- [main] o.s.b.a.e.web.EndpointLinksResolver      : Exposing 1 endpoint(s) beneath base path '/actuator'
17:04:23:935  INFO 33972 --- [main] o.s.b.w.embedded.tomcat.TomcatWebServer  : Tomcat started on port(s): 8080 (http) with context path ''
17:04:23:987  INFO 33972 --- [main] c.a.n.p.a.s.c.ClientAuthPluginManager    : [ClientAuthPluginManager] Load ClientAuthService com.alibaba.nacos.client.auth.impl.NacosClientAuthServiceImpl success.
17:04:23:988  INFO 33972 --- [main] c.a.n.p.a.s.c.ClientAuthPluginManager    : [ClientAuthPluginManager] Load ClientAuthService com.alibaba.nacos.client.auth.ram.RamClientAuthServiceImpl success.
17:04:25:246  INFO 33972 --- [main] c.a.n.c.a.AbstractAbilityControlManager  : Ready to get current node abilities...
17:04:25:248  INFO 33972 --- [main] c.a.n.c.a.AbstractAbilityControlManager  : Ready to initialize current node abilities, support modes: [SDK_CLIENT]
17:04:25:248  INFO 33972 --- [main] c.a.n.c.a.AbstractAbilityControlManager  : Initialize current abilities finish...
17:04:25:249  INFO 33972 --- [main] c.a.n.c.a.d.NacosAbilityManagerHolder    : [AbilityControlManager] Successfully initialize AbilityControlManager
17:04:25:351  INFO 33972 --- [main] c.a.c.n.registry.NacosServiceRegistry    : nacos registry, DEFAULT_GROUP his-service 10.21.93.70:8848 register finished
17:04:25:730  INFO 33972 --- [main] c.l.his_service.HisServiceApplication    : Started HisServiceApplication in 10.445 seconds (JVM running for 11.486)
17:04:26:225  INFO 33972 --- [RMI TCP Connection(3)-10.21.93.70] o.a.c.c.C.[Tomcat].[localhost].[/]       : Initializing Spring DispatcherServlet 'dispatcherServlet'
17:04:26:225  INFO 33972 --- [RMI TCP Connection(3)-10.21.93.70] o.s.web.servlet.DispatcherServlet        : Initializing Servlet 'dispatcherServlet'
17:04:26:235  INFO 33972 --- [RMI TCP Connection(3)-10.21.93.70] o.s.web.servlet.DispatcherServlet        : Completed initialization in 9 ms
17:04:26:239  INFO 33972 --- [RMI TCP Connection(2)-10.21.93.70] com.zaxxer.hikari.HikariDataSource       : HikariPool-1 - Starting...
17:04:27:177  INFO 33972 --- [RMI TCP Connection(2)-10.21.93.70] com.zaxxer.hikari.HikariDataSource       : HikariPool-1 - Start completed.
17:06:42:562  WARN 33972 --- [Thread-18] c.a.n.common.http.HttpClientBeanHolder   : [HttpClientBeanHolder] Start destroying common HttpClient
17:06:42:561  WARN 33972 --- [Thread-15] c.a.nacos.common.notify.NotifyCenter     : [NotifyCenter] Start destroying Publisher
17:06:42:562  WARN 33972 --- [Thread-15] c.a.nacos.common.notify.NotifyCenter     : [NotifyCenter] Destruction of the end
17:06:42:565  WARN 33972 --- [Thread-18] c.a.n.common.http.HttpClientBeanHolder   : [HttpClientBeanHolder] Destruction of the end
17:06:42:649  INFO 33972 --- [SpringApplicationShutdownHook] c.a.c.n.registry.NacosServiceRegistry    : De-registering from Nacos Server now...
17:06:42:683  INFO 33972 --- [SpringApplicationShutdownHook] c.a.c.n.registry.NacosServiceRegistry    : De-registration finished.
17:06:42:728  INFO 33972 --- [SpringApplicationShutdownHook] com.zaxxer.hikari.HikariDataSource       : HikariPool-1 - Shutdown initiated...
17:06:43:036  INFO 33972 --- [SpringApplicationShutdownHook] com.zaxxer.hikari.HikariDataSource       : HikariPool-1 - Shutdown completed.
17:06:54:586  INFO 32264 --- [main] c.l.his_service.HisServiceApplication    : Starting HisServiceApplication using Java 17.0.11 on luo with PID 32264 (A:\Desktop\workspace\HIS\his_service\target\classes started by 22407 in A:\Desktop\workspace\HIS)
17:06:54:587 DEBUG 32264 --- [main] c.l.his_service.HisServiceApplication    : Running with Spring Boot v2.7.12, Spring v5.3.27
17:06:54:590  INFO 32264 --- [main] c.l.his_service.HisServiceApplication    : The following 1 profile is active: "dev"
17:06:55:844  INFO 32264 --- [main] .s.d.r.c.RepositoryConfigurationDelegate : Multiple Spring Data modules found, entering strict repository configuration mode
17:06:55:846  INFO 32264 --- [main] .s.d.r.c.RepositoryConfigurationDelegate : Bootstrapping Spring Data Redis repositories in DEFAULT mode.
17:06:55:874  INFO 32264 --- [main] .s.d.r.c.RepositoryConfigurationDelegate : Finished Spring Data repository scanning in 15 ms. Found 0 Redis repository interfaces.
17:06:56:320  INFO 32264 --- [main] o.s.cloud.context.scope.GenericScope     : BeanFactory id=ac61872e-faec-371d-922e-ad941e5407d7
17:06:58:237  INFO 32264 --- [main] o.s.b.w.embedded.tomcat.TomcatWebServer  : Tomcat initialized with port(s): 8080 (http)
17:06:58:270  INFO 32264 --- [main] o.apache.catalina.core.StandardService   : Starting service [Tomcat]
17:06:58:270  INFO 32264 --- [main] org.apache.catalina.core.StandardEngine  : Starting Servlet engine: [Apache Tomcat/9.0.75]
17:06:58:661  INFO 32264 --- [main] o.a.c.c.C.[Tomcat].[localhost].[/]       : Initializing Spring embedded WebApplicationContext
17:06:58:662  INFO 32264 --- [main] w.s.c.ServletWebServerApplicationContext : Root WebApplicationContext: initialization completed in 4020 ms
17:06:58:959  INFO 32264 --- [main] org.redisson.Version                     : Redisson 3.17.7
17:06:59:500  INFO 32264 --- [redisson-netty-2-9] o.r.c.pool.MasterPubSubConnectionPool    : 1 connections initialized for 111.230.32.147/111.230.32.147:9631
17:07:00:295  INFO 32264 --- [redisson-netty-2-19] o.r.c.pool.MasterConnectionPool          : 24 connections initialized for 111.230.32.147/111.230.32.147:9631
17:07:00:693 DEBUG 32264 --- [main] c.l.h.filter.RefreshTokenFilter          : Filter 'refreshTokenFilter' configured for use
17:07:01:735  INFO 32264 --- [main] o.s.c.openfeign.FeignClientFactoryBean   : For 'flask-service' URL not provided. Will try picking an instance via load-balancing.
17:07:01:933  INFO 32264 --- [main] o.s.c.openfeign.FeignClientFactoryBean   : For 'ai-service' URL not provided. Will try picking an instance via load-balancing.
17:07:02:015  WARN 32264 --- [main] c.b.m.core.metadata.TableInfoHelper      : Can not find table primary key in Class: "java.lang.Object".
17:07:02:015  WARN 32264 --- [main] c.b.m.core.injector.DefaultSqlInjector   : class java.lang.Object ,Not found @TableId annotation, Cannot use Mybatis-Plus 'xxById' Method.
17:07:03:831  WARN 32264 --- [main] iguration$LoadBalancerCaffeineWarnLogger : Spring Cloud LoadBalancer is currently working with the default cache. While this cache implementation is useful for development and tests, it's recommended to use Caffeine cache in production.You can switch to using Caffeine cache, by adding it and org.springframework.cache.caffeine.CaffeineCacheManager to the classpath.
17:07:03:839  INFO 32264 --- [main] o.s.b.a.e.web.EndpointLinksResolver      : Exposing 1 endpoint(s) beneath base path '/actuator'
17:07:03:946  INFO 32264 --- [main] o.s.b.w.embedded.tomcat.TomcatWebServer  : Tomcat started on port(s): 8080 (http) with context path ''
17:07:04:034  INFO 32264 --- [main] c.a.n.p.a.s.c.ClientAuthPluginManager    : [ClientAuthPluginManager] Load ClientAuthService com.alibaba.nacos.client.auth.impl.NacosClientAuthServiceImpl success.
17:07:04:034  INFO 32264 --- [main] c.a.n.p.a.s.c.ClientAuthPluginManager    : [ClientAuthPluginManager] Load ClientAuthService com.alibaba.nacos.client.auth.ram.RamClientAuthServiceImpl success.
17:07:06:372  INFO 32264 --- [main] c.a.n.c.a.AbstractAbilityControlManager  : Ready to get current node abilities...
17:07:06:373  INFO 32264 --- [main] c.a.n.c.a.AbstractAbilityControlManager  : Ready to initialize current node abilities, support modes: [SDK_CLIENT]
17:07:06:374  INFO 32264 --- [main] c.a.n.c.a.AbstractAbilityControlManager  : Initialize current abilities finish...
17:07:06:375  INFO 32264 --- [main] c.a.n.c.a.d.NacosAbilityManagerHolder    : [AbilityControlManager] Successfully initialize AbilityControlManager
17:07:06:465  INFO 32264 --- [main] c.a.c.n.registry.NacosServiceRegistry    : nacos registry, DEFAULT_GROUP his-service 10.21.93.70:8848 register finished
17:07:06:811  INFO 32264 --- [main] c.l.his_service.HisServiceApplication    : Started HisServiceApplication in 13.289 seconds (JVM running for 14.691)
17:07:07:173  INFO 32264 --- [RMI TCP Connection(3)-10.21.93.70] o.a.c.c.C.[Tomcat].[localhost].[/]       : Initializing Spring DispatcherServlet 'dispatcherServlet'
17:07:07:174  INFO 32264 --- [RMI TCP Connection(3)-10.21.93.70] o.s.web.servlet.DispatcherServlet        : Initializing Servlet 'dispatcherServlet'
17:07:07:181  INFO 32264 --- [RMI TCP Connection(3)-10.21.93.70] o.s.web.servlet.DispatcherServlet        : Completed initialization in 7 ms
17:07:07:183  INFO 32264 --- [RMI TCP Connection(2)-10.21.93.70] com.zaxxer.hikari.HikariDataSource       : HikariPool-1 - Starting...
17:07:08:051  INFO 32264 --- [RMI TCP Connection(2)-10.21.93.70] com.zaxxer.hikari.HikariDataSource       : HikariPool-1 - Start completed.
17:07:11:730 DEBUG 32264 --- [http-nio-8080-exec-2] c.l.h.m.D.selectById                     : ==>  Preparing: SELECT id,patient_id,doctor_id,disease_name,disease_category,aimodel_id,result,create_time,status,id_card,name,score,remark FROM diagnosis_report WHERE id=?
17:07:11:765 DEBUG 32264 --- [http-nio-8080-exec-2] c.l.h.m.D.selectById                     : ==> Parameters: 1(Integer)
17:07:11:877 DEBUG 32264 --- [http-nio-8080-exec-2] c.l.h.m.D.selectById                     : <==      Total: 1
17:07:11:882 DEBUG 32264 --- [http-nio-8080-exec-2] c.l.h.mapper.PatientMapper.selectById    : ==>  Preparing: SELECT id,phone,id_card,name,verified,verified_by,verified_time,open_id,hospital_pid FROM patient WHERE id=?
17:07:11:882 DEBUG 32264 --- [http-nio-8080-exec-2] c.l.h.mapper.PatientMapper.selectById    : ==> Parameters: 1(Integer)
17:07:11:915 DEBUG 32264 --- [http-nio-8080-exec-2] c.l.h.mapper.PatientMapper.selectById    : <==      Total: 1
17:07:11:919 DEBUG 32264 --- [http-nio-8080-exec-2] c.l.h.mapper.DoctorMapper.selectById     : ==>  Preparing: SELECT id,phone,id_card,name,verified,verified_by,verified_time,license,department,hospital_pid FROM doctor WHERE id=?
17:07:11:919 DEBUG 32264 --- [http-nio-8080-exec-2] c.l.h.mapper.DoctorMapper.selectById     : ==> Parameters: 1(Integer)
17:07:11:955 DEBUG 32264 --- [http-nio-8080-exec-2] c.l.h.mapper.DoctorMapper.selectById     : <==      Total: 1
17:07:11:961 DEBUG 32264 --- [http-nio-8080-exec-2] c.l.h.m.E.selectListByDiagnosisId        : ==>  Preparing: select * from eye_images where dignosis_report_id = ?
17:07:11:961 DEBUG 32264 --- [http-nio-8080-exec-2] c.l.h.m.E.selectListByDiagnosisId        : ==> Parameters: 1(Integer)
17:07:11:992 DEBUG 32264 --- [http-nio-8080-exec-2] c.l.h.m.E.selectListByDiagnosisId        : <==      Total: 1
17:07:11:993 DEBUG 32264 --- [http-nio-8080-exec-2] c.l.h.m.T.selectByDiagnosisId            : ==>  Preparing: select * from treatment_plans where diagnosis_id = ?
17:07:11:994 DEBUG 32264 --- [http-nio-8080-exec-2] c.l.h.m.T.selectByDiagnosisId            : ==> Parameters: 1(Integer)
17:07:12:026 DEBUG 32264 --- [http-nio-8080-exec-2] c.l.h.m.T.selectByDiagnosisId            : <==      Total: 1
17:07:12:027 DEBUG 32264 --- [http-nio-8080-exec-2] c.l.h.m.M.selectByDiagnosisId            : ==>  Preparing: select * from medication_recommendations where diagnosis_id = ?
17:07:12:028 DEBUG 32264 --- [http-nio-8080-exec-2] c.l.h.m.M.selectByDiagnosisId            : ==> Parameters: 1(Integer)
17:07:12:061 DEBUG 32264 --- [http-nio-8080-exec-2] c.l.h.m.M.selectByDiagnosisId            : <==      Total: 1
17:07:12:061 DEBUG 32264 --- [http-nio-8080-exec-2] c.l.h.mapper.AiModelMapper.selectById    : ==>  Preparing: SELECT id,version,deploy_time,accuracy FROM ai_model WHERE id=?
17:07:12:062 DEBUG 32264 --- [http-nio-8080-exec-2] c.l.h.mapper.AiModelMapper.selectById    : ==> Parameters: 1(Integer)
17:07:12:095 DEBUG 32264 --- [http-nio-8080-exec-2] c.l.h.mapper.AiModelMapper.selectById    : <==      Total: 1
17:07:12:184 DEBUG 32264 --- [http-nio-8080-exec-2] c.l.api.client.FlaskAiDoctorClient       : [FlaskAiDoctorClient#eye_doctor_chat] ---> POST http://ai-service/api/eye-doctor/chat HTTP/1.1
17:07:12:184 DEBUG 32264 --- [http-nio-8080-exec-2] c.l.api.client.FlaskAiDoctorClient       : [FlaskAiDoctorClient#eye_doctor_chat] Content-Length: 726
17:07:12:184 DEBUG 32264 --- [http-nio-8080-exec-2] c.l.api.client.FlaskAiDoctorClient       : [FlaskAiDoctorClient#eye_doctor_chat] Content-Type: application/json
17:07:12:184 DEBUG 32264 --- [http-nio-8080-exec-2] c.l.api.client.FlaskAiDoctorClient       : [FlaskAiDoctorClient#eye_doctor_chat] 
17:07:12:184 DEBUG 32264 --- [http-nio-8080-exec-2] c.l.api.client.FlaskAiDoctorClient       : [FlaskAiDoctorClient#eye_doctor_chat] {"diagnosis_name":"","diagnosis_category":"","result":"A","remark":"A","treatment_plan":{"id":1,"treatmentType":1,"treatmentDetail":"","startTime":"2025-03-01 09:00:00","endDate":"2025-03-10 09:00:00","doctorId":1,"createdTime":[2025,3,1,9,0],"updatedTime":[2025,3,1,9,0]},"medications":[{"id":1,"diagnosisId":1,"medicationName":"A","dosage":"10mg","frequency":"","sideEffects":"","startTime":[2025,3,1,9,0],"endTime":[2025,3,10,9,0],"doctorId":1,"createdTime":"2025-03-01 09:00:00","updatedTime":"2025-03-01 09:00:00"}],"previous_conversations":[{"role":"pariatur tempor do","content":"sit cupidatat commodo"}],"question":"irure eu esse","stream":false}
17:07:12:186 DEBUG 32264 --- [http-nio-8080-exec-2] c.l.api.client.FlaskAiDoctorClient       : [FlaskAiDoctorClient#eye_doctor_chat] ---> END HTTP (726-byte body)
17:07:14:471 DEBUG 32264 --- [http-nio-8080-exec-2] c.l.api.client.FlaskAiDoctorClient       : [FlaskAiDoctorClient#eye_doctor_chat] <--- ERROR ConnectException: Connection refused: getsockopt (2284ms)
17:07:14:472 DEBUG 32264 --- [http-nio-8080-exec-2] c.l.api.client.FlaskAiDoctorClient       : [FlaskAiDoctorClient#eye_doctor_chat] java.net.ConnectException: Connection refused: getsockopt
	at java.base/sun.nio.ch.Net.pollConnect(Native Method)
	at java.base/sun.nio.ch.Net.pollConnectNow(Net.java:672)
	at java.base/sun.nio.ch.NioSocketImpl.timedFinishConnect(NioSocketImpl.java:554)
	at java.base/sun.nio.ch.NioSocketImpl.connect(NioSocketImpl.java:602)
	at java.base/java.net.Socket.connect(Socket.java:633)
	at java.base/sun.net.NetworkClient.doConnect(NetworkClient.java:178)
	at java.base/sun.net.www.http.HttpClient.openServer(HttpClient.java:533)
	at java.base/sun.net.www.http.HttpClient.openServer(HttpClient.java:638)
	at java.base/sun.net.www.http.HttpClient.<init>(HttpClient.java:281)
	at java.base/sun.net.www.http.HttpClient.New(HttpClient.java:386)
	at java.base/sun.net.www.http.HttpClient.New(HttpClient.java:408)
	at java.base/sun.net.www.protocol.http.HttpURLConnection.getNewHttpClient(HttpURLConnection.java:1309)
	at java.base/sun.net.www.protocol.http.HttpURLConnection.plainConnect0(HttpURLConnection.java:1242)
	at java.base/sun.net.www.protocol.http.HttpURLConnection.plainConnect(HttpURLConnection.java:1128)
	at java.base/sun.net.www.protocol.http.HttpURLConnection.connect(HttpURLConnection.java:1057)
	at java.base/sun.net.www.protocol.http.HttpURLConnection.getOutputStream0(HttpURLConnection.java:1451)
	at java.base/sun.net.www.protocol.http.HttpURLConnection.getOutputStream(HttpURLConnection.java:1422)
	at feign.Client$Default.convertAndSend(Client.java:208)
	at feign.Client$Default.execute(Client.java:105)
	at org.springframework.cloud.openfeign.loadbalancer.LoadBalancerUtils.executeWithLoadBalancerLifecycleProcessing(LoadBalancerUtils.java:57)
	at org.springframework.cloud.openfeign.loadbalancer.LoadBalancerUtils.executeWithLoadBalancerLifecycleProcessing(LoadBalancerUtils.java:95)
	at org.springframework.cloud.openfeign.loadbalancer.FeignBlockingLoadBalancerClient.execute(FeignBlockingLoadBalancerClient.java:114)
	at feign.SynchronousMethodHandler.executeAndDecode(SynchronousMethodHandler.java:121)
	at feign.SynchronousMethodHandler.invoke(SynchronousMethodHandler.java:91)
	at feign.ReflectiveFeign$FeignInvocationHandler.invoke(ReflectiveFeign.java:100)
	at jdk.proxy2/jdk.proxy2.$Proxy135.eye_doctor_chat(Unknown Source)
	at com.luojiawei.his_service.controller.ChatController.ask(ChatController.java:38)
	at java.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at java.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:77)
	at java.base/jdk.internal.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.base/java.lang.reflect.Method.invoke(Method.java:568)
	at org.springframework.web.method.support.InvocableHandlerMethod.doInvoke(InvocableHandlerMethod.java:205)
	at org.springframework.web.method.support.InvocableHandlerMethod.invokeForRequest(InvocableHandlerMethod.java:150)
	at org.springframework.web.servlet.mvc.method.annotation.ServletInvocableHandlerMethod.invokeAndHandle(ServletInvocableHandlerMethod.java:117)
	at org.springframework.web.servlet.mvc.method.annotation.RequestMappingHandlerAdapter.invokeHandlerMethod(RequestMappingHandlerAdapter.java:895)
	at org.springframework.web.servlet.mvc.method.annotation.RequestMappingHandlerAdapter.handleInternal(RequestMappingHandlerAdapter.java:808)
	at org.springframework.web.servlet.mvc.method.AbstractHandlerMethodAdapter.handle(AbstractHandlerMethodAdapter.java:87)
	at org.springframework.web.servlet.DispatcherServlet.doDispatch(DispatcherServlet.java:1072)
	at org.springframework.web.servlet.DispatcherServlet.doService(DispatcherServlet.java:965)
	at org.springframework.web.servlet.FrameworkServlet.processRequest(FrameworkServlet.java:1006)
	at org.springframework.web.servlet.FrameworkServlet.doPost(FrameworkServlet.java:909)
	at javax.servlet.http.HttpServlet.service(HttpServlet.java:555)
	at org.springframework.web.servlet.FrameworkServlet.service(FrameworkServlet.java:883)
	at javax.servlet.http.HttpServlet.service(HttpServlet.java:623)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:209)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:153)
	at com.luojiawei.his_service.filter.RefreshTokenFilter.doFilterInternal(RefreshTokenFilter.java:58)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:117)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:178)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:153)
	at org.springframework.web.filter.RequestContextFilter.doFilterInternal(RequestContextFilter.java:100)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:117)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:178)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:153)
	at org.springframework.web.filter.FormContentFilter.doFilterInternal(FormContentFilter.java:93)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:117)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:178)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:153)
	at org.springframework.boot.actuate.metrics.web.servlet.WebMvcMetricsFilter.doFilterInternal(WebMvcMetricsFilter.java:96)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:117)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:178)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:153)
	at org.springframework.web.filter.CharacterEncodingFilter.doFilterInternal(CharacterEncodingFilter.java:201)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:117)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:178)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:153)
	at org.apache.catalina.core.StandardWrapperValve.invoke(StandardWrapperValve.java:167)
	at org.apache.catalina.core.StandardContextValve.invoke(StandardContextValve.java:90)
	at org.apache.catalina.authenticator.AuthenticatorBase.invoke(AuthenticatorBase.java:481)
	at org.apache.catalina.core.StandardHostValve.invoke(StandardHostValve.java:130)
	at org.apache.catalina.valves.ErrorReportValve.invoke(ErrorReportValve.java:93)
	at org.apache.catalina.core.StandardEngineValve.invoke(StandardEngineValve.java:74)
	at org.apache.catalina.connector.CoyoteAdapter.service(CoyoteAdapter.java:343)
	at org.apache.coyote.http11.Http11Processor.service(Http11Processor.java:390)
	at org.apache.coyote.AbstractProcessorLight.process(AbstractProcessorLight.java:63)
	at org.apache.coyote.AbstractProtocol$ConnectionHandler.process(AbstractProtocol.java:926)
	at org.apache.tomcat.util.net.NioEndpoint$SocketProcessor.doRun(NioEndpoint.java:1791)
	at org.apache.tomcat.util.net.SocketProcessorBase.run(SocketProcessorBase.java:52)
	at org.apache.tomcat.util.threads.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1191)
	at org.apache.tomcat.util.threads.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:659)
	at org.apache.tomcat.util.threads.TaskThread$WrappingRunnable.run(TaskThread.java:61)
	at java.base/java.lang.Thread.run(Thread.java:840)

17:07:14:472 DEBUG 32264 --- [http-nio-8080-exec-2] c.l.api.client.FlaskAiDoctorClient       : [FlaskAiDoctorClient#eye_doctor_chat] <--- END ERROR
17:07:14:495 ERROR 32264 --- [http-nio-8080-exec-2] o.a.c.c.C.[.[.[/].[dispatcherServlet]    : Servlet.service() for servlet [dispatcherServlet] in context with path [] threw exception [Request processing failed; nested exception is feign.RetryableException: Connection refused: getsockopt executing POST http://ai-service/api/eye-doctor/chat] with root cause

java.net.ConnectException: Connection refused: getsockopt
	at java.base/sun.nio.ch.Net.pollConnect(Native Method) ~[na:na]
	at java.base/sun.nio.ch.Net.pollConnectNow(Net.java:672) ~[na:na]
	at java.base/sun.nio.ch.NioSocketImpl.timedFinishConnect(NioSocketImpl.java:554) ~[na:na]
	at java.base/sun.nio.ch.NioSocketImpl.connect(NioSocketImpl.java:602) ~[na:na]
	at java.base/java.net.Socket.connect(Socket.java:633) ~[na:na]
	at java.base/sun.net.NetworkClient.doConnect(NetworkClient.java:178) ~[na:na]
	at java.base/sun.net.www.http.HttpClient.openServer(HttpClient.java:533) ~[na:na]
	at java.base/sun.net.www.http.HttpClient.openServer(HttpClient.java:638) ~[na:na]
	at java.base/sun.net.www.http.HttpClient.<init>(HttpClient.java:281) ~[na:na]
	at java.base/sun.net.www.http.HttpClient.New(HttpClient.java:386) ~[na:na]
	at java.base/sun.net.www.http.HttpClient.New(HttpClient.java:408) ~[na:na]
	at java.base/sun.net.www.protocol.http.HttpURLConnection.getNewHttpClient(HttpURLConnection.java:1309) ~[na:na]
	at java.base/sun.net.www.protocol.http.HttpURLConnection.plainConnect0(HttpURLConnection.java:1242) ~[na:na]
	at java.base/sun.net.www.protocol.http.HttpURLConnection.plainConnect(HttpURLConnection.java:1128) ~[na:na]
	at java.base/sun.net.www.protocol.http.HttpURLConnection.connect(HttpURLConnection.java:1057) ~[na:na]
	at java.base/sun.net.www.protocol.http.HttpURLConnection.getOutputStream0(HttpURLConnection.java:1451) ~[na:na]
	at java.base/sun.net.www.protocol.http.HttpURLConnection.getOutputStream(HttpURLConnection.java:1422) ~[na:na]
	at feign.Client$Default.convertAndSend(Client.java:208) ~[feign-core-11.10.jar:na]
	at feign.Client$Default.execute(Client.java:105) ~[feign-core-11.10.jar:na]
	at org.springframework.cloud.openfeign.loadbalancer.LoadBalancerUtils.executeWithLoadBalancerLifecycleProcessing(LoadBalancerUtils.java:57) ~[spring-cloud-openfeign-core-3.1.5.jar:3.1.5]
	at org.springframework.cloud.openfeign.loadbalancer.LoadBalancerUtils.executeWithLoadBalancerLifecycleProcessing(LoadBalancerUtils.java:95) ~[spring-cloud-openfeign-core-3.1.5.jar:3.1.5]
	at org.springframework.cloud.openfeign.loadbalancer.FeignBlockingLoadBalancerClient.execute(FeignBlockingLoadBalancerClient.java:114) ~[spring-cloud-openfeign-core-3.1.5.jar:3.1.5]
	at feign.SynchronousMethodHandler.executeAndDecode(SynchronousMethodHandler.java:121) ~[feign-core-11.10.jar:na]
	at feign.SynchronousMethodHandler.invoke(SynchronousMethodHandler.java:91) ~[feign-core-11.10.jar:na]
	at feign.ReflectiveFeign$FeignInvocationHandler.invoke(ReflectiveFeign.java:100) ~[feign-core-11.10.jar:na]
	at jdk.proxy2/jdk.proxy2.$Proxy135.eye_doctor_chat(Unknown Source) ~[na:na]
	at com.luojiawei.his_service.controller.ChatController.ask(ChatController.java:38) ~[classes/:na]
	at java.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke0(Native Method) ~[na:na]
	at java.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:77) ~[na:na]
	at java.base/jdk.internal.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43) ~[na:na]
	at java.base/java.lang.reflect.Method.invoke(Method.java:568) ~[na:na]
	at org.springframework.web.method.support.InvocableHandlerMethod.doInvoke(InvocableHandlerMethod.java:205) ~[spring-web-5.3.27.jar:5.3.27]
	at org.springframework.web.method.support.InvocableHandlerMethod.invokeForRequest(InvocableHandlerMethod.java:150) ~[spring-web-5.3.27.jar:5.3.27]
	at org.springframework.web.servlet.mvc.method.annotation.ServletInvocableHandlerMethod.invokeAndHandle(ServletInvocableHandlerMethod.java:117) ~[spring-webmvc-5.3.27.jar:5.3.27]
	at org.springframework.web.servlet.mvc.method.annotation.RequestMappingHandlerAdapter.invokeHandlerMethod(RequestMappingHandlerAdapter.java:895) ~[spring-webmvc-5.3.27.jar:5.3.27]
	at org.springframework.web.servlet.mvc.method.annotation.RequestMappingHandlerAdapter.handleInternal(RequestMappingHandlerAdapter.java:808) ~[spring-webmvc-5.3.27.jar:5.3.27]
	at org.springframework.web.servlet.mvc.method.AbstractHandlerMethodAdapter.handle(AbstractHandlerMethodAdapter.java:87) ~[spring-webmvc-5.3.27.jar:5.3.27]
	at org.springframework.web.servlet.DispatcherServlet.doDispatch(DispatcherServlet.java:1072) ~[spring-webmvc-5.3.27.jar:5.3.27]
	at org.springframework.web.servlet.DispatcherServlet.doService(DispatcherServlet.java:965) ~[spring-webmvc-5.3.27.jar:5.3.27]
	at org.springframework.web.servlet.FrameworkServlet.processRequest(FrameworkServlet.java:1006) ~[spring-webmvc-5.3.27.jar:5.3.27]
	at org.springframework.web.servlet.FrameworkServlet.doPost(FrameworkServlet.java:909) ~[spring-webmvc-5.3.27.jar:5.3.27]
	at javax.servlet.http.HttpServlet.service(HttpServlet.java:555) ~[tomcat-embed-core-9.0.75.jar:4.0.FR]
	at org.springframework.web.servlet.FrameworkServlet.service(FrameworkServlet.java:883) ~[spring-webmvc-5.3.27.jar:5.3.27]
	at javax.servlet.http.HttpServlet.service(HttpServlet.java:623) ~[tomcat-embed-core-9.0.75.jar:4.0.FR]
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:209) ~[tomcat-embed-core-9.0.75.jar:9.0.75]
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:153) ~[tomcat-embed-core-9.0.75.jar:9.0.75]
	at com.luojiawei.his_service.filter.RefreshTokenFilter.doFilterInternal(RefreshTokenFilter.java:58) ~[classes/:na]
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:117) ~[spring-web-5.3.27.jar:5.3.27]
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:178) ~[tomcat-embed-core-9.0.75.jar:9.0.75]
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:153) ~[tomcat-embed-core-9.0.75.jar:9.0.75]
	at org.springframework.web.filter.RequestContextFilter.doFilterInternal(RequestContextFilter.java:100) ~[spring-web-5.3.27.jar:5.3.27]
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:117) ~[spring-web-5.3.27.jar:5.3.27]
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:178) ~[tomcat-embed-core-9.0.75.jar:9.0.75]
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:153) ~[tomcat-embed-core-9.0.75.jar:9.0.75]
	at org.springframework.web.filter.FormContentFilter.doFilterInternal(FormContentFilter.java:93) ~[spring-web-5.3.27.jar:5.3.27]
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:117) ~[spring-web-5.3.27.jar:5.3.27]
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:178) ~[tomcat-embed-core-9.0.75.jar:9.0.75]
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:153) ~[tomcat-embed-core-9.0.75.jar:9.0.75]
	at org.springframework.boot.actuate.metrics.web.servlet.WebMvcMetricsFilter.doFilterInternal(WebMvcMetricsFilter.java:96) ~[spring-boot-actuator-2.7.12.jar:2.7.12]
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:117) ~[spring-web-5.3.27.jar:5.3.27]
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:178) ~[tomcat-embed-core-9.0.75.jar:9.0.75]
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:153) ~[tomcat-embed-core-9.0.75.jar:9.0.75]
	at org.springframework.web.filter.CharacterEncodingFilter.doFilterInternal(CharacterEncodingFilter.java:201) ~[spring-web-5.3.27.jar:5.3.27]
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:117) ~[spring-web-5.3.27.jar:5.3.27]
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:178) ~[tomcat-embed-core-9.0.75.jar:9.0.75]
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:153) ~[tomcat-embed-core-9.0.75.jar:9.0.75]
	at org.apache.catalina.core.StandardWrapperValve.invoke(StandardWrapperValve.java:167) ~[tomcat-embed-core-9.0.75.jar:9.0.75]
	at org.apache.catalina.core.StandardContextValve.invoke(StandardContextValve.java:90) ~[tomcat-embed-core-9.0.75.jar:9.0.75]
	at org.apache.catalina.authenticator.AuthenticatorBase.invoke(AuthenticatorBase.java:481) ~[tomcat-embed-core-9.0.75.jar:9.0.75]
	at org.apache.catalina.core.StandardHostValve.invoke(StandardHostValve.java:130) ~[tomcat-embed-core-9.0.75.jar:9.0.75]
	at org.apache.catalina.valves.ErrorReportValve.invoke(ErrorReportValve.java:93) ~[tomcat-embed-core-9.0.75.jar:9.0.75]
	at org.apache.catalina.core.StandardEngineValve.invoke(StandardEngineValve.java:74) ~[tomcat-embed-core-9.0.75.jar:9.0.75]
	at org.apache.catalina.connector.CoyoteAdapter.service(CoyoteAdapter.java:343) ~[tomcat-embed-core-9.0.75.jar:9.0.75]
	at org.apache.coyote.http11.Http11Processor.service(Http11Processor.java:390) ~[tomcat-embed-core-9.0.75.jar:9.0.75]
	at org.apache.coyote.AbstractProcessorLight.process(AbstractProcessorLight.java:63) ~[tomcat-embed-core-9.0.75.jar:9.0.75]
	at org.apache.coyote.AbstractProtocol$ConnectionHandler.process(AbstractProtocol.java:926) ~[tomcat-embed-core-9.0.75.jar:9.0.75]
	at org.apache.tomcat.util.net.NioEndpoint$SocketProcessor.doRun(NioEndpoint.java:1791) ~[tomcat-embed-core-9.0.75.jar:9.0.75]
	at org.apache.tomcat.util.net.SocketProcessorBase.run(SocketProcessorBase.java:52) ~[tomcat-embed-core-9.0.75.jar:9.0.75]
	at org.apache.tomcat.util.threads.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1191) ~[tomcat-embed-core-9.0.75.jar:9.0.75]
	at org.apache.tomcat.util.threads.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:659) ~[tomcat-embed-core-9.0.75.jar:9.0.75]
	at org.apache.tomcat.util.threads.TaskThread$WrappingRunnable.run(TaskThread.java:61) ~[tomcat-embed-core-9.0.75.jar:9.0.75]
	at java.base/java.lang.Thread.run(Thread.java:840) ~[na:na]

17:08:12:959 DEBUG 32264 --- [http-nio-8080-exec-3] c.l.h.m.D.selectById                     : ==>  Preparing: SELECT id,patient_id,doctor_id,disease_name,disease_category,aimodel_id,result,create_time,status,id_card,name,score,remark FROM diagnosis_report WHERE id=?
17:08:12:960 DEBUG 32264 --- [http-nio-8080-exec-3] c.l.h.m.D.selectById                     : ==> Parameters: 1(Integer)
17:08:12:992 DEBUG 32264 --- [http-nio-8080-exec-3] c.l.h.m.D.selectById                     : <==      Total: 1
17:08:12:993 DEBUG 32264 --- [http-nio-8080-exec-3] c.l.h.mapper.PatientMapper.selectById    : ==>  Preparing: SELECT id,phone,id_card,name,verified,verified_by,verified_time,open_id,hospital_pid FROM patient WHERE id=?
17:08:12:993 DEBUG 32264 --- [http-nio-8080-exec-3] c.l.h.mapper.PatientMapper.selectById    : ==> Parameters: 1(Integer)
17:08:13:026 DEBUG 32264 --- [http-nio-8080-exec-3] c.l.h.mapper.PatientMapper.selectById    : <==      Total: 1
17:08:13:027 DEBUG 32264 --- [http-nio-8080-exec-3] c.l.h.mapper.DoctorMapper.selectById     : ==>  Preparing: SELECT id,phone,id_card,name,verified,verified_by,verified_time,license,department,hospital_pid FROM doctor WHERE id=?
17:08:13:027 DEBUG 32264 --- [http-nio-8080-exec-3] c.l.h.mapper.DoctorMapper.selectById     : ==> Parameters: 1(Integer)
17:08:13:059 DEBUG 32264 --- [http-nio-8080-exec-3] c.l.h.mapper.DoctorMapper.selectById     : <==      Total: 1
17:08:13:060 DEBUG 32264 --- [http-nio-8080-exec-3] c.l.h.m.E.selectListByDiagnosisId        : ==>  Preparing: select * from eye_images where dignosis_report_id = ?
17:08:13:061 DEBUG 32264 --- [http-nio-8080-exec-3] c.l.h.m.E.selectListByDiagnosisId        : ==> Parameters: 1(Integer)
17:08:13:093 DEBUG 32264 --- [http-nio-8080-exec-3] c.l.h.m.E.selectListByDiagnosisId        : <==      Total: 1
17:08:13:094 DEBUG 32264 --- [http-nio-8080-exec-3] c.l.h.m.T.selectByDiagnosisId            : ==>  Preparing: select * from treatment_plans where diagnosis_id = ?
17:08:13:095 DEBUG 32264 --- [http-nio-8080-exec-3] c.l.h.m.T.selectByDiagnosisId            : ==> Parameters: 1(Integer)
17:08:13:127 DEBUG 32264 --- [http-nio-8080-exec-3] c.l.h.m.T.selectByDiagnosisId            : <==      Total: 1
17:08:13:128 DEBUG 32264 --- [http-nio-8080-exec-3] c.l.h.m.M.selectByDiagnosisId            : ==>  Preparing: select * from medication_recommendations where diagnosis_id = ?
17:08:13:128 DEBUG 32264 --- [http-nio-8080-exec-3] c.l.h.m.M.selectByDiagnosisId            : ==> Parameters: 1(Integer)
17:08:13:160 DEBUG 32264 --- [http-nio-8080-exec-3] c.l.h.m.M.selectByDiagnosisId            : <==      Total: 1
17:08:13:161 DEBUG 32264 --- [http-nio-8080-exec-3] c.l.h.mapper.AiModelMapper.selectById    : ==>  Preparing: SELECT id,version,deploy_time,accuracy FROM ai_model WHERE id=?
17:08:13:161 DEBUG 32264 --- [http-nio-8080-exec-3] c.l.h.mapper.AiModelMapper.selectById    : ==> Parameters: 1(Integer)
17:08:13:193 DEBUG 32264 --- [http-nio-8080-exec-3] c.l.h.mapper.AiModelMapper.selectById    : <==      Total: 1
17:08:38:877 DEBUG 32264 --- [http-nio-8080-exec-3] c.l.api.client.FlaskAiDoctorClient       : [FlaskAiDoctorClient#eye_doctor_chat] ---> POST http://ai-service/api/eye-doctor/chat HTTP/1.1
17:08:38:877 DEBUG 32264 --- [http-nio-8080-exec-3] c.l.api.client.FlaskAiDoctorClient       : [FlaskAiDoctorClient#eye_doctor_chat] Content-Length: 726
17:08:38:877 DEBUG 32264 --- [http-nio-8080-exec-3] c.l.api.client.FlaskAiDoctorClient       : [FlaskAiDoctorClient#eye_doctor_chat] Content-Type: application/json
17:08:38:877 DEBUG 32264 --- [http-nio-8080-exec-3] c.l.api.client.FlaskAiDoctorClient       : [FlaskAiDoctorClient#eye_doctor_chat] 
17:08:38:877 DEBUG 32264 --- [http-nio-8080-exec-3] c.l.api.client.FlaskAiDoctorClient       : [FlaskAiDoctorClient#eye_doctor_chat] {"diagnosis_name":"","diagnosis_category":"","result":"A","remark":"A","treatment_plan":{"id":1,"treatmentType":1,"treatmentDetail":"","startTime":"2025-03-01 09:00:00","endDate":"2025-03-10 09:00:00","doctorId":1,"createdTime":[2025,3,1,9,0],"updatedTime":[2025,3,1,9,0]},"medications":[{"id":1,"diagnosisId":1,"medicationName":"A","dosage":"10mg","frequency":"","sideEffects":"","startTime":[2025,3,1,9,0],"endTime":[2025,3,10,9,0],"doctorId":1,"createdTime":"2025-03-01 09:00:00","updatedTime":"2025-03-01 09:00:00"}],"previous_conversations":[{"role":"pariatur tempor do","content":"sit cupidatat commodo"}],"question":"irure eu esse","stream":false}
17:08:38:877 DEBUG 32264 --- [http-nio-8080-exec-3] c.l.api.client.FlaskAiDoctorClient       : [FlaskAiDoctorClient#eye_doctor_chat] ---> END HTTP (726-byte body)
17:08:40:933 DEBUG 32264 --- [http-nio-8080-exec-3] c.l.api.client.FlaskAiDoctorClient       : [FlaskAiDoctorClient#eye_doctor_chat] <--- ERROR ConnectException: Connection refused: getsockopt (2055ms)
17:08:40:933 DEBUG 32264 --- [http-nio-8080-exec-3] c.l.api.client.FlaskAiDoctorClient       : [FlaskAiDoctorClient#eye_doctor_chat] java.net.ConnectException: Connection refused: getsockopt
	at java.base/sun.nio.ch.Net.pollConnect(Native Method)
	at java.base/sun.nio.ch.Net.pollConnectNow(Net.java:672)
	at java.base/sun.nio.ch.NioSocketImpl.timedFinishConnect(NioSocketImpl.java:554)
	at java.base/sun.nio.ch.NioSocketImpl.connect(NioSocketImpl.java:602)
	at java.base/java.net.Socket.connect(Socket.java:633)
	at java.base/sun.net.NetworkClient.doConnect(NetworkClient.java:178)
	at java.base/sun.net.www.http.HttpClient.openServer(HttpClient.java:533)
	at java.base/sun.net.www.http.HttpClient.openServer(HttpClient.java:638)
	at java.base/sun.net.www.http.HttpClient.<init>(HttpClient.java:281)
	at java.base/sun.net.www.http.HttpClient.New(HttpClient.java:386)
	at java.base/sun.net.www.http.HttpClient.New(HttpClient.java:408)
	at java.base/sun.net.www.protocol.http.HttpURLConnection.getNewHttpClient(HttpURLConnection.java:1309)
	at java.base/sun.net.www.protocol.http.HttpURLConnection.plainConnect0(HttpURLConnection.java:1242)
	at java.base/sun.net.www.protocol.http.HttpURLConnection.plainConnect(HttpURLConnection.java:1128)
	at java.base/sun.net.www.protocol.http.HttpURLConnection.connect(HttpURLConnection.java:1057)
	at java.base/sun.net.www.protocol.http.HttpURLConnection.getOutputStream0(HttpURLConnection.java:1451)
	at java.base/sun.net.www.protocol.http.HttpURLConnection.getOutputStream(HttpURLConnection.java:1422)
	at feign.Client$Default.convertAndSend(Client.java:208)
	at feign.Client$Default.execute(Client.java:105)
	at org.springframework.cloud.openfeign.loadbalancer.LoadBalancerUtils.executeWithLoadBalancerLifecycleProcessing(LoadBalancerUtils.java:57)
	at org.springframework.cloud.openfeign.loadbalancer.LoadBalancerUtils.executeWithLoadBalancerLifecycleProcessing(LoadBalancerUtils.java:95)
	at org.springframework.cloud.openfeign.loadbalancer.FeignBlockingLoadBalancerClient.execute(FeignBlockingLoadBalancerClient.java:114)
	at feign.SynchronousMethodHandler.executeAndDecode(SynchronousMethodHandler.java:121)
	at feign.SynchronousMethodHandler.invoke(SynchronousMethodHandler.java:91)
	at feign.ReflectiveFeign$FeignInvocationHandler.invoke(ReflectiveFeign.java:100)
	at jdk.proxy2/jdk.proxy2.$Proxy135.eye_doctor_chat(Unknown Source)
	at com.luojiawei.his_service.controller.ChatController.ask(ChatController.java:38)
	at java.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at java.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:77)
	at java.base/jdk.internal.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.base/java.lang.reflect.Method.invoke(Method.java:568)
	at org.springframework.web.method.support.InvocableHandlerMethod.doInvoke(InvocableHandlerMethod.java:205)
	at org.springframework.web.method.support.InvocableHandlerMethod.invokeForRequest(InvocableHandlerMethod.java:150)
	at org.springframework.web.servlet.mvc.method.annotation.ServletInvocableHandlerMethod.invokeAndHandle(ServletInvocableHandlerMethod.java:117)
	at org.springframework.web.servlet.mvc.method.annotation.RequestMappingHandlerAdapter.invokeHandlerMethod(RequestMappingHandlerAdapter.java:895)
	at org.springframework.web.servlet.mvc.method.annotation.RequestMappingHandlerAdapter.handleInternal(RequestMappingHandlerAdapter.java:808)
	at org.springframework.web.servlet.mvc.method.AbstractHandlerMethodAdapter.handle(AbstractHandlerMethodAdapter.java:87)
	at org.springframework.web.servlet.DispatcherServlet.doDispatch(DispatcherServlet.java:1072)
	at org.springframework.web.servlet.DispatcherServlet.doService(DispatcherServlet.java:965)
	at org.springframework.web.servlet.FrameworkServlet.processRequest(FrameworkServlet.java:1006)
	at org.springframework.web.servlet.FrameworkServlet.doPost(FrameworkServlet.java:909)
	at javax.servlet.http.HttpServlet.service(HttpServlet.java:555)
	at org.springframework.web.servlet.FrameworkServlet.service(FrameworkServlet.java:883)
	at javax.servlet.http.HttpServlet.service(HttpServlet.java:623)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:209)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:153)
	at com.luojiawei.his_service.filter.RefreshTokenFilter.doFilterInternal(RefreshTokenFilter.java:58)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:117)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:178)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:153)
	at org.springframework.web.filter.RequestContextFilter.doFilterInternal(RequestContextFilter.java:100)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:117)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:178)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:153)
	at org.springframework.web.filter.FormContentFilter.doFilterInternal(FormContentFilter.java:93)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:117)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:178)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:153)
	at org.springframework.boot.actuate.metrics.web.servlet.WebMvcMetricsFilter.doFilterInternal(WebMvcMetricsFilter.java:96)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:117)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:178)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:153)
	at org.springframework.web.filter.CharacterEncodingFilter.doFilterInternal(CharacterEncodingFilter.java:201)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:117)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:178)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:153)
	at org.apache.catalina.core.StandardWrapperValve.invoke(StandardWrapperValve.java:167)
	at org.apache.catalina.core.StandardContextValve.invoke(StandardContextValve.java:90)
	at org.apache.catalina.authenticator.AuthenticatorBase.invoke(AuthenticatorBase.java:481)
	at org.apache.catalina.core.StandardHostValve.invoke(StandardHostValve.java:130)
	at org.apache.catalina.valves.ErrorReportValve.invoke(ErrorReportValve.java:93)
	at org.apache.catalina.core.StandardEngineValve.invoke(StandardEngineValve.java:74)
	at org.apache.catalina.connector.CoyoteAdapter.service(CoyoteAdapter.java:343)
	at org.apache.coyote.http11.Http11Processor.service(Http11Processor.java:390)
	at org.apache.coyote.AbstractProcessorLight.process(AbstractProcessorLight.java:63)
	at org.apache.coyote.AbstractProtocol$ConnectionHandler.process(AbstractProtocol.java:926)
	at org.apache.tomcat.util.net.NioEndpoint$SocketProcessor.doRun(NioEndpoint.java:1791)
	at org.apache.tomcat.util.net.SocketProcessorBase.run(SocketProcessorBase.java:52)
	at org.apache.tomcat.util.threads.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1191)
	at org.apache.tomcat.util.threads.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:659)
	at org.apache.tomcat.util.threads.TaskThread$WrappingRunnable.run(TaskThread.java:61)
	at java.base/java.lang.Thread.run(Thread.java:840)

17:08:40:933 DEBUG 32264 --- [http-nio-8080-exec-3] c.l.api.client.FlaskAiDoctorClient       : [FlaskAiDoctorClient#eye_doctor_chat] <--- END ERROR
17:08:40:934 ERROR 32264 --- [http-nio-8080-exec-3] o.a.c.c.C.[.[.[/].[dispatcherServlet]    : Servlet.service() for servlet [dispatcherServlet] in context with path [] threw exception [Request processing failed; nested exception is feign.RetryableException: Connection refused: getsockopt executing POST http://ai-service/api/eye-doctor/chat] with root cause

java.net.ConnectException: Connection refused: getsockopt
	at java.base/sun.nio.ch.Net.pollConnect(Native Method) ~[na:na]
	at java.base/sun.nio.ch.Net.pollConnectNow(Net.java:672) ~[na:na]
	at java.base/sun.nio.ch.NioSocketImpl.timedFinishConnect(NioSocketImpl.java:554) ~[na:na]
	at java.base/sun.nio.ch.NioSocketImpl.connect(NioSocketImpl.java:602) ~[na:na]
	at java.base/java.net.Socket.connect(Socket.java:633) ~[na:na]
	at java.base/sun.net.NetworkClient.doConnect(NetworkClient.java:178) ~[na:na]
	at java.base/sun.net.www.http.HttpClient.openServer(HttpClient.java:533) ~[na:na]
	at java.base/sun.net.www.http.HttpClient.openServer(HttpClient.java:638) ~[na:na]
	at java.base/sun.net.www.http.HttpClient.<init>(HttpClient.java:281) ~[na:na]
	at java.base/sun.net.www.http.HttpClient.New(HttpClient.java:386) ~[na:na]
	at java.base/sun.net.www.http.HttpClient.New(HttpClient.java:408) ~[na:na]
	at java.base/sun.net.www.protocol.http.HttpURLConnection.getNewHttpClient(HttpURLConnection.java:1309) ~[na:na]
	at java.base/sun.net.www.protocol.http.HttpURLConnection.plainConnect0(HttpURLConnection.java:1242) ~[na:na]
	at java.base/sun.net.www.protocol.http.HttpURLConnection.plainConnect(HttpURLConnection.java:1128) ~[na:na]
	at java.base/sun.net.www.protocol.http.HttpURLConnection.connect(HttpURLConnection.java:1057) ~[na:na]
	at java.base/sun.net.www.protocol.http.HttpURLConnection.getOutputStream0(HttpURLConnection.java:1451) ~[na:na]
	at java.base/sun.net.www.protocol.http.HttpURLConnection.getOutputStream(HttpURLConnection.java:1422) ~[na:na]
	at feign.Client$Default.convertAndSend(Client.java:208) ~[feign-core-11.10.jar:na]
	at feign.Client$Default.execute(Client.java:105) ~[feign-core-11.10.jar:na]
	at org.springframework.cloud.openfeign.loadbalancer.LoadBalancerUtils.executeWithLoadBalancerLifecycleProcessing(LoadBalancerUtils.java:57) ~[spring-cloud-openfeign-core-3.1.5.jar:3.1.5]
	at org.springframework.cloud.openfeign.loadbalancer.LoadBalancerUtils.executeWithLoadBalancerLifecycleProcessing(LoadBalancerUtils.java:95) ~[spring-cloud-openfeign-core-3.1.5.jar:3.1.5]
	at org.springframework.cloud.openfeign.loadbalancer.FeignBlockingLoadBalancerClient.execute(FeignBlockingLoadBalancerClient.java:114) ~[spring-cloud-openfeign-core-3.1.5.jar:3.1.5]
	at feign.SynchronousMethodHandler.executeAndDecode(SynchronousMethodHandler.java:121) ~[feign-core-11.10.jar:na]
	at feign.SynchronousMethodHandler.invoke(SynchronousMethodHandler.java:91) ~[feign-core-11.10.jar:na]
	at feign.ReflectiveFeign$FeignInvocationHandler.invoke(ReflectiveFeign.java:100) ~[feign-core-11.10.jar:na]
	at jdk.proxy2/jdk.proxy2.$Proxy135.eye_doctor_chat(Unknown Source) ~[na:na]
	at com.luojiawei.his_service.controller.ChatController.ask(ChatController.java:38) ~[classes/:na]
	at java.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke0(Native Method) ~[na:na]
	at java.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:77) ~[na:na]
	at java.base/jdk.internal.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43) ~[na:na]
	at java.base/java.lang.reflect.Method.invoke(Method.java:568) ~[na:na]
	at org.springframework.web.method.support.InvocableHandlerMethod.doInvoke(InvocableHandlerMethod.java:205) ~[spring-web-5.3.27.jar:5.3.27]
	at org.springframework.web.method.support.InvocableHandlerMethod.invokeForRequest(InvocableHandlerMethod.java:150) ~[spring-web-5.3.27.jar:5.3.27]
	at org.springframework.web.servlet.mvc.method.annotation.ServletInvocableHandlerMethod.invokeAndHandle(ServletInvocableHandlerMethod.java:117) ~[spring-webmvc-5.3.27.jar:5.3.27]
	at org.springframework.web.servlet.mvc.method.annotation.RequestMappingHandlerAdapter.invokeHandlerMethod(RequestMappingHandlerAdapter.java:895) ~[spring-webmvc-5.3.27.jar:5.3.27]
	at org.springframework.web.servlet.mvc.method.annotation.RequestMappingHandlerAdapter.handleInternal(RequestMappingHandlerAdapter.java:808) ~[spring-webmvc-5.3.27.jar:5.3.27]
	at org.springframework.web.servlet.mvc.method.AbstractHandlerMethodAdapter.handle(AbstractHandlerMethodAdapter.java:87) ~[spring-webmvc-5.3.27.jar:5.3.27]
	at org.springframework.web.servlet.DispatcherServlet.doDispatch(DispatcherServlet.java:1072) ~[spring-webmvc-5.3.27.jar:5.3.27]
	at org.springframework.web.servlet.DispatcherServlet.doService(DispatcherServlet.java:965) ~[spring-webmvc-5.3.27.jar:5.3.27]
	at org.springframework.web.servlet.FrameworkServlet.processRequest(FrameworkServlet.java:1006) ~[spring-webmvc-5.3.27.jar:5.3.27]
	at org.springframework.web.servlet.FrameworkServlet.doPost(FrameworkServlet.java:909) ~[spring-webmvc-5.3.27.jar:5.3.27]
	at javax.servlet.http.HttpServlet.service(HttpServlet.java:555) ~[tomcat-embed-core-9.0.75.jar:4.0.FR]
	at org.springframework.web.servlet.FrameworkServlet.service(FrameworkServlet.java:883) ~[spring-webmvc-5.3.27.jar:5.3.27]
	at javax.servlet.http.HttpServlet.service(HttpServlet.java:623) ~[tomcat-embed-core-9.0.75.jar:4.0.FR]
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:209) ~[tomcat-embed-core-9.0.75.jar:9.0.75]
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:153) ~[tomcat-embed-core-9.0.75.jar:9.0.75]
	at com.luojiawei.his_service.filter.RefreshTokenFilter.doFilterInternal(RefreshTokenFilter.java:58) ~[classes/:na]
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:117) ~[spring-web-5.3.27.jar:5.3.27]
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:178) ~[tomcat-embed-core-9.0.75.jar:9.0.75]
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:153) ~[tomcat-embed-core-9.0.75.jar:9.0.75]
	at org.springframework.web.filter.RequestContextFilter.doFilterInternal(RequestContextFilter.java:100) ~[spring-web-5.3.27.jar:5.3.27]
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:117) ~[spring-web-5.3.27.jar:5.3.27]
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:178) ~[tomcat-embed-core-9.0.75.jar:9.0.75]
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:153) ~[tomcat-embed-core-9.0.75.jar:9.0.75]
	at org.springframework.web.filter.FormContentFilter.doFilterInternal(FormContentFilter.java:93) ~[spring-web-5.3.27.jar:5.3.27]
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:117) ~[spring-web-5.3.27.jar:5.3.27]
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:178) ~[tomcat-embed-core-9.0.75.jar:9.0.75]
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:153) ~[tomcat-embed-core-9.0.75.jar:9.0.75]
	at org.springframework.boot.actuate.metrics.web.servlet.WebMvcMetricsFilter.doFilterInternal(WebMvcMetricsFilter.java:96) ~[spring-boot-actuator-2.7.12.jar:2.7.12]
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:117) ~[spring-web-5.3.27.jar:5.3.27]
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:178) ~[tomcat-embed-core-9.0.75.jar:9.0.75]
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:153) ~[tomcat-embed-core-9.0.75.jar:9.0.75]
	at org.springframework.web.filter.CharacterEncodingFilter.doFilterInternal(CharacterEncodingFilter.java:201) ~[spring-web-5.3.27.jar:5.3.27]
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:117) ~[spring-web-5.3.27.jar:5.3.27]
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:178) ~[tomcat-embed-core-9.0.75.jar:9.0.75]
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:153) ~[tomcat-embed-core-9.0.75.jar:9.0.75]
	at org.apache.catalina.core.StandardWrapperValve.invoke(StandardWrapperValve.java:167) ~[tomcat-embed-core-9.0.75.jar:9.0.75]
	at org.apache.catalina.core.StandardContextValve.invoke(StandardContextValve.java:90) ~[tomcat-embed-core-9.0.75.jar:9.0.75]
	at org.apache.catalina.authenticator.AuthenticatorBase.invoke(AuthenticatorBase.java:481) ~[tomcat-embed-core-9.0.75.jar:9.0.75]
	at org.apache.catalina.core.StandardHostValve.invoke(StandardHostValve.java:130) ~[tomcat-embed-core-9.0.75.jar:9.0.75]
	at org.apache.catalina.valves.ErrorReportValve.invoke(ErrorReportValve.java:93) ~[tomcat-embed-core-9.0.75.jar:9.0.75]
	at org.apache.catalina.core.StandardEngineValve.invoke(StandardEngineValve.java:74) ~[tomcat-embed-core-9.0.75.jar:9.0.75]
	at org.apache.catalina.connector.CoyoteAdapter.service(CoyoteAdapter.java:343) ~[tomcat-embed-core-9.0.75.jar:9.0.75]
	at org.apache.coyote.http11.Http11Processor.service(Http11Processor.java:390) ~[tomcat-embed-core-9.0.75.jar:9.0.75]
	at org.apache.coyote.AbstractProcessorLight.process(AbstractProcessorLight.java:63) ~[tomcat-embed-core-9.0.75.jar:9.0.75]
	at org.apache.coyote.AbstractProtocol$ConnectionHandler.process(AbstractProtocol.java:926) ~[tomcat-embed-core-9.0.75.jar:9.0.75]
	at org.apache.tomcat.util.net.NioEndpoint$SocketProcessor.doRun(NioEndpoint.java:1791) ~[tomcat-embed-core-9.0.75.jar:9.0.75]
	at org.apache.tomcat.util.net.SocketProcessorBase.run(SocketProcessorBase.java:52) ~[tomcat-embed-core-9.0.75.jar:9.0.75]
	at org.apache.tomcat.util.threads.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1191) ~[tomcat-embed-core-9.0.75.jar:9.0.75]
	at org.apache.tomcat.util.threads.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:659) ~[tomcat-embed-core-9.0.75.jar:9.0.75]
	at org.apache.tomcat.util.threads.TaskThread$WrappingRunnable.run(TaskThread.java:61) ~[tomcat-embed-core-9.0.75.jar:9.0.75]
	at java.base/java.lang.Thread.run(Thread.java:840) ~[na:na]

17:11:16:148  WARN 32264 --- [Thread-15] c.a.nacos.common.notify.NotifyCenter     : [NotifyCenter] Start destroying Publisher
17:11:16:148  WARN 32264 --- [Thread-18] c.a.n.common.http.HttpClientBeanHolder   : [HttpClientBeanHolder] Start destroying common HttpClient
17:11:16:149  WARN 32264 --- [Thread-15] c.a.nacos.common.notify.NotifyCenter     : [NotifyCenter] Destruction of the end
17:11:16:150  WARN 32264 --- [Thread-18] c.a.n.common.http.HttpClientBeanHolder   : [HttpClientBeanHolder] Destruction of the end
17:11:16:214  INFO 32264 --- [SpringApplicationShutdownHook] c.a.c.n.registry.NacosServiceRegistry    : De-registering from Nacos Server now...
17:11:16:252  INFO 32264 --- [SpringApplicationShutdownHook] c.a.c.n.registry.NacosServiceRegistry    : De-registration finished.
17:11:16:261  INFO 32264 --- [SpringApplicationShutdownHook] com.zaxxer.hikari.HikariDataSource       : HikariPool-1 - Shutdown initiated...
17:11:16:590  INFO 32264 --- [SpringApplicationShutdownHook] com.zaxxer.hikari.HikariDataSource       : HikariPool-1 - Shutdown completed.
17:11:24:909  INFO 30724 --- [main] c.l.his_service.HisServiceApplication    : Starting HisServiceApplication using Java 17.0.11 on luo with PID 30724 (A:\Desktop\workspace\HIS\his_service\target\classes started by 22407 in A:\Desktop\workspace\HIS)
17:11:24:913 DEBUG 30724 --- [main] c.l.his_service.HisServiceApplication    : Running with Spring Boot v2.7.12, Spring v5.3.27
17:11:24:916  INFO 30724 --- [main] c.l.his_service.HisServiceApplication    : The following 1 profile is active: "dev"
17:11:26:266  INFO 30724 --- [main] .s.d.r.c.RepositoryConfigurationDelegate : Multiple Spring Data modules found, entering strict repository configuration mode
17:11:26:269  INFO 30724 --- [main] .s.d.r.c.RepositoryConfigurationDelegate : Bootstrapping Spring Data Redis repositories in DEFAULT mode.
17:11:26:297  INFO 30724 --- [main] .s.d.r.c.RepositoryConfigurationDelegate : Finished Spring Data repository scanning in 15 ms. Found 0 Redis repository interfaces.
17:11:26:587  INFO 30724 --- [main] o.s.cloud.context.scope.GenericScope     : BeanFactory id=ac61872e-faec-371d-922e-ad941e5407d7
17:11:27:302  INFO 30724 --- [main] o.s.b.w.embedded.tomcat.TomcatWebServer  : Tomcat initialized with port(s): 8080 (http)
17:11:27:312  INFO 30724 --- [main] o.apache.catalina.core.StandardService   : Starting service [Tomcat]
17:11:27:312  INFO 30724 --- [main] org.apache.catalina.core.StandardEngine  : Starting Servlet engine: [Apache Tomcat/9.0.75]
17:11:27:482  INFO 30724 --- [main] o.a.c.c.C.[Tomcat].[localhost].[/]       : Initializing Spring embedded WebApplicationContext
17:11:27:482  INFO 30724 --- [main] w.s.c.ServletWebServerApplicationContext : Root WebApplicationContext: initialization completed in 2426 ms
17:11:27:760  INFO 30724 --- [main] org.redisson.Version                     : Redisson 3.17.7
17:11:28:214  INFO 30724 --- [redisson-netty-2-9] o.r.c.pool.MasterPubSubConnectionPool    : 1 connections initialized for 111.230.32.147/111.230.32.147:9631
17:11:28:957  INFO 30724 --- [redisson-netty-2-19] o.r.c.pool.MasterConnectionPool          : 24 connections initialized for 111.230.32.147/111.230.32.147:9631
17:11:29:471 DEBUG 30724 --- [main] c.l.h.filter.RefreshTokenFilter          : Filter 'refreshTokenFilter' configured for use
17:11:30:664  INFO 30724 --- [main] o.s.c.openfeign.FeignClientFactoryBean   : For 'flask-service' URL not provided. Will try picking an instance via load-balancing.
17:11:30:808  INFO 30724 --- [main] o.s.c.openfeign.FeignClientFactoryBean   : For 'ai-service' URL not provided. Will try picking an instance via load-balancing.
17:11:30:876  WARN 30724 --- [main] c.b.m.core.metadata.TableInfoHelper      : Can not find table primary key in Class: "java.lang.Object".
17:11:30:877  WARN 30724 --- [main] c.b.m.core.injector.DefaultSqlInjector   : class java.lang.Object ,Not found @TableId annotation, Cannot use Mybatis-Plus 'xxById' Method.
17:11:32:930  WARN 30724 --- [main] iguration$LoadBalancerCaffeineWarnLogger : Spring Cloud LoadBalancer is currently working with the default cache. While this cache implementation is useful for development and tests, it's recommended to use Caffeine cache in production.You can switch to using Caffeine cache, by adding it and org.springframework.cache.caffeine.CaffeineCacheManager to the classpath.
17:11:32:937  INFO 30724 --- [main] o.s.b.a.e.web.EndpointLinksResolver      : Exposing 1 endpoint(s) beneath base path '/actuator'
17:11:33:031  INFO 30724 --- [main] o.s.b.w.embedded.tomcat.TomcatWebServer  : Tomcat started on port(s): 8080 (http) with context path ''
17:11:33:109  INFO 30724 --- [main] c.a.n.p.a.s.c.ClientAuthPluginManager    : [ClientAuthPluginManager] Load ClientAuthService com.alibaba.nacos.client.auth.impl.NacosClientAuthServiceImpl success.
17:11:33:109  INFO 30724 --- [main] c.a.n.p.a.s.c.ClientAuthPluginManager    : [ClientAuthPluginManager] Load ClientAuthService com.alibaba.nacos.client.auth.ram.RamClientAuthServiceImpl success.
17:11:34:218  INFO 30724 --- [main] c.a.n.c.a.AbstractAbilityControlManager  : Ready to get current node abilities...
17:11:34:220  INFO 30724 --- [main] c.a.n.c.a.AbstractAbilityControlManager  : Ready to initialize current node abilities, support modes: [SDK_CLIENT]
17:11:34:221  INFO 30724 --- [main] c.a.n.c.a.AbstractAbilityControlManager  : Initialize current abilities finish...
17:11:34:222  INFO 30724 --- [main] c.a.n.c.a.d.NacosAbilityManagerHolder    : [AbilityControlManager] Successfully initialize AbilityControlManager
17:11:34:340  INFO 30724 --- [main] c.a.c.n.registry.NacosServiceRegistry    : nacos registry, DEFAULT_GROUP his-service 10.21.93.70:8848 register finished
17:11:34:679  INFO 30724 --- [main] c.l.his_service.HisServiceApplication    : Started HisServiceApplication in 11.03 seconds (JVM running for 12.039)
17:11:35:163  INFO 30724 --- [RMI TCP Connection(3)-10.21.93.70] o.a.c.c.C.[Tomcat].[localhost].[/]       : Initializing Spring DispatcherServlet 'dispatcherServlet'
17:11:35:164  INFO 30724 --- [RMI TCP Connection(3)-10.21.93.70] o.s.web.servlet.DispatcherServlet        : Initializing Servlet 'dispatcherServlet'
17:11:35:168  INFO 30724 --- [RMI TCP Connection(3)-10.21.93.70] o.s.web.servlet.DispatcherServlet        : Completed initialization in 4 ms
17:11:35:169  INFO 30724 --- [RMI TCP Connection(2)-10.21.93.70] com.zaxxer.hikari.HikariDataSource       : HikariPool-1 - Starting...
17:11:35:863  INFO 30724 --- [RMI TCP Connection(2)-10.21.93.70] com.zaxxer.hikari.HikariDataSource       : HikariPool-1 - Start completed.
17:11:39:688 DEBUG 30724 --- [http-nio-8080-exec-2] c.l.h.m.D.selectById                     : ==>  Preparing: SELECT id,patient_id,doctor_id,disease_name,disease_category,aimodel_id,result,create_time,status,id_card,name,score,remark FROM diagnosis_report WHERE id=?
17:11:39:719 DEBUG 30724 --- [http-nio-8080-exec-2] c.l.h.m.D.selectById                     : ==> Parameters: 1(Integer)
17:11:39:796 DEBUG 30724 --- [http-nio-8080-exec-2] c.l.h.m.D.selectById                     : <==      Total: 1
17:11:39:798 DEBUG 30724 --- [http-nio-8080-exec-2] c.l.h.mapper.PatientMapper.selectById    : ==>  Preparing: SELECT id,phone,id_card,name,verified,verified_by,verified_time,open_id,hospital_pid FROM patient WHERE id=?
17:11:39:799 DEBUG 30724 --- [http-nio-8080-exec-2] c.l.h.mapper.PatientMapper.selectById    : ==> Parameters: 1(Integer)
17:11:39:843 DEBUG 30724 --- [http-nio-8080-exec-2] c.l.h.mapper.PatientMapper.selectById    : <==      Total: 1
17:11:39:846 DEBUG 30724 --- [http-nio-8080-exec-2] c.l.h.mapper.DoctorMapper.selectById     : ==>  Preparing: SELECT id,phone,id_card,name,verified,verified_by,verified_time,license,department,hospital_pid FROM doctor WHERE id=?
17:11:39:846 DEBUG 30724 --- [http-nio-8080-exec-2] c.l.h.mapper.DoctorMapper.selectById     : ==> Parameters: 1(Integer)
17:11:39:882 DEBUG 30724 --- [http-nio-8080-exec-2] c.l.h.mapper.DoctorMapper.selectById     : <==      Total: 1
17:11:39:884 DEBUG 30724 --- [http-nio-8080-exec-2] c.l.h.m.E.selectListByDiagnosisId        : ==>  Preparing: select * from eye_images where dignosis_report_id = ?
17:11:39:884 DEBUG 30724 --- [http-nio-8080-exec-2] c.l.h.m.E.selectListByDiagnosisId        : ==> Parameters: 1(Integer)
17:11:39:919 DEBUG 30724 --- [http-nio-8080-exec-2] c.l.h.m.E.selectListByDiagnosisId        : <==      Total: 1
17:11:39:920 DEBUG 30724 --- [http-nio-8080-exec-2] c.l.h.m.T.selectByDiagnosisId            : ==>  Preparing: select * from treatment_plans where diagnosis_id = ?
17:11:39:921 DEBUG 30724 --- [http-nio-8080-exec-2] c.l.h.m.T.selectByDiagnosisId            : ==> Parameters: 1(Integer)
17:11:39:955 DEBUG 30724 --- [http-nio-8080-exec-2] c.l.h.m.T.selectByDiagnosisId            : <==      Total: 1
17:11:39:957 DEBUG 30724 --- [http-nio-8080-exec-2] c.l.h.m.M.selectByDiagnosisId            : ==>  Preparing: select * from medication_recommendations where diagnosis_id = ?
17:11:39:957 DEBUG 30724 --- [http-nio-8080-exec-2] c.l.h.m.M.selectByDiagnosisId            : ==> Parameters: 1(Integer)
17:11:39:990 DEBUG 30724 --- [http-nio-8080-exec-2] c.l.h.m.M.selectByDiagnosisId            : <==      Total: 1
17:11:39:991 DEBUG 30724 --- [http-nio-8080-exec-2] c.l.h.mapper.AiModelMapper.selectById    : ==>  Preparing: SELECT id,version,deploy_time,accuracy FROM ai_model WHERE id=?
17:11:39:992 DEBUG 30724 --- [http-nio-8080-exec-2] c.l.h.mapper.AiModelMapper.selectById    : ==> Parameters: 1(Integer)
17:11:40:029 DEBUG 30724 --- [http-nio-8080-exec-2] c.l.h.mapper.AiModelMapper.selectById    : <==      Total: 1
17:11:41:922 DEBUG 30724 --- [http-nio-8080-exec-2] c.l.api.client.FlaskAiDoctorClient       : [FlaskAiDoctorClient#eye_doctor_chat] ---> POST http://ai-service/api/eye-doctor/chat HTTP/1.1
17:11:41:922 DEBUG 30724 --- [http-nio-8080-exec-2] c.l.api.client.FlaskAiDoctorClient       : [FlaskAiDoctorClient#eye_doctor_chat] Content-Length: 753
17:11:41:922 DEBUG 30724 --- [http-nio-8080-exec-2] c.l.api.client.FlaskAiDoctorClient       : [FlaskAiDoctorClient#eye_doctor_chat] Content-Type: application/json
17:11:41:923 DEBUG 30724 --- [http-nio-8080-exec-2] c.l.api.client.FlaskAiDoctorClient       : [FlaskAiDoctorClient#eye_doctor_chat] 
17:11:41:923 DEBUG 30724 --- [http-nio-8080-exec-2] c.l.api.client.FlaskAiDoctorClient       : [FlaskAiDoctorClient#eye_doctor_chat] {"diagnosis_name":"","diagnosis_category":"","result":"A","remark":"A","treatment_plan":{"id":1,"treatmentType":1,"treatmentDetail":"","startTime":"2025-03-01 09:00:00","endDate":"2025-03-10 09:00:00","doctorId":1,"createdTime":"2025-03-01T09:00:00","updatedTime":"2025-03-01T09:00:00"},"medications":[{"id":1,"diagnosisId":1,"medicationName":"A","dosage":"10mg","frequency":"","sideEffects":"","startTime":"2025-03-01T09:00:00","endTime":"2025-03-10T09:00:00","doctorId":1,"createdTime":"2025-03-01 09:00:00","updatedTime":"2025-03-01 09:00:00"}],"previous_conversations":[{"role":"pariatur tempor do","content":"sit cupidatat commodo"}],"question":"irure eu esse","stream":false}
17:11:41:924 DEBUG 30724 --- [http-nio-8080-exec-2] c.l.api.client.FlaskAiDoctorClient       : [FlaskAiDoctorClient#eye_doctor_chat] ---> END HTTP (753-byte body)
17:11:44:132 DEBUG 30724 --- [http-nio-8080-exec-2] c.l.api.client.FlaskAiDoctorClient       : [FlaskAiDoctorClient#eye_doctor_chat] <--- ERROR ConnectException: Connection refused: getsockopt (2208ms)
17:11:44:134 DEBUG 30724 --- [http-nio-8080-exec-2] c.l.api.client.FlaskAiDoctorClient       : [FlaskAiDoctorClient#eye_doctor_chat] java.net.ConnectException: Connection refused: getsockopt
	at java.base/sun.nio.ch.Net.pollConnect(Native Method)
	at java.base/sun.nio.ch.Net.pollConnectNow(Net.java:672)
	at java.base/sun.nio.ch.NioSocketImpl.timedFinishConnect(NioSocketImpl.java:554)
	at java.base/sun.nio.ch.NioSocketImpl.connect(NioSocketImpl.java:602)
	at java.base/java.net.Socket.connect(Socket.java:633)
	at java.base/sun.net.NetworkClient.doConnect(NetworkClient.java:178)
	at java.base/sun.net.www.http.HttpClient.openServer(HttpClient.java:533)
	at java.base/sun.net.www.http.HttpClient.openServer(HttpClient.java:638)
	at java.base/sun.net.www.http.HttpClient.<init>(HttpClient.java:281)
	at java.base/sun.net.www.http.HttpClient.New(HttpClient.java:386)
	at java.base/sun.net.www.http.HttpClient.New(HttpClient.java:408)
	at java.base/sun.net.www.protocol.http.HttpURLConnection.getNewHttpClient(HttpURLConnection.java:1309)
	at java.base/sun.net.www.protocol.http.HttpURLConnection.plainConnect0(HttpURLConnection.java:1242)
	at java.base/sun.net.www.protocol.http.HttpURLConnection.plainConnect(HttpURLConnection.java:1128)
	at java.base/sun.net.www.protocol.http.HttpURLConnection.connect(HttpURLConnection.java:1057)
	at java.base/sun.net.www.protocol.http.HttpURLConnection.getOutputStream0(HttpURLConnection.java:1451)
	at java.base/sun.net.www.protocol.http.HttpURLConnection.getOutputStream(HttpURLConnection.java:1422)
	at feign.Client$Default.convertAndSend(Client.java:208)
	at feign.Client$Default.execute(Client.java:105)
	at org.springframework.cloud.openfeign.loadbalancer.LoadBalancerUtils.executeWithLoadBalancerLifecycleProcessing(LoadBalancerUtils.java:57)
	at org.springframework.cloud.openfeign.loadbalancer.LoadBalancerUtils.executeWithLoadBalancerLifecycleProcessing(LoadBalancerUtils.java:95)
	at org.springframework.cloud.openfeign.loadbalancer.FeignBlockingLoadBalancerClient.execute(FeignBlockingLoadBalancerClient.java:114)
	at feign.SynchronousMethodHandler.executeAndDecode(SynchronousMethodHandler.java:121)
	at feign.SynchronousMethodHandler.invoke(SynchronousMethodHandler.java:91)
	at feign.ReflectiveFeign$FeignInvocationHandler.invoke(ReflectiveFeign.java:100)
	at jdk.proxy2/jdk.proxy2.$Proxy135.eye_doctor_chat(Unknown Source)
	at com.luojiawei.his_service.controller.ChatController.ask(ChatController.java:39)
	at java.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at java.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:77)
	at java.base/jdk.internal.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.base/java.lang.reflect.Method.invoke(Method.java:568)
	at org.springframework.web.method.support.InvocableHandlerMethod.doInvoke(InvocableHandlerMethod.java:205)
	at org.springframework.web.method.support.InvocableHandlerMethod.invokeForRequest(InvocableHandlerMethod.java:150)
	at org.springframework.web.servlet.mvc.method.annotation.ServletInvocableHandlerMethod.invokeAndHandle(ServletInvocableHandlerMethod.java:117)
	at org.springframework.web.servlet.mvc.method.annotation.RequestMappingHandlerAdapter.invokeHandlerMethod(RequestMappingHandlerAdapter.java:895)
	at org.springframework.web.servlet.mvc.method.annotation.RequestMappingHandlerAdapter.handleInternal(RequestMappingHandlerAdapter.java:808)
	at org.springframework.web.servlet.mvc.method.AbstractHandlerMethodAdapter.handle(AbstractHandlerMethodAdapter.java:87)
	at org.springframework.web.servlet.DispatcherServlet.doDispatch(DispatcherServlet.java:1072)
	at org.springframework.web.servlet.DispatcherServlet.doService(DispatcherServlet.java:965)
	at org.springframework.web.servlet.FrameworkServlet.processRequest(FrameworkServlet.java:1006)
	at org.springframework.web.servlet.FrameworkServlet.doPost(FrameworkServlet.java:909)
	at javax.servlet.http.HttpServlet.service(HttpServlet.java:555)
	at org.springframework.web.servlet.FrameworkServlet.service(FrameworkServlet.java:883)
	at javax.servlet.http.HttpServlet.service(HttpServlet.java:623)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:209)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:153)
	at com.luojiawei.his_service.filter.RefreshTokenFilter.doFilterInternal(RefreshTokenFilter.java:58)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:117)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:178)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:153)
	at org.springframework.web.filter.RequestContextFilter.doFilterInternal(RequestContextFilter.java:100)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:117)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:178)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:153)
	at org.springframework.web.filter.FormContentFilter.doFilterInternal(FormContentFilter.java:93)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:117)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:178)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:153)
	at org.springframework.boot.actuate.metrics.web.servlet.WebMvcMetricsFilter.doFilterInternal(WebMvcMetricsFilter.java:96)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:117)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:178)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:153)
	at org.springframework.web.filter.CharacterEncodingFilter.doFilterInternal(CharacterEncodingFilter.java:201)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:117)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:178)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:153)
	at org.apache.catalina.core.StandardWrapperValve.invoke(StandardWrapperValve.java:167)
	at org.apache.catalina.core.StandardContextValve.invoke(StandardContextValve.java:90)
	at org.apache.catalina.authenticator.AuthenticatorBase.invoke(AuthenticatorBase.java:481)
	at org.apache.catalina.core.StandardHostValve.invoke(StandardHostValve.java:130)
	at org.apache.catalina.valves.ErrorReportValve.invoke(ErrorReportValve.java:93)
	at org.apache.catalina.core.StandardEngineValve.invoke(StandardEngineValve.java:74)
	at org.apache.catalina.connector.CoyoteAdapter.service(CoyoteAdapter.java:343)
	at org.apache.coyote.http11.Http11Processor.service(Http11Processor.java:390)
	at org.apache.coyote.AbstractProcessorLight.process(AbstractProcessorLight.java:63)
	at org.apache.coyote.AbstractProtocol$ConnectionHandler.process(AbstractProtocol.java:926)
	at org.apache.tomcat.util.net.NioEndpoint$SocketProcessor.doRun(NioEndpoint.java:1791)
	at org.apache.tomcat.util.net.SocketProcessorBase.run(SocketProcessorBase.java:52)
	at org.apache.tomcat.util.threads.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1191)
	at org.apache.tomcat.util.threads.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:659)
	at org.apache.tomcat.util.threads.TaskThread$WrappingRunnable.run(TaskThread.java:61)
	at java.base/java.lang.Thread.run(Thread.java:840)

17:11:44:134 DEBUG 30724 --- [http-nio-8080-exec-2] c.l.api.client.FlaskAiDoctorClient       : [FlaskAiDoctorClient#eye_doctor_chat] <--- END ERROR
17:11:44:151 ERROR 30724 --- [http-nio-8080-exec-2] o.a.c.c.C.[.[.[/].[dispatcherServlet]    : Servlet.service() for servlet [dispatcherServlet] in context with path [] threw exception [Request processing failed; nested exception is feign.RetryableException: Connection refused: getsockopt executing POST http://ai-service/api/eye-doctor/chat] with root cause

java.net.ConnectException: Connection refused: getsockopt
	at java.base/sun.nio.ch.Net.pollConnect(Native Method) ~[na:na]
	at java.base/sun.nio.ch.Net.pollConnectNow(Net.java:672) ~[na:na]
	at java.base/sun.nio.ch.NioSocketImpl.timedFinishConnect(NioSocketImpl.java:554) ~[na:na]
	at java.base/sun.nio.ch.NioSocketImpl.connect(NioSocketImpl.java:602) ~[na:na]
	at java.base/java.net.Socket.connect(Socket.java:633) ~[na:na]
	at java.base/sun.net.NetworkClient.doConnect(NetworkClient.java:178) ~[na:na]
	at java.base/sun.net.www.http.HttpClient.openServer(HttpClient.java:533) ~[na:na]
	at java.base/sun.net.www.http.HttpClient.openServer(HttpClient.java:638) ~[na:na]
	at java.base/sun.net.www.http.HttpClient.<init>(HttpClient.java:281) ~[na:na]
	at java.base/sun.net.www.http.HttpClient.New(HttpClient.java:386) ~[na:na]
	at java.base/sun.net.www.http.HttpClient.New(HttpClient.java:408) ~[na:na]
	at java.base/sun.net.www.protocol.http.HttpURLConnection.getNewHttpClient(HttpURLConnection.java:1309) ~[na:na]
	at java.base/sun.net.www.protocol.http.HttpURLConnection.plainConnect0(HttpURLConnection.java:1242) ~[na:na]
	at java.base/sun.net.www.protocol.http.HttpURLConnection.plainConnect(HttpURLConnection.java:1128) ~[na:na]
	at java.base/sun.net.www.protocol.http.HttpURLConnection.connect(HttpURLConnection.java:1057) ~[na:na]
	at java.base/sun.net.www.protocol.http.HttpURLConnection.getOutputStream0(HttpURLConnection.java:1451) ~[na:na]
	at java.base/sun.net.www.protocol.http.HttpURLConnection.getOutputStream(HttpURLConnection.java:1422) ~[na:na]
	at feign.Client$Default.convertAndSend(Client.java:208) ~[feign-core-11.10.jar:na]
	at feign.Client$Default.execute(Client.java:105) ~[feign-core-11.10.jar:na]
	at org.springframework.cloud.openfeign.loadbalancer.LoadBalancerUtils.executeWithLoadBalancerLifecycleProcessing(LoadBalancerUtils.java:57) ~[spring-cloud-openfeign-core-3.1.5.jar:3.1.5]
	at org.springframework.cloud.openfeign.loadbalancer.LoadBalancerUtils.executeWithLoadBalancerLifecycleProcessing(LoadBalancerUtils.java:95) ~[spring-cloud-openfeign-core-3.1.5.jar:3.1.5]
	at org.springframework.cloud.openfeign.loadbalancer.FeignBlockingLoadBalancerClient.execute(FeignBlockingLoadBalancerClient.java:114) ~[spring-cloud-openfeign-core-3.1.5.jar:3.1.5]
	at feign.SynchronousMethodHandler.executeAndDecode(SynchronousMethodHandler.java:121) ~[feign-core-11.10.jar:na]
	at feign.SynchronousMethodHandler.invoke(SynchronousMethodHandler.java:91) ~[feign-core-11.10.jar:na]
	at feign.ReflectiveFeign$FeignInvocationHandler.invoke(ReflectiveFeign.java:100) ~[feign-core-11.10.jar:na]
	at jdk.proxy2/jdk.proxy2.$Proxy135.eye_doctor_chat(Unknown Source) ~[na:na]
	at com.luojiawei.his_service.controller.ChatController.ask(ChatController.java:39) ~[classes/:na]
	at java.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke0(Native Method) ~[na:na]
	at java.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:77) ~[na:na]
	at java.base/jdk.internal.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43) ~[na:na]
	at java.base/java.lang.reflect.Method.invoke(Method.java:568) ~[na:na]
	at org.springframework.web.method.support.InvocableHandlerMethod.doInvoke(InvocableHandlerMethod.java:205) ~[spring-web-5.3.27.jar:5.3.27]
	at org.springframework.web.method.support.InvocableHandlerMethod.invokeForRequest(InvocableHandlerMethod.java:150) ~[spring-web-5.3.27.jar:5.3.27]
	at org.springframework.web.servlet.mvc.method.annotation.ServletInvocableHandlerMethod.invokeAndHandle(ServletInvocableHandlerMethod.java:117) ~[spring-webmvc-5.3.27.jar:5.3.27]
	at org.springframework.web.servlet.mvc.method.annotation.RequestMappingHandlerAdapter.invokeHandlerMethod(RequestMappingHandlerAdapter.java:895) ~[spring-webmvc-5.3.27.jar:5.3.27]
	at org.springframework.web.servlet.mvc.method.annotation.RequestMappingHandlerAdapter.handleInternal(RequestMappingHandlerAdapter.java:808) ~[spring-webmvc-5.3.27.jar:5.3.27]
	at org.springframework.web.servlet.mvc.method.AbstractHandlerMethodAdapter.handle(AbstractHandlerMethodAdapter.java:87) ~[spring-webmvc-5.3.27.jar:5.3.27]
	at org.springframework.web.servlet.DispatcherServlet.doDispatch(DispatcherServlet.java:1072) ~[spring-webmvc-5.3.27.jar:5.3.27]
	at org.springframework.web.servlet.DispatcherServlet.doService(DispatcherServlet.java:965) ~[spring-webmvc-5.3.27.jar:5.3.27]
	at org.springframework.web.servlet.FrameworkServlet.processRequest(FrameworkServlet.java:1006) ~[spring-webmvc-5.3.27.jar:5.3.27]
	at org.springframework.web.servlet.FrameworkServlet.doPost(FrameworkServlet.java:909) ~[spring-webmvc-5.3.27.jar:5.3.27]
	at javax.servlet.http.HttpServlet.service(HttpServlet.java:555) ~[tomcat-embed-core-9.0.75.jar:4.0.FR]
	at org.springframework.web.servlet.FrameworkServlet.service(FrameworkServlet.java:883) ~[spring-webmvc-5.3.27.jar:5.3.27]
	at javax.servlet.http.HttpServlet.service(HttpServlet.java:623) ~[tomcat-embed-core-9.0.75.jar:4.0.FR]
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:209) ~[tomcat-embed-core-9.0.75.jar:9.0.75]
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:153) ~[tomcat-embed-core-9.0.75.jar:9.0.75]
	at com.luojiawei.his_service.filter.RefreshTokenFilter.doFilterInternal(RefreshTokenFilter.java:58) ~[classes/:na]
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:117) ~[spring-web-5.3.27.jar:5.3.27]
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:178) ~[tomcat-embed-core-9.0.75.jar:9.0.75]
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:153) ~[tomcat-embed-core-9.0.75.jar:9.0.75]
	at org.springframework.web.filter.RequestContextFilter.doFilterInternal(RequestContextFilter.java:100) ~[spring-web-5.3.27.jar:5.3.27]
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:117) ~[spring-web-5.3.27.jar:5.3.27]
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:178) ~[tomcat-embed-core-9.0.75.jar:9.0.75]
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:153) ~[tomcat-embed-core-9.0.75.jar:9.0.75]
	at org.springframework.web.filter.FormContentFilter.doFilterInternal(FormContentFilter.java:93) ~[spring-web-5.3.27.jar:5.3.27]
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:117) ~[spring-web-5.3.27.jar:5.3.27]
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:178) ~[tomcat-embed-core-9.0.75.jar:9.0.75]
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:153) ~[tomcat-embed-core-9.0.75.jar:9.0.75]
	at org.springframework.boot.actuate.metrics.web.servlet.WebMvcMetricsFilter.doFilterInternal(WebMvcMetricsFilter.java:96) ~[spring-boot-actuator-2.7.12.jar:2.7.12]
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:117) ~[spring-web-5.3.27.jar:5.3.27]
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:178) ~[tomcat-embed-core-9.0.75.jar:9.0.75]
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:153) ~[tomcat-embed-core-9.0.75.jar:9.0.75]
	at org.springframework.web.filter.CharacterEncodingFilter.doFilterInternal(CharacterEncodingFilter.java:201) ~[spring-web-5.3.27.jar:5.3.27]
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:117) ~[spring-web-5.3.27.jar:5.3.27]
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:178) ~[tomcat-embed-core-9.0.75.jar:9.0.75]
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:153) ~[tomcat-embed-core-9.0.75.jar:9.0.75]
	at org.apache.catalina.core.StandardWrapperValve.invoke(StandardWrapperValve.java:167) ~[tomcat-embed-core-9.0.75.jar:9.0.75]
	at org.apache.catalina.core.StandardContextValve.invoke(StandardContextValve.java:90) ~[tomcat-embed-core-9.0.75.jar:9.0.75]
	at org.apache.catalina.authenticator.AuthenticatorBase.invoke(AuthenticatorBase.java:481) ~[tomcat-embed-core-9.0.75.jar:9.0.75]
	at org.apache.catalina.core.StandardHostValve.invoke(StandardHostValve.java:130) ~[tomcat-embed-core-9.0.75.jar:9.0.75]
	at org.apache.catalina.valves.ErrorReportValve.invoke(ErrorReportValve.java:93) ~[tomcat-embed-core-9.0.75.jar:9.0.75]
	at org.apache.catalina.core.StandardEngineValve.invoke(StandardEngineValve.java:74) ~[tomcat-embed-core-9.0.75.jar:9.0.75]
	at org.apache.catalina.connector.CoyoteAdapter.service(CoyoteAdapter.java:343) ~[tomcat-embed-core-9.0.75.jar:9.0.75]
	at org.apache.coyote.http11.Http11Processor.service(Http11Processor.java:390) ~[tomcat-embed-core-9.0.75.jar:9.0.75]
	at org.apache.coyote.AbstractProcessorLight.process(AbstractProcessorLight.java:63) ~[tomcat-embed-core-9.0.75.jar:9.0.75]
	at org.apache.coyote.AbstractProtocol$ConnectionHandler.process(AbstractProtocol.java:926) ~[tomcat-embed-core-9.0.75.jar:9.0.75]
	at org.apache.tomcat.util.net.NioEndpoint$SocketProcessor.doRun(NioEndpoint.java:1791) ~[tomcat-embed-core-9.0.75.jar:9.0.75]
	at org.apache.tomcat.util.net.SocketProcessorBase.run(SocketProcessorBase.java:52) ~[tomcat-embed-core-9.0.75.jar:9.0.75]
	at org.apache.tomcat.util.threads.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1191) ~[tomcat-embed-core-9.0.75.jar:9.0.75]
	at org.apache.tomcat.util.threads.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:659) ~[tomcat-embed-core-9.0.75.jar:9.0.75]
	at org.apache.tomcat.util.threads.TaskThread$WrappingRunnable.run(TaskThread.java:61) ~[tomcat-embed-core-9.0.75.jar:9.0.75]
	at java.base/java.lang.Thread.run(Thread.java:840) ~[na:na]

17:16:07:328  WARN 30724 --- [Thread-18] c.a.n.common.http.HttpClientBeanHolder   : [HttpClientBeanHolder] Start destroying common HttpClient
17:16:07:331  WARN 30724 --- [Thread-15] c.a.nacos.common.notify.NotifyCenter     : [NotifyCenter] Start destroying Publisher
17:16:07:336  WARN 30724 --- [Thread-15] c.a.nacos.common.notify.NotifyCenter     : [NotifyCenter] Destruction of the end
17:16:07:341  WARN 30724 --- [Thread-18] c.a.n.common.http.HttpClientBeanHolder   : [HttpClientBeanHolder] Destruction of the end
17:16:07:488  INFO 30724 --- [SpringApplicationShutdownHook] c.a.c.n.registry.NacosServiceRegistry    : De-registering from Nacos Server now...
17:16:07:524  INFO 30724 --- [SpringApplicationShutdownHook] c.a.c.n.registry.NacosServiceRegistry    : De-registration finished.
17:16:07:574  INFO 30724 --- [SpringApplicationShutdownHook] com.zaxxer.hikari.HikariDataSource       : HikariPool-1 - Shutdown initiated...
17:16:07:933  INFO 30724 --- [SpringApplicationShutdownHook] com.zaxxer.hikari.HikariDataSource       : HikariPool-1 - Shutdown completed.
17:16:13:222  INFO 22164 --- [main] c.l.his_service.HisServiceApplication    : Starting HisServiceApplication using Java 17.0.11 on luo with PID 22164 (A:\Desktop\workspace\HIS\his_service\target\classes started by 22407 in A:\Desktop\workspace\HIS)
17:16:13:223 DEBUG 22164 --- [main] c.l.his_service.HisServiceApplication    : Running with Spring Boot v2.7.12, Spring v5.3.27
17:16:13:223  INFO 22164 --- [main] c.l.his_service.HisServiceApplication    : The following 1 profile is active: "dev"
17:16:14:527  INFO 22164 --- [main] .s.d.r.c.RepositoryConfigurationDelegate : Multiple Spring Data modules found, entering strict repository configuration mode
17:16:14:531  INFO 22164 --- [main] .s.d.r.c.RepositoryConfigurationDelegate : Bootstrapping Spring Data Redis repositories in DEFAULT mode.
17:16:14:559  INFO 22164 --- [main] .s.d.r.c.RepositoryConfigurationDelegate : Finished Spring Data repository scanning in 14 ms. Found 0 Redis repository interfaces.
17:16:14:878  INFO 22164 --- [main] o.s.cloud.context.scope.GenericScope     : BeanFactory id=ac61872e-faec-371d-922e-ad941e5407d7
17:16:16:460  INFO 22164 --- [main] o.s.b.w.embedded.tomcat.TomcatWebServer  : Tomcat initialized with port(s): 8080 (http)
17:16:16:486  INFO 22164 --- [main] o.apache.catalina.core.StandardService   : Starting service [Tomcat]
17:16:16:487  INFO 22164 --- [main] org.apache.catalina.core.StandardEngine  : Starting Servlet engine: [Apache Tomcat/9.0.75]
17:16:16:729  INFO 22164 --- [main] o.a.c.c.C.[Tomcat].[localhost].[/]       : Initializing Spring embedded WebApplicationContext
17:16:16:729  INFO 22164 --- [main] w.s.c.ServletWebServerApplicationContext : Root WebApplicationContext: initialization completed in 3446 ms
17:16:16:990  INFO 22164 --- [main] org.redisson.Version                     : Redisson 3.17.7
17:16:17:414  INFO 22164 --- [redisson-netty-2-9] o.r.c.pool.MasterPubSubConnectionPool    : 1 connections initialized for 111.230.32.147/111.230.32.147:9631
17:16:18:111  INFO 22164 --- [redisson-netty-2-19] o.r.c.pool.MasterConnectionPool          : 24 connections initialized for 111.230.32.147/111.230.32.147:9631
17:16:18:493 DEBUG 22164 --- [main] c.l.h.filter.RefreshTokenFilter          : Filter 'refreshTokenFilter' configured for use
17:16:19:451  INFO 22164 --- [main] o.s.c.openfeign.FeignClientFactoryBean   : For 'flask-service' URL not provided. Will try picking an instance via load-balancing.
17:16:19:626  INFO 22164 --- [main] o.s.c.openfeign.FeignClientFactoryBean   : For 'ai-service' URL not provided. Will try picking an instance via load-balancing.
17:16:19:704  WARN 22164 --- [main] c.b.m.core.metadata.TableInfoHelper      : Can not find table primary key in Class: "java.lang.Object".
17:16:19:704  WARN 22164 --- [main] c.b.m.core.injector.DefaultSqlInjector   : class java.lang.Object ,Not found @TableId annotation, Cannot use Mybatis-Plus 'xxById' Method.
17:16:21:582  WARN 22164 --- [main] iguration$LoadBalancerCaffeineWarnLogger : Spring Cloud LoadBalancer is currently working with the default cache. While this cache implementation is useful for development and tests, it's recommended to use Caffeine cache in production.You can switch to using Caffeine cache, by adding it and org.springframework.cache.caffeine.CaffeineCacheManager to the classpath.
17:16:21:588  INFO 22164 --- [main] o.s.b.a.e.web.EndpointLinksResolver      : Exposing 1 endpoint(s) beneath base path '/actuator'
17:16:21:700  INFO 22164 --- [main] o.s.b.w.embedded.tomcat.TomcatWebServer  : Tomcat started on port(s): 8080 (http) with context path ''
17:16:21:748  INFO 22164 --- [main] c.a.n.p.a.s.c.ClientAuthPluginManager    : [ClientAuthPluginManager] Load ClientAuthService com.alibaba.nacos.client.auth.impl.NacosClientAuthServiceImpl success.
17:16:21:749  INFO 22164 --- [main] c.a.n.p.a.s.c.ClientAuthPluginManager    : [ClientAuthPluginManager] Load ClientAuthService com.alibaba.nacos.client.auth.ram.RamClientAuthServiceImpl success.
17:16:26:052  INFO 22164 --- [main] c.a.n.c.a.AbstractAbilityControlManager  : Ready to get current node abilities...
17:16:26:055  INFO 22164 --- [main] c.a.n.c.a.AbstractAbilityControlManager  : Ready to initialize current node abilities, support modes: [SDK_CLIENT]
17:16:26:056  INFO 22164 --- [main] c.a.n.c.a.AbstractAbilityControlManager  : Initialize current abilities finish...
17:16:26:056  INFO 22164 --- [main] c.a.n.c.a.d.NacosAbilityManagerHolder    : [AbilityControlManager] Successfully initialize AbilityControlManager
17:16:29:238  INFO 22164 --- [main] c.a.c.n.registry.NacosServiceRegistry    : nacos registry, DEFAULT_GROUP his-service 10.21.93.70:8848 register finished
17:16:29:507  INFO 22164 --- [main] c.l.his_service.HisServiceApplication    : Started HisServiceApplication in 17.368 seconds (JVM running for 19.001)
17:22:11:595  INFO 22164 --- [http-nio-8080-exec-2] o.a.c.c.C.[Tomcat].[localhost].[/]       : Initializing Spring DispatcherServlet 'dispatcherServlet'
17:22:11:595  INFO 22164 --- [http-nio-8080-exec-2] o.s.web.servlet.DispatcherServlet        : Initializing Servlet 'dispatcherServlet'
17:22:11:598  INFO 22164 --- [http-nio-8080-exec-2] o.s.web.servlet.DispatcherServlet        : Completed initialization in 2 ms
17:22:13:935 DEBUG 22164 --- [http-nio-8080-exec-2] c.l.api.client.FlaskModelAnalyzeClient   : [FlaskModelAnalyzeClient#uploadFile] ---> POST http://flask-service/upload HTTP/1.1
17:22:13:936 DEBUG 22164 --- [http-nio-8080-exec-2] c.l.api.client.FlaskModelAnalyzeClient   : [FlaskModelAnalyzeClient#uploadFile] Content-Length: 67886
17:22:13:936 DEBUG 22164 --- [http-nio-8080-exec-2] c.l.api.client.FlaskModelAnalyzeClient   : [FlaskModelAnalyzeClient#uploadFile] Content-Type: multipart/form-data; charset=UTF-8; boundary=1958ecfbd25
17:22:13:936 DEBUG 22164 --- [http-nio-8080-exec-2] c.l.api.client.FlaskModelAnalyzeClient   : [FlaskModelAnalyzeClient#uploadFile] X-API-Key: 123456
17:22:13:936 DEBUG 22164 --- [http-nio-8080-exec-2] c.l.api.client.FlaskModelAnalyzeClient   : [FlaskModelAnalyzeClient#uploadFile] 
17:22:13:936 DEBUG 22164 --- [http-nio-8080-exec-2] c.l.api.client.FlaskModelAnalyzeClient   : [FlaskModelAnalyzeClient#uploadFile] Binary data
17:22:13:936 DEBUG 22164 --- [http-nio-8080-exec-2] c.l.api.client.FlaskModelAnalyzeClient   : [FlaskModelAnalyzeClient#uploadFile] ---> END HTTP (67886-byte body)
17:22:17:569 DEBUG 22164 --- [http-nio-8080-exec-2] c.l.api.client.FlaskModelAnalyzeClient   : [FlaskModelAnalyzeClient#uploadFile] <--- ERROR ConnectException: Connection refused: getsockopt (3632ms)
17:22:17:571 DEBUG 22164 --- [http-nio-8080-exec-2] c.l.api.client.FlaskModelAnalyzeClient   : [FlaskModelAnalyzeClient#uploadFile] java.net.ConnectException: Connection refused: getsockopt
	at java.base/sun.nio.ch.Net.pollConnect(Native Method)
	at java.base/sun.nio.ch.Net.pollConnectNow(Net.java:672)
	at java.base/sun.nio.ch.NioSocketImpl.timedFinishConnect(NioSocketImpl.java:554)
	at java.base/sun.nio.ch.NioSocketImpl.connect(NioSocketImpl.java:602)
	at java.base/java.net.Socket.connect(Socket.java:633)
	at java.base/sun.net.NetworkClient.doConnect(NetworkClient.java:178)
	at java.base/sun.net.www.http.HttpClient.openServer(HttpClient.java:533)
	at java.base/sun.net.www.http.HttpClient.openServer(HttpClient.java:638)
	at java.base/sun.net.www.http.HttpClient.<init>(HttpClient.java:281)
	at java.base/sun.net.www.http.HttpClient.New(HttpClient.java:386)
	at java.base/sun.net.www.http.HttpClient.New(HttpClient.java:408)
	at java.base/sun.net.www.protocol.http.HttpURLConnection.getNewHttpClient(HttpURLConnection.java:1309)
	at java.base/sun.net.www.protocol.http.HttpURLConnection.plainConnect0(HttpURLConnection.java:1242)
	at java.base/sun.net.www.protocol.http.HttpURLConnection.plainConnect(HttpURLConnection.java:1128)
	at java.base/sun.net.www.protocol.http.HttpURLConnection.connect(HttpURLConnection.java:1057)
	at java.base/sun.net.www.protocol.http.HttpURLConnection.getOutputStream0(HttpURLConnection.java:1451)
	at java.base/sun.net.www.protocol.http.HttpURLConnection.getOutputStream(HttpURLConnection.java:1422)
	at feign.Client$Default.convertAndSend(Client.java:208)
	at feign.Client$Default.execute(Client.java:105)
	at org.springframework.cloud.openfeign.loadbalancer.LoadBalancerUtils.executeWithLoadBalancerLifecycleProcessing(LoadBalancerUtils.java:57)
	at org.springframework.cloud.openfeign.loadbalancer.LoadBalancerUtils.executeWithLoadBalancerLifecycleProcessing(LoadBalancerUtils.java:95)
	at org.springframework.cloud.openfeign.loadbalancer.FeignBlockingLoadBalancerClient.execute(FeignBlockingLoadBalancerClient.java:114)
	at feign.SynchronousMethodHandler.executeAndDecode(SynchronousMethodHandler.java:121)
	at feign.SynchronousMethodHandler.invoke(SynchronousMethodHandler.java:91)
	at feign.ReflectiveFeign$FeignInvocationHandler.invoke(ReflectiveFeign.java:100)
	at jdk.proxy2/jdk.proxy2.$Proxy125.uploadFile(Unknown Source)
	at com.luojiawei.his_service.service.impl.UploadServiceImpl.handleFileUpload(UploadServiceImpl.java:43)
	at com.luojiawei.his_service.controller.AiModelController.testFileUpload(AiModelController.java:40)
	at java.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at java.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:77)
	at java.base/jdk.internal.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.base/java.lang.reflect.Method.invoke(Method.java:568)
	at org.springframework.web.method.support.InvocableHandlerMethod.doInvoke(InvocableHandlerMethod.java:205)
	at org.springframework.web.method.support.InvocableHandlerMethod.invokeForRequest(InvocableHandlerMethod.java:150)
	at org.springframework.web.servlet.mvc.method.annotation.ServletInvocableHandlerMethod.invokeAndHandle(ServletInvocableHandlerMethod.java:117)
	at org.springframework.web.servlet.mvc.method.annotation.RequestMappingHandlerAdapter.invokeHandlerMethod(RequestMappingHandlerAdapter.java:895)
	at org.springframework.web.servlet.mvc.method.annotation.RequestMappingHandlerAdapter.handleInternal(RequestMappingHandlerAdapter.java:808)
	at org.springframework.web.servlet.mvc.method.AbstractHandlerMethodAdapter.handle(AbstractHandlerMethodAdapter.java:87)
	at org.springframework.web.servlet.DispatcherServlet.doDispatch(DispatcherServlet.java:1072)
	at org.springframework.web.servlet.DispatcherServlet.doService(DispatcherServlet.java:965)
	at org.springframework.web.servlet.FrameworkServlet.processRequest(FrameworkServlet.java:1006)
	at org.springframework.web.servlet.FrameworkServlet.doPost(FrameworkServlet.java:909)
	at javax.servlet.http.HttpServlet.service(HttpServlet.java:555)
	at org.springframework.web.servlet.FrameworkServlet.service(FrameworkServlet.java:883)
	at javax.servlet.http.HttpServlet.service(HttpServlet.java:623)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:209)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:153)
	at com.luojiawei.his_service.filter.RefreshTokenFilter.doFilterInternal(RefreshTokenFilter.java:58)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:117)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:178)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:153)
	at org.springframework.web.filter.RequestContextFilter.doFilterInternal(RequestContextFilter.java:100)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:117)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:178)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:153)
	at org.springframework.web.filter.FormContentFilter.doFilterInternal(FormContentFilter.java:93)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:117)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:178)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:153)
	at org.springframework.boot.actuate.metrics.web.servlet.WebMvcMetricsFilter.doFilterInternal(WebMvcMetricsFilter.java:96)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:117)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:178)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:153)
	at org.springframework.web.filter.CharacterEncodingFilter.doFilterInternal(CharacterEncodingFilter.java:201)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:117)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:178)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:153)
	at org.apache.catalina.core.StandardWrapperValve.invoke(StandardWrapperValve.java:167)
	at org.apache.catalina.core.StandardContextValve.invoke(StandardContextValve.java:90)
	at org.apache.catalina.authenticator.AuthenticatorBase.invoke(AuthenticatorBase.java:481)
	at org.apache.catalina.core.StandardHostValve.invoke(StandardHostValve.java:130)
	at org.apache.catalina.valves.ErrorReportValve.invoke(ErrorReportValve.java:93)
	at org.apache.catalina.core.StandardEngineValve.invoke(StandardEngineValve.java:74)
	at org.apache.catalina.connector.CoyoteAdapter.service(CoyoteAdapter.java:343)
	at org.apache.coyote.http11.Http11Processor.service(Http11Processor.java:390)
	at org.apache.coyote.AbstractProcessorLight.process(AbstractProcessorLight.java:63)
	at org.apache.coyote.AbstractProtocol$ConnectionHandler.process(AbstractProtocol.java:926)
	at org.apache.tomcat.util.net.NioEndpoint$SocketProcessor.doRun(NioEndpoint.java:1791)
	at org.apache.tomcat.util.net.SocketProcessorBase.run(SocketProcessorBase.java:52)
	at org.apache.tomcat.util.threads.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1191)
	at org.apache.tomcat.util.threads.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:659)
	at org.apache.tomcat.util.threads.TaskThread$WrappingRunnable.run(TaskThread.java:61)
	at java.base/java.lang.Thread.run(Thread.java:840)

17:22:17:571 DEBUG 22164 --- [http-nio-8080-exec-2] c.l.api.client.FlaskModelAnalyzeClient   : [FlaskModelAnalyzeClient#uploadFile] <--- END ERROR
17:22:17:602 ERROR 22164 --- [http-nio-8080-exec-2] o.a.c.c.C.[.[.[/].[dispatcherServlet]    : Servlet.service() for servlet [dispatcherServlet] in context with path [] threw exception [Request processing failed; nested exception is java.lang.RuntimeException: ] with root cause

java.net.ConnectException: Connection refused: getsockopt
	at java.base/sun.nio.ch.Net.pollConnect(Native Method) ~[na:na]
	at java.base/sun.nio.ch.Net.pollConnectNow(Net.java:672) ~[na:na]
	at java.base/sun.nio.ch.NioSocketImpl.timedFinishConnect(NioSocketImpl.java:554) ~[na:na]
	at java.base/sun.nio.ch.NioSocketImpl.connect(NioSocketImpl.java:602) ~[na:na]
	at java.base/java.net.Socket.connect(Socket.java:633) ~[na:na]
	at java.base/sun.net.NetworkClient.doConnect(NetworkClient.java:178) ~[na:na]
	at java.base/sun.net.www.http.HttpClient.openServer(HttpClient.java:533) ~[na:na]
	at java.base/sun.net.www.http.HttpClient.openServer(HttpClient.java:638) ~[na:na]
	at java.base/sun.net.www.http.HttpClient.<init>(HttpClient.java:281) ~[na:na]
	at java.base/sun.net.www.http.HttpClient.New(HttpClient.java:386) ~[na:na]
	at java.base/sun.net.www.http.HttpClient.New(HttpClient.java:408) ~[na:na]
	at java.base/sun.net.www.protocol.http.HttpURLConnection.getNewHttpClient(HttpURLConnection.java:1309) ~[na:na]
	at java.base/sun.net.www.protocol.http.HttpURLConnection.plainConnect0(HttpURLConnection.java:1242) ~[na:na]
	at java.base/sun.net.www.protocol.http.HttpURLConnection.plainConnect(HttpURLConnection.java:1128) ~[na:na]
	at java.base/sun.net.www.protocol.http.HttpURLConnection.connect(HttpURLConnection.java:1057) ~[na:na]
	at java.base/sun.net.www.protocol.http.HttpURLConnection.getOutputStream0(HttpURLConnection.java:1451) ~[na:na]
	at java.base/sun.net.www.protocol.http.HttpURLConnection.getOutputStream(HttpURLConnection.java:1422) ~[na:na]
	at feign.Client$Default.convertAndSend(Client.java:208) ~[feign-core-11.10.jar:na]
	at feign.Client$Default.execute(Client.java:105) ~[feign-core-11.10.jar:na]
	at org.springframework.cloud.openfeign.loadbalancer.LoadBalancerUtils.executeWithLoadBalancerLifecycleProcessing(LoadBalancerUtils.java:57) ~[spring-cloud-openfeign-core-3.1.5.jar:3.1.5]
	at org.springframework.cloud.openfeign.loadbalancer.LoadBalancerUtils.executeWithLoadBalancerLifecycleProcessing(LoadBalancerUtils.java:95) ~[spring-cloud-openfeign-core-3.1.5.jar:3.1.5]
	at org.springframework.cloud.openfeign.loadbalancer.FeignBlockingLoadBalancerClient.execute(FeignBlockingLoadBalancerClient.java:114) ~[spring-cloud-openfeign-core-3.1.5.jar:3.1.5]
	at feign.SynchronousMethodHandler.executeAndDecode(SynchronousMethodHandler.java:121) ~[feign-core-11.10.jar:na]
	at feign.SynchronousMethodHandler.invoke(SynchronousMethodHandler.java:91) ~[feign-core-11.10.jar:na]
	at feign.ReflectiveFeign$FeignInvocationHandler.invoke(ReflectiveFeign.java:100) ~[feign-core-11.10.jar:na]
	at jdk.proxy2/jdk.proxy2.$Proxy125.uploadFile(Unknown Source) ~[na:na]
	at com.luojiawei.his_service.service.impl.UploadServiceImpl.handleFileUpload(UploadServiceImpl.java:43) ~[classes/:na]
	at com.luojiawei.his_service.controller.AiModelController.testFileUpload(AiModelController.java:40) ~[classes/:na]
	at java.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke0(Native Method) ~[na:na]
	at java.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:77) ~[na:na]
	at java.base/jdk.internal.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43) ~[na:na]
	at java.base/java.lang.reflect.Method.invoke(Method.java:568) ~[na:na]
	at org.springframework.web.method.support.InvocableHandlerMethod.doInvoke(InvocableHandlerMethod.java:205) ~[spring-web-5.3.27.jar:5.3.27]
	at org.springframework.web.method.support.InvocableHandlerMethod.invokeForRequest(InvocableHandlerMethod.java:150) ~[spring-web-5.3.27.jar:5.3.27]
	at org.springframework.web.servlet.mvc.method.annotation.ServletInvocableHandlerMethod.invokeAndHandle(ServletInvocableHandlerMethod.java:117) ~[spring-webmvc-5.3.27.jar:5.3.27]
	at org.springframework.web.servlet.mvc.method.annotation.RequestMappingHandlerAdapter.invokeHandlerMethod(RequestMappingHandlerAdapter.java:895) ~[spring-webmvc-5.3.27.jar:5.3.27]
	at org.springframework.web.servlet.mvc.method.annotation.RequestMappingHandlerAdapter.handleInternal(RequestMappingHandlerAdapter.java:808) ~[spring-webmvc-5.3.27.jar:5.3.27]
	at org.springframework.web.servlet.mvc.method.AbstractHandlerMethodAdapter.handle(AbstractHandlerMethodAdapter.java:87) ~[spring-webmvc-5.3.27.jar:5.3.27]
	at org.springframework.web.servlet.DispatcherServlet.doDispatch(DispatcherServlet.java:1072) ~[spring-webmvc-5.3.27.jar:5.3.27]
	at org.springframework.web.servlet.DispatcherServlet.doService(DispatcherServlet.java:965) ~[spring-webmvc-5.3.27.jar:5.3.27]
	at org.springframework.web.servlet.FrameworkServlet.processRequest(FrameworkServlet.java:1006) ~[spring-webmvc-5.3.27.jar:5.3.27]
	at org.springframework.web.servlet.FrameworkServlet.doPost(FrameworkServlet.java:909) ~[spring-webmvc-5.3.27.jar:5.3.27]
	at javax.servlet.http.HttpServlet.service(HttpServlet.java:555) ~[tomcat-embed-core-9.0.75.jar:4.0.FR]
	at org.springframework.web.servlet.FrameworkServlet.service(FrameworkServlet.java:883) ~[spring-webmvc-5.3.27.jar:5.3.27]
	at javax.servlet.http.HttpServlet.service(HttpServlet.java:623) ~[tomcat-embed-core-9.0.75.jar:4.0.FR]
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:209) ~[tomcat-embed-core-9.0.75.jar:9.0.75]
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:153) ~[tomcat-embed-core-9.0.75.jar:9.0.75]
	at com.luojiawei.his_service.filter.RefreshTokenFilter.doFilterInternal(RefreshTokenFilter.java:58) ~[classes/:na]
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:117) ~[spring-web-5.3.27.jar:5.3.27]
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:178) ~[tomcat-embed-core-9.0.75.jar:9.0.75]
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:153) ~[tomcat-embed-core-9.0.75.jar:9.0.75]
	at org.springframework.web.filter.RequestContextFilter.doFilterInternal(RequestContextFilter.java:100) ~[spring-web-5.3.27.jar:5.3.27]
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:117) ~[spring-web-5.3.27.jar:5.3.27]
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:178) ~[tomcat-embed-core-9.0.75.jar:9.0.75]
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:153) ~[tomcat-embed-core-9.0.75.jar:9.0.75]
	at org.springframework.web.filter.FormContentFilter.doFilterInternal(FormContentFilter.java:93) ~[spring-web-5.3.27.jar:5.3.27]
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:117) ~[spring-web-5.3.27.jar:5.3.27]
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:178) ~[tomcat-embed-core-9.0.75.jar:9.0.75]
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:153) ~[tomcat-embed-core-9.0.75.jar:9.0.75]
	at org.springframework.boot.actuate.metrics.web.servlet.WebMvcMetricsFilter.doFilterInternal(WebMvcMetricsFilter.java:96) ~[spring-boot-actuator-2.7.12.jar:2.7.12]
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:117) ~[spring-web-5.3.27.jar:5.3.27]
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:178) ~[tomcat-embed-core-9.0.75.jar:9.0.75]
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:153) ~[tomcat-embed-core-9.0.75.jar:9.0.75]
	at org.springframework.web.filter.CharacterEncodingFilter.doFilterInternal(CharacterEncodingFilter.java:201) ~[spring-web-5.3.27.jar:5.3.27]
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:117) ~[spring-web-5.3.27.jar:5.3.27]
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:178) ~[tomcat-embed-core-9.0.75.jar:9.0.75]
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:153) ~[tomcat-embed-core-9.0.75.jar:9.0.75]
	at org.apache.catalina.core.StandardWrapperValve.invoke(StandardWrapperValve.java:167) ~[tomcat-embed-core-9.0.75.jar:9.0.75]
	at org.apache.catalina.core.StandardContextValve.invoke(StandardContextValve.java:90) ~[tomcat-embed-core-9.0.75.jar:9.0.75]
	at org.apache.catalina.authenticator.AuthenticatorBase.invoke(AuthenticatorBase.java:481) ~[tomcat-embed-core-9.0.75.jar:9.0.75]
	at org.apache.catalina.core.StandardHostValve.invoke(StandardHostValve.java:130) ~[tomcat-embed-core-9.0.75.jar:9.0.75]
	at org.apache.catalina.valves.ErrorReportValve.invoke(ErrorReportValve.java:93) ~[tomcat-embed-core-9.0.75.jar:9.0.75]
	at org.apache.catalina.core.StandardEngineValve.invoke(StandardEngineValve.java:74) ~[tomcat-embed-core-9.0.75.jar:9.0.75]
	at org.apache.catalina.connector.CoyoteAdapter.service(CoyoteAdapter.java:343) ~[tomcat-embed-core-9.0.75.jar:9.0.75]
	at org.apache.coyote.http11.Http11Processor.service(Http11Processor.java:390) ~[tomcat-embed-core-9.0.75.jar:9.0.75]
	at org.apache.coyote.AbstractProcessorLight.process(AbstractProcessorLight.java:63) ~[tomcat-embed-core-9.0.75.jar:9.0.75]
	at org.apache.coyote.AbstractProtocol$ConnectionHandler.process(AbstractProtocol.java:926) ~[tomcat-embed-core-9.0.75.jar:9.0.75]
	at org.apache.tomcat.util.net.NioEndpoint$SocketProcessor.doRun(NioEndpoint.java:1791) ~[tomcat-embed-core-9.0.75.jar:9.0.75]
	at org.apache.tomcat.util.net.SocketProcessorBase.run(SocketProcessorBase.java:52) ~[tomcat-embed-core-9.0.75.jar:9.0.75]
	at org.apache.tomcat.util.threads.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1191) ~[tomcat-embed-core-9.0.75.jar:9.0.75]
	at org.apache.tomcat.util.threads.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:659) ~[tomcat-embed-core-9.0.75.jar:9.0.75]
	at org.apache.tomcat.util.threads.TaskThread$WrappingRunnable.run(TaskThread.java:61) ~[tomcat-embed-core-9.0.75.jar:9.0.75]
	at java.base/java.lang.Thread.run(Thread.java:840) ~[na:na]

19:39:37:914 DEBUG 22164 --- [http-nio-8080-exec-5] c.l.api.client.FlaskModelAnalyzeClient   : [FlaskModelAnalyzeClient#uploadFile] ---> POST http://flask-service/upload HTTP/1.1
19:39:37:920 DEBUG 22164 --- [http-nio-8080-exec-5] c.l.api.client.FlaskModelAnalyzeClient   : [FlaskModelAnalyzeClient#uploadFile] Content-Length: 67886
19:39:37:921 DEBUG 22164 --- [http-nio-8080-exec-5] c.l.api.client.FlaskModelAnalyzeClient   : [FlaskModelAnalyzeClient#uploadFile] Content-Type: multipart/form-data; charset=UTF-8; boundary=1958f4d882f
19:39:37:921 DEBUG 22164 --- [http-nio-8080-exec-5] c.l.api.client.FlaskModelAnalyzeClient   : [FlaskModelAnalyzeClient#uploadFile] X-API-Key: 123456
19:39:37:921 DEBUG 22164 --- [http-nio-8080-exec-5] c.l.api.client.FlaskModelAnalyzeClient   : [FlaskModelAnalyzeClient#uploadFile] 
19:39:37:921 DEBUG 22164 --- [http-nio-8080-exec-5] c.l.api.client.FlaskModelAnalyzeClient   : [FlaskModelAnalyzeClient#uploadFile] Binary data
19:39:37:921 DEBUG 22164 --- [http-nio-8080-exec-5] c.l.api.client.FlaskModelAnalyzeClient   : [FlaskModelAnalyzeClient#uploadFile] ---> END HTTP (67886-byte body)
19:39:40:032 DEBUG 22164 --- [http-nio-8080-exec-5] c.l.api.client.FlaskModelAnalyzeClient   : [FlaskModelAnalyzeClient#uploadFile] <--- ERROR ConnectException: Connection refused: getsockopt (2110ms)
19:39:40:046 DEBUG 22164 --- [http-nio-8080-exec-5] c.l.api.client.FlaskModelAnalyzeClient   : [FlaskModelAnalyzeClient#uploadFile] java.net.ConnectException: Connection refused: getsockopt
	at java.base/sun.nio.ch.Net.pollConnect(Native Method)
	at java.base/sun.nio.ch.Net.pollConnectNow(Net.java:672)
	at java.base/sun.nio.ch.NioSocketImpl.timedFinishConnect(NioSocketImpl.java:554)
	at java.base/sun.nio.ch.NioSocketImpl.connect(NioSocketImpl.java:602)
	at java.base/java.net.Socket.connect(Socket.java:633)
	at java.base/sun.net.NetworkClient.doConnect(NetworkClient.java:178)
	at java.base/sun.net.www.http.HttpClient.openServer(HttpClient.java:533)
	at java.base/sun.net.www.http.HttpClient.openServer(HttpClient.java:638)
	at java.base/sun.net.www.http.HttpClient.<init>(HttpClient.java:281)
	at java.base/sun.net.www.http.HttpClient.New(HttpClient.java:386)
	at java.base/sun.net.www.http.HttpClient.New(HttpClient.java:408)
	at java.base/sun.net.www.protocol.http.HttpURLConnection.getNewHttpClient(HttpURLConnection.java:1309)
	at java.base/sun.net.www.protocol.http.HttpURLConnection.plainConnect0(HttpURLConnection.java:1242)
	at java.base/sun.net.www.protocol.http.HttpURLConnection.plainConnect(HttpURLConnection.java:1128)
	at java.base/sun.net.www.protocol.http.HttpURLConnection.connect(HttpURLConnection.java:1057)
	at java.base/sun.net.www.protocol.http.HttpURLConnection.getOutputStream0(HttpURLConnection.java:1451)
	at java.base/sun.net.www.protocol.http.HttpURLConnection.getOutputStream(HttpURLConnection.java:1422)
	at feign.Client$Default.convertAndSend(Client.java:208)
	at feign.Client$Default.execute(Client.java:105)
	at org.springframework.cloud.openfeign.loadbalancer.LoadBalancerUtils.executeWithLoadBalancerLifecycleProcessing(LoadBalancerUtils.java:57)
	at org.springframework.cloud.openfeign.loadbalancer.LoadBalancerUtils.executeWithLoadBalancerLifecycleProcessing(LoadBalancerUtils.java:95)
	at org.springframework.cloud.openfeign.loadbalancer.FeignBlockingLoadBalancerClient.execute(FeignBlockingLoadBalancerClient.java:114)
	at feign.SynchronousMethodHandler.executeAndDecode(SynchronousMethodHandler.java:121)
	at feign.SynchronousMethodHandler.invoke(SynchronousMethodHandler.java:91)
	at feign.ReflectiveFeign$FeignInvocationHandler.invoke(ReflectiveFeign.java:100)
	at jdk.proxy2/jdk.proxy2.$Proxy125.uploadFile(Unknown Source)
	at com.luojiawei.his_service.service.impl.UploadServiceImpl.handleFileUpload(UploadServiceImpl.java:43)
	at com.luojiawei.his_service.controller.AiModelController.testFileUpload(AiModelController.java:40)
	at java.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at java.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:77)
	at java.base/jdk.internal.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.base/java.lang.reflect.Method.invoke(Method.java:568)
	at org.springframework.web.method.support.InvocableHandlerMethod.doInvoke(InvocableHandlerMethod.java:205)
	at org.springframework.web.method.support.InvocableHandlerMethod.invokeForRequest(InvocableHandlerMethod.java:150)
	at org.springframework.web.servlet.mvc.method.annotation.ServletInvocableHandlerMethod.invokeAndHandle(ServletInvocableHandlerMethod.java:117)
	at org.springframework.web.servlet.mvc.method.annotation.RequestMappingHandlerAdapter.invokeHandlerMethod(RequestMappingHandlerAdapter.java:895)
	at org.springframework.web.servlet.mvc.method.annotation.RequestMappingHandlerAdapter.handleInternal(RequestMappingHandlerAdapter.java:808)
	at org.springframework.web.servlet.mvc.method.AbstractHandlerMethodAdapter.handle(AbstractHandlerMethodAdapter.java:87)
	at org.springframework.web.servlet.DispatcherServlet.doDispatch(DispatcherServlet.java:1072)
	at org.springframework.web.servlet.DispatcherServlet.doService(DispatcherServlet.java:965)
	at org.springframework.web.servlet.FrameworkServlet.processRequest(FrameworkServlet.java:1006)
	at org.springframework.web.servlet.FrameworkServlet.doPost(FrameworkServlet.java:909)
	at javax.servlet.http.HttpServlet.service(HttpServlet.java:555)
	at org.springframework.web.servlet.FrameworkServlet.service(FrameworkServlet.java:883)
	at javax.servlet.http.HttpServlet.service(HttpServlet.java:623)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:209)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:153)
	at com.luojiawei.his_service.filter.RefreshTokenFilter.doFilterInternal(RefreshTokenFilter.java:58)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:117)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:178)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:153)
	at org.springframework.web.filter.RequestContextFilter.doFilterInternal(RequestContextFilter.java:100)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:117)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:178)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:153)
	at org.springframework.web.filter.FormContentFilter.doFilterInternal(FormContentFilter.java:93)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:117)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:178)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:153)
	at org.springframework.boot.actuate.metrics.web.servlet.WebMvcMetricsFilter.doFilterInternal(WebMvcMetricsFilter.java:96)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:117)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:178)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:153)
	at org.springframework.web.filter.CharacterEncodingFilter.doFilterInternal(CharacterEncodingFilter.java:201)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:117)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:178)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:153)
	at org.apache.catalina.core.StandardWrapperValve.invoke(StandardWrapperValve.java:167)
	at org.apache.catalina.core.StandardContextValve.invoke(StandardContextValve.java:90)
	at org.apache.catalina.authenticator.AuthenticatorBase.invoke(AuthenticatorBase.java:481)
	at org.apache.catalina.core.StandardHostValve.invoke(StandardHostValve.java:130)
	at org.apache.catalina.valves.ErrorReportValve.invoke(ErrorReportValve.java:93)
	at org.apache.catalina.core.StandardEngineValve.invoke(StandardEngineValve.java:74)
	at org.apache.catalina.connector.CoyoteAdapter.service(CoyoteAdapter.java:343)
	at org.apache.coyote.http11.Http11Processor.service(Http11Processor.java:390)
	at org.apache.coyote.AbstractProcessorLight.process(AbstractProcessorLight.java:63)
	at org.apache.coyote.AbstractProtocol$ConnectionHandler.process(AbstractProtocol.java:926)
	at org.apache.tomcat.util.net.NioEndpoint$SocketProcessor.doRun(NioEndpoint.java:1791)
	at org.apache.tomcat.util.net.SocketProcessorBase.run(SocketProcessorBase.java:52)
	at org.apache.tomcat.util.threads.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1191)
	at org.apache.tomcat.util.threads.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:659)
	at org.apache.tomcat.util.threads.TaskThread$WrappingRunnable.run(TaskThread.java:61)
	at java.base/java.lang.Thread.run(Thread.java:840)

19:39:40:048 DEBUG 22164 --- [http-nio-8080-exec-5] c.l.api.client.FlaskModelAnalyzeClient   : [FlaskModelAnalyzeClient#uploadFile] <--- END ERROR
19:39:40:089 ERROR 22164 --- [http-nio-8080-exec-5] o.a.c.c.C.[.[.[/].[dispatcherServlet]    : Servlet.service() for servlet [dispatcherServlet] in context with path [] threw exception [Request processing failed; nested exception is java.lang.RuntimeException: ] with root cause

java.net.ConnectException: Connection refused: getsockopt
	at java.base/sun.nio.ch.Net.pollConnect(Native Method) ~[na:na]
	at java.base/sun.nio.ch.Net.pollConnectNow(Net.java:672) ~[na:na]
	at java.base/sun.nio.ch.NioSocketImpl.timedFinishConnect(NioSocketImpl.java:554) ~[na:na]
	at java.base/sun.nio.ch.NioSocketImpl.connect(NioSocketImpl.java:602) ~[na:na]
	at java.base/java.net.Socket.connect(Socket.java:633) ~[na:na]
	at java.base/sun.net.NetworkClient.doConnect(NetworkClient.java:178) ~[na:na]
	at java.base/sun.net.www.http.HttpClient.openServer(HttpClient.java:533) ~[na:na]
	at java.base/sun.net.www.http.HttpClient.openServer(HttpClient.java:638) ~[na:na]
	at java.base/sun.net.www.http.HttpClient.<init>(HttpClient.java:281) ~[na:na]
	at java.base/sun.net.www.http.HttpClient.New(HttpClient.java:386) ~[na:na]
	at java.base/sun.net.www.http.HttpClient.New(HttpClient.java:408) ~[na:na]
	at java.base/sun.net.www.protocol.http.HttpURLConnection.getNewHttpClient(HttpURLConnection.java:1309) ~[na:na]
	at java.base/sun.net.www.protocol.http.HttpURLConnection.plainConnect0(HttpURLConnection.java:1242) ~[na:na]
	at java.base/sun.net.www.protocol.http.HttpURLConnection.plainConnect(HttpURLConnection.java:1128) ~[na:na]
	at java.base/sun.net.www.protocol.http.HttpURLConnection.connect(HttpURLConnection.java:1057) ~[na:na]
	at java.base/sun.net.www.protocol.http.HttpURLConnection.getOutputStream0(HttpURLConnection.java:1451) ~[na:na]
	at java.base/sun.net.www.protocol.http.HttpURLConnection.getOutputStream(HttpURLConnection.java:1422) ~[na:na]
	at feign.Client$Default.convertAndSend(Client.java:208) ~[feign-core-11.10.jar:na]
	at feign.Client$Default.execute(Client.java:105) ~[feign-core-11.10.jar:na]
	at org.springframework.cloud.openfeign.loadbalancer.LoadBalancerUtils.executeWithLoadBalancerLifecycleProcessing(LoadBalancerUtils.java:57) ~[spring-cloud-openfeign-core-3.1.5.jar:3.1.5]
	at org.springframework.cloud.openfeign.loadbalancer.LoadBalancerUtils.executeWithLoadBalancerLifecycleProcessing(LoadBalancerUtils.java:95) ~[spring-cloud-openfeign-core-3.1.5.jar:3.1.5]
	at org.springframework.cloud.openfeign.loadbalancer.FeignBlockingLoadBalancerClient.execute(FeignBlockingLoadBalancerClient.java:114) ~[spring-cloud-openfeign-core-3.1.5.jar:3.1.5]
	at feign.SynchronousMethodHandler.executeAndDecode(SynchronousMethodHandler.java:121) ~[feign-core-11.10.jar:na]
	at feign.SynchronousMethodHandler.invoke(SynchronousMethodHandler.java:91) ~[feign-core-11.10.jar:na]
	at feign.ReflectiveFeign$FeignInvocationHandler.invoke(ReflectiveFeign.java:100) ~[feign-core-11.10.jar:na]
	at jdk.proxy2/jdk.proxy2.$Proxy125.uploadFile(Unknown Source) ~[na:na]
	at com.luojiawei.his_service.service.impl.UploadServiceImpl.handleFileUpload(UploadServiceImpl.java:43) ~[classes/:na]
	at com.luojiawei.his_service.controller.AiModelController.testFileUpload(AiModelController.java:40) ~[classes/:na]
	at java.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke0(Native Method) ~[na:na]
	at java.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:77) ~[na:na]
	at java.base/jdk.internal.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43) ~[na:na]
	at java.base/java.lang.reflect.Method.invoke(Method.java:568) ~[na:na]
	at org.springframework.web.method.support.InvocableHandlerMethod.doInvoke(InvocableHandlerMethod.java:205) ~[spring-web-5.3.27.jar:5.3.27]
	at org.springframework.web.method.support.InvocableHandlerMethod.invokeForRequest(InvocableHandlerMethod.java:150) ~[spring-web-5.3.27.jar:5.3.27]
	at org.springframework.web.servlet.mvc.method.annotation.ServletInvocableHandlerMethod.invokeAndHandle(ServletInvocableHandlerMethod.java:117) ~[spring-webmvc-5.3.27.jar:5.3.27]
	at org.springframework.web.servlet.mvc.method.annotation.RequestMappingHandlerAdapter.invokeHandlerMethod(RequestMappingHandlerAdapter.java:895) ~[spring-webmvc-5.3.27.jar:5.3.27]
	at org.springframework.web.servlet.mvc.method.annotation.RequestMappingHandlerAdapter.handleInternal(RequestMappingHandlerAdapter.java:808) ~[spring-webmvc-5.3.27.jar:5.3.27]
	at org.springframework.web.servlet.mvc.method.AbstractHandlerMethodAdapter.handle(AbstractHandlerMethodAdapter.java:87) ~[spring-webmvc-5.3.27.jar:5.3.27]
	at org.springframework.web.servlet.DispatcherServlet.doDispatch(DispatcherServlet.java:1072) ~[spring-webmvc-5.3.27.jar:5.3.27]
	at org.springframework.web.servlet.DispatcherServlet.doService(DispatcherServlet.java:965) ~[spring-webmvc-5.3.27.jar:5.3.27]
	at org.springframework.web.servlet.FrameworkServlet.processRequest(FrameworkServlet.java:1006) ~[spring-webmvc-5.3.27.jar:5.3.27]
	at org.springframework.web.servlet.FrameworkServlet.doPost(FrameworkServlet.java:909) ~[spring-webmvc-5.3.27.jar:5.3.27]
	at javax.servlet.http.HttpServlet.service(HttpServlet.java:555) ~[tomcat-embed-core-9.0.75.jar:4.0.FR]
	at org.springframework.web.servlet.FrameworkServlet.service(FrameworkServlet.java:883) ~[spring-webmvc-5.3.27.jar:5.3.27]
	at javax.servlet.http.HttpServlet.service(HttpServlet.java:623) ~[tomcat-embed-core-9.0.75.jar:4.0.FR]
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:209) ~[tomcat-embed-core-9.0.75.jar:9.0.75]
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:153) ~[tomcat-embed-core-9.0.75.jar:9.0.75]
	at com.luojiawei.his_service.filter.RefreshTokenFilter.doFilterInternal(RefreshTokenFilter.java:58) ~[classes/:na]
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:117) ~[spring-web-5.3.27.jar:5.3.27]
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:178) ~[tomcat-embed-core-9.0.75.jar:9.0.75]
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:153) ~[tomcat-embed-core-9.0.75.jar:9.0.75]
	at org.springframework.web.filter.RequestContextFilter.doFilterInternal(RequestContextFilter.java:100) ~[spring-web-5.3.27.jar:5.3.27]
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:117) ~[spring-web-5.3.27.jar:5.3.27]
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:178) ~[tomcat-embed-core-9.0.75.jar:9.0.75]
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:153) ~[tomcat-embed-core-9.0.75.jar:9.0.75]
	at org.springframework.web.filter.FormContentFilter.doFilterInternal(FormContentFilter.java:93) ~[spring-web-5.3.27.jar:5.3.27]
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:117) ~[spring-web-5.3.27.jar:5.3.27]
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:178) ~[tomcat-embed-core-9.0.75.jar:9.0.75]
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:153) ~[tomcat-embed-core-9.0.75.jar:9.0.75]
	at org.springframework.boot.actuate.metrics.web.servlet.WebMvcMetricsFilter.doFilterInternal(WebMvcMetricsFilter.java:96) ~[spring-boot-actuator-2.7.12.jar:2.7.12]
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:117) ~[spring-web-5.3.27.jar:5.3.27]
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:178) ~[tomcat-embed-core-9.0.75.jar:9.0.75]
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:153) ~[tomcat-embed-core-9.0.75.jar:9.0.75]
	at org.springframework.web.filter.CharacterEncodingFilter.doFilterInternal(CharacterEncodingFilter.java:201) ~[spring-web-5.3.27.jar:5.3.27]
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:117) ~[spring-web-5.3.27.jar:5.3.27]
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:178) ~[tomcat-embed-core-9.0.75.jar:9.0.75]
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:153) ~[tomcat-embed-core-9.0.75.jar:9.0.75]
	at org.apache.catalina.core.StandardWrapperValve.invoke(StandardWrapperValve.java:167) ~[tomcat-embed-core-9.0.75.jar:9.0.75]
	at org.apache.catalina.core.StandardContextValve.invoke(StandardContextValve.java:90) ~[tomcat-embed-core-9.0.75.jar:9.0.75]
	at org.apache.catalina.authenticator.AuthenticatorBase.invoke(AuthenticatorBase.java:481) ~[tomcat-embed-core-9.0.75.jar:9.0.75]
	at org.apache.catalina.core.StandardHostValve.invoke(StandardHostValve.java:130) ~[tomcat-embed-core-9.0.75.jar:9.0.75]
	at org.apache.catalina.valves.ErrorReportValve.invoke(ErrorReportValve.java:93) ~[tomcat-embed-core-9.0.75.jar:9.0.75]
	at org.apache.catalina.core.StandardEngineValve.invoke(StandardEngineValve.java:74) ~[tomcat-embed-core-9.0.75.jar:9.0.75]
	at org.apache.catalina.connector.CoyoteAdapter.service(CoyoteAdapter.java:343) ~[tomcat-embed-core-9.0.75.jar:9.0.75]
	at org.apache.coyote.http11.Http11Processor.service(Http11Processor.java:390) ~[tomcat-embed-core-9.0.75.jar:9.0.75]
	at org.apache.coyote.AbstractProcessorLight.process(AbstractProcessorLight.java:63) ~[tomcat-embed-core-9.0.75.jar:9.0.75]
	at org.apache.coyote.AbstractProtocol$ConnectionHandler.process(AbstractProtocol.java:926) ~[tomcat-embed-core-9.0.75.jar:9.0.75]
	at org.apache.tomcat.util.net.NioEndpoint$SocketProcessor.doRun(NioEndpoint.java:1791) ~[tomcat-embed-core-9.0.75.jar:9.0.75]
	at org.apache.tomcat.util.net.SocketProcessorBase.run(SocketProcessorBase.java:52) ~[tomcat-embed-core-9.0.75.jar:9.0.75]
	at org.apache.tomcat.util.threads.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1191) ~[tomcat-embed-core-9.0.75.jar:9.0.75]
	at org.apache.tomcat.util.threads.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:659) ~[tomcat-embed-core-9.0.75.jar:9.0.75]
	at org.apache.tomcat.util.threads.TaskThread$WrappingRunnable.run(TaskThread.java:61) ~[tomcat-embed-core-9.0.75.jar:9.0.75]
	at java.base/java.lang.Thread.run(Thread.java:840) ~[na:na]

19:48:56:210 DEBUG 22164 --- [http-nio-8080-exec-7] c.l.api.client.FlaskModelAnalyzeClient   : [FlaskModelAnalyzeClient#uploadFile] ---> POST http://flask-service/upload HTTP/1.1
19:48:56:213 DEBUG 22164 --- [http-nio-8080-exec-7] c.l.api.client.FlaskModelAnalyzeClient   : [FlaskModelAnalyzeClient#uploadFile] Content-Length: 67886
19:48:56:214 DEBUG 22164 --- [http-nio-8080-exec-7] c.l.api.client.FlaskModelAnalyzeClient   : [FlaskModelAnalyzeClient#uploadFile] Content-Type: multipart/form-data; charset=UTF-8; boundary=1958f560d0e
19:48:56:214 DEBUG 22164 --- [http-nio-8080-exec-7] c.l.api.client.FlaskModelAnalyzeClient   : [FlaskModelAnalyzeClient#uploadFile] X-API-Key: 123456
19:48:56:214 DEBUG 22164 --- [http-nio-8080-exec-7] c.l.api.client.FlaskModelAnalyzeClient   : [FlaskModelAnalyzeClient#uploadFile] 
19:48:56:214 DEBUG 22164 --- [http-nio-8080-exec-7] c.l.api.client.FlaskModelAnalyzeClient   : [FlaskModelAnalyzeClient#uploadFile] Binary data
19:48:56:214 DEBUG 22164 --- [http-nio-8080-exec-7] c.l.api.client.FlaskModelAnalyzeClient   : [FlaskModelAnalyzeClient#uploadFile] ---> END HTTP (67886-byte body)
19:48:58:267 DEBUG 22164 --- [http-nio-8080-exec-7] c.l.api.client.FlaskModelAnalyzeClient   : [FlaskModelAnalyzeClient#uploadFile] <--- ERROR ConnectException: Connection refused: getsockopt (2052ms)
19:48:58:268 DEBUG 22164 --- [http-nio-8080-exec-7] c.l.api.client.FlaskModelAnalyzeClient   : [FlaskModelAnalyzeClient#uploadFile] java.net.ConnectException: Connection refused: getsockopt
	at java.base/sun.nio.ch.Net.pollConnect(Native Method)
	at java.base/sun.nio.ch.Net.pollConnectNow(Net.java:672)
	at java.base/sun.nio.ch.NioSocketImpl.timedFinishConnect(NioSocketImpl.java:554)
	at java.base/sun.nio.ch.NioSocketImpl.connect(NioSocketImpl.java:602)
	at java.base/java.net.Socket.connect(Socket.java:633)
	at java.base/sun.net.NetworkClient.doConnect(NetworkClient.java:178)
	at java.base/sun.net.www.http.HttpClient.openServer(HttpClient.java:533)
	at java.base/sun.net.www.http.HttpClient.openServer(HttpClient.java:638)
	at java.base/sun.net.www.http.HttpClient.<init>(HttpClient.java:281)
	at java.base/sun.net.www.http.HttpClient.New(HttpClient.java:386)
	at java.base/sun.net.www.http.HttpClient.New(HttpClient.java:408)
	at java.base/sun.net.www.protocol.http.HttpURLConnection.getNewHttpClient(HttpURLConnection.java:1309)
	at java.base/sun.net.www.protocol.http.HttpURLConnection.plainConnect0(HttpURLConnection.java:1242)
	at java.base/sun.net.www.protocol.http.HttpURLConnection.plainConnect(HttpURLConnection.java:1128)
	at java.base/sun.net.www.protocol.http.HttpURLConnection.connect(HttpURLConnection.java:1057)
	at java.base/sun.net.www.protocol.http.HttpURLConnection.getOutputStream0(HttpURLConnection.java:1451)
	at java.base/sun.net.www.protocol.http.HttpURLConnection.getOutputStream(HttpURLConnection.java:1422)
	at feign.Client$Default.convertAndSend(Client.java:208)
	at feign.Client$Default.execute(Client.java:105)
	at org.springframework.cloud.openfeign.loadbalancer.LoadBalancerUtils.executeWithLoadBalancerLifecycleProcessing(LoadBalancerUtils.java:57)
	at org.springframework.cloud.openfeign.loadbalancer.LoadBalancerUtils.executeWithLoadBalancerLifecycleProcessing(LoadBalancerUtils.java:95)
	at org.springframework.cloud.openfeign.loadbalancer.FeignBlockingLoadBalancerClient.execute(FeignBlockingLoadBalancerClient.java:114)
	at feign.SynchronousMethodHandler.executeAndDecode(SynchronousMethodHandler.java:121)
	at feign.SynchronousMethodHandler.invoke(SynchronousMethodHandler.java:91)
	at feign.ReflectiveFeign$FeignInvocationHandler.invoke(ReflectiveFeign.java:100)
	at jdk.proxy2/jdk.proxy2.$Proxy125.uploadFile(Unknown Source)
	at com.luojiawei.his_service.service.impl.UploadServiceImpl.handleFileUpload(UploadServiceImpl.java:43)
	at com.luojiawei.his_service.controller.AiModelController.testFileUpload(AiModelController.java:40)
	at java.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at java.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:77)
	at java.base/jdk.internal.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.base/java.lang.reflect.Method.invoke(Method.java:568)
	at org.springframework.web.method.support.InvocableHandlerMethod.doInvoke(InvocableHandlerMethod.java:205)
	at org.springframework.web.method.support.InvocableHandlerMethod.invokeForRequest(InvocableHandlerMethod.java:150)
	at org.springframework.web.servlet.mvc.method.annotation.ServletInvocableHandlerMethod.invokeAndHandle(ServletInvocableHandlerMethod.java:117)
	at org.springframework.web.servlet.mvc.method.annotation.RequestMappingHandlerAdapter.invokeHandlerMethod(RequestMappingHandlerAdapter.java:895)
	at org.springframework.web.servlet.mvc.method.annotation.RequestMappingHandlerAdapter.handleInternal(RequestMappingHandlerAdapter.java:808)
	at org.springframework.web.servlet.mvc.method.AbstractHandlerMethodAdapter.handle(AbstractHandlerMethodAdapter.java:87)
	at org.springframework.web.servlet.DispatcherServlet.doDispatch(DispatcherServlet.java:1072)
	at org.springframework.web.servlet.DispatcherServlet.doService(DispatcherServlet.java:965)
	at org.springframework.web.servlet.FrameworkServlet.processRequest(FrameworkServlet.java:1006)
	at org.springframework.web.servlet.FrameworkServlet.doPost(FrameworkServlet.java:909)
	at javax.servlet.http.HttpServlet.service(HttpServlet.java:555)
	at org.springframework.web.servlet.FrameworkServlet.service(FrameworkServlet.java:883)
	at javax.servlet.http.HttpServlet.service(HttpServlet.java:623)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:209)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:153)
	at com.luojiawei.his_service.filter.RefreshTokenFilter.doFilterInternal(RefreshTokenFilter.java:58)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:117)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:178)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:153)
	at org.springframework.web.filter.RequestContextFilter.doFilterInternal(RequestContextFilter.java:100)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:117)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:178)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:153)
	at org.springframework.web.filter.FormContentFilter.doFilterInternal(FormContentFilter.java:93)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:117)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:178)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:153)
	at org.springframework.boot.actuate.metrics.web.servlet.WebMvcMetricsFilter.doFilterInternal(WebMvcMetricsFilter.java:96)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:117)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:178)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:153)
	at org.springframework.web.filter.CharacterEncodingFilter.doFilterInternal(CharacterEncodingFilter.java:201)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:117)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:178)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:153)
	at org.apache.catalina.core.StandardWrapperValve.invoke(StandardWrapperValve.java:167)
	at org.apache.catalina.core.StandardContextValve.invoke(StandardContextValve.java:90)
	at org.apache.catalina.authenticator.AuthenticatorBase.invoke(AuthenticatorBase.java:481)
	at org.apache.catalina.core.StandardHostValve.invoke(StandardHostValve.java:130)
	at org.apache.catalina.valves.ErrorReportValve.invoke(ErrorReportValve.java:93)
	at org.apache.catalina.core.StandardEngineValve.invoke(StandardEngineValve.java:74)
	at org.apache.catalina.connector.CoyoteAdapter.service(CoyoteAdapter.java:343)
	at org.apache.coyote.http11.Http11Processor.service(Http11Processor.java:390)
	at org.apache.coyote.AbstractProcessorLight.process(AbstractProcessorLight.java:63)
	at org.apache.coyote.AbstractProtocol$ConnectionHandler.process(AbstractProtocol.java:926)
	at org.apache.tomcat.util.net.NioEndpoint$SocketProcessor.doRun(NioEndpoint.java:1791)
	at org.apache.tomcat.util.net.SocketProcessorBase.run(SocketProcessorBase.java:52)
	at org.apache.tomcat.util.threads.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1191)
	at org.apache.tomcat.util.threads.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:659)
	at org.apache.tomcat.util.threads.TaskThread$WrappingRunnable.run(TaskThread.java:61)
	at java.base/java.lang.Thread.run(Thread.java:840)

19:48:58:268 DEBUG 22164 --- [http-nio-8080-exec-7] c.l.api.client.FlaskModelAnalyzeClient   : [FlaskModelAnalyzeClient#uploadFile] <--- END ERROR
19:48:58:273 ERROR 22164 --- [http-nio-8080-exec-7] o.a.c.c.C.[.[.[/].[dispatcherServlet]    : Servlet.service() for servlet [dispatcherServlet] in context with path [] threw exception [Request processing failed; nested exception is java.lang.RuntimeException: ] with root cause

java.net.ConnectException: Connection refused: getsockopt
	at java.base/sun.nio.ch.Net.pollConnect(Native Method) ~[na:na]
	at java.base/sun.nio.ch.Net.pollConnectNow(Net.java:672) ~[na:na]
	at java.base/sun.nio.ch.NioSocketImpl.timedFinishConnect(NioSocketImpl.java:554) ~[na:na]
	at java.base/sun.nio.ch.NioSocketImpl.connect(NioSocketImpl.java:602) ~[na:na]
	at java.base/java.net.Socket.connect(Socket.java:633) ~[na:na]
	at java.base/sun.net.NetworkClient.doConnect(NetworkClient.java:178) ~[na:na]
	at java.base/sun.net.www.http.HttpClient.openServer(HttpClient.java:533) ~[na:na]
	at java.base/sun.net.www.http.HttpClient.openServer(HttpClient.java:638) ~[na:na]
	at java.base/sun.net.www.http.HttpClient.<init>(HttpClient.java:281) ~[na:na]
	at java.base/sun.net.www.http.HttpClient.New(HttpClient.java:386) ~[na:na]
	at java.base/sun.net.www.http.HttpClient.New(HttpClient.java:408) ~[na:na]
	at java.base/sun.net.www.protocol.http.HttpURLConnection.getNewHttpClient(HttpURLConnection.java:1309) ~[na:na]
	at java.base/sun.net.www.protocol.http.HttpURLConnection.plainConnect0(HttpURLConnection.java:1242) ~[na:na]
	at java.base/sun.net.www.protocol.http.HttpURLConnection.plainConnect(HttpURLConnection.java:1128) ~[na:na]
	at java.base/sun.net.www.protocol.http.HttpURLConnection.connect(HttpURLConnection.java:1057) ~[na:na]
	at java.base/sun.net.www.protocol.http.HttpURLConnection.getOutputStream0(HttpURLConnection.java:1451) ~[na:na]
	at java.base/sun.net.www.protocol.http.HttpURLConnection.getOutputStream(HttpURLConnection.java:1422) ~[na:na]
	at feign.Client$Default.convertAndSend(Client.java:208) ~[feign-core-11.10.jar:na]
	at feign.Client$Default.execute(Client.java:105) ~[feign-core-11.10.jar:na]
	at org.springframework.cloud.openfeign.loadbalancer.LoadBalancerUtils.executeWithLoadBalancerLifecycleProcessing(LoadBalancerUtils.java:57) ~[spring-cloud-openfeign-core-3.1.5.jar:3.1.5]
	at org.springframework.cloud.openfeign.loadbalancer.LoadBalancerUtils.executeWithLoadBalancerLifecycleProcessing(LoadBalancerUtils.java:95) ~[spring-cloud-openfeign-core-3.1.5.jar:3.1.5]
	at org.springframework.cloud.openfeign.loadbalancer.FeignBlockingLoadBalancerClient.execute(FeignBlockingLoadBalancerClient.java:114) ~[spring-cloud-openfeign-core-3.1.5.jar:3.1.5]
	at feign.SynchronousMethodHandler.executeAndDecode(SynchronousMethodHandler.java:121) ~[feign-core-11.10.jar:na]
	at feign.SynchronousMethodHandler.invoke(SynchronousMethodHandler.java:91) ~[feign-core-11.10.jar:na]
	at feign.ReflectiveFeign$FeignInvocationHandler.invoke(ReflectiveFeign.java:100) ~[feign-core-11.10.jar:na]
	at jdk.proxy2/jdk.proxy2.$Proxy125.uploadFile(Unknown Source) ~[na:na]
	at com.luojiawei.his_service.service.impl.UploadServiceImpl.handleFileUpload(UploadServiceImpl.java:43) ~[classes/:na]
	at com.luojiawei.his_service.controller.AiModelController.testFileUpload(AiModelController.java:40) ~[classes/:na]
	at java.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke0(Native Method) ~[na:na]
	at java.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:77) ~[na:na]
	at java.base/jdk.internal.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43) ~[na:na]
	at java.base/java.lang.reflect.Method.invoke(Method.java:568) ~[na:na]
	at org.springframework.web.method.support.InvocableHandlerMethod.doInvoke(InvocableHandlerMethod.java:205) ~[spring-web-5.3.27.jar:5.3.27]
	at org.springframework.web.method.support.InvocableHandlerMethod.invokeForRequest(InvocableHandlerMethod.java:150) ~[spring-web-5.3.27.jar:5.3.27]
	at org.springframework.web.servlet.mvc.method.annotation.ServletInvocableHandlerMethod.invokeAndHandle(ServletInvocableHandlerMethod.java:117) ~[spring-webmvc-5.3.27.jar:5.3.27]
	at org.springframework.web.servlet.mvc.method.annotation.RequestMappingHandlerAdapter.invokeHandlerMethod(RequestMappingHandlerAdapter.java:895) ~[spring-webmvc-5.3.27.jar:5.3.27]
	at org.springframework.web.servlet.mvc.method.annotation.RequestMappingHandlerAdapter.handleInternal(RequestMappingHandlerAdapter.java:808) ~[spring-webmvc-5.3.27.jar:5.3.27]
	at org.springframework.web.servlet.mvc.method.AbstractHandlerMethodAdapter.handle(AbstractHandlerMethodAdapter.java:87) ~[spring-webmvc-5.3.27.jar:5.3.27]
	at org.springframework.web.servlet.DispatcherServlet.doDispatch(DispatcherServlet.java:1072) ~[spring-webmvc-5.3.27.jar:5.3.27]
	at org.springframework.web.servlet.DispatcherServlet.doService(DispatcherServlet.java:965) ~[spring-webmvc-5.3.27.jar:5.3.27]
	at org.springframework.web.servlet.FrameworkServlet.processRequest(FrameworkServlet.java:1006) ~[spring-webmvc-5.3.27.jar:5.3.27]
	at org.springframework.web.servlet.FrameworkServlet.doPost(FrameworkServlet.java:909) ~[spring-webmvc-5.3.27.jar:5.3.27]
	at javax.servlet.http.HttpServlet.service(HttpServlet.java:555) ~[tomcat-embed-core-9.0.75.jar:4.0.FR]
	at org.springframework.web.servlet.FrameworkServlet.service(FrameworkServlet.java:883) ~[spring-webmvc-5.3.27.jar:5.3.27]
	at javax.servlet.http.HttpServlet.service(HttpServlet.java:623) ~[tomcat-embed-core-9.0.75.jar:4.0.FR]
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:209) ~[tomcat-embed-core-9.0.75.jar:9.0.75]
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:153) ~[tomcat-embed-core-9.0.75.jar:9.0.75]
	at com.luojiawei.his_service.filter.RefreshTokenFilter.doFilterInternal(RefreshTokenFilter.java:58) ~[classes/:na]
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:117) ~[spring-web-5.3.27.jar:5.3.27]
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:178) ~[tomcat-embed-core-9.0.75.jar:9.0.75]
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:153) ~[tomcat-embed-core-9.0.75.jar:9.0.75]
	at org.springframework.web.filter.RequestContextFilter.doFilterInternal(RequestContextFilter.java:100) ~[spring-web-5.3.27.jar:5.3.27]
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:117) ~[spring-web-5.3.27.jar:5.3.27]
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:178) ~[tomcat-embed-core-9.0.75.jar:9.0.75]
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:153) ~[tomcat-embed-core-9.0.75.jar:9.0.75]
	at org.springframework.web.filter.FormContentFilter.doFilterInternal(FormContentFilter.java:93) ~[spring-web-5.3.27.jar:5.3.27]
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:117) ~[spring-web-5.3.27.jar:5.3.27]
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:178) ~[tomcat-embed-core-9.0.75.jar:9.0.75]
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:153) ~[tomcat-embed-core-9.0.75.jar:9.0.75]
	at org.springframework.boot.actuate.metrics.web.servlet.WebMvcMetricsFilter.doFilterInternal(WebMvcMetricsFilter.java:96) ~[spring-boot-actuator-2.7.12.jar:2.7.12]
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:117) ~[spring-web-5.3.27.jar:5.3.27]
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:178) ~[tomcat-embed-core-9.0.75.jar:9.0.75]
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:153) ~[tomcat-embed-core-9.0.75.jar:9.0.75]
	at org.springframework.web.filter.CharacterEncodingFilter.doFilterInternal(CharacterEncodingFilter.java:201) ~[spring-web-5.3.27.jar:5.3.27]
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:117) ~[spring-web-5.3.27.jar:5.3.27]
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:178) ~[tomcat-embed-core-9.0.75.jar:9.0.75]
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:153) ~[tomcat-embed-core-9.0.75.jar:9.0.75]
	at org.apache.catalina.core.StandardWrapperValve.invoke(StandardWrapperValve.java:167) ~[tomcat-embed-core-9.0.75.jar:9.0.75]
	at org.apache.catalina.core.StandardContextValve.invoke(StandardContextValve.java:90) ~[tomcat-embed-core-9.0.75.jar:9.0.75]
	at org.apache.catalina.authenticator.AuthenticatorBase.invoke(AuthenticatorBase.java:481) ~[tomcat-embed-core-9.0.75.jar:9.0.75]
	at org.apache.catalina.core.StandardHostValve.invoke(StandardHostValve.java:130) ~[tomcat-embed-core-9.0.75.jar:9.0.75]
	at org.apache.catalina.valves.ErrorReportValve.invoke(ErrorReportValve.java:93) ~[tomcat-embed-core-9.0.75.jar:9.0.75]
	at org.apache.catalina.core.StandardEngineValve.invoke(StandardEngineValve.java:74) ~[tomcat-embed-core-9.0.75.jar:9.0.75]
	at org.apache.catalina.connector.CoyoteAdapter.service(CoyoteAdapter.java:343) ~[tomcat-embed-core-9.0.75.jar:9.0.75]
	at org.apache.coyote.http11.Http11Processor.service(Http11Processor.java:390) ~[tomcat-embed-core-9.0.75.jar:9.0.75]
	at org.apache.coyote.AbstractProcessorLight.process(AbstractProcessorLight.java:63) ~[tomcat-embed-core-9.0.75.jar:9.0.75]
	at org.apache.coyote.AbstractProtocol$ConnectionHandler.process(AbstractProtocol.java:926) ~[tomcat-embed-core-9.0.75.jar:9.0.75]
	at org.apache.tomcat.util.net.NioEndpoint$SocketProcessor.doRun(NioEndpoint.java:1791) ~[tomcat-embed-core-9.0.75.jar:9.0.75]
	at org.apache.tomcat.util.net.SocketProcessorBase.run(SocketProcessorBase.java:52) ~[tomcat-embed-core-9.0.75.jar:9.0.75]
	at org.apache.tomcat.util.threads.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1191) ~[tomcat-embed-core-9.0.75.jar:9.0.75]
	at org.apache.tomcat.util.threads.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:659) ~[tomcat-embed-core-9.0.75.jar:9.0.75]
	at org.apache.tomcat.util.threads.TaskThread$WrappingRunnable.run(TaskThread.java:61) ~[tomcat-embed-core-9.0.75.jar:9.0.75]
	at java.base/java.lang.Thread.run(Thread.java:840) ~[na:na]

19:49:05:032 DEBUG 22164 --- [http-nio-8080-exec-9] c.l.api.client.FlaskModelAnalyzeClient   : [FlaskModelAnalyzeClient#uploadFile] ---> POST http://flask-service/upload HTTP/1.1
19:49:05:032 DEBUG 22164 --- [http-nio-8080-exec-9] c.l.api.client.FlaskModelAnalyzeClient   : [FlaskModelAnalyzeClient#uploadFile] Content-Length: 67886
19:49:05:032 DEBUG 22164 --- [http-nio-8080-exec-9] c.l.api.client.FlaskModelAnalyzeClient   : [FlaskModelAnalyzeClient#uploadFile] Content-Type: multipart/form-data; charset=UTF-8; boundary=1958f562f85
19:49:05:032 DEBUG 22164 --- [http-nio-8080-exec-9] c.l.api.client.FlaskModelAnalyzeClient   : [FlaskModelAnalyzeClient#uploadFile] X-API-Key: 123456
19:49:05:032 DEBUG 22164 --- [http-nio-8080-exec-9] c.l.api.client.FlaskModelAnalyzeClient   : [FlaskModelAnalyzeClient#uploadFile] 
19:49:05:032 DEBUG 22164 --- [http-nio-8080-exec-9] c.l.api.client.FlaskModelAnalyzeClient   : [FlaskModelAnalyzeClient#uploadFile] Binary data
19:49:05:032 DEBUG 22164 --- [http-nio-8080-exec-9] c.l.api.client.FlaskModelAnalyzeClient   : [FlaskModelAnalyzeClient#uploadFile] ---> END HTTP (67886-byte body)
19:49:07:141 DEBUG 22164 --- [http-nio-8080-exec-9] c.l.api.client.FlaskModelAnalyzeClient   : [FlaskModelAnalyzeClient#uploadFile] <--- ERROR ConnectException: Connection refused: getsockopt (2108ms)
19:49:07:142 DEBUG 22164 --- [http-nio-8080-exec-9] c.l.api.client.FlaskModelAnalyzeClient   : [FlaskModelAnalyzeClient#uploadFile] java.net.ConnectException: Connection refused: getsockopt
	at java.base/sun.nio.ch.Net.pollConnect(Native Method)
	at java.base/sun.nio.ch.Net.pollConnectNow(Net.java:672)
	at java.base/sun.nio.ch.NioSocketImpl.timedFinishConnect(NioSocketImpl.java:554)
	at java.base/sun.nio.ch.NioSocketImpl.connect(NioSocketImpl.java:602)
	at java.base/java.net.Socket.connect(Socket.java:633)
	at java.base/sun.net.NetworkClient.doConnect(NetworkClient.java:178)
	at java.base/sun.net.www.http.HttpClient.openServer(HttpClient.java:533)
	at java.base/sun.net.www.http.HttpClient.openServer(HttpClient.java:638)
	at java.base/sun.net.www.http.HttpClient.<init>(HttpClient.java:281)
	at java.base/sun.net.www.http.HttpClient.New(HttpClient.java:386)
	at java.base/sun.net.www.http.HttpClient.New(HttpClient.java:408)
	at java.base/sun.net.www.protocol.http.HttpURLConnection.getNewHttpClient(HttpURLConnection.java:1309)
	at java.base/sun.net.www.protocol.http.HttpURLConnection.plainConnect0(HttpURLConnection.java:1242)
	at java.base/sun.net.www.protocol.http.HttpURLConnection.plainConnect(HttpURLConnection.java:1128)
	at java.base/sun.net.www.protocol.http.HttpURLConnection.connect(HttpURLConnection.java:1057)
	at java.base/sun.net.www.protocol.http.HttpURLConnection.getOutputStream0(HttpURLConnection.java:1451)
	at java.base/sun.net.www.protocol.http.HttpURLConnection.getOutputStream(HttpURLConnection.java:1422)
	at feign.Client$Default.convertAndSend(Client.java:208)
	at feign.Client$Default.execute(Client.java:105)
	at org.springframework.cloud.openfeign.loadbalancer.LoadBalancerUtils.executeWithLoadBalancerLifecycleProcessing(LoadBalancerUtils.java:57)
	at org.springframework.cloud.openfeign.loadbalancer.LoadBalancerUtils.executeWithLoadBalancerLifecycleProcessing(LoadBalancerUtils.java:95)
	at org.springframework.cloud.openfeign.loadbalancer.FeignBlockingLoadBalancerClient.execute(FeignBlockingLoadBalancerClient.java:114)
	at feign.SynchronousMethodHandler.executeAndDecode(SynchronousMethodHandler.java:121)
	at feign.SynchronousMethodHandler.invoke(SynchronousMethodHandler.java:91)
	at feign.ReflectiveFeign$FeignInvocationHandler.invoke(ReflectiveFeign.java:100)
	at jdk.proxy2/jdk.proxy2.$Proxy125.uploadFile(Unknown Source)
	at com.luojiawei.his_service.service.impl.UploadServiceImpl.handleFileUpload(UploadServiceImpl.java:43)
	at com.luojiawei.his_service.controller.AiModelController.testFileUpload(AiModelController.java:40)
	at java.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at java.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:77)
	at java.base/jdk.internal.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.base/java.lang.reflect.Method.invoke(Method.java:568)
	at org.springframework.web.method.support.InvocableHandlerMethod.doInvoke(InvocableHandlerMethod.java:205)
	at org.springframework.web.method.support.InvocableHandlerMethod.invokeForRequest(InvocableHandlerMethod.java:150)
	at org.springframework.web.servlet.mvc.method.annotation.ServletInvocableHandlerMethod.invokeAndHandle(ServletInvocableHandlerMethod.java:117)
	at org.springframework.web.servlet.mvc.method.annotation.RequestMappingHandlerAdapter.invokeHandlerMethod(RequestMappingHandlerAdapter.java:895)
	at org.springframework.web.servlet.mvc.method.annotation.RequestMappingHandlerAdapter.handleInternal(RequestMappingHandlerAdapter.java:808)
	at org.springframework.web.servlet.mvc.method.AbstractHandlerMethodAdapter.handle(AbstractHandlerMethodAdapter.java:87)
	at org.springframework.web.servlet.DispatcherServlet.doDispatch(DispatcherServlet.java:1072)
	at org.springframework.web.servlet.DispatcherServlet.doService(DispatcherServlet.java:965)
	at org.springframework.web.servlet.FrameworkServlet.processRequest(FrameworkServlet.java:1006)
	at org.springframework.web.servlet.FrameworkServlet.doPost(FrameworkServlet.java:909)
	at javax.servlet.http.HttpServlet.service(HttpServlet.java:555)
	at org.springframework.web.servlet.FrameworkServlet.service(FrameworkServlet.java:883)
	at javax.servlet.http.HttpServlet.service(HttpServlet.java:623)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:209)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:153)
	at com.luojiawei.his_service.filter.RefreshTokenFilter.doFilterInternal(RefreshTokenFilter.java:58)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:117)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:178)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:153)
	at org.springframework.web.filter.RequestContextFilter.doFilterInternal(RequestContextFilter.java:100)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:117)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:178)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:153)
	at org.springframework.web.filter.FormContentFilter.doFilterInternal(FormContentFilter.java:93)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:117)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:178)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:153)
	at org.springframework.boot.actuate.metrics.web.servlet.WebMvcMetricsFilter.doFilterInternal(WebMvcMetricsFilter.java:96)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:117)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:178)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:153)
	at org.springframework.web.filter.CharacterEncodingFilter.doFilterInternal(CharacterEncodingFilter.java:201)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:117)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:178)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:153)
	at org.apache.catalina.core.StandardWrapperValve.invoke(StandardWrapperValve.java:167)
	at org.apache.catalina.core.StandardContextValve.invoke(StandardContextValve.java:90)
	at org.apache.catalina.authenticator.AuthenticatorBase.invoke(AuthenticatorBase.java:481)
	at org.apache.catalina.core.StandardHostValve.invoke(StandardHostValve.java:130)
	at org.apache.catalina.valves.ErrorReportValve.invoke(ErrorReportValve.java:93)
	at org.apache.catalina.core.StandardEngineValve.invoke(StandardEngineValve.java:74)
	at org.apache.catalina.connector.CoyoteAdapter.service(CoyoteAdapter.java:343)
	at org.apache.coyote.http11.Http11Processor.service(Http11Processor.java:390)
	at org.apache.coyote.AbstractProcessorLight.process(AbstractProcessorLight.java:63)
	at org.apache.coyote.AbstractProtocol$ConnectionHandler.process(AbstractProtocol.java:926)
	at org.apache.tomcat.util.net.NioEndpoint$SocketProcessor.doRun(NioEndpoint.java:1791)
	at org.apache.tomcat.util.net.SocketProcessorBase.run(SocketProcessorBase.java:52)
	at org.apache.tomcat.util.threads.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1191)
	at org.apache.tomcat.util.threads.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:659)
	at org.apache.tomcat.util.threads.TaskThread$WrappingRunnable.run(TaskThread.java:61)
	at java.base/java.lang.Thread.run(Thread.java:840)

19:49:07:143 DEBUG 22164 --- [http-nio-8080-exec-9] c.l.api.client.FlaskModelAnalyzeClient   : [FlaskModelAnalyzeClient#uploadFile] <--- END ERROR
19:49:07:145 ERROR 22164 --- [http-nio-8080-exec-9] o.a.c.c.C.[.[.[/].[dispatcherServlet]    : Servlet.service() for servlet [dispatcherServlet] in context with path [] threw exception [Request processing failed; nested exception is java.lang.RuntimeException: ] with root cause

java.net.ConnectException: Connection refused: getsockopt
	at java.base/sun.nio.ch.Net.pollConnect(Native Method) ~[na:na]
	at java.base/sun.nio.ch.Net.pollConnectNow(Net.java:672) ~[na:na]
	at java.base/sun.nio.ch.NioSocketImpl.timedFinishConnect(NioSocketImpl.java:554) ~[na:na]
	at java.base/sun.nio.ch.NioSocketImpl.connect(NioSocketImpl.java:602) ~[na:na]
	at java.base/java.net.Socket.connect(Socket.java:633) ~[na:na]
	at java.base/sun.net.NetworkClient.doConnect(NetworkClient.java:178) ~[na:na]
	at java.base/sun.net.www.http.HttpClient.openServer(HttpClient.java:533) ~[na:na]
	at java.base/sun.net.www.http.HttpClient.openServer(HttpClient.java:638) ~[na:na]
	at java.base/sun.net.www.http.HttpClient.<init>(HttpClient.java:281) ~[na:na]
	at java.base/sun.net.www.http.HttpClient.New(HttpClient.java:386) ~[na:na]
	at java.base/sun.net.www.http.HttpClient.New(HttpClient.java:408) ~[na:na]
	at java.base/sun.net.www.protocol.http.HttpURLConnection.getNewHttpClient(HttpURLConnection.java:1309) ~[na:na]
	at java.base/sun.net.www.protocol.http.HttpURLConnection.plainConnect0(HttpURLConnection.java:1242) ~[na:na]
	at java.base/sun.net.www.protocol.http.HttpURLConnection.plainConnect(HttpURLConnection.java:1128) ~[na:na]
	at java.base/sun.net.www.protocol.http.HttpURLConnection.connect(HttpURLConnection.java:1057) ~[na:na]
	at java.base/sun.net.www.protocol.http.HttpURLConnection.getOutputStream0(HttpURLConnection.java:1451) ~[na:na]
	at java.base/sun.net.www.protocol.http.HttpURLConnection.getOutputStream(HttpURLConnection.java:1422) ~[na:na]
	at feign.Client$Default.convertAndSend(Client.java:208) ~[feign-core-11.10.jar:na]
	at feign.Client$Default.execute(Client.java:105) ~[feign-core-11.10.jar:na]
	at org.springframework.cloud.openfeign.loadbalancer.LoadBalancerUtils.executeWithLoadBalancerLifecycleProcessing(LoadBalancerUtils.java:57) ~[spring-cloud-openfeign-core-3.1.5.jar:3.1.5]
	at org.springframework.cloud.openfeign.loadbalancer.LoadBalancerUtils.executeWithLoadBalancerLifecycleProcessing(LoadBalancerUtils.java:95) ~[spring-cloud-openfeign-core-3.1.5.jar:3.1.5]
	at org.springframework.cloud.openfeign.loadbalancer.FeignBlockingLoadBalancerClient.execute(FeignBlockingLoadBalancerClient.java:114) ~[spring-cloud-openfeign-core-3.1.5.jar:3.1.5]
	at feign.SynchronousMethodHandler.executeAndDecode(SynchronousMethodHandler.java:121) ~[feign-core-11.10.jar:na]
	at feign.SynchronousMethodHandler.invoke(SynchronousMethodHandler.java:91) ~[feign-core-11.10.jar:na]
	at feign.ReflectiveFeign$FeignInvocationHandler.invoke(ReflectiveFeign.java:100) ~[feign-core-11.10.jar:na]
	at jdk.proxy2/jdk.proxy2.$Proxy125.uploadFile(Unknown Source) ~[na:na]
	at com.luojiawei.his_service.service.impl.UploadServiceImpl.handleFileUpload(UploadServiceImpl.java:43) ~[classes/:na]
	at com.luojiawei.his_service.controller.AiModelController.testFileUpload(AiModelController.java:40) ~[classes/:na]
	at java.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke0(Native Method) ~[na:na]
	at java.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:77) ~[na:na]
	at java.base/jdk.internal.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43) ~[na:na]
	at java.base/java.lang.reflect.Method.invoke(Method.java:568) ~[na:na]
	at org.springframework.web.method.support.InvocableHandlerMethod.doInvoke(InvocableHandlerMethod.java:205) ~[spring-web-5.3.27.jar:5.3.27]
	at org.springframework.web.method.support.InvocableHandlerMethod.invokeForRequest(InvocableHandlerMethod.java:150) ~[spring-web-5.3.27.jar:5.3.27]
	at org.springframework.web.servlet.mvc.method.annotation.ServletInvocableHandlerMethod.invokeAndHandle(ServletInvocableHandlerMethod.java:117) ~[spring-webmvc-5.3.27.jar:5.3.27]
	at org.springframework.web.servlet.mvc.method.annotation.RequestMappingHandlerAdapter.invokeHandlerMethod(RequestMappingHandlerAdapter.java:895) ~[spring-webmvc-5.3.27.jar:5.3.27]
	at org.springframework.web.servlet.mvc.method.annotation.RequestMappingHandlerAdapter.handleInternal(RequestMappingHandlerAdapter.java:808) ~[spring-webmvc-5.3.27.jar:5.3.27]
	at org.springframework.web.servlet.mvc.method.AbstractHandlerMethodAdapter.handle(AbstractHandlerMethodAdapter.java:87) ~[spring-webmvc-5.3.27.jar:5.3.27]
	at org.springframework.web.servlet.DispatcherServlet.doDispatch(DispatcherServlet.java:1072) ~[spring-webmvc-5.3.27.jar:5.3.27]
	at org.springframework.web.servlet.DispatcherServlet.doService(DispatcherServlet.java:965) ~[spring-webmvc-5.3.27.jar:5.3.27]
	at org.springframework.web.servlet.FrameworkServlet.processRequest(FrameworkServlet.java:1006) ~[spring-webmvc-5.3.27.jar:5.3.27]
	at org.springframework.web.servlet.FrameworkServlet.doPost(FrameworkServlet.java:909) ~[spring-webmvc-5.3.27.jar:5.3.27]
	at javax.servlet.http.HttpServlet.service(HttpServlet.java:555) ~[tomcat-embed-core-9.0.75.jar:4.0.FR]
	at org.springframework.web.servlet.FrameworkServlet.service(FrameworkServlet.java:883) ~[spring-webmvc-5.3.27.jar:5.3.27]
	at javax.servlet.http.HttpServlet.service(HttpServlet.java:623) ~[tomcat-embed-core-9.0.75.jar:4.0.FR]
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:209) ~[tomcat-embed-core-9.0.75.jar:9.0.75]
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:153) ~[tomcat-embed-core-9.0.75.jar:9.0.75]
	at com.luojiawei.his_service.filter.RefreshTokenFilter.doFilterInternal(RefreshTokenFilter.java:58) ~[classes/:na]
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:117) ~[spring-web-5.3.27.jar:5.3.27]
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:178) ~[tomcat-embed-core-9.0.75.jar:9.0.75]
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:153) ~[tomcat-embed-core-9.0.75.jar:9.0.75]
	at org.springframework.web.filter.RequestContextFilter.doFilterInternal(RequestContextFilter.java:100) ~[spring-web-5.3.27.jar:5.3.27]
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:117) ~[spring-web-5.3.27.jar:5.3.27]
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:178) ~[tomcat-embed-core-9.0.75.jar:9.0.75]
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:153) ~[tomcat-embed-core-9.0.75.jar:9.0.75]
	at org.springframework.web.filter.FormContentFilter.doFilterInternal(FormContentFilter.java:93) ~[spring-web-5.3.27.jar:5.3.27]
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:117) ~[spring-web-5.3.27.jar:5.3.27]
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:178) ~[tomcat-embed-core-9.0.75.jar:9.0.75]
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:153) ~[tomcat-embed-core-9.0.75.jar:9.0.75]
	at org.springframework.boot.actuate.metrics.web.servlet.WebMvcMetricsFilter.doFilterInternal(WebMvcMetricsFilter.java:96) ~[spring-boot-actuator-2.7.12.jar:2.7.12]
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:117) ~[spring-web-5.3.27.jar:5.3.27]
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:178) ~[tomcat-embed-core-9.0.75.jar:9.0.75]
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:153) ~[tomcat-embed-core-9.0.75.jar:9.0.75]
	at org.springframework.web.filter.CharacterEncodingFilter.doFilterInternal(CharacterEncodingFilter.java:201) ~[spring-web-5.3.27.jar:5.3.27]
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:117) ~[spring-web-5.3.27.jar:5.3.27]
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:178) ~[tomcat-embed-core-9.0.75.jar:9.0.75]
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:153) ~[tomcat-embed-core-9.0.75.jar:9.0.75]
	at org.apache.catalina.core.StandardWrapperValve.invoke(StandardWrapperValve.java:167) ~[tomcat-embed-core-9.0.75.jar:9.0.75]
	at org.apache.catalina.core.StandardContextValve.invoke(StandardContextValve.java:90) ~[tomcat-embed-core-9.0.75.jar:9.0.75]
	at org.apache.catalina.authenticator.AuthenticatorBase.invoke(AuthenticatorBase.java:481) ~[tomcat-embed-core-9.0.75.jar:9.0.75]
	at org.apache.catalina.core.StandardHostValve.invoke(StandardHostValve.java:130) ~[tomcat-embed-core-9.0.75.jar:9.0.75]
	at org.apache.catalina.valves.ErrorReportValve.invoke(ErrorReportValve.java:93) ~[tomcat-embed-core-9.0.75.jar:9.0.75]
	at org.apache.catalina.core.StandardEngineValve.invoke(StandardEngineValve.java:74) ~[tomcat-embed-core-9.0.75.jar:9.0.75]
	at org.apache.catalina.connector.CoyoteAdapter.service(CoyoteAdapter.java:343) ~[tomcat-embed-core-9.0.75.jar:9.0.75]
	at org.apache.coyote.http11.Http11Processor.service(Http11Processor.java:390) ~[tomcat-embed-core-9.0.75.jar:9.0.75]
	at org.apache.coyote.AbstractProcessorLight.process(AbstractProcessorLight.java:63) ~[tomcat-embed-core-9.0.75.jar:9.0.75]
	at org.apache.coyote.AbstractProtocol$ConnectionHandler.process(AbstractProtocol.java:926) ~[tomcat-embed-core-9.0.75.jar:9.0.75]
	at org.apache.tomcat.util.net.NioEndpoint$SocketProcessor.doRun(NioEndpoint.java:1791) ~[tomcat-embed-core-9.0.75.jar:9.0.75]
	at org.apache.tomcat.util.net.SocketProcessorBase.run(SocketProcessorBase.java:52) ~[tomcat-embed-core-9.0.75.jar:9.0.75]
	at org.apache.tomcat.util.threads.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1191) ~[tomcat-embed-core-9.0.75.jar:9.0.75]
	at org.apache.tomcat.util.threads.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:659) ~[tomcat-embed-core-9.0.75.jar:9.0.75]
	at org.apache.tomcat.util.threads.TaskThread$WrappingRunnable.run(TaskThread.java:61) ~[tomcat-embed-core-9.0.75.jar:9.0.75]
	at java.base/java.lang.Thread.run(Thread.java:840) ~[na:na]

19:52:33:917  WARN 22164 --- [Thread-15] c.a.nacos.common.notify.NotifyCenter     : [NotifyCenter] Start destroying Publisher
19:52:33:918  WARN 22164 --- [Thread-18] c.a.n.common.http.HttpClientBeanHolder   : [HttpClientBeanHolder] Start destroying common HttpClient
19:52:33:920  WARN 22164 --- [Thread-15] c.a.nacos.common.notify.NotifyCenter     : [NotifyCenter] Destruction of the end
19:52:33:930  WARN 22164 --- [Thread-18] c.a.n.common.http.HttpClientBeanHolder   : [HttpClientBeanHolder] Destruction of the end
19:52:34:392  INFO 22164 --- [SpringApplicationShutdownHook] c.a.c.n.registry.NacosServiceRegistry    : De-registering from Nacos Server now...
19:52:34:440  INFO 22164 --- [SpringApplicationShutdownHook] c.a.c.n.registry.NacosServiceRegistry    : De-registration finished.
19:52:43:803  INFO 26296 --- [main] c.l.his_service.HisServiceApplication    : Starting HisServiceApplication using Java 17.0.11 on luo with PID 26296 (A:\Desktop\workspace\HIS\his_service\target\classes started by 22407 in A:\Desktop\workspace\HIS)
19:52:43:805 DEBUG 26296 --- [main] c.l.his_service.HisServiceApplication    : Running with Spring Boot v2.7.12, Spring v5.3.27
19:52:43:805  INFO 26296 --- [main] c.l.his_service.HisServiceApplication    : The following 1 profile is active: "dev"
19:52:48:495  INFO 26296 --- [main] .s.d.r.c.RepositoryConfigurationDelegate : Multiple Spring Data modules found, entering strict repository configuration mode
19:52:48:509  INFO 26296 --- [main] .s.d.r.c.RepositoryConfigurationDelegate : Bootstrapping Spring Data Redis repositories in DEFAULT mode.
19:52:48:627  INFO 26296 --- [main] .s.d.r.c.RepositoryConfigurationDelegate : Finished Spring Data repository scanning in 30 ms. Found 0 Redis repository interfaces.
19:52:49:354  INFO 26296 --- [main] o.s.cloud.context.scope.GenericScope     : BeanFactory id=ac61872e-faec-371d-922e-ad941e5407d7
19:52:52:448  INFO 26296 --- [main] o.s.b.w.embedded.tomcat.TomcatWebServer  : Tomcat initialized with port(s): 8080 (http)
19:52:52:486  INFO 26296 --- [main] o.apache.catalina.core.StandardService   : Starting service [Tomcat]
19:52:52:487  INFO 26296 --- [main] org.apache.catalina.core.StandardEngine  : Starting Servlet engine: [Apache Tomcat/9.0.75]
19:52:52:806  INFO 26296 --- [main] o.a.c.c.C.[Tomcat].[localhost].[/]       : Initializing Spring embedded WebApplicationContext
19:52:52:807  INFO 26296 --- [main] w.s.c.ServletWebServerApplicationContext : Root WebApplicationContext: initialization completed in 8808 ms
19:52:53:691  INFO 26296 --- [main] org.redisson.Version                     : Redisson 3.17.7
19:52:54:519  INFO 26296 --- [redisson-netty-2-9] o.r.c.pool.MasterPubSubConnectionPool    : 1 connections initialized for 111.230.32.147/111.230.32.147:9631
19:52:55:268  INFO 26296 --- [redisson-netty-2-19] o.r.c.pool.MasterConnectionPool          : 24 connections initialized for 111.230.32.147/111.230.32.147:9631
19:52:55:929 DEBUG 26296 --- [main] c.l.h.filter.RefreshTokenFilter          : Filter 'refreshTokenFilter' configured for use
19:52:57:621  INFO 26296 --- [main] o.s.c.openfeign.FeignClientFactoryBean   : For 'flask-service' URL not provided. Will try picking an instance via load-balancing.
19:52:57:778  INFO 26296 --- [main] o.s.c.openfeign.FeignClientFactoryBean   : For 'ai-service' URL not provided. Will try picking an instance via load-balancing.
19:52:57:832  WARN 26296 --- [main] c.b.m.core.metadata.TableInfoHelper      : Can not find table primary key in Class: "java.lang.Object".
19:52:57:833  WARN 26296 --- [main] c.b.m.core.injector.DefaultSqlInjector   : class java.lang.Object ,Not found @TableId annotation, Cannot use Mybatis-Plus 'xxById' Method.
19:53:00:556  WARN 26296 --- [main] iguration$LoadBalancerCaffeineWarnLogger : Spring Cloud LoadBalancer is currently working with the default cache. While this cache implementation is useful for development and tests, it's recommended to use Caffeine cache in production.You can switch to using Caffeine cache, by adding it and org.springframework.cache.caffeine.CaffeineCacheManager to the classpath.
19:53:00:564  INFO 26296 --- [main] o.s.b.a.e.web.EndpointLinksResolver      : Exposing 1 endpoint(s) beneath base path '/actuator'
19:53:00:680  INFO 26296 --- [main] o.s.b.w.embedded.tomcat.TomcatWebServer  : Tomcat started on port(s): 8080 (http) with context path ''
19:53:00:762  INFO 26296 --- [main] c.a.n.p.a.s.c.ClientAuthPluginManager    : [ClientAuthPluginManager] Load ClientAuthService com.alibaba.nacos.client.auth.impl.NacosClientAuthServiceImpl success.
19:53:00:762  INFO 26296 --- [main] c.a.n.p.a.s.c.ClientAuthPluginManager    : [ClientAuthPluginManager] Load ClientAuthService com.alibaba.nacos.client.auth.ram.RamClientAuthServiceImpl success.
19:53:03:627  INFO 26296 --- [main] c.a.n.c.a.AbstractAbilityControlManager  : Ready to get current node abilities...
19:53:03:629  INFO 26296 --- [main] c.a.n.c.a.AbstractAbilityControlManager  : Ready to initialize current node abilities, support modes: [SDK_CLIENT]
19:53:03:629  INFO 26296 --- [main] c.a.n.c.a.AbstractAbilityControlManager  : Initialize current abilities finish...
19:53:03:630  INFO 26296 --- [main] c.a.n.c.a.d.NacosAbilityManagerHolder    : [AbilityControlManager] Successfully initialize AbilityControlManager
19:53:03:762  INFO 26296 --- [main] c.a.c.n.registry.NacosServiceRegistry    : nacos registry, DEFAULT_GROUP his-service 10.21.93.70:8848 register finished
19:53:04:116  INFO 26296 --- [main] c.l.his_service.HisServiceApplication    : Started HisServiceApplication in 22.336 seconds (JVM running for 25.736)
19:57:54:835  WARN 26296 --- [Thread-18] c.a.n.common.http.HttpClientBeanHolder   : [HttpClientBeanHolder] Start destroying common HttpClient
19:57:54:835  WARN 26296 --- [Thread-15] c.a.nacos.common.notify.NotifyCenter     : [NotifyCenter] Start destroying Publisher
19:57:54:839  WARN 26296 --- [Thread-15] c.a.nacos.common.notify.NotifyCenter     : [NotifyCenter] Destruction of the end
19:57:54:842  WARN 26296 --- [Thread-18] c.a.n.common.http.HttpClientBeanHolder   : [HttpClientBeanHolder] Destruction of the end
19:57:54:907  INFO 26296 --- [SpringApplicationShutdownHook] c.a.c.n.registry.NacosServiceRegistry    : De-registering from Nacos Server now...
19:57:54:938  INFO 26296 --- [SpringApplicationShutdownHook] c.a.c.n.registry.NacosServiceRegistry    : De-registration finished.
19:58:00:190  INFO 37296 --- [main] c.l.his_service.HisServiceApplication    : Starting HisServiceApplication using Java 17.0.11 on luo with PID 37296 (A:\Desktop\workspace\HIS\his_service\target\classes started by 22407 in A:\Desktop\workspace\HIS)
19:58:00:191 DEBUG 37296 --- [main] c.l.his_service.HisServiceApplication    : Running with Spring Boot v2.7.12, Spring v5.3.27
19:58:00:191  INFO 37296 --- [main] c.l.his_service.HisServiceApplication    : The following 1 profile is active: "dev"
19:58:01:314  INFO 37296 --- [main] .s.d.r.c.RepositoryConfigurationDelegate : Multiple Spring Data modules found, entering strict repository configuration mode
19:58:01:317  INFO 37296 --- [main] .s.d.r.c.RepositoryConfigurationDelegate : Bootstrapping Spring Data Redis repositories in DEFAULT mode.
19:58:01:347  INFO 37296 --- [main] .s.d.r.c.RepositoryConfigurationDelegate : Finished Spring Data repository scanning in 15 ms. Found 0 Redis repository interfaces.
19:58:01:677  INFO 37296 --- [main] o.s.cloud.context.scope.GenericScope     : BeanFactory id=ac61872e-faec-371d-922e-ad941e5407d7
19:58:03:383  INFO 37296 --- [main] o.s.b.w.embedded.tomcat.TomcatWebServer  : Tomcat initialized with port(s): 8080 (http)
19:58:03:412  INFO 37296 --- [main] o.apache.catalina.core.StandardService   : Starting service [Tomcat]
19:58:03:412  INFO 37296 --- [main] org.apache.catalina.core.StandardEngine  : Starting Servlet engine: [Apache Tomcat/9.0.75]
19:58:03:704  INFO 37296 --- [main] o.a.c.c.C.[Tomcat].[localhost].[/]       : Initializing Spring embedded WebApplicationContext
19:58:03:705  INFO 37296 --- [main] w.s.c.ServletWebServerApplicationContext : Root WebApplicationContext: initialization completed in 3467 ms
19:58:03:997  INFO 37296 --- [main] org.redisson.Version                     : Redisson 3.17.7
19:58:04:573  INFO 37296 --- [redisson-netty-2-9] o.r.c.pool.MasterPubSubConnectionPool    : 1 connections initialized for 111.230.32.147/111.230.32.147:9631
19:58:05:773  INFO 37296 --- [redisson-netty-2-18] o.r.c.pool.MasterConnectionPool          : 24 connections initialized for 111.230.32.147/111.230.32.147:9631
19:58:06:122 DEBUG 37296 --- [main] c.l.h.filter.RefreshTokenFilter          : Filter 'refreshTokenFilter' configured for use
19:58:07:044  INFO 37296 --- [main] o.s.c.openfeign.FeignClientFactoryBean   : For 'flask-service' URL not provided. Will try picking an instance via load-balancing.
19:58:07:190  INFO 37296 --- [main] o.s.c.openfeign.FeignClientFactoryBean   : For 'ai-service' URL not provided. Will try picking an instance via load-balancing.
19:58:07:247  WARN 37296 --- [main] c.b.m.core.metadata.TableInfoHelper      : Can not find table primary key in Class: "java.lang.Object".
19:58:07:247  WARN 37296 --- [main] c.b.m.core.injector.DefaultSqlInjector   : class java.lang.Object ,Not found @TableId annotation, Cannot use Mybatis-Plus 'xxById' Method.
19:58:09:262  WARN 37296 --- [main] iguration$LoadBalancerCaffeineWarnLogger : Spring Cloud LoadBalancer is currently working with the default cache. While this cache implementation is useful for development and tests, it's recommended to use Caffeine cache in production.You can switch to using Caffeine cache, by adding it and org.springframework.cache.caffeine.CaffeineCacheManager to the classpath.
19:58:09:277  INFO 37296 --- [main] o.s.b.a.e.web.EndpointLinksResolver      : Exposing 1 endpoint(s) beneath base path '/actuator'
19:58:09:422  INFO 37296 --- [main] o.s.b.w.embedded.tomcat.TomcatWebServer  : Tomcat started on port(s): 8080 (http) with context path ''
19:58:09:501  INFO 37296 --- [main] c.a.n.p.a.s.c.ClientAuthPluginManager    : [ClientAuthPluginManager] Load ClientAuthService com.alibaba.nacos.client.auth.impl.NacosClientAuthServiceImpl success.
19:58:09:502  INFO 37296 --- [main] c.a.n.p.a.s.c.ClientAuthPluginManager    : [ClientAuthPluginManager] Load ClientAuthService com.alibaba.nacos.client.auth.ram.RamClientAuthServiceImpl success.
19:58:10:629  INFO 37296 --- [main] c.a.n.c.a.AbstractAbilityControlManager  : Ready to get current node abilities...
19:58:10:630  INFO 37296 --- [main] c.a.n.c.a.AbstractAbilityControlManager  : Ready to initialize current node abilities, support modes: [SDK_CLIENT]
19:58:10:631  INFO 37296 --- [main] c.a.n.c.a.AbstractAbilityControlManager  : Initialize current abilities finish...
19:58:10:632  INFO 37296 --- [main] c.a.n.c.a.d.NacosAbilityManagerHolder    : [AbilityControlManager] Successfully initialize AbilityControlManager
19:58:10:686  INFO 37296 --- [main] c.a.c.n.registry.NacosServiceRegistry    : nacos registry, DEFAULT_GROUP his-service 10.21.93.70:8848 register finished
19:58:10:977  INFO 37296 --- [main] c.l.his_service.HisServiceApplication    : Started HisServiceApplication in 11.819 seconds (JVM running for 13.121)
19:58:11:458  INFO 37296 --- [RMI TCP Connection(1)-10.21.93.70] o.a.c.c.C.[Tomcat].[localhost].[/]       : Initializing Spring DispatcherServlet 'dispatcherServlet'
19:58:11:459  INFO 37296 --- [RMI TCP Connection(1)-10.21.93.70] o.s.web.servlet.DispatcherServlet        : Initializing Servlet 'dispatcherServlet'
19:58:11:462  INFO 37296 --- [RMI TCP Connection(1)-10.21.93.70] o.s.web.servlet.DispatcherServlet        : Completed initialization in 3 ms
19:58:11:463  INFO 37296 --- [RMI TCP Connection(2)-10.21.93.70] com.zaxxer.hikari.HikariDataSource       : HikariPool-1 - Starting...
19:58:12:335  INFO 37296 --- [RMI TCP Connection(2)-10.21.93.70] com.zaxxer.hikari.HikariDataSource       : HikariPool-1 - Start completed.
19:58:16:264 DEBUG 37296 --- [http-nio-8080-exec-2] c.l.api.client.FlaskModelAnalyzeClient   : [FlaskModelAnalyzeClient#uploadFile] ---> POST http://flask-service/upload HTTP/1.1
19:58:16:265 DEBUG 37296 --- [http-nio-8080-exec-2] c.l.api.client.FlaskModelAnalyzeClient   : [FlaskModelAnalyzeClient#uploadFile] Content-Length: 67886
19:58:16:265 DEBUG 37296 --- [http-nio-8080-exec-2] c.l.api.client.FlaskModelAnalyzeClient   : [FlaskModelAnalyzeClient#uploadFile] Content-Type: multipart/form-data; charset=UTF-8; boundary=1958f5e98c3
19:58:16:265 DEBUG 37296 --- [http-nio-8080-exec-2] c.l.api.client.FlaskModelAnalyzeClient   : [FlaskModelAnalyzeClient#uploadFile] X-API-Key: 123456
19:58:16:265 DEBUG 37296 --- [http-nio-8080-exec-2] c.l.api.client.FlaskModelAnalyzeClient   : [FlaskModelAnalyzeClient#uploadFile] 
19:58:16:265 DEBUG 37296 --- [http-nio-8080-exec-2] c.l.api.client.FlaskModelAnalyzeClient   : [FlaskModelAnalyzeClient#uploadFile] Binary data
19:58:16:265 DEBUG 37296 --- [http-nio-8080-exec-2] c.l.api.client.FlaskModelAnalyzeClient   : [FlaskModelAnalyzeClient#uploadFile] ---> END HTTP (67886-byte body)
19:58:18:468 DEBUG 37296 --- [http-nio-8080-exec-2] c.l.api.client.FlaskModelAnalyzeClient   : [FlaskModelAnalyzeClient#uploadFile] <--- ERROR ConnectException: Connection refused: getsockopt (2202ms)
19:58:18:470 DEBUG 37296 --- [http-nio-8080-exec-2] c.l.api.client.FlaskModelAnalyzeClient   : [FlaskModelAnalyzeClient#uploadFile] java.net.ConnectException: Connection refused: getsockopt
	at java.base/sun.nio.ch.Net.pollConnect(Native Method)
	at java.base/sun.nio.ch.Net.pollConnectNow(Net.java:672)
	at java.base/sun.nio.ch.NioSocketImpl.timedFinishConnect(NioSocketImpl.java:554)
	at java.base/sun.nio.ch.NioSocketImpl.connect(NioSocketImpl.java:602)
	at java.base/java.net.Socket.connect(Socket.java:633)
	at java.base/sun.net.NetworkClient.doConnect(NetworkClient.java:178)
	at java.base/sun.net.www.http.HttpClient.openServer(HttpClient.java:533)
	at java.base/sun.net.www.http.HttpClient.openServer(HttpClient.java:638)
	at java.base/sun.net.www.http.HttpClient.<init>(HttpClient.java:281)
	at java.base/sun.net.www.http.HttpClient.New(HttpClient.java:386)
	at java.base/sun.net.www.http.HttpClient.New(HttpClient.java:408)
	at java.base/sun.net.www.protocol.http.HttpURLConnection.getNewHttpClient(HttpURLConnection.java:1309)
	at java.base/sun.net.www.protocol.http.HttpURLConnection.plainConnect0(HttpURLConnection.java:1242)
	at java.base/sun.net.www.protocol.http.HttpURLConnection.plainConnect(HttpURLConnection.java:1128)
	at java.base/sun.net.www.protocol.http.HttpURLConnection.connect(HttpURLConnection.java:1057)
	at java.base/sun.net.www.protocol.http.HttpURLConnection.getOutputStream0(HttpURLConnection.java:1451)
	at java.base/sun.net.www.protocol.http.HttpURLConnection.getOutputStream(HttpURLConnection.java:1422)
	at feign.Client$Default.convertAndSend(Client.java:208)
	at feign.Client$Default.execute(Client.java:105)
	at org.springframework.cloud.openfeign.loadbalancer.LoadBalancerUtils.executeWithLoadBalancerLifecycleProcessing(LoadBalancerUtils.java:57)
	at org.springframework.cloud.openfeign.loadbalancer.LoadBalancerUtils.executeWithLoadBalancerLifecycleProcessing(LoadBalancerUtils.java:95)
	at org.springframework.cloud.openfeign.loadbalancer.FeignBlockingLoadBalancerClient.execute(FeignBlockingLoadBalancerClient.java:114)
	at feign.SynchronousMethodHandler.executeAndDecode(SynchronousMethodHandler.java:121)
	at feign.SynchronousMethodHandler.invoke(SynchronousMethodHandler.java:91)
	at feign.ReflectiveFeign$FeignInvocationHandler.invoke(ReflectiveFeign.java:100)
	at jdk.proxy2/jdk.proxy2.$Proxy125.uploadFile(Unknown Source)
	at com.luojiawei.his_service.service.impl.UploadServiceImpl.handleFileUpload(UploadServiceImpl.java:43)
	at com.luojiawei.his_service.controller.AiModelController.testFileUpload(AiModelController.java:40)
	at java.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at java.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:77)
	at java.base/jdk.internal.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.base/java.lang.reflect.Method.invoke(Method.java:568)
	at org.springframework.web.method.support.InvocableHandlerMethod.doInvoke(InvocableHandlerMethod.java:205)
	at org.springframework.web.method.support.InvocableHandlerMethod.invokeForRequest(InvocableHandlerMethod.java:150)
	at org.springframework.web.servlet.mvc.method.annotation.ServletInvocableHandlerMethod.invokeAndHandle(ServletInvocableHandlerMethod.java:117)
	at org.springframework.web.servlet.mvc.method.annotation.RequestMappingHandlerAdapter.invokeHandlerMethod(RequestMappingHandlerAdapter.java:895)
	at org.springframework.web.servlet.mvc.method.annotation.RequestMappingHandlerAdapter.handleInternal(RequestMappingHandlerAdapter.java:808)
	at org.springframework.web.servlet.mvc.method.AbstractHandlerMethodAdapter.handle(AbstractHandlerMethodAdapter.java:87)
	at org.springframework.web.servlet.DispatcherServlet.doDispatch(DispatcherServlet.java:1072)
	at org.springframework.web.servlet.DispatcherServlet.doService(DispatcherServlet.java:965)
	at org.springframework.web.servlet.FrameworkServlet.processRequest(FrameworkServlet.java:1006)
	at org.springframework.web.servlet.FrameworkServlet.doPost(FrameworkServlet.java:909)
	at javax.servlet.http.HttpServlet.service(HttpServlet.java:555)
	at org.springframework.web.servlet.FrameworkServlet.service(FrameworkServlet.java:883)
	at javax.servlet.http.HttpServlet.service(HttpServlet.java:623)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:209)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:153)
	at com.luojiawei.his_service.filter.RefreshTokenFilter.doFilterInternal(RefreshTokenFilter.java:58)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:117)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:178)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:153)
	at org.springframework.web.filter.RequestContextFilter.doFilterInternal(RequestContextFilter.java:100)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:117)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:178)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:153)
	at org.springframework.web.filter.FormContentFilter.doFilterInternal(FormContentFilter.java:93)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:117)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:178)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:153)
	at org.springframework.boot.actuate.metrics.web.servlet.WebMvcMetricsFilter.doFilterInternal(WebMvcMetricsFilter.java:96)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:117)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:178)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:153)
	at org.springframework.web.filter.CharacterEncodingFilter.doFilterInternal(CharacterEncodingFilter.java:201)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:117)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:178)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:153)
	at org.apache.catalina.core.StandardWrapperValve.invoke(StandardWrapperValve.java:167)
	at org.apache.catalina.core.StandardContextValve.invoke(StandardContextValve.java:90)
	at org.apache.catalina.authenticator.AuthenticatorBase.invoke(AuthenticatorBase.java:481)
	at org.apache.catalina.core.StandardHostValve.invoke(StandardHostValve.java:130)
	at org.apache.catalina.valves.ErrorReportValve.invoke(ErrorReportValve.java:93)
	at org.apache.catalina.core.StandardEngineValve.invoke(StandardEngineValve.java:74)
	at org.apache.catalina.connector.CoyoteAdapter.service(CoyoteAdapter.java:343)
	at org.apache.coyote.http11.Http11Processor.service(Http11Processor.java:390)
	at org.apache.coyote.AbstractProcessorLight.process(AbstractProcessorLight.java:63)
	at org.apache.coyote.AbstractProtocol$ConnectionHandler.process(AbstractProtocol.java:926)
	at org.apache.tomcat.util.net.NioEndpoint$SocketProcessor.doRun(NioEndpoint.java:1791)
	at org.apache.tomcat.util.net.SocketProcessorBase.run(SocketProcessorBase.java:52)
	at org.apache.tomcat.util.threads.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1191)
	at org.apache.tomcat.util.threads.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:659)
	at org.apache.tomcat.util.threads.TaskThread$WrappingRunnable.run(TaskThread.java:61)
	at java.base/java.lang.Thread.run(Thread.java:840)

19:58:18:470 DEBUG 37296 --- [http-nio-8080-exec-2] c.l.api.client.FlaskModelAnalyzeClient   : [FlaskModelAnalyzeClient#uploadFile] <--- END ERROR
19:58:18:500 ERROR 37296 --- [http-nio-8080-exec-2] o.a.c.c.C.[.[.[/].[dispatcherServlet]    : Servlet.service() for servlet [dispatcherServlet] in context with path [] threw exception [Request processing failed; nested exception is java.lang.RuntimeException: ] with root cause

java.net.ConnectException: Connection refused: getsockopt
	at java.base/sun.nio.ch.Net.pollConnect(Native Method) ~[na:na]
	at java.base/sun.nio.ch.Net.pollConnectNow(Net.java:672) ~[na:na]
	at java.base/sun.nio.ch.NioSocketImpl.timedFinishConnect(NioSocketImpl.java:554) ~[na:na]
	at java.base/sun.nio.ch.NioSocketImpl.connect(NioSocketImpl.java:602) ~[na:na]
	at java.base/java.net.Socket.connect(Socket.java:633) ~[na:na]
	at java.base/sun.net.NetworkClient.doConnect(NetworkClient.java:178) ~[na:na]
	at java.base/sun.net.www.http.HttpClient.openServer(HttpClient.java:533) ~[na:na]
	at java.base/sun.net.www.http.HttpClient.openServer(HttpClient.java:638) ~[na:na]
	at java.base/sun.net.www.http.HttpClient.<init>(HttpClient.java:281) ~[na:na]
	at java.base/sun.net.www.http.HttpClient.New(HttpClient.java:386) ~[na:na]
	at java.base/sun.net.www.http.HttpClient.New(HttpClient.java:408) ~[na:na]
	at java.base/sun.net.www.protocol.http.HttpURLConnection.getNewHttpClient(HttpURLConnection.java:1309) ~[na:na]
	at java.base/sun.net.www.protocol.http.HttpURLConnection.plainConnect0(HttpURLConnection.java:1242) ~[na:na]
	at java.base/sun.net.www.protocol.http.HttpURLConnection.plainConnect(HttpURLConnection.java:1128) ~[na:na]
	at java.base/sun.net.www.protocol.http.HttpURLConnection.connect(HttpURLConnection.java:1057) ~[na:na]
	at java.base/sun.net.www.protocol.http.HttpURLConnection.getOutputStream0(HttpURLConnection.java:1451) ~[na:na]
	at java.base/sun.net.www.protocol.http.HttpURLConnection.getOutputStream(HttpURLConnection.java:1422) ~[na:na]
	at feign.Client$Default.convertAndSend(Client.java:208) ~[feign-core-11.10.jar:na]
	at feign.Client$Default.execute(Client.java:105) ~[feign-core-11.10.jar:na]
	at org.springframework.cloud.openfeign.loadbalancer.LoadBalancerUtils.executeWithLoadBalancerLifecycleProcessing(LoadBalancerUtils.java:57) ~[spring-cloud-openfeign-core-3.1.5.jar:3.1.5]
	at org.springframework.cloud.openfeign.loadbalancer.LoadBalancerUtils.executeWithLoadBalancerLifecycleProcessing(LoadBalancerUtils.java:95) ~[spring-cloud-openfeign-core-3.1.5.jar:3.1.5]
	at org.springframework.cloud.openfeign.loadbalancer.FeignBlockingLoadBalancerClient.execute(FeignBlockingLoadBalancerClient.java:114) ~[spring-cloud-openfeign-core-3.1.5.jar:3.1.5]
	at feign.SynchronousMethodHandler.executeAndDecode(SynchronousMethodHandler.java:121) ~[feign-core-11.10.jar:na]
	at feign.SynchronousMethodHandler.invoke(SynchronousMethodHandler.java:91) ~[feign-core-11.10.jar:na]
	at feign.ReflectiveFeign$FeignInvocationHandler.invoke(ReflectiveFeign.java:100) ~[feign-core-11.10.jar:na]
	at jdk.proxy2/jdk.proxy2.$Proxy125.uploadFile(Unknown Source) ~[na:na]
	at com.luojiawei.his_service.service.impl.UploadServiceImpl.handleFileUpload(UploadServiceImpl.java:43) ~[classes/:na]
	at com.luojiawei.his_service.controller.AiModelController.testFileUpload(AiModelController.java:40) ~[classes/:na]
	at java.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke0(Native Method) ~[na:na]
	at java.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:77) ~[na:na]
	at java.base/jdk.internal.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43) ~[na:na]
	at java.base/java.lang.reflect.Method.invoke(Method.java:568) ~[na:na]
	at org.springframework.web.method.support.InvocableHandlerMethod.doInvoke(InvocableHandlerMethod.java:205) ~[spring-web-5.3.27.jar:5.3.27]
	at org.springframework.web.method.support.InvocableHandlerMethod.invokeForRequest(InvocableHandlerMethod.java:150) ~[spring-web-5.3.27.jar:5.3.27]
	at org.springframework.web.servlet.mvc.method.annotation.ServletInvocableHandlerMethod.invokeAndHandle(ServletInvocableHandlerMethod.java:117) ~[spring-webmvc-5.3.27.jar:5.3.27]
	at org.springframework.web.servlet.mvc.method.annotation.RequestMappingHandlerAdapter.invokeHandlerMethod(RequestMappingHandlerAdapter.java:895) ~[spring-webmvc-5.3.27.jar:5.3.27]
	at org.springframework.web.servlet.mvc.method.annotation.RequestMappingHandlerAdapter.handleInternal(RequestMappingHandlerAdapter.java:808) ~[spring-webmvc-5.3.27.jar:5.3.27]
	at org.springframework.web.servlet.mvc.method.AbstractHandlerMethodAdapter.handle(AbstractHandlerMethodAdapter.java:87) ~[spring-webmvc-5.3.27.jar:5.3.27]
	at org.springframework.web.servlet.DispatcherServlet.doDispatch(DispatcherServlet.java:1072) ~[spring-webmvc-5.3.27.jar:5.3.27]
	at org.springframework.web.servlet.DispatcherServlet.doService(DispatcherServlet.java:965) ~[spring-webmvc-5.3.27.jar:5.3.27]
	at org.springframework.web.servlet.FrameworkServlet.processRequest(FrameworkServlet.java:1006) ~[spring-webmvc-5.3.27.jar:5.3.27]
	at org.springframework.web.servlet.FrameworkServlet.doPost(FrameworkServlet.java:909) ~[spring-webmvc-5.3.27.jar:5.3.27]
	at javax.servlet.http.HttpServlet.service(HttpServlet.java:555) ~[tomcat-embed-core-9.0.75.jar:4.0.FR]
	at org.springframework.web.servlet.FrameworkServlet.service(FrameworkServlet.java:883) ~[spring-webmvc-5.3.27.jar:5.3.27]
	at javax.servlet.http.HttpServlet.service(HttpServlet.java:623) ~[tomcat-embed-core-9.0.75.jar:4.0.FR]
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:209) ~[tomcat-embed-core-9.0.75.jar:9.0.75]
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:153) ~[tomcat-embed-core-9.0.75.jar:9.0.75]
	at com.luojiawei.his_service.filter.RefreshTokenFilter.doFilterInternal(RefreshTokenFilter.java:58) ~[classes/:na]
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:117) ~[spring-web-5.3.27.jar:5.3.27]
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:178) ~[tomcat-embed-core-9.0.75.jar:9.0.75]
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:153) ~[tomcat-embed-core-9.0.75.jar:9.0.75]
	at org.springframework.web.filter.RequestContextFilter.doFilterInternal(RequestContextFilter.java:100) ~[spring-web-5.3.27.jar:5.3.27]
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:117) ~[spring-web-5.3.27.jar:5.3.27]
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:178) ~[tomcat-embed-core-9.0.75.jar:9.0.75]
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:153) ~[tomcat-embed-core-9.0.75.jar:9.0.75]
	at org.springframework.web.filter.FormContentFilter.doFilterInternal(FormContentFilter.java:93) ~[spring-web-5.3.27.jar:5.3.27]
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:117) ~[spring-web-5.3.27.jar:5.3.27]
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:178) ~[tomcat-embed-core-9.0.75.jar:9.0.75]
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:153) ~[tomcat-embed-core-9.0.75.jar:9.0.75]
	at org.springframework.boot.actuate.metrics.web.servlet.WebMvcMetricsFilter.doFilterInternal(WebMvcMetricsFilter.java:96) ~[spring-boot-actuator-2.7.12.jar:2.7.12]
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:117) ~[spring-web-5.3.27.jar:5.3.27]
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:178) ~[tomcat-embed-core-9.0.75.jar:9.0.75]
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:153) ~[tomcat-embed-core-9.0.75.jar:9.0.75]
	at org.springframework.web.filter.CharacterEncodingFilter.doFilterInternal(CharacterEncodingFilter.java:201) ~[spring-web-5.3.27.jar:5.3.27]
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:117) ~[spring-web-5.3.27.jar:5.3.27]
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:178) ~[tomcat-embed-core-9.0.75.jar:9.0.75]
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:153) ~[tomcat-embed-core-9.0.75.jar:9.0.75]
	at org.apache.catalina.core.StandardWrapperValve.invoke(StandardWrapperValve.java:167) ~[tomcat-embed-core-9.0.75.jar:9.0.75]
	at org.apache.catalina.core.StandardContextValve.invoke(StandardContextValve.java:90) ~[tomcat-embed-core-9.0.75.jar:9.0.75]
	at org.apache.catalina.authenticator.AuthenticatorBase.invoke(AuthenticatorBase.java:481) ~[tomcat-embed-core-9.0.75.jar:9.0.75]
	at org.apache.catalina.core.StandardHostValve.invoke(StandardHostValve.java:130) ~[tomcat-embed-core-9.0.75.jar:9.0.75]
	at org.apache.catalina.valves.ErrorReportValve.invoke(ErrorReportValve.java:93) ~[tomcat-embed-core-9.0.75.jar:9.0.75]
	at org.apache.catalina.core.StandardEngineValve.invoke(StandardEngineValve.java:74) ~[tomcat-embed-core-9.0.75.jar:9.0.75]
	at org.apache.catalina.connector.CoyoteAdapter.service(CoyoteAdapter.java:343) ~[tomcat-embed-core-9.0.75.jar:9.0.75]
	at org.apache.coyote.http11.Http11Processor.service(Http11Processor.java:390) ~[tomcat-embed-core-9.0.75.jar:9.0.75]
	at org.apache.coyote.AbstractProcessorLight.process(AbstractProcessorLight.java:63) ~[tomcat-embed-core-9.0.75.jar:9.0.75]
	at org.apache.coyote.AbstractProtocol$ConnectionHandler.process(AbstractProtocol.java:926) ~[tomcat-embed-core-9.0.75.jar:9.0.75]
	at org.apache.tomcat.util.net.NioEndpoint$SocketProcessor.doRun(NioEndpoint.java:1791) ~[tomcat-embed-core-9.0.75.jar:9.0.75]
	at org.apache.tomcat.util.net.SocketProcessorBase.run(SocketProcessorBase.java:52) ~[tomcat-embed-core-9.0.75.jar:9.0.75]
	at org.apache.tomcat.util.threads.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1191) ~[tomcat-embed-core-9.0.75.jar:9.0.75]
	at org.apache.tomcat.util.threads.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:659) ~[tomcat-embed-core-9.0.75.jar:9.0.75]
	at org.apache.tomcat.util.threads.TaskThread$WrappingRunnable.run(TaskThread.java:61) ~[tomcat-embed-core-9.0.75.jar:9.0.75]
	at java.base/java.lang.Thread.run(Thread.java:840) ~[na:na]

20:00:03:944  WARN 37296 --- [Thread-18] c.a.n.common.http.HttpClientBeanHolder   : [HttpClientBeanHolder] Start destroying common HttpClient
20:00:03:944  WARN 37296 --- [Thread-15] c.a.nacos.common.notify.NotifyCenter     : [NotifyCenter] Start destroying Publisher
20:00:03:944  WARN 37296 --- [Thread-15] c.a.nacos.common.notify.NotifyCenter     : [NotifyCenter] Destruction of the end
20:00:03:945  WARN 37296 --- [Thread-18] c.a.n.common.http.HttpClientBeanHolder   : [HttpClientBeanHolder] Destruction of the end
20:00:04:013  INFO 37296 --- [SpringApplicationShutdownHook] c.a.c.n.registry.NacosServiceRegistry    : De-registering from Nacos Server now...
20:00:04:040  INFO 37296 --- [SpringApplicationShutdownHook] c.a.c.n.registry.NacosServiceRegistry    : De-registration finished.
20:00:04:062  INFO 37296 --- [SpringApplicationShutdownHook] com.zaxxer.hikari.HikariDataSource       : HikariPool-1 - Shutdown initiated...
20:00:04:430  INFO 37296 --- [SpringApplicationShutdownHook] com.zaxxer.hikari.HikariDataSource       : HikariPool-1 - Shutdown completed.
20:00:11:257  INFO 6020 --- [main] c.l.his_service.HisServiceApplication    : Starting HisServiceApplication using Java 17.0.11 on luo with PID 6020 (A:\Desktop\workspace\HIS\his_service\target\classes started by 22407 in A:\Desktop\workspace\HIS)
20:00:11:259 DEBUG 6020 --- [main] c.l.his_service.HisServiceApplication    : Running with Spring Boot v2.7.12, Spring v5.3.27
20:00:11:259  INFO 6020 --- [main] c.l.his_service.HisServiceApplication    : The following 1 profile is active: "dev"
20:00:12:364  INFO 6020 --- [main] .s.d.r.c.RepositoryConfigurationDelegate : Multiple Spring Data modules found, entering strict repository configuration mode
20:00:12:367  INFO 6020 --- [main] .s.d.r.c.RepositoryConfigurationDelegate : Bootstrapping Spring Data Redis repositories in DEFAULT mode.
20:00:12:394  INFO 6020 --- [main] .s.d.r.c.RepositoryConfigurationDelegate : Finished Spring Data repository scanning in 15 ms. Found 0 Redis repository interfaces.
20:00:12:758  INFO 6020 --- [main] o.s.cloud.context.scope.GenericScope     : BeanFactory id=ac61872e-faec-371d-922e-ad941e5407d7
20:00:13:389  INFO 6020 --- [main] o.s.b.w.embedded.tomcat.TomcatWebServer  : Tomcat initialized with port(s): 8080 (http)
20:00:13:397  INFO 6020 --- [main] o.apache.catalina.core.StandardService   : Starting service [Tomcat]
20:00:13:397  INFO 6020 --- [main] org.apache.catalina.core.StandardEngine  : Starting Servlet engine: [Apache Tomcat/9.0.75]
20:00:13:545  INFO 6020 --- [main] o.a.c.c.C.[Tomcat].[localhost].[/]       : Initializing Spring embedded WebApplicationContext
20:00:13:546  INFO 6020 --- [main] w.s.c.ServletWebServerApplicationContext : Root WebApplicationContext: initialization completed in 2232 ms
20:00:13:817  INFO 6020 --- [main] org.redisson.Version                     : Redisson 3.17.7
20:00:14:321  INFO 6020 --- [redisson-netty-2-9] o.r.c.pool.MasterPubSubConnectionPool    : 1 connections initialized for 111.230.32.147/111.230.32.147:9631
20:00:15:003  INFO 6020 --- [redisson-netty-2-19] o.r.c.pool.MasterConnectionPool          : 24 connections initialized for 111.230.32.147/111.230.32.147:9631
20:00:15:311 DEBUG 6020 --- [main] c.l.h.filter.RefreshTokenFilter          : Filter 'refreshTokenFilter' configured for use
20:00:15:920  WARN 6020 --- [main] ConfigServletWebServerApplicationContext : Exception encountered during context initialization - cancelling refresh attempt: org.springframework.beans.factory.UnsatisfiedDependencyException: Error creating bean with name 'aiModelController' defined in file [A:\Desktop\workspace\HIS\his_service\target\classes\com\luojiawei\his_service\controller\AiModelController.class]: Unsatisfied dependency expressed through constructor parameter 0; nested exception is org.springframework.beans.factory.UnsatisfiedDependencyException: Error creating bean with name 'uploadServiceImpl' defined in file [A:\Desktop\workspace\HIS\his_service\target\classes\com\luojiawei\his_service\service\impl\UploadServiceImpl.class]: Unsatisfied dependency expressed through constructor parameter 1; nested exception is org.springframework.beans.factory.BeanCreationException: Error creating bean with name 'com.luojiawei.api.client.FlaskModelAnalyzeClient': Unexpected exception during bean creation; nested exception is java.lang.IllegalArgumentException: lb://flask-service is malformed
20:00:15:980  INFO 6020 --- [main] o.apache.catalina.core.StandardService   : Stopping service [Tomcat]
20:00:15:985  WARN 6020 --- [main] o.a.c.loader.WebappClassLoaderBase       : The web application [ROOT] appears to have started a thread named [Thread-8] but has failed to stop it. This is very likely to create a memory leak. Stack trace of thread:
 java.base@17.0.11/sun.net.dns.ResolverConfigurationImpl.notifyAddrChange0(Native Method)
 java.base@17.0.11/sun.net.dns.ResolverConfigurationImpl$AddressChangeListener.run(ResolverConfigurationImpl.java:176)
20:00:16:007  INFO 6020 --- [main] ConditionEvaluationReportLoggingListener : 

Error starting ApplicationContext. To display the conditions report re-run your application with 'debug' enabled.
20:00:16:036 ERROR 6020 --- [main] o.s.boot.SpringApplication               : Application run failed

org.springframework.beans.factory.UnsatisfiedDependencyException: Error creating bean with name 'aiModelController' defined in file [A:\Desktop\workspace\HIS\his_service\target\classes\com\luojiawei\his_service\controller\AiModelController.class]: Unsatisfied dependency expressed through constructor parameter 0; nested exception is org.springframework.beans.factory.UnsatisfiedDependencyException: Error creating bean with name 'uploadServiceImpl' defined in file [A:\Desktop\workspace\HIS\his_service\target\classes\com\luojiawei\his_service\service\impl\UploadServiceImpl.class]: Unsatisfied dependency expressed through constructor parameter 1; nested exception is org.springframework.beans.factory.BeanCreationException: Error creating bean with name 'com.luojiawei.api.client.FlaskModelAnalyzeClient': Unexpected exception during bean creation; nested exception is java.lang.IllegalArgumentException: lb://flask-service is malformed
	at org.springframework.beans.factory.support.ConstructorResolver.createArgumentArray(ConstructorResolver.java:800) ~[spring-beans-5.3.27.jar:5.3.27]
	at org.springframework.beans.factory.support.ConstructorResolver.autowireConstructor(ConstructorResolver.java:229) ~[spring-beans-5.3.27.jar:5.3.27]
	at org.springframework.beans.factory.support.AbstractAutowireCapableBeanFactory.autowireConstructor(AbstractAutowireCapableBeanFactory.java:1372) ~[spring-beans-5.3.27.jar:5.3.27]
	at org.springframework.beans.factory.support.AbstractAutowireCapableBeanFactory.createBeanInstance(AbstractAutowireCapableBeanFactory.java:1222) ~[spring-beans-5.3.27.jar:5.3.27]
	at org.springframework.beans.factory.support.AbstractAutowireCapableBeanFactory.doCreateBean(AbstractAutowireCapableBeanFactory.java:582) ~[spring-beans-5.3.27.jar:5.3.27]
	at org.springframework.beans.factory.support.AbstractAutowireCapableBeanFactory.createBean(AbstractAutowireCapableBeanFactory.java:542) ~[spring-beans-5.3.27.jar:5.3.27]
	at org.springframework.beans.factory.support.AbstractBeanFactory.lambda$doGetBean$0(AbstractBeanFactory.java:335) ~[spring-beans-5.3.27.jar:5.3.27]
	at org.springframework.beans.factory.support.DefaultSingletonBeanRegistry.getSingleton(DefaultSingletonBeanRegistry.java:234) ~[spring-beans-5.3.27.jar:5.3.27]
	at org.springframework.beans.factory.support.AbstractBeanFactory.doGetBean(AbstractBeanFactory.java:333) ~[spring-beans-5.3.27.jar:5.3.27]
	at org.springframework.beans.factory.support.AbstractBeanFactory.getBean(AbstractBeanFactory.java:208) ~[spring-beans-5.3.27.jar:5.3.27]
	at org.springframework.beans.factory.support.DefaultListableBeanFactory.preInstantiateSingletons(DefaultListableBeanFactory.java:955) ~[spring-beans-5.3.27.jar:5.3.27]
	at org.springframework.context.support.AbstractApplicationContext.finishBeanFactoryInitialization(AbstractApplicationContext.java:920) ~[spring-context-5.3.27.jar:5.3.27]
	at org.springframework.context.support.AbstractApplicationContext.refresh(AbstractApplicationContext.java:583) ~[spring-context-5.3.27.jar:5.3.27]
	at org.springframework.boot.web.servlet.context.ServletWebServerApplicationContext.refresh(ServletWebServerApplicationContext.java:147) ~[spring-boot-2.7.12.jar:2.7.12]
	at org.springframework.boot.SpringApplication.refresh(SpringApplication.java:731) ~[spring-boot-2.7.12.jar:2.7.12]
	at org.springframework.boot.SpringApplication.refreshContext(SpringApplication.java:408) ~[spring-boot-2.7.12.jar:2.7.12]
	at org.springframework.boot.SpringApplication.run(SpringApplication.java:307) ~[spring-boot-2.7.12.jar:2.7.12]
	at org.springframework.boot.SpringApplication.run(SpringApplication.java:1303) ~[spring-boot-2.7.12.jar:2.7.12]
	at org.springframework.boot.SpringApplication.run(SpringApplication.java:1292) ~[spring-boot-2.7.12.jar:2.7.12]
	at com.luojiawei.his_service.HisServiceApplication.main(HisServiceApplication.java:19) ~[classes/:na]
Caused by: org.springframework.beans.factory.UnsatisfiedDependencyException: Error creating bean with name 'uploadServiceImpl' defined in file [A:\Desktop\workspace\HIS\his_service\target\classes\com\luojiawei\his_service\service\impl\UploadServiceImpl.class]: Unsatisfied dependency expressed through constructor parameter 1; nested exception is org.springframework.beans.factory.BeanCreationException: Error creating bean with name 'com.luojiawei.api.client.FlaskModelAnalyzeClient': Unexpected exception during bean creation; nested exception is java.lang.IllegalArgumentException: lb://flask-service is malformed
	at org.springframework.beans.factory.support.ConstructorResolver.createArgumentArray(ConstructorResolver.java:800) ~[spring-beans-5.3.27.jar:5.3.27]
	at org.springframework.beans.factory.support.ConstructorResolver.autowireConstructor(ConstructorResolver.java:229) ~[spring-beans-5.3.27.jar:5.3.27]
	at org.springframework.beans.factory.support.AbstractAutowireCapableBeanFactory.autowireConstructor(AbstractAutowireCapableBeanFactory.java:1372) ~[spring-beans-5.3.27.jar:5.3.27]
	at org.springframework.beans.factory.support.AbstractAutowireCapableBeanFactory.createBeanInstance(AbstractAutowireCapableBeanFactory.java:1222) ~[spring-beans-5.3.27.jar:5.3.27]
	at org.springframework.beans.factory.support.AbstractAutowireCapableBeanFactory.doCreateBean(AbstractAutowireCapableBeanFactory.java:582) ~[spring-beans-5.3.27.jar:5.3.27]
	at org.springframework.beans.factory.support.AbstractAutowireCapableBeanFactory.createBean(AbstractAutowireCapableBeanFactory.java:542) ~[spring-beans-5.3.27.jar:5.3.27]
	at org.springframework.beans.factory.support.AbstractBeanFactory.lambda$doGetBean$0(AbstractBeanFactory.java:335) ~[spring-beans-5.3.27.jar:5.3.27]
	at org.springframework.beans.factory.support.DefaultSingletonBeanRegistry.getSingleton(DefaultSingletonBeanRegistry.java:234) ~[spring-beans-5.3.27.jar:5.3.27]
	at org.springframework.beans.factory.support.AbstractBeanFactory.doGetBean(AbstractBeanFactory.java:333) ~[spring-beans-5.3.27.jar:5.3.27]
	at org.springframework.beans.factory.support.AbstractBeanFactory.getBean(AbstractBeanFactory.java:208) ~[spring-beans-5.3.27.jar:5.3.27]
	at org.springframework.beans.factory.config.DependencyDescriptor.resolveCandidate(DependencyDescriptor.java:276) ~[spring-beans-5.3.27.jar:5.3.27]
	at org.springframework.beans.factory.support.DefaultListableBeanFactory.doResolveDependency(DefaultListableBeanFactory.java:1391) ~[spring-beans-5.3.27.jar:5.3.27]
	at org.springframework.beans.factory.support.DefaultListableBeanFactory.resolveDependency(DefaultListableBeanFactory.java:1311) ~[spring-beans-5.3.27.jar:5.3.27]
	at org.springframework.beans.factory.support.ConstructorResolver.resolveAutowiredArgument(ConstructorResolver.java:887) ~[spring-beans-5.3.27.jar:5.3.27]
	at org.springframework.beans.factory.support.ConstructorResolver.createArgumentArray(ConstructorResolver.java:791) ~[spring-beans-5.3.27.jar:5.3.27]
	... 19 common frames omitted
Caused by: org.springframework.beans.factory.BeanCreationException: Error creating bean with name 'com.luojiawei.api.client.FlaskModelAnalyzeClient': Unexpected exception during bean creation; nested exception is java.lang.IllegalArgumentException: lb://flask-service is malformed
	at org.springframework.beans.factory.support.AbstractAutowireCapableBeanFactory.createBean(AbstractAutowireCapableBeanFactory.java:555) ~[spring-beans-5.3.27.jar:5.3.27]
	at org.springframework.beans.factory.support.AbstractBeanFactory.lambda$doGetBean$0(AbstractBeanFactory.java:335) ~[spring-beans-5.3.27.jar:5.3.27]
	at org.springframework.beans.factory.support.DefaultSingletonBeanRegistry.getSingleton(DefaultSingletonBeanRegistry.java:234) ~[spring-beans-5.3.27.jar:5.3.27]
	at org.springframework.beans.factory.support.AbstractBeanFactory.doGetBean(AbstractBeanFactory.java:333) ~[spring-beans-5.3.27.jar:5.3.27]
	at org.springframework.beans.factory.support.AbstractBeanFactory.getBean(AbstractBeanFactory.java:208) ~[spring-beans-5.3.27.jar:5.3.27]
	at org.springframework.beans.factory.config.DependencyDescriptor.resolveCandidate(DependencyDescriptor.java:276) ~[spring-beans-5.3.27.jar:5.3.27]
	at org.springframework.beans.factory.support.DefaultListableBeanFactory.doResolveDependency(DefaultListableBeanFactory.java:1391) ~[spring-beans-5.3.27.jar:5.3.27]
	at org.springframework.beans.factory.support.DefaultListableBeanFactory.resolveDependency(DefaultListableBeanFactory.java:1311) ~[spring-beans-5.3.27.jar:5.3.27]
	at org.springframework.beans.factory.support.ConstructorResolver.resolveAutowiredArgument(ConstructorResolver.java:887) ~[spring-beans-5.3.27.jar:5.3.27]
	at org.springframework.beans.factory.support.ConstructorResolver.createArgumentArray(ConstructorResolver.java:791) ~[spring-beans-5.3.27.jar:5.3.27]
	... 33 common frames omitted
Caused by: java.lang.IllegalArgumentException: lb://flask-service is malformed
	at org.springframework.cloud.openfeign.FeignClientsRegistrar.getUrl(FeignClientsRegistrar.java:124) ~[spring-cloud-openfeign-core-3.1.5.jar:3.1.5]
	at org.springframework.cloud.openfeign.FeignClientsRegistrar.getUrl(FeignClientsRegistrar.java:316) ~[spring-cloud-openfeign-core-3.1.5.jar:3.1.5]
	at org.springframework.cloud.openfeign.FeignClientsRegistrar.lambda$registerFeignClient$0(FeignClientsRegistrar.java:222) ~[spring-cloud-openfeign-core-3.1.5.jar:3.1.5]
	at org.springframework.beans.factory.support.AbstractAutowireCapableBeanFactory.obtainFromSupplier(AbstractAutowireCapableBeanFactory.java:1249) ~[spring-beans-5.3.27.jar:5.3.27]
	at org.springframework.beans.factory.support.AbstractAutowireCapableBeanFactory.createBeanInstance(AbstractAutowireCapableBeanFactory.java:1191) ~[spring-beans-5.3.27.jar:5.3.27]
	at org.springframework.beans.factory.support.AbstractAutowireCapableBeanFactory.doCreateBean(AbstractAutowireCapableBeanFactory.java:582) ~[spring-beans-5.3.27.jar:5.3.27]
	at org.springframework.beans.factory.support.AbstractAutowireCapableBeanFactory.createBean(AbstractAutowireCapableBeanFactory.java:542) ~[spring-beans-5.3.27.jar:5.3.27]
	... 42 common frames omitted
Caused by: java.net.MalformedURLException: unknown protocol: lb
	at java.base/java.net.URL.<init>(URL.java:681) ~[na:na]
	at java.base/java.net.URL.<init>(URL.java:569) ~[na:na]
	at java.base/java.net.URL.<init>(URL.java:516) ~[na:na]
	at org.springframework.cloud.openfeign.FeignClientsRegistrar.getUrl(FeignClientsRegistrar.java:121) ~[spring-cloud-openfeign-core-3.1.5.jar:3.1.5]
	... 48 common frames omitted

20:04:22:694  INFO 12980 --- [main] c.l.his_service.HisServiceApplication    : Starting HisServiceApplication using Java 17.0.11 on luo with PID 12980 (A:\Desktop\workspace\HIS\his_service\target\classes started by 22407 in A:\Desktop\workspace\HIS)
20:04:22:699 DEBUG 12980 --- [main] c.l.his_service.HisServiceApplication    : Running with Spring Boot v2.7.12, Spring v5.3.27
20:04:22:700  INFO 12980 --- [main] c.l.his_service.HisServiceApplication    : The following 1 profile is active: "dev"
20:04:25:631  INFO 12980 --- [main] .s.d.r.c.RepositoryConfigurationDelegate : Multiple Spring Data modules found, entering strict repository configuration mode
20:04:25:639  INFO 12980 --- [main] .s.d.r.c.RepositoryConfigurationDelegate : Bootstrapping Spring Data Redis repositories in DEFAULT mode.
20:04:25:739  INFO 12980 --- [main] .s.d.r.c.RepositoryConfigurationDelegate : Finished Spring Data repository scanning in 22 ms. Found 0 Redis repository interfaces.
20:04:26:338  INFO 12980 --- [main] o.s.cloud.context.scope.GenericScope     : BeanFactory id=ac61872e-faec-371d-922e-ad941e5407d7
20:04:28:879  INFO 12980 --- [main] o.s.b.w.embedded.tomcat.TomcatWebServer  : Tomcat initialized with port(s): 8080 (http)
20:04:28:913  INFO 12980 --- [main] o.apache.catalina.core.StandardService   : Starting service [Tomcat]
20:04:28:913  INFO 12980 --- [main] org.apache.catalina.core.StandardEngine  : Starting Servlet engine: [Apache Tomcat/9.0.75]
20:04:29:227  INFO 12980 --- [main] o.a.c.c.C.[Tomcat].[localhost].[/]       : Initializing Spring embedded WebApplicationContext
20:04:29:228  INFO 12980 --- [main] w.s.c.ServletWebServerApplicationContext : Root WebApplicationContext: initialization completed in 6379 ms
20:04:29:832  INFO 12980 --- [main] org.redisson.Version                     : Redisson 3.17.7
20:04:30:569  INFO 12980 --- [redisson-netty-2-9] o.r.c.pool.MasterPubSubConnectionPool    : 1 connections initialized for 111.230.32.147/111.230.32.147:9631
20:04:31:245  INFO 12980 --- [redisson-netty-2-19] o.r.c.pool.MasterConnectionPool          : 24 connections initialized for 111.230.32.147/111.230.32.147:9631
20:04:31:856 DEBUG 12980 --- [main] c.l.h.filter.RefreshTokenFilter          : Filter 'refreshTokenFilter' configured for use
20:04:32:821  WARN 12980 --- [main] ConfigServletWebServerApplicationContext : Exception encountered during context initialization - cancelling refresh attempt: org.springframework.beans.factory.UnsatisfiedDependencyException: Error creating bean with name 'aiModelController' defined in file [A:\Desktop\workspace\HIS\his_service\target\classes\com\luojiawei\his_service\controller\AiModelController.class]: Unsatisfied dependency expressed through constructor parameter 0; nested exception is org.springframework.beans.factory.UnsatisfiedDependencyException: Error creating bean with name 'uploadServiceImpl' defined in file [A:\Desktop\workspace\HIS\his_service\target\classes\com\luojiawei\his_service\service\impl\UploadServiceImpl.class]: Unsatisfied dependency expressed through constructor parameter 1; nested exception is org.springframework.beans.factory.BeanCreationException: Error creating bean with name 'com.luojiawei.api.client.FlaskModelAnalyzeClient': Unexpected exception during bean creation; nested exception is java.lang.IllegalArgumentException: lb://flask-service is malformed
20:04:32:875  INFO 12980 --- [main] o.apache.catalina.core.StandardService   : Stopping service [Tomcat]
20:04:32:880  WARN 12980 --- [main] o.a.c.loader.WebappClassLoaderBase       : The web application [ROOT] appears to have started a thread named [Thread-8] but has failed to stop it. This is very likely to create a memory leak. Stack trace of thread:
 java.base@17.0.11/sun.net.dns.ResolverConfigurationImpl.notifyAddrChange0(Native Method)
 java.base@17.0.11/sun.net.dns.ResolverConfigurationImpl$AddressChangeListener.run(ResolverConfigurationImpl.java:176)
20:04:32:902  INFO 12980 --- [main] ConditionEvaluationReportLoggingListener : 

Error starting ApplicationContext. To display the conditions report re-run your application with 'debug' enabled.
20:04:32:926 ERROR 12980 --- [main] o.s.boot.SpringApplication               : Application run failed

org.springframework.beans.factory.UnsatisfiedDependencyException: Error creating bean with name 'aiModelController' defined in file [A:\Desktop\workspace\HIS\his_service\target\classes\com\luojiawei\his_service\controller\AiModelController.class]: Unsatisfied dependency expressed through constructor parameter 0; nested exception is org.springframework.beans.factory.UnsatisfiedDependencyException: Error creating bean with name 'uploadServiceImpl' defined in file [A:\Desktop\workspace\HIS\his_service\target\classes\com\luojiawei\his_service\service\impl\UploadServiceImpl.class]: Unsatisfied dependency expressed through constructor parameter 1; nested exception is org.springframework.beans.factory.BeanCreationException: Error creating bean with name 'com.luojiawei.api.client.FlaskModelAnalyzeClient': Unexpected exception during bean creation; nested exception is java.lang.IllegalArgumentException: lb://flask-service is malformed
	at org.springframework.beans.factory.support.ConstructorResolver.createArgumentArray(ConstructorResolver.java:800) ~[spring-beans-5.3.27.jar:5.3.27]
	at org.springframework.beans.factory.support.ConstructorResolver.autowireConstructor(ConstructorResolver.java:229) ~[spring-beans-5.3.27.jar:5.3.27]
	at org.springframework.beans.factory.support.AbstractAutowireCapableBeanFactory.autowireConstructor(AbstractAutowireCapableBeanFactory.java:1372) ~[spring-beans-5.3.27.jar:5.3.27]
	at org.springframework.beans.factory.support.AbstractAutowireCapableBeanFactory.createBeanInstance(AbstractAutowireCapableBeanFactory.java:1222) ~[spring-beans-5.3.27.jar:5.3.27]
	at org.springframework.beans.factory.support.AbstractAutowireCapableBeanFactory.doCreateBean(AbstractAutowireCapableBeanFactory.java:582) ~[spring-beans-5.3.27.jar:5.3.27]
	at org.springframework.beans.factory.support.AbstractAutowireCapableBeanFactory.createBean(AbstractAutowireCapableBeanFactory.java:542) ~[spring-beans-5.3.27.jar:5.3.27]
	at org.springframework.beans.factory.support.AbstractBeanFactory.lambda$doGetBean$0(AbstractBeanFactory.java:335) ~[spring-beans-5.3.27.jar:5.3.27]
	at org.springframework.beans.factory.support.DefaultSingletonBeanRegistry.getSingleton(DefaultSingletonBeanRegistry.java:234) ~[spring-beans-5.3.27.jar:5.3.27]
	at org.springframework.beans.factory.support.AbstractBeanFactory.doGetBean(AbstractBeanFactory.java:333) ~[spring-beans-5.3.27.jar:5.3.27]
	at org.springframework.beans.factory.support.AbstractBeanFactory.getBean(AbstractBeanFactory.java:208) ~[spring-beans-5.3.27.jar:5.3.27]
	at org.springframework.beans.factory.support.DefaultListableBeanFactory.preInstantiateSingletons(DefaultListableBeanFactory.java:955) ~[spring-beans-5.3.27.jar:5.3.27]
	at org.springframework.context.support.AbstractApplicationContext.finishBeanFactoryInitialization(AbstractApplicationContext.java:920) ~[spring-context-5.3.27.jar:5.3.27]
	at org.springframework.context.support.AbstractApplicationContext.refresh(AbstractApplicationContext.java:583) ~[spring-context-5.3.27.jar:5.3.27]
	at org.springframework.boot.web.servlet.context.ServletWebServerApplicationContext.refresh(ServletWebServerApplicationContext.java:147) ~[spring-boot-2.7.12.jar:2.7.12]
	at org.springframework.boot.SpringApplication.refresh(SpringApplication.java:731) ~[spring-boot-2.7.12.jar:2.7.12]
	at org.springframework.boot.SpringApplication.refreshContext(SpringApplication.java:408) ~[spring-boot-2.7.12.jar:2.7.12]
	at org.springframework.boot.SpringApplication.run(SpringApplication.java:307) ~[spring-boot-2.7.12.jar:2.7.12]
	at org.springframework.boot.SpringApplication.run(SpringApplication.java:1303) ~[spring-boot-2.7.12.jar:2.7.12]
	at org.springframework.boot.SpringApplication.run(SpringApplication.java:1292) ~[spring-boot-2.7.12.jar:2.7.12]
	at com.luojiawei.his_service.HisServiceApplication.main(HisServiceApplication.java:19) ~[classes/:na]
Caused by: org.springframework.beans.factory.UnsatisfiedDependencyException: Error creating bean with name 'uploadServiceImpl' defined in file [A:\Desktop\workspace\HIS\his_service\target\classes\com\luojiawei\his_service\service\impl\UploadServiceImpl.class]: Unsatisfied dependency expressed through constructor parameter 1; nested exception is org.springframework.beans.factory.BeanCreationException: Error creating bean with name 'com.luojiawei.api.client.FlaskModelAnalyzeClient': Unexpected exception during bean creation; nested exception is java.lang.IllegalArgumentException: lb://flask-service is malformed
	at org.springframework.beans.factory.support.ConstructorResolver.createArgumentArray(ConstructorResolver.java:800) ~[spring-beans-5.3.27.jar:5.3.27]
	at org.springframework.beans.factory.support.ConstructorResolver.autowireConstructor(ConstructorResolver.java:229) ~[spring-beans-5.3.27.jar:5.3.27]
	at org.springframework.beans.factory.support.AbstractAutowireCapableBeanFactory.autowireConstructor(AbstractAutowireCapableBeanFactory.java:1372) ~[spring-beans-5.3.27.jar:5.3.27]
	at org.springframework.beans.factory.support.AbstractAutowireCapableBeanFactory.createBeanInstance(AbstractAutowireCapableBeanFactory.java:1222) ~[spring-beans-5.3.27.jar:5.3.27]
	at org.springframework.beans.factory.support.AbstractAutowireCapableBeanFactory.doCreateBean(AbstractAutowireCapableBeanFactory.java:582) ~[spring-beans-5.3.27.jar:5.3.27]
	at org.springframework.beans.factory.support.AbstractAutowireCapableBeanFactory.createBean(AbstractAutowireCapableBeanFactory.java:542) ~[spring-beans-5.3.27.jar:5.3.27]
	at org.springframework.beans.factory.support.AbstractBeanFactory.lambda$doGetBean$0(AbstractBeanFactory.java:335) ~[spring-beans-5.3.27.jar:5.3.27]
	at org.springframework.beans.factory.support.DefaultSingletonBeanRegistry.getSingleton(DefaultSingletonBeanRegistry.java:234) ~[spring-beans-5.3.27.jar:5.3.27]
	at org.springframework.beans.factory.support.AbstractBeanFactory.doGetBean(AbstractBeanFactory.java:333) ~[spring-beans-5.3.27.jar:5.3.27]
	at org.springframework.beans.factory.support.AbstractBeanFactory.getBean(AbstractBeanFactory.java:208) ~[spring-beans-5.3.27.jar:5.3.27]
	at org.springframework.beans.factory.config.DependencyDescriptor.resolveCandidate(DependencyDescriptor.java:276) ~[spring-beans-5.3.27.jar:5.3.27]
	at org.springframework.beans.factory.support.DefaultListableBeanFactory.doResolveDependency(DefaultListableBeanFactory.java:1391) ~[spring-beans-5.3.27.jar:5.3.27]
	at org.springframework.beans.factory.support.DefaultListableBeanFactory.resolveDependency(DefaultListableBeanFactory.java:1311) ~[spring-beans-5.3.27.jar:5.3.27]
	at org.springframework.beans.factory.support.ConstructorResolver.resolveAutowiredArgument(ConstructorResolver.java:887) ~[spring-beans-5.3.27.jar:5.3.27]
	at org.springframework.beans.factory.support.ConstructorResolver.createArgumentArray(ConstructorResolver.java:791) ~[spring-beans-5.3.27.jar:5.3.27]
	... 19 common frames omitted
Caused by: org.springframework.beans.factory.BeanCreationException: Error creating bean with name 'com.luojiawei.api.client.FlaskModelAnalyzeClient': Unexpected exception during bean creation; nested exception is java.lang.IllegalArgumentException: lb://flask-service is malformed
	at org.springframework.beans.factory.support.AbstractAutowireCapableBeanFactory.createBean(AbstractAutowireCapableBeanFactory.java:555) ~[spring-beans-5.3.27.jar:5.3.27]
	at org.springframework.beans.factory.support.AbstractBeanFactory.lambda$doGetBean$0(AbstractBeanFactory.java:335) ~[spring-beans-5.3.27.jar:5.3.27]
	at org.springframework.beans.factory.support.DefaultSingletonBeanRegistry.getSingleton(DefaultSingletonBeanRegistry.java:234) ~[spring-beans-5.3.27.jar:5.3.27]
	at org.springframework.beans.factory.support.AbstractBeanFactory.doGetBean(AbstractBeanFactory.java:333) ~[spring-beans-5.3.27.jar:5.3.27]
	at org.springframework.beans.factory.support.AbstractBeanFactory.getBean(AbstractBeanFactory.java:208) ~[spring-beans-5.3.27.jar:5.3.27]
	at org.springframework.beans.factory.config.DependencyDescriptor.resolveCandidate(DependencyDescriptor.java:276) ~[spring-beans-5.3.27.jar:5.3.27]
	at org.springframework.beans.factory.support.DefaultListableBeanFactory.doResolveDependency(DefaultListableBeanFactory.java:1391) ~[spring-beans-5.3.27.jar:5.3.27]
	at org.springframework.beans.factory.support.DefaultListableBeanFactory.resolveDependency(DefaultListableBeanFactory.java:1311) ~[spring-beans-5.3.27.jar:5.3.27]
	at org.springframework.beans.factory.support.ConstructorResolver.resolveAutowiredArgument(ConstructorResolver.java:887) ~[spring-beans-5.3.27.jar:5.3.27]
	at org.springframework.beans.factory.support.ConstructorResolver.createArgumentArray(ConstructorResolver.java:791) ~[spring-beans-5.3.27.jar:5.3.27]
	... 33 common frames omitted
Caused by: java.lang.IllegalArgumentException: lb://flask-service is malformed
	at org.springframework.cloud.openfeign.FeignClientsRegistrar.getUrl(FeignClientsRegistrar.java:124) ~[spring-cloud-openfeign-core-3.1.5.jar:3.1.5]
	at org.springframework.cloud.openfeign.FeignClientsRegistrar.getUrl(FeignClientsRegistrar.java:316) ~[spring-cloud-openfeign-core-3.1.5.jar:3.1.5]
	at org.springframework.cloud.openfeign.FeignClientsRegistrar.lambda$registerFeignClient$0(FeignClientsRegistrar.java:222) ~[spring-cloud-openfeign-core-3.1.5.jar:3.1.5]
	at org.springframework.beans.factory.support.AbstractAutowireCapableBeanFactory.obtainFromSupplier(AbstractAutowireCapableBeanFactory.java:1249) ~[spring-beans-5.3.27.jar:5.3.27]
	at org.springframework.beans.factory.support.AbstractAutowireCapableBeanFactory.createBeanInstance(AbstractAutowireCapableBeanFactory.java:1191) ~[spring-beans-5.3.27.jar:5.3.27]
	at org.springframework.beans.factory.support.AbstractAutowireCapableBeanFactory.doCreateBean(AbstractAutowireCapableBeanFactory.java:582) ~[spring-beans-5.3.27.jar:5.3.27]
	at org.springframework.beans.factory.support.AbstractAutowireCapableBeanFactory.createBean(AbstractAutowireCapableBeanFactory.java:542) ~[spring-beans-5.3.27.jar:5.3.27]
	... 42 common frames omitted
Caused by: java.net.MalformedURLException: unknown protocol: lb
	at java.base/java.net.URL.<init>(URL.java:681) ~[na:na]
	at java.base/java.net.URL.<init>(URL.java:569) ~[na:na]
	at java.base/java.net.URL.<init>(URL.java:516) ~[na:na]
	at org.springframework.cloud.openfeign.FeignClientsRegistrar.getUrl(FeignClientsRegistrar.java:121) ~[spring-cloud-openfeign-core-3.1.5.jar:3.1.5]
	... 48 common frames omitted

20:04:47:992  INFO 21756 --- [main] c.l.his_service.HisServiceApplication    : Starting HisServiceApplication using Java 17.0.11 on luo with PID 21756 (A:\Desktop\workspace\HIS\his_service\target\classes started by 22407 in A:\Desktop\workspace\HIS)
20:04:47:993 DEBUG 21756 --- [main] c.l.his_service.HisServiceApplication    : Running with Spring Boot v2.7.12, Spring v5.3.27
20:04:47:994  INFO 21756 --- [main] c.l.his_service.HisServiceApplication    : The following 1 profile is active: "dev"
20:04:49:177  INFO 21756 --- [main] .s.d.r.c.RepositoryConfigurationDelegate : Multiple Spring Data modules found, entering strict repository configuration mode
20:04:49:179  INFO 21756 --- [main] .s.d.r.c.RepositoryConfigurationDelegate : Bootstrapping Spring Data Redis repositories in DEFAULT mode.
20:04:49:215  INFO 21756 --- [main] .s.d.r.c.RepositoryConfigurationDelegate : Finished Spring Data repository scanning in 20 ms. Found 0 Redis repository interfaces.
20:04:49:508  INFO 21756 --- [main] o.s.cloud.context.scope.GenericScope     : BeanFactory id=ac61872e-faec-371d-922e-ad941e5407d7
20:04:50:132  INFO 21756 --- [main] o.s.b.w.embedded.tomcat.TomcatWebServer  : Tomcat initialized with port(s): 8080 (http)
20:04:50:148  INFO 21756 --- [main] o.apache.catalina.core.StandardService   : Starting service [Tomcat]
20:04:50:149  INFO 21756 --- [main] org.apache.catalina.core.StandardEngine  : Starting Servlet engine: [Apache Tomcat/9.0.75]
20:04:50:324  INFO 21756 --- [main] o.a.c.c.C.[Tomcat].[localhost].[/]       : Initializing Spring embedded WebApplicationContext
20:04:50:324  INFO 21756 --- [main] w.s.c.ServletWebServerApplicationContext : Root WebApplicationContext: initialization completed in 2274 ms
20:04:50:583  INFO 21756 --- [main] org.redisson.Version                     : Redisson 3.17.7
20:04:50:989  INFO 21756 --- [redisson-netty-2-9] o.r.c.pool.MasterPubSubConnectionPool    : 1 connections initialized for 111.230.32.147/111.230.32.147:9631
20:04:51:681  INFO 21756 --- [redisson-netty-2-19] o.r.c.pool.MasterConnectionPool          : 24 connections initialized for 111.230.32.147/111.230.32.147:9631
20:04:51:991 DEBUG 21756 --- [main] c.l.h.filter.RefreshTokenFilter          : Filter 'refreshTokenFilter' configured for use
20:04:52:921  INFO 21756 --- [main] o.s.c.openfeign.FeignClientFactoryBean   : For 'flask-service' URL not provided. Will try picking an instance via load-balancing.
20:04:53:054  INFO 21756 --- [main] o.s.c.openfeign.FeignClientFactoryBean   : For 'ai-service' URL not provided. Will try picking an instance via load-balancing.
20:04:53:098  WARN 21756 --- [main] c.b.m.core.metadata.TableInfoHelper      : Can not find table primary key in Class: "java.lang.Object".
20:04:53:098  WARN 21756 --- [main] c.b.m.core.injector.DefaultSqlInjector   : class java.lang.Object ,Not found @TableId annotation, Cannot use Mybatis-Plus 'xxById' Method.
20:04:55:726  WARN 21756 --- [main] iguration$LoadBalancerCaffeineWarnLogger : Spring Cloud LoadBalancer is currently working with the default cache. While this cache implementation is useful for development and tests, it's recommended to use Caffeine cache in production.You can switch to using Caffeine cache, by adding it and org.springframework.cache.caffeine.CaffeineCacheManager to the classpath.
20:04:55:731  INFO 21756 --- [main] o.s.b.a.e.web.EndpointLinksResolver      : Exposing 1 endpoint(s) beneath base path '/actuator'
20:04:55:837  INFO 21756 --- [main] o.s.b.w.embedded.tomcat.TomcatWebServer  : Tomcat started on port(s): 8080 (http) with context path ''
20:04:55:914  INFO 21756 --- [main] c.a.n.p.a.s.c.ClientAuthPluginManager    : [ClientAuthPluginManager] Load ClientAuthService com.alibaba.nacos.client.auth.impl.NacosClientAuthServiceImpl success.
20:04:55:915  INFO 21756 --- [main] c.a.n.p.a.s.c.ClientAuthPluginManager    : [ClientAuthPluginManager] Load ClientAuthService com.alibaba.nacos.client.auth.ram.RamClientAuthServiceImpl success.
20:04:58:230  INFO 21756 --- [main] c.a.n.c.a.AbstractAbilityControlManager  : Ready to get current node abilities...
20:04:58:233  INFO 21756 --- [main] c.a.n.c.a.AbstractAbilityControlManager  : Ready to initialize current node abilities, support modes: [SDK_CLIENT]
20:04:58:234  INFO 21756 --- [main] c.a.n.c.a.AbstractAbilityControlManager  : Initialize current abilities finish...
20:04:58:235  INFO 21756 --- [main] c.a.n.c.a.d.NacosAbilityManagerHolder    : [AbilityControlManager] Successfully initialize AbilityControlManager
20:04:58:325  INFO 21756 --- [main] c.a.c.n.registry.NacosServiceRegistry    : nacos registry, DEFAULT_GROUP his-service 10.21.93.70:8848 register finished
20:04:58:642  INFO 21756 --- [main] c.l.his_service.HisServiceApplication    : Started HisServiceApplication in 11.663 seconds (JVM running for 12.741)
20:04:58:867  INFO 21756 --- [RMI TCP Connection(1)-10.21.93.70] o.a.c.c.C.[Tomcat].[localhost].[/]       : Initializing Spring DispatcherServlet 'dispatcherServlet'
20:04:58:867  INFO 21756 --- [RMI TCP Connection(1)-10.21.93.70] o.s.web.servlet.DispatcherServlet        : Initializing Servlet 'dispatcherServlet'
20:04:58:870  INFO 21756 --- [RMI TCP Connection(1)-10.21.93.70] o.s.web.servlet.DispatcherServlet        : Completed initialization in 3 ms
20:04:58:882  INFO 21756 --- [RMI TCP Connection(3)-10.21.93.70] com.zaxxer.hikari.HikariDataSource       : HikariPool-1 - Starting...
20:04:59:748  INFO 21756 --- [RMI TCP Connection(3)-10.21.93.70] com.zaxxer.hikari.HikariDataSource       : HikariPool-1 - Start completed.
20:05:04:281 DEBUG 21756 --- [http-nio-8080-exec-2] c.l.api.client.FlaskModelAnalyzeClient   : [FlaskModelAnalyzeClient#uploadFile] ---> POST http://flask-service/upload HTTP/1.1
20:05:04:282 DEBUG 21756 --- [http-nio-8080-exec-2] c.l.api.client.FlaskModelAnalyzeClient   : [FlaskModelAnalyzeClient#uploadFile] Content-Length: 67886
20:05:04:282 DEBUG 21756 --- [http-nio-8080-exec-2] c.l.api.client.FlaskModelAnalyzeClient   : [FlaskModelAnalyzeClient#uploadFile] Content-Type: multipart/form-data; charset=UTF-8; boundary=1958f64d293
20:05:04:282 DEBUG 21756 --- [http-nio-8080-exec-2] c.l.api.client.FlaskModelAnalyzeClient   : [FlaskModelAnalyzeClient#uploadFile] X-API-Key: 123456
20:05:04:282 DEBUG 21756 --- [http-nio-8080-exec-2] c.l.api.client.FlaskModelAnalyzeClient   : [FlaskModelAnalyzeClient#uploadFile] 
20:05:04:282 DEBUG 21756 --- [http-nio-8080-exec-2] c.l.api.client.FlaskModelAnalyzeClient   : [FlaskModelAnalyzeClient#uploadFile] Binary data
20:05:04:283 DEBUG 21756 --- [http-nio-8080-exec-2] c.l.api.client.FlaskModelAnalyzeClient   : [FlaskModelAnalyzeClient#uploadFile] ---> END HTTP (67886-byte body)
20:05:06:660 DEBUG 21756 --- [http-nio-8080-exec-2] c.l.api.client.FlaskModelAnalyzeClient   : [FlaskModelAnalyzeClient#uploadFile] <--- ERROR ConnectException: Connection refused: getsockopt (2375ms)
20:05:06:661 DEBUG 21756 --- [http-nio-8080-exec-2] c.l.api.client.FlaskModelAnalyzeClient   : [FlaskModelAnalyzeClient#uploadFile] java.net.ConnectException: Connection refused: getsockopt
	at java.base/sun.nio.ch.Net.pollConnect(Native Method)
	at java.base/sun.nio.ch.Net.pollConnectNow(Net.java:672)
	at java.base/sun.nio.ch.NioSocketImpl.timedFinishConnect(NioSocketImpl.java:554)
	at java.base/sun.nio.ch.NioSocketImpl.connect(NioSocketImpl.java:602)
	at java.base/java.net.Socket.connect(Socket.java:633)
	at java.base/sun.net.NetworkClient.doConnect(NetworkClient.java:178)
	at java.base/sun.net.www.http.HttpClient.openServer(HttpClient.java:533)
	at java.base/sun.net.www.http.HttpClient.openServer(HttpClient.java:638)
	at java.base/sun.net.www.http.HttpClient.<init>(HttpClient.java:281)
	at java.base/sun.net.www.http.HttpClient.New(HttpClient.java:386)
	at java.base/sun.net.www.http.HttpClient.New(HttpClient.java:408)
	at java.base/sun.net.www.protocol.http.HttpURLConnection.getNewHttpClient(HttpURLConnection.java:1309)
	at java.base/sun.net.www.protocol.http.HttpURLConnection.plainConnect0(HttpURLConnection.java:1242)
	at java.base/sun.net.www.protocol.http.HttpURLConnection.plainConnect(HttpURLConnection.java:1128)
	at java.base/sun.net.www.protocol.http.HttpURLConnection.connect(HttpURLConnection.java:1057)
	at java.base/sun.net.www.protocol.http.HttpURLConnection.getOutputStream0(HttpURLConnection.java:1451)
	at java.base/sun.net.www.protocol.http.HttpURLConnection.getOutputStream(HttpURLConnection.java:1422)
	at feign.Client$Default.convertAndSend(Client.java:208)
	at feign.Client$Default.execute(Client.java:105)
	at org.springframework.cloud.openfeign.loadbalancer.LoadBalancerUtils.executeWithLoadBalancerLifecycleProcessing(LoadBalancerUtils.java:57)
	at org.springframework.cloud.openfeign.loadbalancer.LoadBalancerUtils.executeWithLoadBalancerLifecycleProcessing(LoadBalancerUtils.java:95)
	at org.springframework.cloud.openfeign.loadbalancer.FeignBlockingLoadBalancerClient.execute(FeignBlockingLoadBalancerClient.java:114)
	at feign.SynchronousMethodHandler.executeAndDecode(SynchronousMethodHandler.java:121)
	at feign.SynchronousMethodHandler.invoke(SynchronousMethodHandler.java:91)
	at feign.ReflectiveFeign$FeignInvocationHandler.invoke(ReflectiveFeign.java:100)
	at jdk.proxy2/jdk.proxy2.$Proxy125.uploadFile(Unknown Source)
	at com.luojiawei.his_service.service.impl.UploadServiceImpl.handleFileUpload(UploadServiceImpl.java:43)
	at com.luojiawei.his_service.controller.AiModelController.testFileUpload(AiModelController.java:40)
	at java.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at java.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:77)
	at java.base/jdk.internal.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.base/java.lang.reflect.Method.invoke(Method.java:568)
	at org.springframework.web.method.support.InvocableHandlerMethod.doInvoke(InvocableHandlerMethod.java:205)
	at org.springframework.web.method.support.InvocableHandlerMethod.invokeForRequest(InvocableHandlerMethod.java:150)
	at org.springframework.web.servlet.mvc.method.annotation.ServletInvocableHandlerMethod.invokeAndHandle(ServletInvocableHandlerMethod.java:117)
	at org.springframework.web.servlet.mvc.method.annotation.RequestMappingHandlerAdapter.invokeHandlerMethod(RequestMappingHandlerAdapter.java:895)
	at org.springframework.web.servlet.mvc.method.annotation.RequestMappingHandlerAdapter.handleInternal(RequestMappingHandlerAdapter.java:808)
	at org.springframework.web.servlet.mvc.method.AbstractHandlerMethodAdapter.handle(AbstractHandlerMethodAdapter.java:87)
	at org.springframework.web.servlet.DispatcherServlet.doDispatch(DispatcherServlet.java:1072)
	at org.springframework.web.servlet.DispatcherServlet.doService(DispatcherServlet.java:965)
	at org.springframework.web.servlet.FrameworkServlet.processRequest(FrameworkServlet.java:1006)
	at org.springframework.web.servlet.FrameworkServlet.doPost(FrameworkServlet.java:909)
	at javax.servlet.http.HttpServlet.service(HttpServlet.java:555)
	at org.springframework.web.servlet.FrameworkServlet.service(FrameworkServlet.java:883)
	at javax.servlet.http.HttpServlet.service(HttpServlet.java:623)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:209)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:153)
	at com.luojiawei.his_service.filter.RefreshTokenFilter.doFilterInternal(RefreshTokenFilter.java:58)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:117)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:178)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:153)
	at org.springframework.web.filter.RequestContextFilter.doFilterInternal(RequestContextFilter.java:100)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:117)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:178)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:153)
	at org.springframework.web.filter.FormContentFilter.doFilterInternal(FormContentFilter.java:93)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:117)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:178)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:153)
	at org.springframework.boot.actuate.metrics.web.servlet.WebMvcMetricsFilter.doFilterInternal(WebMvcMetricsFilter.java:96)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:117)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:178)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:153)
	at org.springframework.web.filter.CharacterEncodingFilter.doFilterInternal(CharacterEncodingFilter.java:201)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:117)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:178)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:153)
	at org.apache.catalina.core.StandardWrapperValve.invoke(StandardWrapperValve.java:167)
	at org.apache.catalina.core.StandardContextValve.invoke(StandardContextValve.java:90)
	at org.apache.catalina.authenticator.AuthenticatorBase.invoke(AuthenticatorBase.java:481)
	at org.apache.catalina.core.StandardHostValve.invoke(StandardHostValve.java:130)
	at org.apache.catalina.valves.ErrorReportValve.invoke(ErrorReportValve.java:93)
	at org.apache.catalina.core.StandardEngineValve.invoke(StandardEngineValve.java:74)
	at org.apache.catalina.connector.CoyoteAdapter.service(CoyoteAdapter.java:343)
	at org.apache.coyote.http11.Http11Processor.service(Http11Processor.java:390)
	at org.apache.coyote.AbstractProcessorLight.process(AbstractProcessorLight.java:63)
	at org.apache.coyote.AbstractProtocol$ConnectionHandler.process(AbstractProtocol.java:926)
	at org.apache.tomcat.util.net.NioEndpoint$SocketProcessor.doRun(NioEndpoint.java:1791)
	at org.apache.tomcat.util.net.SocketProcessorBase.run(SocketProcessorBase.java:52)
	at org.apache.tomcat.util.threads.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1191)
	at org.apache.tomcat.util.threads.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:659)
	at org.apache.tomcat.util.threads.TaskThread$WrappingRunnable.run(TaskThread.java:61)
	at java.base/java.lang.Thread.run(Thread.java:840)

20:05:06:661 DEBUG 21756 --- [http-nio-8080-exec-2] c.l.api.client.FlaskModelAnalyzeClient   : [FlaskModelAnalyzeClient#uploadFile] <--- END ERROR
20:05:06:687 ERROR 21756 --- [http-nio-8080-exec-2] o.a.c.c.C.[.[.[/].[dispatcherServlet]    : Servlet.service() for servlet [dispatcherServlet] in context with path [] threw exception [Request processing failed; nested exception is java.lang.RuntimeException: ] with root cause

java.net.ConnectException: Connection refused: getsockopt
	at java.base/sun.nio.ch.Net.pollConnect(Native Method) ~[na:na]
	at java.base/sun.nio.ch.Net.pollConnectNow(Net.java:672) ~[na:na]
	at java.base/sun.nio.ch.NioSocketImpl.timedFinishConnect(NioSocketImpl.java:554) ~[na:na]
	at java.base/sun.nio.ch.NioSocketImpl.connect(NioSocketImpl.java:602) ~[na:na]
	at java.base/java.net.Socket.connect(Socket.java:633) ~[na:na]
	at java.base/sun.net.NetworkClient.doConnect(NetworkClient.java:178) ~[na:na]
	at java.base/sun.net.www.http.HttpClient.openServer(HttpClient.java:533) ~[na:na]
	at java.base/sun.net.www.http.HttpClient.openServer(HttpClient.java:638) ~[na:na]
	at java.base/sun.net.www.http.HttpClient.<init>(HttpClient.java:281) ~[na:na]
	at java.base/sun.net.www.http.HttpClient.New(HttpClient.java:386) ~[na:na]
	at java.base/sun.net.www.http.HttpClient.New(HttpClient.java:408) ~[na:na]
	at java.base/sun.net.www.protocol.http.HttpURLConnection.getNewHttpClient(HttpURLConnection.java:1309) ~[na:na]
	at java.base/sun.net.www.protocol.http.HttpURLConnection.plainConnect0(HttpURLConnection.java:1242) ~[na:na]
	at java.base/sun.net.www.protocol.http.HttpURLConnection.plainConnect(HttpURLConnection.java:1128) ~[na:na]
	at java.base/sun.net.www.protocol.http.HttpURLConnection.connect(HttpURLConnection.java:1057) ~[na:na]
	at java.base/sun.net.www.protocol.http.HttpURLConnection.getOutputStream0(HttpURLConnection.java:1451) ~[na:na]
	at java.base/sun.net.www.protocol.http.HttpURLConnection.getOutputStream(HttpURLConnection.java:1422) ~[na:na]
	at feign.Client$Default.convertAndSend(Client.java:208) ~[feign-core-11.10.jar:na]
	at feign.Client$Default.execute(Client.java:105) ~[feign-core-11.10.jar:na]
	at org.springframework.cloud.openfeign.loadbalancer.LoadBalancerUtils.executeWithLoadBalancerLifecycleProcessing(LoadBalancerUtils.java:57) ~[spring-cloud-openfeign-core-3.1.5.jar:3.1.5]
	at org.springframework.cloud.openfeign.loadbalancer.LoadBalancerUtils.executeWithLoadBalancerLifecycleProcessing(LoadBalancerUtils.java:95) ~[spring-cloud-openfeign-core-3.1.5.jar:3.1.5]
	at org.springframework.cloud.openfeign.loadbalancer.FeignBlockingLoadBalancerClient.execute(FeignBlockingLoadBalancerClient.java:114) ~[spring-cloud-openfeign-core-3.1.5.jar:3.1.5]
	at feign.SynchronousMethodHandler.executeAndDecode(SynchronousMethodHandler.java:121) ~[feign-core-11.10.jar:na]
	at feign.SynchronousMethodHandler.invoke(SynchronousMethodHandler.java:91) ~[feign-core-11.10.jar:na]
	at feign.ReflectiveFeign$FeignInvocationHandler.invoke(ReflectiveFeign.java:100) ~[feign-core-11.10.jar:na]
	at jdk.proxy2/jdk.proxy2.$Proxy125.uploadFile(Unknown Source) ~[na:na]
	at com.luojiawei.his_service.service.impl.UploadServiceImpl.handleFileUpload(UploadServiceImpl.java:43) ~[classes/:na]
	at com.luojiawei.his_service.controller.AiModelController.testFileUpload(AiModelController.java:40) ~[classes/:na]
	at java.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke0(Native Method) ~[na:na]
	at java.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:77) ~[na:na]
	at java.base/jdk.internal.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43) ~[na:na]
	at java.base/java.lang.reflect.Method.invoke(Method.java:568) ~[na:na]
	at org.springframework.web.method.support.InvocableHandlerMethod.doInvoke(InvocableHandlerMethod.java:205) ~[spring-web-5.3.27.jar:5.3.27]
	at org.springframework.web.method.support.InvocableHandlerMethod.invokeForRequest(InvocableHandlerMethod.java:150) ~[spring-web-5.3.27.jar:5.3.27]
	at org.springframework.web.servlet.mvc.method.annotation.ServletInvocableHandlerMethod.invokeAndHandle(ServletInvocableHandlerMethod.java:117) ~[spring-webmvc-5.3.27.jar:5.3.27]
	at org.springframework.web.servlet.mvc.method.annotation.RequestMappingHandlerAdapter.invokeHandlerMethod(RequestMappingHandlerAdapter.java:895) ~[spring-webmvc-5.3.27.jar:5.3.27]
	at org.springframework.web.servlet.mvc.method.annotation.RequestMappingHandlerAdapter.handleInternal(RequestMappingHandlerAdapter.java:808) ~[spring-webmvc-5.3.27.jar:5.3.27]
	at org.springframework.web.servlet.mvc.method.AbstractHandlerMethodAdapter.handle(AbstractHandlerMethodAdapter.java:87) ~[spring-webmvc-5.3.27.jar:5.3.27]
	at org.springframework.web.servlet.DispatcherServlet.doDispatch(DispatcherServlet.java:1072) ~[spring-webmvc-5.3.27.jar:5.3.27]
	at org.springframework.web.servlet.DispatcherServlet.doService(DispatcherServlet.java:965) ~[spring-webmvc-5.3.27.jar:5.3.27]
	at org.springframework.web.servlet.FrameworkServlet.processRequest(FrameworkServlet.java:1006) ~[spring-webmvc-5.3.27.jar:5.3.27]
	at org.springframework.web.servlet.FrameworkServlet.doPost(FrameworkServlet.java:909) ~[spring-webmvc-5.3.27.jar:5.3.27]
	at javax.servlet.http.HttpServlet.service(HttpServlet.java:555) ~[tomcat-embed-core-9.0.75.jar:4.0.FR]
	at org.springframework.web.servlet.FrameworkServlet.service(FrameworkServlet.java:883) ~[spring-webmvc-5.3.27.jar:5.3.27]
	at javax.servlet.http.HttpServlet.service(HttpServlet.java:623) ~[tomcat-embed-core-9.0.75.jar:4.0.FR]
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:209) ~[tomcat-embed-core-9.0.75.jar:9.0.75]
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:153) ~[tomcat-embed-core-9.0.75.jar:9.0.75]
	at com.luojiawei.his_service.filter.RefreshTokenFilter.doFilterInternal(RefreshTokenFilter.java:58) ~[classes/:na]
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:117) ~[spring-web-5.3.27.jar:5.3.27]
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:178) ~[tomcat-embed-core-9.0.75.jar:9.0.75]
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:153) ~[tomcat-embed-core-9.0.75.jar:9.0.75]
	at org.springframework.web.filter.RequestContextFilter.doFilterInternal(RequestContextFilter.java:100) ~[spring-web-5.3.27.jar:5.3.27]
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:117) ~[spring-web-5.3.27.jar:5.3.27]
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:178) ~[tomcat-embed-core-9.0.75.jar:9.0.75]
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:153) ~[tomcat-embed-core-9.0.75.jar:9.0.75]
	at org.springframework.web.filter.FormContentFilter.doFilterInternal(FormContentFilter.java:93) ~[spring-web-5.3.27.jar:5.3.27]
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:117) ~[spring-web-5.3.27.jar:5.3.27]
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:178) ~[tomcat-embed-core-9.0.75.jar:9.0.75]
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:153) ~[tomcat-embed-core-9.0.75.jar:9.0.75]
	at org.springframework.boot.actuate.metrics.web.servlet.WebMvcMetricsFilter.doFilterInternal(WebMvcMetricsFilter.java:96) ~[spring-boot-actuator-2.7.12.jar:2.7.12]
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:117) ~[spring-web-5.3.27.jar:5.3.27]
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:178) ~[tomcat-embed-core-9.0.75.jar:9.0.75]
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:153) ~[tomcat-embed-core-9.0.75.jar:9.0.75]
	at org.springframework.web.filter.CharacterEncodingFilter.doFilterInternal(CharacterEncodingFilter.java:201) ~[spring-web-5.3.27.jar:5.3.27]
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:117) ~[spring-web-5.3.27.jar:5.3.27]
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:178) ~[tomcat-embed-core-9.0.75.jar:9.0.75]
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:153) ~[tomcat-embed-core-9.0.75.jar:9.0.75]
	at org.apache.catalina.core.StandardWrapperValve.invoke(StandardWrapperValve.java:167) ~[tomcat-embed-core-9.0.75.jar:9.0.75]
	at org.apache.catalina.core.StandardContextValve.invoke(StandardContextValve.java:90) ~[tomcat-embed-core-9.0.75.jar:9.0.75]
	at org.apache.catalina.authenticator.AuthenticatorBase.invoke(AuthenticatorBase.java:481) ~[tomcat-embed-core-9.0.75.jar:9.0.75]
	at org.apache.catalina.core.StandardHostValve.invoke(StandardHostValve.java:130) ~[tomcat-embed-core-9.0.75.jar:9.0.75]
	at org.apache.catalina.valves.ErrorReportValve.invoke(ErrorReportValve.java:93) ~[tomcat-embed-core-9.0.75.jar:9.0.75]
	at org.apache.catalina.core.StandardEngineValve.invoke(StandardEngineValve.java:74) ~[tomcat-embed-core-9.0.75.jar:9.0.75]
	at org.apache.catalina.connector.CoyoteAdapter.service(CoyoteAdapter.java:343) ~[tomcat-embed-core-9.0.75.jar:9.0.75]
	at org.apache.coyote.http11.Http11Processor.service(Http11Processor.java:390) ~[tomcat-embed-core-9.0.75.jar:9.0.75]
	at org.apache.coyote.AbstractProcessorLight.process(AbstractProcessorLight.java:63) ~[tomcat-embed-core-9.0.75.jar:9.0.75]
	at org.apache.coyote.AbstractProtocol$ConnectionHandler.process(AbstractProtocol.java:926) ~[tomcat-embed-core-9.0.75.jar:9.0.75]
	at org.apache.tomcat.util.net.NioEndpoint$SocketProcessor.doRun(NioEndpoint.java:1791) ~[tomcat-embed-core-9.0.75.jar:9.0.75]
	at org.apache.tomcat.util.net.SocketProcessorBase.run(SocketProcessorBase.java:52) ~[tomcat-embed-core-9.0.75.jar:9.0.75]
	at org.apache.tomcat.util.threads.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1191) ~[tomcat-embed-core-9.0.75.jar:9.0.75]
	at org.apache.tomcat.util.threads.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:659) ~[tomcat-embed-core-9.0.75.jar:9.0.75]
	at org.apache.tomcat.util.threads.TaskThread$WrappingRunnable.run(TaskThread.java:61) ~[tomcat-embed-core-9.0.75.jar:9.0.75]
	at java.base/java.lang.Thread.run(Thread.java:840) ~[na:na]

20:16:41:065  WARN 21756 --- [Thread-15] c.a.nacos.common.notify.NotifyCenter     : [NotifyCenter] Start destroying Publisher
20:16:41:074  WARN 21756 --- [Thread-15] c.a.nacos.common.notify.NotifyCenter     : [NotifyCenter] Destruction of the end
20:16:41:075  WARN 21756 --- [Thread-18] c.a.n.common.http.HttpClientBeanHolder   : [HttpClientBeanHolder] Start destroying common HttpClient
20:16:41:082  WARN 21756 --- [Thread-18] c.a.n.common.http.HttpClientBeanHolder   : [HttpClientBeanHolder] Destruction of the end
20:16:41:216  INFO 21756 --- [SpringApplicationShutdownHook] c.a.c.n.registry.NacosServiceRegistry    : De-registering from Nacos Server now...
20:16:41:560  INFO 21756 --- [SpringApplicationShutdownHook] c.a.c.n.registry.NacosServiceRegistry    : De-registration finished.
20:16:41:619  INFO 21756 --- [SpringApplicationShutdownHook] com.zaxxer.hikari.HikariDataSource       : HikariPool-1 - Shutdown initiated...
20:16:41:935  INFO 21756 --- [SpringApplicationShutdownHook] com.zaxxer.hikari.HikariDataSource       : HikariPool-1 - Shutdown completed.
20:21:50:226  INFO 36852 --- [main] c.l.his_service.HisServiceApplication    : Starting HisServiceApplication using Java 17.0.11 on luo with PID 36852 (A:\Desktop\workspace\HIS\his_service\target\classes started by 22407 in A:\Desktop\workspace\HIS)
20:21:50:230 DEBUG 36852 --- [main] c.l.his_service.HisServiceApplication    : Running with Spring Boot v2.7.12, Spring v5.3.27
20:21:50:230  INFO 36852 --- [main] c.l.his_service.HisServiceApplication    : The following 1 profile is active: "dev"
20:21:52:951  INFO 36852 --- [main] .s.d.r.c.RepositoryConfigurationDelegate : Multiple Spring Data modules found, entering strict repository configuration mode
20:21:52:955  INFO 36852 --- [main] .s.d.r.c.RepositoryConfigurationDelegate : Bootstrapping Spring Data Redis repositories in DEFAULT mode.
20:21:53:048  INFO 36852 --- [main] .s.d.r.c.RepositoryConfigurationDelegate : Finished Spring Data repository scanning in 23 ms. Found 0 Redis repository interfaces.
20:21:53:555  INFO 36852 --- [main] o.s.cloud.context.scope.GenericScope     : BeanFactory id=ac61872e-faec-371d-922e-ad941e5407d7
20:21:56:009  INFO 36852 --- [main] o.s.b.w.embedded.tomcat.TomcatWebServer  : Tomcat initialized with port(s): 8080 (http)
20:21:56:040  INFO 36852 --- [main] o.apache.catalina.core.StandardService   : Starting service [Tomcat]
20:21:56:041  INFO 36852 --- [main] org.apache.catalina.core.StandardEngine  : Starting Servlet engine: [Apache Tomcat/9.0.75]
20:21:56:318  INFO 36852 --- [main] o.a.c.c.C.[Tomcat].[localhost].[/]       : Initializing Spring embedded WebApplicationContext
20:21:56:318  INFO 36852 --- [main] w.s.c.ServletWebServerApplicationContext : Root WebApplicationContext: initialization completed in 5980 ms
20:21:56:943  INFO 36852 --- [main] org.redisson.Version                     : Redisson 3.17.7
20:21:57:720  INFO 36852 --- [redisson-netty-2-9] o.r.c.pool.MasterPubSubConnectionPool    : 1 connections initialized for 111.230.32.147/111.230.32.147:9631
20:21:58:395  INFO 36852 --- [redisson-netty-2-18] o.r.c.pool.MasterConnectionPool          : 24 connections initialized for 111.230.32.147/111.230.32.147:9631
20:21:59:060 DEBUG 36852 --- [main] c.l.h.filter.RefreshTokenFilter          : Filter 'refreshTokenFilter' configured for use
20:22:00:373  INFO 36852 --- [main] o.s.c.openfeign.FeignClientFactoryBean   : For 'flask-service' URL not provided. Will try picking an instance via load-balancing.
20:22:00:551  INFO 36852 --- [main] o.s.c.openfeign.FeignClientFactoryBean   : For 'ai-service' URL not provided. Will try picking an instance via load-balancing.
20:22:00:615  WARN 36852 --- [main] c.b.m.core.metadata.TableInfoHelper      : Can not find table primary key in Class: "java.lang.Object".
20:22:00:615  WARN 36852 --- [main] c.b.m.core.injector.DefaultSqlInjector   : class java.lang.Object ,Not found @TableId annotation, Cannot use Mybatis-Plus 'xxById' Method.
20:22:03:233  WARN 36852 --- [main] iguration$LoadBalancerCaffeineWarnLogger : Spring Cloud LoadBalancer is currently working with the default cache. While this cache implementation is useful for development and tests, it's recommended to use Caffeine cache in production.You can switch to using Caffeine cache, by adding it and org.springframework.cache.caffeine.CaffeineCacheManager to the classpath.
20:22:03:244  INFO 36852 --- [main] o.s.b.a.e.web.EndpointLinksResolver      : Exposing 1 endpoint(s) beneath base path '/actuator'
20:22:03:374  INFO 36852 --- [main] o.s.b.w.embedded.tomcat.TomcatWebServer  : Tomcat started on port(s): 8080 (http) with context path ''
20:22:03:430  INFO 36852 --- [main] c.a.n.p.a.s.c.ClientAuthPluginManager    : [ClientAuthPluginManager] Load ClientAuthService com.alibaba.nacos.client.auth.impl.NacosClientAuthServiceImpl success.
20:22:03:430  INFO 36852 --- [main] c.a.n.p.a.s.c.ClientAuthPluginManager    : [ClientAuthPluginManager] Load ClientAuthService com.alibaba.nacos.client.auth.ram.RamClientAuthServiceImpl success.
20:22:03:961  INFO 36852 --- [http-nio-8080-exec-2] o.a.c.c.C.[Tomcat].[localhost].[/]       : Initializing Spring DispatcherServlet 'dispatcherServlet'
20:22:03:962  INFO 36852 --- [http-nio-8080-exec-2] o.s.web.servlet.DispatcherServlet        : Initializing Servlet 'dispatcherServlet'
20:22:03:965  INFO 36852 --- [http-nio-8080-exec-2] o.s.web.servlet.DispatcherServlet        : Completed initialization in 3 ms
20:22:04:691  INFO 36852 --- [http-nio-8080-exec-2] com.zaxxer.hikari.HikariDataSource       : HikariPool-1 - Starting...
20:22:05:739  INFO 36852 --- [http-nio-8080-exec-2] com.zaxxer.hikari.HikariDataSource       : HikariPool-1 - Start completed.
20:22:05:763 DEBUG 36852 --- [http-nio-8080-exec-2] c.l.h.m.D.selectById                     : ==>  Preparing: SELECT id,patient_id,doctor_id,disease_name,disease_category,aimodel_id,result,create_time,status,id_card,name,score,remark FROM diagnosis_report WHERE id=?
20:22:05:817 DEBUG 36852 --- [http-nio-8080-exec-2] c.l.h.m.D.selectById                     : ==> Parameters: 1(Integer)
20:22:05:914 DEBUG 36852 --- [http-nio-8080-exec-2] c.l.h.m.D.selectById                     : <==      Total: 1
20:22:05:925 DEBUG 36852 --- [http-nio-8080-exec-2] c.l.h.mapper.PatientMapper.selectById    : ==>  Preparing: SELECT id,phone,id_card,name,verified,verified_by,verified_time,open_id,hospital_pid FROM patient WHERE id=?
20:22:05:926 DEBUG 36852 --- [http-nio-8080-exec-2] c.l.h.mapper.PatientMapper.selectById    : ==> Parameters: 1(Integer)
20:22:05:956 DEBUG 36852 --- [http-nio-8080-exec-2] c.l.h.mapper.PatientMapper.selectById    : <==      Total: 1
20:22:05:959 DEBUG 36852 --- [http-nio-8080-exec-2] c.l.h.mapper.DoctorMapper.selectById     : ==>  Preparing: SELECT id,phone,id_card,name,verified,verified_by,verified_time,license,department,hospital_pid FROM doctor WHERE id=?
20:22:05:960 DEBUG 36852 --- [http-nio-8080-exec-2] c.l.h.mapper.DoctorMapper.selectById     : ==> Parameters: 1(Integer)
20:22:05:992 DEBUG 36852 --- [http-nio-8080-exec-2] c.l.h.mapper.DoctorMapper.selectById     : <==      Total: 1
20:22:06:000 DEBUG 36852 --- [http-nio-8080-exec-2] c.l.h.m.E.selectListByDiagnosisId        : ==>  Preparing: select * from eye_images where dignosis_report_id = ?
20:22:06:001 DEBUG 36852 --- [http-nio-8080-exec-2] c.l.h.m.E.selectListByDiagnosisId        : ==> Parameters: 1(Integer)
20:22:06:032 DEBUG 36852 --- [http-nio-8080-exec-2] c.l.h.m.E.selectListByDiagnosisId        : <==      Total: 1
20:22:06:033 DEBUG 36852 --- [http-nio-8080-exec-2] c.l.h.m.T.selectByDiagnosisId            : ==>  Preparing: select * from treatment_plans where diagnosis_id = ?
20:22:06:033 DEBUG 36852 --- [http-nio-8080-exec-2] c.l.h.m.T.selectByDiagnosisId            : ==> Parameters: 1(Integer)
20:22:06:064 DEBUG 36852 --- [http-nio-8080-exec-2] c.l.h.m.T.selectByDiagnosisId            : <==      Total: 1
20:22:06:065 DEBUG 36852 --- [http-nio-8080-exec-2] c.l.h.m.M.selectByDiagnosisId            : ==>  Preparing: select * from medication_recommendations where diagnosis_id = ?
20:22:06:066 DEBUG 36852 --- [http-nio-8080-exec-2] c.l.h.m.M.selectByDiagnosisId            : ==> Parameters: 1(Integer)
20:22:06:097 DEBUG 36852 --- [http-nio-8080-exec-2] c.l.h.m.M.selectByDiagnosisId            : <==      Total: 1
20:22:06:098 DEBUG 36852 --- [http-nio-8080-exec-2] c.l.h.mapper.AiModelMapper.selectById    : ==>  Preparing: SELECT id,version,deploy_time,accuracy FROM ai_model WHERE id=?
20:22:06:098 DEBUG 36852 --- [http-nio-8080-exec-2] c.l.h.mapper.AiModelMapper.selectById    : ==> Parameters: 1(Integer)
20:22:06:107  INFO 36852 --- [main] c.a.n.c.a.AbstractAbilityControlManager  : Ready to get current node abilities...
20:22:06:110  INFO 36852 --- [main] c.a.n.c.a.AbstractAbilityControlManager  : Ready to initialize current node abilities, support modes: [SDK_CLIENT]
20:22:06:111  INFO 36852 --- [main] c.a.n.c.a.AbstractAbilityControlManager  : Initialize current abilities finish...
20:22:06:112  INFO 36852 --- [main] c.a.n.c.a.d.NacosAbilityManagerHolder    : [AbilityControlManager] Successfully initialize AbilityControlManager
20:22:06:129 DEBUG 36852 --- [http-nio-8080-exec-2] c.l.h.mapper.AiModelMapper.selectById    : <==      Total: 1
20:22:06:154 DEBUG 36852 --- [http-nio-8080-exec-2] c.l.api.client.FlaskAiDoctorClient       : [FlaskAiDoctorClient#eye_doctor_chat] ---> POST http://ai-service/api/eye-doctor/chat HTTP/1.1
20:22:06:155 DEBUG 36852 --- [http-nio-8080-exec-2] c.l.api.client.FlaskAiDoctorClient       : [FlaskAiDoctorClient#eye_doctor_chat] Content-Length: 753
20:22:06:155 DEBUG 36852 --- [http-nio-8080-exec-2] c.l.api.client.FlaskAiDoctorClient       : [FlaskAiDoctorClient#eye_doctor_chat] Content-Type: application/json
20:22:06:155 DEBUG 36852 --- [http-nio-8080-exec-2] c.l.api.client.FlaskAiDoctorClient       : [FlaskAiDoctorClient#eye_doctor_chat] 
20:22:06:155 DEBUG 36852 --- [http-nio-8080-exec-2] c.l.api.client.FlaskAiDoctorClient       : [FlaskAiDoctorClient#eye_doctor_chat] {"diagnosis_name":"","diagnosis_category":"","result":"A","remark":"A","treatment_plan":{"id":1,"treatmentType":1,"treatmentDetail":"","startTime":"2025-03-01 09:00:00","endDate":"2025-03-10 09:00:00","doctorId":1,"createdTime":"2025-03-01T09:00:00","updatedTime":"2025-03-01T09:00:00"},"medications":[{"id":1,"diagnosisId":1,"medicationName":"A","dosage":"10mg","frequency":"","sideEffects":"","startTime":"2025-03-01T09:00:00","endTime":"2025-03-10T09:00:00","doctorId":1,"createdTime":"2025-03-01 09:00:00","updatedTime":"2025-03-01 09:00:00"}],"previous_conversations":[{"role":"pariatur tempor do","content":"sit cupidatat commodo"}],"question":"irure eu esse","stream":false}
20:22:06:156 DEBUG 36852 --- [http-nio-8080-exec-2] c.l.api.client.FlaskAiDoctorClient       : [FlaskAiDoctorClient#eye_doctor_chat] ---> END HTTP (753-byte body)
20:22:07:162  INFO 36852 --- [main] c.a.c.n.registry.NacosServiceRegistry    : nacos registry, DEFAULT_GROUP his-service 10.21.93.70:8848 register finished
20:22:07:461  INFO 36852 --- [main] c.l.his_service.HisServiceApplication    : Started HisServiceApplication in 19.077 seconds (JVM running for 22.054)
20:22:07:527  WARN 36852 --- [http-nio-8080-exec-2] o.s.c.l.core.RoundRobinLoadBalancer      : No servers available for service: ai-service
20:22:07:529  WARN 36852 --- [http-nio-8080-exec-2] .s.c.o.l.FeignBlockingLoadBalancerClient : Load balancer does not contain an instance for the service ai-service
20:22:07:531 DEBUG 36852 --- [http-nio-8080-exec-2] c.l.api.client.FlaskAiDoctorClient       : [FlaskAiDoctorClient#eye_doctor_chat] <--- HTTP/1.1 503 (1374ms)
20:22:07:531 DEBUG 36852 --- [http-nio-8080-exec-2] c.l.api.client.FlaskAiDoctorClient       : [FlaskAiDoctorClient#eye_doctor_chat] 
20:22:07:531 DEBUG 36852 --- [http-nio-8080-exec-2] c.l.api.client.FlaskAiDoctorClient       : [FlaskAiDoctorClient#eye_doctor_chat] Load balancer does not contain an instance for the service ai-service
20:22:07:531 DEBUG 36852 --- [http-nio-8080-exec-2] c.l.api.client.FlaskAiDoctorClient       : [FlaskAiDoctorClient#eye_doctor_chat] <--- END HTTP (69-byte body)
20:22:07:554 ERROR 36852 --- [http-nio-8080-exec-2] o.a.c.c.C.[.[.[/].[dispatcherServlet]    : Servlet.service() for servlet [dispatcherServlet] in context with path [] threw exception [Request processing failed; nested exception is feign.FeignException$ServiceUnavailable: [503] during [POST] to [http://ai-service/api/eye-doctor/chat] [FlaskAiDoctorClient#eye_doctor_chat(ChatForm)]: [Load balancer does not contain an instance for the service ai-service]] with root cause

feign.FeignException$ServiceUnavailable: [503] during [POST] to [http://ai-service/api/eye-doctor/chat] [FlaskAiDoctorClient#eye_doctor_chat(ChatForm)]: [Load balancer does not contain an instance for the service ai-service]
	at feign.FeignException.serverErrorStatus(FeignException.java:256) ~[feign-core-11.10.jar:na]
	at feign.FeignException.errorStatus(FeignException.java:197) ~[feign-core-11.10.jar:na]
	at feign.FeignException.errorStatus(FeignException.java:185) ~[feign-core-11.10.jar:na]
	at feign.codec.ErrorDecoder$Default.decode(ErrorDecoder.java:92) ~[feign-core-11.10.jar:na]
	at feign.AsyncResponseHandler.handleResponse(AsyncResponseHandler.java:98) ~[feign-core-11.10.jar:na]
	at feign.SynchronousMethodHandler.executeAndDecode(SynchronousMethodHandler.java:141) ~[feign-core-11.10.jar:na]
	at feign.SynchronousMethodHandler.invoke(SynchronousMethodHandler.java:91) ~[feign-core-11.10.jar:na]
	at feign.ReflectiveFeign$FeignInvocationHandler.invoke(ReflectiveFeign.java:100) ~[feign-core-11.10.jar:na]
	at jdk.proxy2/jdk.proxy2.$Proxy135.eye_doctor_chat(Unknown Source) ~[na:na]
	at com.luojiawei.his_service.controller.ChatController.ask(ChatController.java:39) ~[classes/:na]
	at java.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke0(Native Method) ~[na:na]
	at java.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:77) ~[na:na]
	at java.base/jdk.internal.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43) ~[na:na]
	at java.base/java.lang.reflect.Method.invoke(Method.java:568) ~[na:na]
	at org.springframework.web.method.support.InvocableHandlerMethod.doInvoke(InvocableHandlerMethod.java:205) ~[spring-web-5.3.27.jar:5.3.27]
	at org.springframework.web.method.support.InvocableHandlerMethod.invokeForRequest(InvocableHandlerMethod.java:150) ~[spring-web-5.3.27.jar:5.3.27]
	at org.springframework.web.servlet.mvc.method.annotation.ServletInvocableHandlerMethod.invokeAndHandle(ServletInvocableHandlerMethod.java:117) ~[spring-webmvc-5.3.27.jar:5.3.27]
	at org.springframework.web.servlet.mvc.method.annotation.RequestMappingHandlerAdapter.invokeHandlerMethod(RequestMappingHandlerAdapter.java:895) ~[spring-webmvc-5.3.27.jar:5.3.27]
	at org.springframework.web.servlet.mvc.method.annotation.RequestMappingHandlerAdapter.handleInternal(RequestMappingHandlerAdapter.java:808) ~[spring-webmvc-5.3.27.jar:5.3.27]
	at org.springframework.web.servlet.mvc.method.AbstractHandlerMethodAdapter.handle(AbstractHandlerMethodAdapter.java:87) ~[spring-webmvc-5.3.27.jar:5.3.27]
	at org.springframework.web.servlet.DispatcherServlet.doDispatch(DispatcherServlet.java:1072) ~[spring-webmvc-5.3.27.jar:5.3.27]
	at org.springframework.web.servlet.DispatcherServlet.doService(DispatcherServlet.java:965) ~[spring-webmvc-5.3.27.jar:5.3.27]
	at org.springframework.web.servlet.FrameworkServlet.processRequest(FrameworkServlet.java:1006) ~[spring-webmvc-5.3.27.jar:5.3.27]
	at org.springframework.web.servlet.FrameworkServlet.doPost(FrameworkServlet.java:909) ~[spring-webmvc-5.3.27.jar:5.3.27]
	at javax.servlet.http.HttpServlet.service(HttpServlet.java:555) ~[tomcat-embed-core-9.0.75.jar:4.0.FR]
	at org.springframework.web.servlet.FrameworkServlet.service(FrameworkServlet.java:883) ~[spring-webmvc-5.3.27.jar:5.3.27]
	at javax.servlet.http.HttpServlet.service(HttpServlet.java:623) ~[tomcat-embed-core-9.0.75.jar:4.0.FR]
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:209) ~[tomcat-embed-core-9.0.75.jar:9.0.75]
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:153) ~[tomcat-embed-core-9.0.75.jar:9.0.75]
	at com.luojiawei.his_service.filter.RefreshTokenFilter.doFilterInternal(RefreshTokenFilter.java:58) ~[classes/:na]
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:117) ~[spring-web-5.3.27.jar:5.3.27]
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:178) ~[tomcat-embed-core-9.0.75.jar:9.0.75]
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:153) ~[tomcat-embed-core-9.0.75.jar:9.0.75]
	at org.springframework.web.filter.RequestContextFilter.doFilterInternal(RequestContextFilter.java:100) ~[spring-web-5.3.27.jar:5.3.27]
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:117) ~[spring-web-5.3.27.jar:5.3.27]
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:178) ~[tomcat-embed-core-9.0.75.jar:9.0.75]
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:153) ~[tomcat-embed-core-9.0.75.jar:9.0.75]
	at org.springframework.web.filter.FormContentFilter.doFilterInternal(FormContentFilter.java:93) ~[spring-web-5.3.27.jar:5.3.27]
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:117) ~[spring-web-5.3.27.jar:5.3.27]
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:178) ~[tomcat-embed-core-9.0.75.jar:9.0.75]
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:153) ~[tomcat-embed-core-9.0.75.jar:9.0.75]
	at org.springframework.boot.actuate.metrics.web.servlet.WebMvcMetricsFilter.doFilterInternal(WebMvcMetricsFilter.java:96) ~[spring-boot-actuator-2.7.12.jar:2.7.12]
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:117) ~[spring-web-5.3.27.jar:5.3.27]
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:178) ~[tomcat-embed-core-9.0.75.jar:9.0.75]
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:153) ~[tomcat-embed-core-9.0.75.jar:9.0.75]
	at org.springframework.web.filter.CharacterEncodingFilter.doFilterInternal(CharacterEncodingFilter.java:201) ~[spring-web-5.3.27.jar:5.3.27]
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:117) ~[spring-web-5.3.27.jar:5.3.27]
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:178) ~[tomcat-embed-core-9.0.75.jar:9.0.75]
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:153) ~[tomcat-embed-core-9.0.75.jar:9.0.75]
	at org.apache.catalina.core.StandardWrapperValve.invoke(StandardWrapperValve.java:167) ~[tomcat-embed-core-9.0.75.jar:9.0.75]
	at org.apache.catalina.core.StandardContextValve.invoke(StandardContextValve.java:90) ~[tomcat-embed-core-9.0.75.jar:9.0.75]
	at org.apache.catalina.authenticator.AuthenticatorBase.invoke(AuthenticatorBase.java:481) ~[tomcat-embed-core-9.0.75.jar:9.0.75]
	at org.apache.catalina.core.StandardHostValve.invoke(StandardHostValve.java:130) ~[tomcat-embed-core-9.0.75.jar:9.0.75]
	at org.apache.catalina.valves.ErrorReportValve.invoke(ErrorReportValve.java:93) ~[tomcat-embed-core-9.0.75.jar:9.0.75]
	at org.apache.catalina.core.StandardEngineValve.invoke(StandardEngineValve.java:74) ~[tomcat-embed-core-9.0.75.jar:9.0.75]
	at org.apache.catalina.connector.CoyoteAdapter.service(CoyoteAdapter.java:343) ~[tomcat-embed-core-9.0.75.jar:9.0.75]
	at org.apache.coyote.http11.Http11Processor.service(Http11Processor.java:390) ~[tomcat-embed-core-9.0.75.jar:9.0.75]
	at org.apache.coyote.AbstractProcessorLight.process(AbstractProcessorLight.java:63) ~[tomcat-embed-core-9.0.75.jar:9.0.75]
	at org.apache.coyote.AbstractProtocol$ConnectionHandler.process(AbstractProtocol.java:926) ~[tomcat-embed-core-9.0.75.jar:9.0.75]
	at org.apache.tomcat.util.net.NioEndpoint$SocketProcessor.doRun(NioEndpoint.java:1791) ~[tomcat-embed-core-9.0.75.jar:9.0.75]
	at org.apache.tomcat.util.net.SocketProcessorBase.run(SocketProcessorBase.java:52) ~[tomcat-embed-core-9.0.75.jar:9.0.75]
	at org.apache.tomcat.util.threads.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1191) ~[tomcat-embed-core-9.0.75.jar:9.0.75]
	at org.apache.tomcat.util.threads.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:659) ~[tomcat-embed-core-9.0.75.jar:9.0.75]
	at org.apache.tomcat.util.threads.TaskThread$WrappingRunnable.run(TaskThread.java:61) ~[tomcat-embed-core-9.0.75.jar:9.0.75]
	at java.base/java.lang.Thread.run(Thread.java:840) ~[na:na]

20:23:20:536 DEBUG 36852 --- [http-nio-8080-exec-5] c.l.h.m.D.selectById                     : ==>  Preparing: SELECT id,patient_id,doctor_id,disease_name,disease_category,aimodel_id,result,create_time,status,id_card,name,score,remark FROM diagnosis_report WHERE id=?
20:23:20:536 DEBUG 36852 --- [http-nio-8080-exec-5] c.l.h.m.D.selectById                     : ==> Parameters: 1(Integer)
20:23:20:567 DEBUG 36852 --- [http-nio-8080-exec-5] c.l.h.m.D.selectById                     : <==      Total: 1
20:23:20:568 DEBUG 36852 --- [http-nio-8080-exec-5] c.l.h.mapper.PatientMapper.selectById    : ==>  Preparing: SELECT id,phone,id_card,name,verified,verified_by,verified_time,open_id,hospital_pid FROM patient WHERE id=?
20:23:20:568 DEBUG 36852 --- [http-nio-8080-exec-5] c.l.h.mapper.PatientMapper.selectById    : ==> Parameters: 1(Integer)
20:23:20:599 DEBUG 36852 --- [http-nio-8080-exec-5] c.l.h.mapper.PatientMapper.selectById    : <==      Total: 1
20:23:20:600 DEBUG 36852 --- [http-nio-8080-exec-5] c.l.h.mapper.DoctorMapper.selectById     : ==>  Preparing: SELECT id,phone,id_card,name,verified,verified_by,verified_time,license,department,hospital_pid FROM doctor WHERE id=?
20:23:20:600 DEBUG 36852 --- [http-nio-8080-exec-5] c.l.h.mapper.DoctorMapper.selectById     : ==> Parameters: 1(Integer)
20:23:20:630 DEBUG 36852 --- [http-nio-8080-exec-5] c.l.h.mapper.DoctorMapper.selectById     : <==      Total: 1
20:23:20:631 DEBUG 36852 --- [http-nio-8080-exec-5] c.l.h.m.E.selectListByDiagnosisId        : ==>  Preparing: select * from eye_images where dignosis_report_id = ?
20:23:20:631 DEBUG 36852 --- [http-nio-8080-exec-5] c.l.h.m.E.selectListByDiagnosisId        : ==> Parameters: 1(Integer)
20:23:20:661 DEBUG 36852 --- [http-nio-8080-exec-5] c.l.h.m.E.selectListByDiagnosisId        : <==      Total: 1
20:23:20:662 DEBUG 36852 --- [http-nio-8080-exec-5] c.l.h.m.T.selectByDiagnosisId            : ==>  Preparing: select * from treatment_plans where diagnosis_id = ?
20:23:20:662 DEBUG 36852 --- [http-nio-8080-exec-5] c.l.h.m.T.selectByDiagnosisId            : ==> Parameters: 1(Integer)
20:23:20:692 DEBUG 36852 --- [http-nio-8080-exec-5] c.l.h.m.T.selectByDiagnosisId            : <==      Total: 1
20:23:20:693 DEBUG 36852 --- [http-nio-8080-exec-5] c.l.h.m.M.selectByDiagnosisId            : ==>  Preparing: select * from medication_recommendations where diagnosis_id = ?
20:23:20:693 DEBUG 36852 --- [http-nio-8080-exec-5] c.l.h.m.M.selectByDiagnosisId            : ==> Parameters: 1(Integer)
20:23:20:723 DEBUG 36852 --- [http-nio-8080-exec-5] c.l.h.m.M.selectByDiagnosisId            : <==      Total: 1
20:23:20:724 DEBUG 36852 --- [http-nio-8080-exec-5] c.l.h.mapper.AiModelMapper.selectById    : ==>  Preparing: SELECT id,version,deploy_time,accuracy FROM ai_model WHERE id=?
20:23:20:725 DEBUG 36852 --- [http-nio-8080-exec-5] c.l.h.mapper.AiModelMapper.selectById    : ==> Parameters: 1(Integer)
20:23:20:755 DEBUG 36852 --- [http-nio-8080-exec-5] c.l.h.mapper.AiModelMapper.selectById    : <==      Total: 1
20:23:20:757 DEBUG 36852 --- [http-nio-8080-exec-5] c.l.api.client.FlaskAiDoctorClient       : [FlaskAiDoctorClient#eye_doctor_chat] ---> POST http://ai-service/api/eye-doctor/chat HTTP/1.1
20:23:20:758 DEBUG 36852 --- [http-nio-8080-exec-5] c.l.api.client.FlaskAiDoctorClient       : [FlaskAiDoctorClient#eye_doctor_chat] Content-Length: 753
20:23:20:758 DEBUG 36852 --- [http-nio-8080-exec-5] c.l.api.client.FlaskAiDoctorClient       : [FlaskAiDoctorClient#eye_doctor_chat] Content-Type: application/json
20:23:20:758 DEBUG 36852 --- [http-nio-8080-exec-5] c.l.api.client.FlaskAiDoctorClient       : [FlaskAiDoctorClient#eye_doctor_chat] 
20:23:20:758 DEBUG 36852 --- [http-nio-8080-exec-5] c.l.api.client.FlaskAiDoctorClient       : [FlaskAiDoctorClient#eye_doctor_chat] {"diagnosis_name":"","diagnosis_category":"","result":"A","remark":"A","treatment_plan":{"id":1,"treatmentType":1,"treatmentDetail":"","startTime":"2025-03-01 09:00:00","endDate":"2025-03-10 09:00:00","doctorId":1,"createdTime":"2025-03-01T09:00:00","updatedTime":"2025-03-01T09:00:00"},"medications":[{"id":1,"diagnosisId":1,"medicationName":"A","dosage":"10mg","frequency":"","sideEffects":"","startTime":"2025-03-01T09:00:00","endTime":"2025-03-10T09:00:00","doctorId":1,"createdTime":"2025-03-01 09:00:00","updatedTime":"2025-03-01 09:00:00"}],"previous_conversations":[{"role":"pariatur tempor do","content":"sit cupidatat commodo"}],"question":"irure eu esse","stream":false}
20:23:20:759 DEBUG 36852 --- [http-nio-8080-exec-5] c.l.api.client.FlaskAiDoctorClient       : [FlaskAiDoctorClient#eye_doctor_chat] ---> END HTTP (753-byte body)
20:23:22:830 DEBUG 36852 --- [http-nio-8080-exec-5] c.l.api.client.FlaskAiDoctorClient       : [FlaskAiDoctorClient#eye_doctor_chat] <--- ERROR ConnectException: Connection refused: getsockopt (2071ms)
20:23:22:831 DEBUG 36852 --- [http-nio-8080-exec-5] c.l.api.client.FlaskAiDoctorClient       : [FlaskAiDoctorClient#eye_doctor_chat] java.net.ConnectException: Connection refused: getsockopt
	at java.base/sun.nio.ch.Net.pollConnect(Native Method)
	at java.base/sun.nio.ch.Net.pollConnectNow(Net.java:672)
	at java.base/sun.nio.ch.NioSocketImpl.timedFinishConnect(NioSocketImpl.java:554)
	at java.base/sun.nio.ch.NioSocketImpl.connect(NioSocketImpl.java:602)
	at java.base/java.net.Socket.connect(Socket.java:633)
	at java.base/sun.net.NetworkClient.doConnect(NetworkClient.java:178)
	at java.base/sun.net.www.http.HttpClient.openServer(HttpClient.java:533)
	at java.base/sun.net.www.http.HttpClient.openServer(HttpClient.java:638)
	at java.base/sun.net.www.http.HttpClient.<init>(HttpClient.java:281)
	at java.base/sun.net.www.http.HttpClient.New(HttpClient.java:386)
	at java.base/sun.net.www.http.HttpClient.New(HttpClient.java:408)
	at java.base/sun.net.www.protocol.http.HttpURLConnection.getNewHttpClient(HttpURLConnection.java:1309)
	at java.base/sun.net.www.protocol.http.HttpURLConnection.plainConnect0(HttpURLConnection.java:1242)
	at java.base/sun.net.www.protocol.http.HttpURLConnection.plainConnect(HttpURLConnection.java:1128)
	at java.base/sun.net.www.protocol.http.HttpURLConnection.connect(HttpURLConnection.java:1057)
	at java.base/sun.net.www.protocol.http.HttpURLConnection.getOutputStream0(HttpURLConnection.java:1451)
	at java.base/sun.net.www.protocol.http.HttpURLConnection.getOutputStream(HttpURLConnection.java:1422)
	at feign.Client$Default.convertAndSend(Client.java:208)
	at feign.Client$Default.execute(Client.java:105)
	at org.springframework.cloud.openfeign.loadbalancer.LoadBalancerUtils.executeWithLoadBalancerLifecycleProcessing(LoadBalancerUtils.java:57)
	at org.springframework.cloud.openfeign.loadbalancer.LoadBalancerUtils.executeWithLoadBalancerLifecycleProcessing(LoadBalancerUtils.java:95)
	at org.springframework.cloud.openfeign.loadbalancer.FeignBlockingLoadBalancerClient.execute(FeignBlockingLoadBalancerClient.java:114)
	at feign.SynchronousMethodHandler.executeAndDecode(SynchronousMethodHandler.java:121)
	at feign.SynchronousMethodHandler.invoke(SynchronousMethodHandler.java:91)
	at feign.ReflectiveFeign$FeignInvocationHandler.invoke(ReflectiveFeign.java:100)
	at jdk.proxy2/jdk.proxy2.$Proxy135.eye_doctor_chat(Unknown Source)
	at com.luojiawei.his_service.controller.ChatController.ask(ChatController.java:39)
	at java.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at java.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:77)
	at java.base/jdk.internal.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.base/java.lang.reflect.Method.invoke(Method.java:568)
	at org.springframework.web.method.support.InvocableHandlerMethod.doInvoke(InvocableHandlerMethod.java:205)
	at org.springframework.web.method.support.InvocableHandlerMethod.invokeForRequest(InvocableHandlerMethod.java:150)
	at org.springframework.web.servlet.mvc.method.annotation.ServletInvocableHandlerMethod.invokeAndHandle(ServletInvocableHandlerMethod.java:117)
	at org.springframework.web.servlet.mvc.method.annotation.RequestMappingHandlerAdapter.invokeHandlerMethod(RequestMappingHandlerAdapter.java:895)
	at org.springframework.web.servlet.mvc.method.annotation.RequestMappingHandlerAdapter.handleInternal(RequestMappingHandlerAdapter.java:808)
	at org.springframework.web.servlet.mvc.method.AbstractHandlerMethodAdapter.handle(AbstractHandlerMethodAdapter.java:87)
	at org.springframework.web.servlet.DispatcherServlet.doDispatch(DispatcherServlet.java:1072)
	at org.springframework.web.servlet.DispatcherServlet.doService(DispatcherServlet.java:965)
	at org.springframework.web.servlet.FrameworkServlet.processRequest(FrameworkServlet.java:1006)
	at org.springframework.web.servlet.FrameworkServlet.doPost(FrameworkServlet.java:909)
	at javax.servlet.http.HttpServlet.service(HttpServlet.java:555)
	at org.springframework.web.servlet.FrameworkServlet.service(FrameworkServlet.java:883)
	at javax.servlet.http.HttpServlet.service(HttpServlet.java:623)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:209)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:153)
	at com.luojiawei.his_service.filter.RefreshTokenFilter.doFilterInternal(RefreshTokenFilter.java:58)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:117)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:178)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:153)
	at org.springframework.web.filter.RequestContextFilter.doFilterInternal(RequestContextFilter.java:100)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:117)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:178)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:153)
	at org.springframework.web.filter.FormContentFilter.doFilterInternal(FormContentFilter.java:93)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:117)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:178)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:153)
	at org.springframework.boot.actuate.metrics.web.servlet.WebMvcMetricsFilter.doFilterInternal(WebMvcMetricsFilter.java:96)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:117)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:178)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:153)
	at org.springframework.web.filter.CharacterEncodingFilter.doFilterInternal(CharacterEncodingFilter.java:201)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:117)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:178)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:153)
	at org.apache.catalina.core.StandardWrapperValve.invoke(StandardWrapperValve.java:167)
	at org.apache.catalina.core.StandardContextValve.invoke(StandardContextValve.java:90)
	at org.apache.catalina.authenticator.AuthenticatorBase.invoke(AuthenticatorBase.java:481)
	at org.apache.catalina.core.StandardHostValve.invoke(StandardHostValve.java:130)
	at org.apache.catalina.valves.ErrorReportValve.invoke(ErrorReportValve.java:93)
	at org.apache.catalina.core.StandardEngineValve.invoke(StandardEngineValve.java:74)
	at org.apache.catalina.connector.CoyoteAdapter.service(CoyoteAdapter.java:343)
	at org.apache.coyote.http11.Http11Processor.service(Http11Processor.java:390)
	at org.apache.coyote.AbstractProcessorLight.process(AbstractProcessorLight.java:63)
	at org.apache.coyote.AbstractProtocol$ConnectionHandler.process(AbstractProtocol.java:926)
	at org.apache.tomcat.util.net.NioEndpoint$SocketProcessor.doRun(NioEndpoint.java:1791)
	at org.apache.tomcat.util.net.SocketProcessorBase.run(SocketProcessorBase.java:52)
	at org.apache.tomcat.util.threads.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1191)
	at org.apache.tomcat.util.threads.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:659)
	at org.apache.tomcat.util.threads.TaskThread$WrappingRunnable.run(TaskThread.java:61)
	at java.base/java.lang.Thread.run(Thread.java:840)

20:23:22:831 DEBUG 36852 --- [http-nio-8080-exec-5] c.l.api.client.FlaskAiDoctorClient       : [FlaskAiDoctorClient#eye_doctor_chat] <--- END ERROR
20:23:22:833 ERROR 36852 --- [http-nio-8080-exec-5] o.a.c.c.C.[.[.[/].[dispatcherServlet]    : Servlet.service() for servlet [dispatcherServlet] in context with path [] threw exception [Request processing failed; nested exception is feign.RetryableException: Connection refused: getsockopt executing POST http://ai-service/api/eye-doctor/chat] with root cause

java.net.ConnectException: Connection refused: getsockopt
	at java.base/sun.nio.ch.Net.pollConnect(Native Method) ~[na:na]
	at java.base/sun.nio.ch.Net.pollConnectNow(Net.java:672) ~[na:na]
	at java.base/sun.nio.ch.NioSocketImpl.timedFinishConnect(NioSocketImpl.java:554) ~[na:na]
	at java.base/sun.nio.ch.NioSocketImpl.connect(NioSocketImpl.java:602) ~[na:na]
	at java.base/java.net.Socket.connect(Socket.java:633) ~[na:na]
	at java.base/sun.net.NetworkClient.doConnect(NetworkClient.java:178) ~[na:na]
	at java.base/sun.net.www.http.HttpClient.openServer(HttpClient.java:533) ~[na:na]
	at java.base/sun.net.www.http.HttpClient.openServer(HttpClient.java:638) ~[na:na]
	at java.base/sun.net.www.http.HttpClient.<init>(HttpClient.java:281) ~[na:na]
	at java.base/sun.net.www.http.HttpClient.New(HttpClient.java:386) ~[na:na]
	at java.base/sun.net.www.http.HttpClient.New(HttpClient.java:408) ~[na:na]
	at java.base/sun.net.www.protocol.http.HttpURLConnection.getNewHttpClient(HttpURLConnection.java:1309) ~[na:na]
	at java.base/sun.net.www.protocol.http.HttpURLConnection.plainConnect0(HttpURLConnection.java:1242) ~[na:na]
	at java.base/sun.net.www.protocol.http.HttpURLConnection.plainConnect(HttpURLConnection.java:1128) ~[na:na]
	at java.base/sun.net.www.protocol.http.HttpURLConnection.connect(HttpURLConnection.java:1057) ~[na:na]
	at java.base/sun.net.www.protocol.http.HttpURLConnection.getOutputStream0(HttpURLConnection.java:1451) ~[na:na]
	at java.base/sun.net.www.protocol.http.HttpURLConnection.getOutputStream(HttpURLConnection.java:1422) ~[na:na]
	at feign.Client$Default.convertAndSend(Client.java:208) ~[feign-core-11.10.jar:na]
	at feign.Client$Default.execute(Client.java:105) ~[feign-core-11.10.jar:na]
	at org.springframework.cloud.openfeign.loadbalancer.LoadBalancerUtils.executeWithLoadBalancerLifecycleProcessing(LoadBalancerUtils.java:57) ~[spring-cloud-openfeign-core-3.1.5.jar:3.1.5]
	at org.springframework.cloud.openfeign.loadbalancer.LoadBalancerUtils.executeWithLoadBalancerLifecycleProcessing(LoadBalancerUtils.java:95) ~[spring-cloud-openfeign-core-3.1.5.jar:3.1.5]
	at org.springframework.cloud.openfeign.loadbalancer.FeignBlockingLoadBalancerClient.execute(FeignBlockingLoadBalancerClient.java:114) ~[spring-cloud-openfeign-core-3.1.5.jar:3.1.5]
	at feign.SynchronousMethodHandler.executeAndDecode(SynchronousMethodHandler.java:121) ~[feign-core-11.10.jar:na]
	at feign.SynchronousMethodHandler.invoke(SynchronousMethodHandler.java:91) ~[feign-core-11.10.jar:na]
	at feign.ReflectiveFeign$FeignInvocationHandler.invoke(ReflectiveFeign.java:100) ~[feign-core-11.10.jar:na]
	at jdk.proxy2/jdk.proxy2.$Proxy135.eye_doctor_chat(Unknown Source) ~[na:na]
	at com.luojiawei.his_service.controller.ChatController.ask(ChatController.java:39) ~[classes/:na]
	at java.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke0(Native Method) ~[na:na]
	at java.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:77) ~[na:na]
	at java.base/jdk.internal.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43) ~[na:na]
	at java.base/java.lang.reflect.Method.invoke(Method.java:568) ~[na:na]
	at org.springframework.web.method.support.InvocableHandlerMethod.doInvoke(InvocableHandlerMethod.java:205) ~[spring-web-5.3.27.jar:5.3.27]
	at org.springframework.web.method.support.InvocableHandlerMethod.invokeForRequest(InvocableHandlerMethod.java:150) ~[spring-web-5.3.27.jar:5.3.27]
	at org.springframework.web.servlet.mvc.method.annotation.ServletInvocableHandlerMethod.invokeAndHandle(ServletInvocableHandlerMethod.java:117) ~[spring-webmvc-5.3.27.jar:5.3.27]
	at org.springframework.web.servlet.mvc.method.annotation.RequestMappingHandlerAdapter.invokeHandlerMethod(RequestMappingHandlerAdapter.java:895) ~[spring-webmvc-5.3.27.jar:5.3.27]
	at org.springframework.web.servlet.mvc.method.annotation.RequestMappingHandlerAdapter.handleInternal(RequestMappingHandlerAdapter.java:808) ~[spring-webmvc-5.3.27.jar:5.3.27]
	at org.springframework.web.servlet.mvc.method.AbstractHandlerMethodAdapter.handle(AbstractHandlerMethodAdapter.java:87) ~[spring-webmvc-5.3.27.jar:5.3.27]
	at org.springframework.web.servlet.DispatcherServlet.doDispatch(DispatcherServlet.java:1072) ~[spring-webmvc-5.3.27.jar:5.3.27]
	at org.springframework.web.servlet.DispatcherServlet.doService(DispatcherServlet.java:965) ~[spring-webmvc-5.3.27.jar:5.3.27]
	at org.springframework.web.servlet.FrameworkServlet.processRequest(FrameworkServlet.java:1006) ~[spring-webmvc-5.3.27.jar:5.3.27]
	at org.springframework.web.servlet.FrameworkServlet.doPost(FrameworkServlet.java:909) ~[spring-webmvc-5.3.27.jar:5.3.27]
	at javax.servlet.http.HttpServlet.service(HttpServlet.java:555) ~[tomcat-embed-core-9.0.75.jar:4.0.FR]
	at org.springframework.web.servlet.FrameworkServlet.service(FrameworkServlet.java:883) ~[spring-webmvc-5.3.27.jar:5.3.27]
	at javax.servlet.http.HttpServlet.service(HttpServlet.java:623) ~[tomcat-embed-core-9.0.75.jar:4.0.FR]
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:209) ~[tomcat-embed-core-9.0.75.jar:9.0.75]
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:153) ~[tomcat-embed-core-9.0.75.jar:9.0.75]
	at com.luojiawei.his_service.filter.RefreshTokenFilter.doFilterInternal(RefreshTokenFilter.java:58) ~[classes/:na]
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:117) ~[spring-web-5.3.27.jar:5.3.27]
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:178) ~[tomcat-embed-core-9.0.75.jar:9.0.75]
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:153) ~[tomcat-embed-core-9.0.75.jar:9.0.75]
	at org.springframework.web.filter.RequestContextFilter.doFilterInternal(RequestContextFilter.java:100) ~[spring-web-5.3.27.jar:5.3.27]
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:117) ~[spring-web-5.3.27.jar:5.3.27]
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:178) ~[tomcat-embed-core-9.0.75.jar:9.0.75]
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:153) ~[tomcat-embed-core-9.0.75.jar:9.0.75]
	at org.springframework.web.filter.FormContentFilter.doFilterInternal(FormContentFilter.java:93) ~[spring-web-5.3.27.jar:5.3.27]
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:117) ~[spring-web-5.3.27.jar:5.3.27]
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:178) ~[tomcat-embed-core-9.0.75.jar:9.0.75]
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:153) ~[tomcat-embed-core-9.0.75.jar:9.0.75]
	at org.springframework.boot.actuate.metrics.web.servlet.WebMvcMetricsFilter.doFilterInternal(WebMvcMetricsFilter.java:96) ~[spring-boot-actuator-2.7.12.jar:2.7.12]
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:117) ~[spring-web-5.3.27.jar:5.3.27]
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:178) ~[tomcat-embed-core-9.0.75.jar:9.0.75]
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:153) ~[tomcat-embed-core-9.0.75.jar:9.0.75]
	at org.springframework.web.filter.CharacterEncodingFilter.doFilterInternal(CharacterEncodingFilter.java:201) ~[spring-web-5.3.27.jar:5.3.27]
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:117) ~[spring-web-5.3.27.jar:5.3.27]
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:178) ~[tomcat-embed-core-9.0.75.jar:9.0.75]
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:153) ~[tomcat-embed-core-9.0.75.jar:9.0.75]
	at org.apache.catalina.core.StandardWrapperValve.invoke(StandardWrapperValve.java:167) ~[tomcat-embed-core-9.0.75.jar:9.0.75]
	at org.apache.catalina.core.StandardContextValve.invoke(StandardContextValve.java:90) ~[tomcat-embed-core-9.0.75.jar:9.0.75]
	at org.apache.catalina.authenticator.AuthenticatorBase.invoke(AuthenticatorBase.java:481) ~[tomcat-embed-core-9.0.75.jar:9.0.75]
	at org.apache.catalina.core.StandardHostValve.invoke(StandardHostValve.java:130) ~[tomcat-embed-core-9.0.75.jar:9.0.75]
	at org.apache.catalina.valves.ErrorReportValve.invoke(ErrorReportValve.java:93) ~[tomcat-embed-core-9.0.75.jar:9.0.75]
	at org.apache.catalina.core.StandardEngineValve.invoke(StandardEngineValve.java:74) ~[tomcat-embed-core-9.0.75.jar:9.0.75]
	at org.apache.catalina.connector.CoyoteAdapter.service(CoyoteAdapter.java:343) ~[tomcat-embed-core-9.0.75.jar:9.0.75]
	at org.apache.coyote.http11.Http11Processor.service(Http11Processor.java:390) ~[tomcat-embed-core-9.0.75.jar:9.0.75]
	at org.apache.coyote.AbstractProcessorLight.process(AbstractProcessorLight.java:63) ~[tomcat-embed-core-9.0.75.jar:9.0.75]
	at org.apache.coyote.AbstractProtocol$ConnectionHandler.process(AbstractProtocol.java:926) ~[tomcat-embed-core-9.0.75.jar:9.0.75]
	at org.apache.tomcat.util.net.NioEndpoint$SocketProcessor.doRun(NioEndpoint.java:1791) ~[tomcat-embed-core-9.0.75.jar:9.0.75]
	at org.apache.tomcat.util.net.SocketProcessorBase.run(SocketProcessorBase.java:52) ~[tomcat-embed-core-9.0.75.jar:9.0.75]
	at org.apache.tomcat.util.threads.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1191) ~[tomcat-embed-core-9.0.75.jar:9.0.75]
	at org.apache.tomcat.util.threads.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:659) ~[tomcat-embed-core-9.0.75.jar:9.0.75]
	at org.apache.tomcat.util.threads.TaskThread$WrappingRunnable.run(TaskThread.java:61) ~[tomcat-embed-core-9.0.75.jar:9.0.75]
	at java.base/java.lang.Thread.run(Thread.java:840) ~[na:na]

20:23:58:773  WARN 36852 --- [Thread-18] c.a.n.common.http.HttpClientBeanHolder   : [HttpClientBeanHolder] Start destroying common HttpClient
20:23:58:773  WARN 36852 --- [Thread-15] c.a.nacos.common.notify.NotifyCenter     : [NotifyCenter] Start destroying Publisher
20:23:58:780  WARN 36852 --- [Thread-15] c.a.nacos.common.notify.NotifyCenter     : [NotifyCenter] Destruction of the end
20:23:58:784  WARN 36852 --- [Thread-18] c.a.n.common.http.HttpClientBeanHolder   : [HttpClientBeanHolder] Destruction of the end
20:23:58:866  INFO 36852 --- [SpringApplicationShutdownHook] c.a.c.n.registry.NacosServiceRegistry    : De-registering from Nacos Server now...
20:23:58:904  INFO 36852 --- [SpringApplicationShutdownHook] c.a.c.n.registry.NacosServiceRegistry    : De-registration finished.
20:23:58:958  INFO 36852 --- [SpringApplicationShutdownHook] com.zaxxer.hikari.HikariDataSource       : HikariPool-1 - Shutdown initiated...
20:23:59:260  INFO 36852 --- [SpringApplicationShutdownHook] com.zaxxer.hikari.HikariDataSource       : HikariPool-1 - Shutdown completed.
20:24:08:258  INFO 35032 --- [main] c.l.his_service.HisServiceApplication    : Starting HisServiceApplication using Java 17.0.11 on luo with PID 35032 (A:\Desktop\workspace\HIS\his_service\target\classes started by 22407 in A:\Desktop\workspace\HIS)
20:24:08:260 DEBUG 35032 --- [main] c.l.his_service.HisServiceApplication    : Running with Spring Boot v2.7.12, Spring v5.3.27
20:24:08:260  INFO 35032 --- [main] c.l.his_service.HisServiceApplication    : The following 1 profile is active: "dev"
20:24:09:562  INFO 35032 --- [main] .s.d.r.c.RepositoryConfigurationDelegate : Multiple Spring Data modules found, entering strict repository configuration mode
20:24:09:564  INFO 35032 --- [main] .s.d.r.c.RepositoryConfigurationDelegate : Bootstrapping Spring Data Redis repositories in DEFAULT mode.
20:24:09:594  INFO 35032 --- [main] .s.d.r.c.RepositoryConfigurationDelegate : Finished Spring Data repository scanning in 15 ms. Found 0 Redis repository interfaces.
20:24:09:874  INFO 35032 --- [main] o.s.cloud.context.scope.GenericScope     : BeanFactory id=ac61872e-faec-371d-922e-ad941e5407d7
20:24:11:605  INFO 35032 --- [main] o.s.b.w.embedded.tomcat.TomcatWebServer  : Tomcat initialized with port(s): 8080 (http)
20:24:11:636  INFO 35032 --- [main] o.apache.catalina.core.StandardService   : Starting service [Tomcat]
20:24:11:636  INFO 35032 --- [main] org.apache.catalina.core.StandardEngine  : Starting Servlet engine: [Apache Tomcat/9.0.75]
20:24:11:908  INFO 35032 --- [main] o.a.c.c.C.[Tomcat].[localhost].[/]       : Initializing Spring embedded WebApplicationContext
20:24:11:908  INFO 35032 --- [main] w.s.c.ServletWebServerApplicationContext : Root WebApplicationContext: initialization completed in 3583 ms
20:24:12:184  INFO 35032 --- [main] org.redisson.Version                     : Redisson 3.17.7
20:24:12:622  INFO 35032 --- [redisson-netty-2-9] o.r.c.pool.MasterPubSubConnectionPool    : 1 connections initialized for 111.230.32.147/111.230.32.147:9631
20:24:13:313  INFO 35032 --- [redisson-netty-2-19] o.r.c.pool.MasterConnectionPool          : 24 connections initialized for 111.230.32.147/111.230.32.147:9631
20:24:13:641 DEBUG 35032 --- [main] c.l.h.filter.RefreshTokenFilter          : Filter 'refreshTokenFilter' configured for use
20:24:14:564  INFO 35032 --- [main] o.s.c.openfeign.FeignClientFactoryBean   : For 'flask-service' URL not provided. Will try picking an instance via load-balancing.
20:24:14:692  INFO 35032 --- [main] o.s.c.openfeign.FeignClientFactoryBean   : For 'ai-service' URL not provided. Will try picking an instance via load-balancing.
20:24:14:738  WARN 35032 --- [main] c.b.m.core.metadata.TableInfoHelper      : Can not find table primary key in Class: "java.lang.Object".
20:24:14:738  WARN 35032 --- [main] c.b.m.core.injector.DefaultSqlInjector   : class java.lang.Object ,Not found @TableId annotation, Cannot use Mybatis-Plus 'xxById' Method.
20:24:16:630  WARN 35032 --- [main] iguration$LoadBalancerCaffeineWarnLogger : Spring Cloud LoadBalancer is currently working with the default cache. While this cache implementation is useful for development and tests, it's recommended to use Caffeine cache in production.You can switch to using Caffeine cache, by adding it and org.springframework.cache.caffeine.CaffeineCacheManager to the classpath.
20:24:16:636  INFO 35032 --- [main] o.s.b.a.e.web.EndpointLinksResolver      : Exposing 1 endpoint(s) beneath base path '/actuator'
20:24:16:743  INFO 35032 --- [main] o.s.b.w.embedded.tomcat.TomcatWebServer  : Tomcat started on port(s): 8080 (http) with context path ''
20:24:16:798  INFO 35032 --- [main] c.a.n.p.a.s.c.ClientAuthPluginManager    : [ClientAuthPluginManager] Load ClientAuthService com.alibaba.nacos.client.auth.impl.NacosClientAuthServiceImpl success.
20:24:16:799  INFO 35032 --- [main] c.a.n.p.a.s.c.ClientAuthPluginManager    : [ClientAuthPluginManager] Load ClientAuthService com.alibaba.nacos.client.auth.ram.RamClientAuthServiceImpl success.
20:24:19:027  INFO 35032 --- [main] c.a.n.c.a.AbstractAbilityControlManager  : Ready to get current node abilities...
20:24:19:028  INFO 35032 --- [main] c.a.n.c.a.AbstractAbilityControlManager  : Ready to initialize current node abilities, support modes: [SDK_CLIENT]
20:24:19:029  INFO 35032 --- [main] c.a.n.c.a.AbstractAbilityControlManager  : Initialize current abilities finish...
20:24:19:030  INFO 35032 --- [main] c.a.n.c.a.d.NacosAbilityManagerHolder    : [AbilityControlManager] Successfully initialize AbilityControlManager
20:24:19:121  INFO 35032 --- [main] c.a.c.n.registry.NacosServiceRegistry    : nacos registry, DEFAULT_GROUP his-service 10.21.93.70:8848 register finished
20:24:19:424  INFO 35032 --- [main] c.l.his_service.HisServiceApplication    : Started HisServiceApplication in 12.281 seconds (JVM running for 13.474)
20:24:19:985  INFO 35032 --- [RMI TCP Connection(1)-10.21.93.70] o.a.c.c.C.[Tomcat].[localhost].[/]       : Initializing Spring DispatcherServlet 'dispatcherServlet'
20:24:19:986  INFO 35032 --- [RMI TCP Connection(1)-10.21.93.70] o.s.web.servlet.DispatcherServlet        : Initializing Servlet 'dispatcherServlet'
20:24:19:988  INFO 35032 --- [RMI TCP Connection(1)-10.21.93.70] o.s.web.servlet.DispatcherServlet        : Completed initialization in 2 ms
20:24:19:990  INFO 35032 --- [RMI TCP Connection(2)-10.21.93.70] com.zaxxer.hikari.HikariDataSource       : HikariPool-1 - Starting...
20:24:21:159  INFO 35032 --- [RMI TCP Connection(2)-10.21.93.70] com.zaxxer.hikari.HikariDataSource       : HikariPool-1 - Start completed.
20:24:22:089 DEBUG 35032 --- [http-nio-8080-exec-2] c.l.h.m.D.selectById                     : ==>  Preparing: SELECT id,patient_id,doctor_id,disease_name,disease_category,aimodel_id,result,create_time,status,id_card,name,score,remark FROM diagnosis_report WHERE id=?
20:24:22:124 DEBUG 35032 --- [http-nio-8080-exec-2] c.l.h.m.D.selectById                     : ==> Parameters: 1(Integer)
20:24:22:193 DEBUG 35032 --- [http-nio-8080-exec-2] c.l.h.m.D.selectById                     : <==      Total: 1
20:24:22:196 DEBUG 35032 --- [http-nio-8080-exec-2] c.l.h.mapper.PatientMapper.selectById    : ==>  Preparing: SELECT id,phone,id_card,name,verified,verified_by,verified_time,open_id,hospital_pid FROM patient WHERE id=?
20:24:22:196 DEBUG 35032 --- [http-nio-8080-exec-2] c.l.h.mapper.PatientMapper.selectById    : ==> Parameters: 1(Integer)
20:24:22:227 DEBUG 35032 --- [http-nio-8080-exec-2] c.l.h.mapper.PatientMapper.selectById    : <==      Total: 1
20:24:22:231 DEBUG 35032 --- [http-nio-8080-exec-2] c.l.h.mapper.DoctorMapper.selectById     : ==>  Preparing: SELECT id,phone,id_card,name,verified,verified_by,verified_time,license,department,hospital_pid FROM doctor WHERE id=?
20:24:22:232 DEBUG 35032 --- [http-nio-8080-exec-2] c.l.h.mapper.DoctorMapper.selectById     : ==> Parameters: 1(Integer)
20:24:22:263 DEBUG 35032 --- [http-nio-8080-exec-2] c.l.h.mapper.DoctorMapper.selectById     : <==      Total: 1
20:24:22:268 DEBUG 35032 --- [http-nio-8080-exec-2] c.l.h.m.E.selectListByDiagnosisId        : ==>  Preparing: select * from eye_images where dignosis_report_id = ?
20:24:22:269 DEBUG 35032 --- [http-nio-8080-exec-2] c.l.h.m.E.selectListByDiagnosisId        : ==> Parameters: 1(Integer)
20:24:22:298 DEBUG 35032 --- [http-nio-8080-exec-2] c.l.h.m.E.selectListByDiagnosisId        : <==      Total: 1
20:24:22:299 DEBUG 35032 --- [http-nio-8080-exec-2] c.l.h.m.T.selectByDiagnosisId            : ==>  Preparing: select * from treatment_plans where diagnosis_id = ?
20:24:22:300 DEBUG 35032 --- [http-nio-8080-exec-2] c.l.h.m.T.selectByDiagnosisId            : ==> Parameters: 1(Integer)
20:24:22:331 DEBUG 35032 --- [http-nio-8080-exec-2] c.l.h.m.T.selectByDiagnosisId            : <==      Total: 1
20:24:22:331 DEBUG 35032 --- [http-nio-8080-exec-2] c.l.h.m.M.selectByDiagnosisId            : ==>  Preparing: select * from medication_recommendations where diagnosis_id = ?
20:24:22:331 DEBUG 35032 --- [http-nio-8080-exec-2] c.l.h.m.M.selectByDiagnosisId            : ==> Parameters: 1(Integer)
20:24:22:362 DEBUG 35032 --- [http-nio-8080-exec-2] c.l.h.m.M.selectByDiagnosisId            : <==      Total: 1
20:24:22:363 DEBUG 35032 --- [http-nio-8080-exec-2] c.l.h.mapper.AiModelMapper.selectById    : ==>  Preparing: SELECT id,version,deploy_time,accuracy FROM ai_model WHERE id=?
20:24:22:363 DEBUG 35032 --- [http-nio-8080-exec-2] c.l.h.mapper.AiModelMapper.selectById    : ==> Parameters: 1(Integer)
20:24:22:392 DEBUG 35032 --- [http-nio-8080-exec-2] c.l.h.mapper.AiModelMapper.selectById    : <==      Total: 1
20:24:22:426 DEBUG 35032 --- [http-nio-8080-exec-2] c.l.api.client.FlaskAiDoctorClient       : [FlaskAiDoctorClient#eye_doctor_chat] ---> POST http://ai-service/api/eye-doctor/chat HTTP/1.1
20:24:22:427 DEBUG 35032 --- [http-nio-8080-exec-2] c.l.api.client.FlaskAiDoctorClient       : [FlaskAiDoctorClient#eye_doctor_chat] Content-Length: 753
20:24:22:427 DEBUG 35032 --- [http-nio-8080-exec-2] c.l.api.client.FlaskAiDoctorClient       : [FlaskAiDoctorClient#eye_doctor_chat] Content-Type: application/json
20:24:22:427 DEBUG 35032 --- [http-nio-8080-exec-2] c.l.api.client.FlaskAiDoctorClient       : [FlaskAiDoctorClient#eye_doctor_chat] 
20:24:22:427 DEBUG 35032 --- [http-nio-8080-exec-2] c.l.api.client.FlaskAiDoctorClient       : [FlaskAiDoctorClient#eye_doctor_chat] {"diagnosis_name":"","diagnosis_category":"","result":"A","remark":"A","treatment_plan":{"id":1,"treatmentType":1,"treatmentDetail":"","startTime":"2025-03-01 09:00:00","endDate":"2025-03-10 09:00:00","doctorId":1,"createdTime":"2025-03-01T09:00:00","updatedTime":"2025-03-01T09:00:00"},"medications":[{"id":1,"diagnosisId":1,"medicationName":"A","dosage":"10mg","frequency":"","sideEffects":"","startTime":"2025-03-01T09:00:00","endTime":"2025-03-10T09:00:00","doctorId":1,"createdTime":"2025-03-01 09:00:00","updatedTime":"2025-03-01 09:00:00"}],"previous_conversations":[{"role":"pariatur tempor do","content":"sit cupidatat commodo"}],"question":"irure eu esse","stream":false}
20:24:22:428 DEBUG 35032 --- [http-nio-8080-exec-2] c.l.api.client.FlaskAiDoctorClient       : [FlaskAiDoctorClient#eye_doctor_chat] ---> END HTTP (753-byte body)
20:24:24:637 DEBUG 35032 --- [http-nio-8080-exec-2] c.l.api.client.FlaskAiDoctorClient       : [FlaskAiDoctorClient#eye_doctor_chat] <--- ERROR ConnectException: Connection refused: getsockopt (2208ms)
20:24:24:638 DEBUG 35032 --- [http-nio-8080-exec-2] c.l.api.client.FlaskAiDoctorClient       : [FlaskAiDoctorClient#eye_doctor_chat] java.net.ConnectException: Connection refused: getsockopt
	at java.base/sun.nio.ch.Net.pollConnect(Native Method)
	at java.base/sun.nio.ch.Net.pollConnectNow(Net.java:672)
	at java.base/sun.nio.ch.NioSocketImpl.timedFinishConnect(NioSocketImpl.java:554)
	at java.base/sun.nio.ch.NioSocketImpl.connect(NioSocketImpl.java:602)
	at java.base/java.net.Socket.connect(Socket.java:633)
	at java.base/sun.net.NetworkClient.doConnect(NetworkClient.java:178)
	at java.base/sun.net.www.http.HttpClient.openServer(HttpClient.java:533)
	at java.base/sun.net.www.http.HttpClient.openServer(HttpClient.java:638)
	at java.base/sun.net.www.http.HttpClient.<init>(HttpClient.java:281)
	at java.base/sun.net.www.http.HttpClient.New(HttpClient.java:386)
	at java.base/sun.net.www.http.HttpClient.New(HttpClient.java:408)
	at java.base/sun.net.www.protocol.http.HttpURLConnection.getNewHttpClient(HttpURLConnection.java:1309)
	at java.base/sun.net.www.protocol.http.HttpURLConnection.plainConnect0(HttpURLConnection.java:1242)
	at java.base/sun.net.www.protocol.http.HttpURLConnection.plainConnect(HttpURLConnection.java:1128)
	at java.base/sun.net.www.protocol.http.HttpURLConnection.connect(HttpURLConnection.java:1057)
	at java.base/sun.net.www.protocol.http.HttpURLConnection.getOutputStream0(HttpURLConnection.java:1451)
	at java.base/sun.net.www.protocol.http.HttpURLConnection.getOutputStream(HttpURLConnection.java:1422)
	at feign.Client$Default.convertAndSend(Client.java:208)
	at feign.Client$Default.execute(Client.java:105)
	at org.springframework.cloud.openfeign.loadbalancer.LoadBalancerUtils.executeWithLoadBalancerLifecycleProcessing(LoadBalancerUtils.java:57)
	at org.springframework.cloud.openfeign.loadbalancer.LoadBalancerUtils.executeWithLoadBalancerLifecycleProcessing(LoadBalancerUtils.java:95)
	at org.springframework.cloud.openfeign.loadbalancer.FeignBlockingLoadBalancerClient.execute(FeignBlockingLoadBalancerClient.java:114)
	at feign.SynchronousMethodHandler.executeAndDecode(SynchronousMethodHandler.java:121)
	at feign.SynchronousMethodHandler.invoke(SynchronousMethodHandler.java:91)
	at feign.ReflectiveFeign$FeignInvocationHandler.invoke(ReflectiveFeign.java:100)
	at jdk.proxy2/jdk.proxy2.$Proxy135.eye_doctor_chat(Unknown Source)
	at com.luojiawei.his_service.controller.ChatController.ask(ChatController.java:39)
	at java.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at java.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:77)
	at java.base/jdk.internal.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.base/java.lang.reflect.Method.invoke(Method.java:568)
	at org.springframework.web.method.support.InvocableHandlerMethod.doInvoke(InvocableHandlerMethod.java:205)
	at org.springframework.web.method.support.InvocableHandlerMethod.invokeForRequest(InvocableHandlerMethod.java:150)
	at org.springframework.web.servlet.mvc.method.annotation.ServletInvocableHandlerMethod.invokeAndHandle(ServletInvocableHandlerMethod.java:117)
	at org.springframework.web.servlet.mvc.method.annotation.RequestMappingHandlerAdapter.invokeHandlerMethod(RequestMappingHandlerAdapter.java:895)
	at org.springframework.web.servlet.mvc.method.annotation.RequestMappingHandlerAdapter.handleInternal(RequestMappingHandlerAdapter.java:808)
	at org.springframework.web.servlet.mvc.method.AbstractHandlerMethodAdapter.handle(AbstractHandlerMethodAdapter.java:87)
	at org.springframework.web.servlet.DispatcherServlet.doDispatch(DispatcherServlet.java:1072)
	at org.springframework.web.servlet.DispatcherServlet.doService(DispatcherServlet.java:965)
	at org.springframework.web.servlet.FrameworkServlet.processRequest(FrameworkServlet.java:1006)
	at org.springframework.web.servlet.FrameworkServlet.doPost(FrameworkServlet.java:909)
	at javax.servlet.http.HttpServlet.service(HttpServlet.java:555)
	at org.springframework.web.servlet.FrameworkServlet.service(FrameworkServlet.java:883)
	at javax.servlet.http.HttpServlet.service(HttpServlet.java:623)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:209)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:153)
	at com.luojiawei.his_service.filter.RefreshTokenFilter.doFilterInternal(RefreshTokenFilter.java:58)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:117)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:178)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:153)
	at org.springframework.web.filter.RequestContextFilter.doFilterInternal(RequestContextFilter.java:100)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:117)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:178)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:153)
	at org.springframework.web.filter.FormContentFilter.doFilterInternal(FormContentFilter.java:93)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:117)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:178)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:153)
	at org.springframework.boot.actuate.metrics.web.servlet.WebMvcMetricsFilter.doFilterInternal(WebMvcMetricsFilter.java:96)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:117)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:178)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:153)
	at org.springframework.web.filter.CharacterEncodingFilter.doFilterInternal(CharacterEncodingFilter.java:201)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:117)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:178)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:153)
	at org.apache.catalina.core.StandardWrapperValve.invoke(StandardWrapperValve.java:167)
	at org.apache.catalina.core.StandardContextValve.invoke(StandardContextValve.java:90)
	at org.apache.catalina.authenticator.AuthenticatorBase.invoke(AuthenticatorBase.java:481)
	at org.apache.catalina.core.StandardHostValve.invoke(StandardHostValve.java:130)
	at org.apache.catalina.valves.ErrorReportValve.invoke(ErrorReportValve.java:93)
	at org.apache.catalina.core.StandardEngineValve.invoke(StandardEngineValve.java:74)
	at org.apache.catalina.connector.CoyoteAdapter.service(CoyoteAdapter.java:343)
	at org.apache.coyote.http11.Http11Processor.service(Http11Processor.java:390)
	at org.apache.coyote.AbstractProcessorLight.process(AbstractProcessorLight.java:63)
	at org.apache.coyote.AbstractProtocol$ConnectionHandler.process(AbstractProtocol.java:926)
	at org.apache.tomcat.util.net.NioEndpoint$SocketProcessor.doRun(NioEndpoint.java:1791)
	at org.apache.tomcat.util.net.SocketProcessorBase.run(SocketProcessorBase.java:52)
	at org.apache.tomcat.util.threads.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1191)
	at org.apache.tomcat.util.threads.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:659)
	at org.apache.tomcat.util.threads.TaskThread$WrappingRunnable.run(TaskThread.java:61)
	at java.base/java.lang.Thread.run(Thread.java:840)

20:24:24:638 DEBUG 35032 --- [http-nio-8080-exec-2] c.l.api.client.FlaskAiDoctorClient       : [FlaskAiDoctorClient#eye_doctor_chat] <--- END ERROR
20:24:24:658 ERROR 35032 --- [http-nio-8080-exec-2] o.a.c.c.C.[.[.[/].[dispatcherServlet]    : Servlet.service() for servlet [dispatcherServlet] in context with path [] threw exception [Request processing failed; nested exception is feign.RetryableException: Connection refused: getsockopt executing POST http://ai-service/api/eye-doctor/chat] with root cause

java.net.ConnectException: Connection refused: getsockopt
	at java.base/sun.nio.ch.Net.pollConnect(Native Method) ~[na:na]
	at java.base/sun.nio.ch.Net.pollConnectNow(Net.java:672) ~[na:na]
	at java.base/sun.nio.ch.NioSocketImpl.timedFinishConnect(NioSocketImpl.java:554) ~[na:na]
	at java.base/sun.nio.ch.NioSocketImpl.connect(NioSocketImpl.java:602) ~[na:na]
	at java.base/java.net.Socket.connect(Socket.java:633) ~[na:na]
	at java.base/sun.net.NetworkClient.doConnect(NetworkClient.java:178) ~[na:na]
	at java.base/sun.net.www.http.HttpClient.openServer(HttpClient.java:533) ~[na:na]
	at java.base/sun.net.www.http.HttpClient.openServer(HttpClient.java:638) ~[na:na]
	at java.base/sun.net.www.http.HttpClient.<init>(HttpClient.java:281) ~[na:na]
	at java.base/sun.net.www.http.HttpClient.New(HttpClient.java:386) ~[na:na]
	at java.base/sun.net.www.http.HttpClient.New(HttpClient.java:408) ~[na:na]
	at java.base/sun.net.www.protocol.http.HttpURLConnection.getNewHttpClient(HttpURLConnection.java:1309) ~[na:na]
	at java.base/sun.net.www.protocol.http.HttpURLConnection.plainConnect0(HttpURLConnection.java:1242) ~[na:na]
	at java.base/sun.net.www.protocol.http.HttpURLConnection.plainConnect(HttpURLConnection.java:1128) ~[na:na]
	at java.base/sun.net.www.protocol.http.HttpURLConnection.connect(HttpURLConnection.java:1057) ~[na:na]
	at java.base/sun.net.www.protocol.http.HttpURLConnection.getOutputStream0(HttpURLConnection.java:1451) ~[na:na]
	at java.base/sun.net.www.protocol.http.HttpURLConnection.getOutputStream(HttpURLConnection.java:1422) ~[na:na]
	at feign.Client$Default.convertAndSend(Client.java:208) ~[feign-core-11.10.jar:na]
	at feign.Client$Default.execute(Client.java:105) ~[feign-core-11.10.jar:na]
	at org.springframework.cloud.openfeign.loadbalancer.LoadBalancerUtils.executeWithLoadBalancerLifecycleProcessing(LoadBalancerUtils.java:57) ~[spring-cloud-openfeign-core-3.1.5.jar:3.1.5]
	at org.springframework.cloud.openfeign.loadbalancer.LoadBalancerUtils.executeWithLoadBalancerLifecycleProcessing(LoadBalancerUtils.java:95) ~[spring-cloud-openfeign-core-3.1.5.jar:3.1.5]
	at org.springframework.cloud.openfeign.loadbalancer.FeignBlockingLoadBalancerClient.execute(FeignBlockingLoadBalancerClient.java:114) ~[spring-cloud-openfeign-core-3.1.5.jar:3.1.5]
	at feign.SynchronousMethodHandler.executeAndDecode(SynchronousMethodHandler.java:121) ~[feign-core-11.10.jar:na]
	at feign.SynchronousMethodHandler.invoke(SynchronousMethodHandler.java:91) ~[feign-core-11.10.jar:na]
	at feign.ReflectiveFeign$FeignInvocationHandler.invoke(ReflectiveFeign.java:100) ~[feign-core-11.10.jar:na]
	at jdk.proxy2/jdk.proxy2.$Proxy135.eye_doctor_chat(Unknown Source) ~[na:na]
	at com.luojiawei.his_service.controller.ChatController.ask(ChatController.java:39) ~[classes/:na]
	at java.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke0(Native Method) ~[na:na]
	at java.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:77) ~[na:na]
	at java.base/jdk.internal.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43) ~[na:na]
	at java.base/java.lang.reflect.Method.invoke(Method.java:568) ~[na:na]
	at org.springframework.web.method.support.InvocableHandlerMethod.doInvoke(InvocableHandlerMethod.java:205) ~[spring-web-5.3.27.jar:5.3.27]
	at org.springframework.web.method.support.InvocableHandlerMethod.invokeForRequest(InvocableHandlerMethod.java:150) ~[spring-web-5.3.27.jar:5.3.27]
	at org.springframework.web.servlet.mvc.method.annotation.ServletInvocableHandlerMethod.invokeAndHandle(ServletInvocableHandlerMethod.java:117) ~[spring-webmvc-5.3.27.jar:5.3.27]
	at org.springframework.web.servlet.mvc.method.annotation.RequestMappingHandlerAdapter.invokeHandlerMethod(RequestMappingHandlerAdapter.java:895) ~[spring-webmvc-5.3.27.jar:5.3.27]
	at org.springframework.web.servlet.mvc.method.annotation.RequestMappingHandlerAdapter.handleInternal(RequestMappingHandlerAdapter.java:808) ~[spring-webmvc-5.3.27.jar:5.3.27]
	at org.springframework.web.servlet.mvc.method.AbstractHandlerMethodAdapter.handle(AbstractHandlerMethodAdapter.java:87) ~[spring-webmvc-5.3.27.jar:5.3.27]
	at org.springframework.web.servlet.DispatcherServlet.doDispatch(DispatcherServlet.java:1072) ~[spring-webmvc-5.3.27.jar:5.3.27]
	at org.springframework.web.servlet.DispatcherServlet.doService(DispatcherServlet.java:965) ~[spring-webmvc-5.3.27.jar:5.3.27]
	at org.springframework.web.servlet.FrameworkServlet.processRequest(FrameworkServlet.java:1006) ~[spring-webmvc-5.3.27.jar:5.3.27]
	at org.springframework.web.servlet.FrameworkServlet.doPost(FrameworkServlet.java:909) ~[spring-webmvc-5.3.27.jar:5.3.27]
	at javax.servlet.http.HttpServlet.service(HttpServlet.java:555) ~[tomcat-embed-core-9.0.75.jar:4.0.FR]
	at org.springframework.web.servlet.FrameworkServlet.service(FrameworkServlet.java:883) ~[spring-webmvc-5.3.27.jar:5.3.27]
	at javax.servlet.http.HttpServlet.service(HttpServlet.java:623) ~[tomcat-embed-core-9.0.75.jar:4.0.FR]
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:209) ~[tomcat-embed-core-9.0.75.jar:9.0.75]
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:153) ~[tomcat-embed-core-9.0.75.jar:9.0.75]
	at com.luojiawei.his_service.filter.RefreshTokenFilter.doFilterInternal(RefreshTokenFilter.java:58) ~[classes/:na]
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:117) ~[spring-web-5.3.27.jar:5.3.27]
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:178) ~[tomcat-embed-core-9.0.75.jar:9.0.75]
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:153) ~[tomcat-embed-core-9.0.75.jar:9.0.75]
	at org.springframework.web.filter.RequestContextFilter.doFilterInternal(RequestContextFilter.java:100) ~[spring-web-5.3.27.jar:5.3.27]
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:117) ~[spring-web-5.3.27.jar:5.3.27]
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:178) ~[tomcat-embed-core-9.0.75.jar:9.0.75]
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:153) ~[tomcat-embed-core-9.0.75.jar:9.0.75]
	at org.springframework.web.filter.FormContentFilter.doFilterInternal(FormContentFilter.java:93) ~[spring-web-5.3.27.jar:5.3.27]
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:117) ~[spring-web-5.3.27.jar:5.3.27]
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:178) ~[tomcat-embed-core-9.0.75.jar:9.0.75]
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:153) ~[tomcat-embed-core-9.0.75.jar:9.0.75]
	at org.springframework.boot.actuate.metrics.web.servlet.WebMvcMetricsFilter.doFilterInternal(WebMvcMetricsFilter.java:96) ~[spring-boot-actuator-2.7.12.jar:2.7.12]
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:117) ~[spring-web-5.3.27.jar:5.3.27]
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:178) ~[tomcat-embed-core-9.0.75.jar:9.0.75]
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:153) ~[tomcat-embed-core-9.0.75.jar:9.0.75]
	at org.springframework.web.filter.CharacterEncodingFilter.doFilterInternal(CharacterEncodingFilter.java:201) ~[spring-web-5.3.27.jar:5.3.27]
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:117) ~[spring-web-5.3.27.jar:5.3.27]
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:178) ~[tomcat-embed-core-9.0.75.jar:9.0.75]
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:153) ~[tomcat-embed-core-9.0.75.jar:9.0.75]
	at org.apache.catalina.core.StandardWrapperValve.invoke(StandardWrapperValve.java:167) ~[tomcat-embed-core-9.0.75.jar:9.0.75]
	at org.apache.catalina.core.StandardContextValve.invoke(StandardContextValve.java:90) ~[tomcat-embed-core-9.0.75.jar:9.0.75]
	at org.apache.catalina.authenticator.AuthenticatorBase.invoke(AuthenticatorBase.java:481) ~[tomcat-embed-core-9.0.75.jar:9.0.75]
	at org.apache.catalina.core.StandardHostValve.invoke(StandardHostValve.java:130) ~[tomcat-embed-core-9.0.75.jar:9.0.75]
	at org.apache.catalina.valves.ErrorReportValve.invoke(ErrorReportValve.java:93) ~[tomcat-embed-core-9.0.75.jar:9.0.75]
	at org.apache.catalina.core.StandardEngineValve.invoke(StandardEngineValve.java:74) ~[tomcat-embed-core-9.0.75.jar:9.0.75]
	at org.apache.catalina.connector.CoyoteAdapter.service(CoyoteAdapter.java:343) ~[tomcat-embed-core-9.0.75.jar:9.0.75]
	at org.apache.coyote.http11.Http11Processor.service(Http11Processor.java:390) ~[tomcat-embed-core-9.0.75.jar:9.0.75]
	at org.apache.coyote.AbstractProcessorLight.process(AbstractProcessorLight.java:63) ~[tomcat-embed-core-9.0.75.jar:9.0.75]
	at org.apache.coyote.AbstractProtocol$ConnectionHandler.process(AbstractProtocol.java:926) ~[tomcat-embed-core-9.0.75.jar:9.0.75]
	at org.apache.tomcat.util.net.NioEndpoint$SocketProcessor.doRun(NioEndpoint.java:1791) ~[tomcat-embed-core-9.0.75.jar:9.0.75]
	at org.apache.tomcat.util.net.SocketProcessorBase.run(SocketProcessorBase.java:52) ~[tomcat-embed-core-9.0.75.jar:9.0.75]
	at org.apache.tomcat.util.threads.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1191) ~[tomcat-embed-core-9.0.75.jar:9.0.75]
	at org.apache.tomcat.util.threads.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:659) ~[tomcat-embed-core-9.0.75.jar:9.0.75]
	at org.apache.tomcat.util.threads.TaskThread$WrappingRunnable.run(TaskThread.java:61) ~[tomcat-embed-core-9.0.75.jar:9.0.75]
	at java.base/java.lang.Thread.run(Thread.java:840) ~[na:na]

20:30:24:366 DEBUG 35032 --- [http-nio-8080-exec-5] c.l.h.m.D.selectById                     : ==>  Preparing: SELECT id,patient_id,doctor_id,disease_name,disease_category,aimodel_id,result,create_time,status,id_card,name,score,remark FROM diagnosis_report WHERE id=?
20:30:24:371 DEBUG 35032 --- [http-nio-8080-exec-5] c.l.h.m.D.selectById                     : ==> Parameters: 1(Integer)
20:30:24:408 DEBUG 35032 --- [http-nio-8080-exec-5] c.l.h.m.D.selectById                     : <==      Total: 1
20:30:24:409 DEBUG 35032 --- [http-nio-8080-exec-5] c.l.h.mapper.PatientMapper.selectById    : ==>  Preparing: SELECT id,phone,id_card,name,verified,verified_by,verified_time,open_id,hospital_pid FROM patient WHERE id=?
20:30:24:410 DEBUG 35032 --- [http-nio-8080-exec-5] c.l.h.mapper.PatientMapper.selectById    : ==> Parameters: 1(Integer)
20:30:24:439 DEBUG 35032 --- [http-nio-8080-exec-5] c.l.h.mapper.PatientMapper.selectById    : <==      Total: 1
20:30:24:440 DEBUG 35032 --- [http-nio-8080-exec-5] c.l.h.mapper.DoctorMapper.selectById     : ==>  Preparing: SELECT id,phone,id_card,name,verified,verified_by,verified_time,license,department,hospital_pid FROM doctor WHERE id=?
20:30:24:440 DEBUG 35032 --- [http-nio-8080-exec-5] c.l.h.mapper.DoctorMapper.selectById     : ==> Parameters: 1(Integer)
20:30:24:470 DEBUG 35032 --- [http-nio-8080-exec-5] c.l.h.mapper.DoctorMapper.selectById     : <==      Total: 1
20:30:24:471 DEBUG 35032 --- [http-nio-8080-exec-5] c.l.h.m.E.selectListByDiagnosisId        : ==>  Preparing: select * from eye_images where dignosis_report_id = ?
20:30:24:471 DEBUG 35032 --- [http-nio-8080-exec-5] c.l.h.m.E.selectListByDiagnosisId        : ==> Parameters: 1(Integer)
20:30:24:502 DEBUG 35032 --- [http-nio-8080-exec-5] c.l.h.m.E.selectListByDiagnosisId        : <==      Total: 1
20:30:24:503 DEBUG 35032 --- [http-nio-8080-exec-5] c.l.h.m.T.selectByDiagnosisId            : ==>  Preparing: select * from treatment_plans where diagnosis_id = ?
20:30:24:503 DEBUG 35032 --- [http-nio-8080-exec-5] c.l.h.m.T.selectByDiagnosisId            : ==> Parameters: 1(Integer)
20:30:24:535 DEBUG 35032 --- [http-nio-8080-exec-5] c.l.h.m.T.selectByDiagnosisId            : <==      Total: 1
20:30:24:536 DEBUG 35032 --- [http-nio-8080-exec-5] c.l.h.m.M.selectByDiagnosisId            : ==>  Preparing: select * from medication_recommendations where diagnosis_id = ?
20:30:24:536 DEBUG 35032 --- [http-nio-8080-exec-5] c.l.h.m.M.selectByDiagnosisId            : ==> Parameters: 1(Integer)
20:30:24:567 DEBUG 35032 --- [http-nio-8080-exec-5] c.l.h.m.M.selectByDiagnosisId            : <==      Total: 1
20:30:24:569 DEBUG 35032 --- [http-nio-8080-exec-5] c.l.h.mapper.AiModelMapper.selectById    : ==>  Preparing: SELECT id,version,deploy_time,accuracy FROM ai_model WHERE id=?
20:30:24:569 DEBUG 35032 --- [http-nio-8080-exec-5] c.l.h.mapper.AiModelMapper.selectById    : ==> Parameters: 1(Integer)
20:30:24:599 DEBUG 35032 --- [http-nio-8080-exec-5] c.l.h.mapper.AiModelMapper.selectById    : <==      Total: 1
20:30:24:606 DEBUG 35032 --- [http-nio-8080-exec-5] c.l.api.client.FlaskAiDoctorClient       : [FlaskAiDoctorClient#eye_doctor_chat] ---> POST http://ai-service/api/eye-doctor/chat HTTP/1.1
20:30:24:607 DEBUG 35032 --- [http-nio-8080-exec-5] c.l.api.client.FlaskAiDoctorClient       : [FlaskAiDoctorClient#eye_doctor_chat] Content-Length: 753
20:30:24:607 DEBUG 35032 --- [http-nio-8080-exec-5] c.l.api.client.FlaskAiDoctorClient       : [FlaskAiDoctorClient#eye_doctor_chat] Content-Type: application/json
20:30:24:607 DEBUG 35032 --- [http-nio-8080-exec-5] c.l.api.client.FlaskAiDoctorClient       : [FlaskAiDoctorClient#eye_doctor_chat] 
20:30:24:607 DEBUG 35032 --- [http-nio-8080-exec-5] c.l.api.client.FlaskAiDoctorClient       : [FlaskAiDoctorClient#eye_doctor_chat] {"diagnosis_name":"","diagnosis_category":"","result":"A","remark":"A","treatment_plan":{"id":1,"treatmentType":1,"treatmentDetail":"","startTime":"2025-03-01 09:00:00","endDate":"2025-03-10 09:00:00","doctorId":1,"createdTime":"2025-03-01T09:00:00","updatedTime":"2025-03-01T09:00:00"},"medications":[{"id":1,"diagnosisId":1,"medicationName":"A","dosage":"10mg","frequency":"","sideEffects":"","startTime":"2025-03-01T09:00:00","endTime":"2025-03-10T09:00:00","doctorId":1,"createdTime":"2025-03-01 09:00:00","updatedTime":"2025-03-01 09:00:00"}],"previous_conversations":[{"role":"pariatur tempor do","content":"sit cupidatat commodo"}],"question":"irure eu esse","stream":false}
20:30:24:607 DEBUG 35032 --- [http-nio-8080-exec-5] c.l.api.client.FlaskAiDoctorClient       : [FlaskAiDoctorClient#eye_doctor_chat] ---> END HTTP (753-byte body)
20:30:26:671 DEBUG 35032 --- [http-nio-8080-exec-5] c.l.api.client.FlaskAiDoctorClient       : [FlaskAiDoctorClient#eye_doctor_chat] <--- ERROR ConnectException: Connection refused: getsockopt (2063ms)
20:30:26:673 DEBUG 35032 --- [http-nio-8080-exec-5] c.l.api.client.FlaskAiDoctorClient       : [FlaskAiDoctorClient#eye_doctor_chat] java.net.ConnectException: Connection refused: getsockopt
	at java.base/sun.nio.ch.Net.pollConnect(Native Method)
	at java.base/sun.nio.ch.Net.pollConnectNow(Net.java:672)
	at java.base/sun.nio.ch.NioSocketImpl.timedFinishConnect(NioSocketImpl.java:554)
	at java.base/sun.nio.ch.NioSocketImpl.connect(NioSocketImpl.java:602)
	at java.base/java.net.Socket.connect(Socket.java:633)
	at java.base/sun.net.NetworkClient.doConnect(NetworkClient.java:178)
	at java.base/sun.net.www.http.HttpClient.openServer(HttpClient.java:533)
	at java.base/sun.net.www.http.HttpClient.openServer(HttpClient.java:638)
	at java.base/sun.net.www.http.HttpClient.<init>(HttpClient.java:281)
	at java.base/sun.net.www.http.HttpClient.New(HttpClient.java:386)
	at java.base/sun.net.www.http.HttpClient.New(HttpClient.java:408)
	at java.base/sun.net.www.protocol.http.HttpURLConnection.getNewHttpClient(HttpURLConnection.java:1309)
	at java.base/sun.net.www.protocol.http.HttpURLConnection.plainConnect0(HttpURLConnection.java:1242)
	at java.base/sun.net.www.protocol.http.HttpURLConnection.plainConnect(HttpURLConnection.java:1128)
	at java.base/sun.net.www.protocol.http.HttpURLConnection.connect(HttpURLConnection.java:1057)
	at java.base/sun.net.www.protocol.http.HttpURLConnection.getOutputStream0(HttpURLConnection.java:1451)
	at java.base/sun.net.www.protocol.http.HttpURLConnection.getOutputStream(HttpURLConnection.java:1422)
	at feign.Client$Default.convertAndSend(Client.java:208)
	at feign.Client$Default.execute(Client.java:105)
	at org.springframework.cloud.openfeign.loadbalancer.LoadBalancerUtils.executeWithLoadBalancerLifecycleProcessing(LoadBalancerUtils.java:57)
	at org.springframework.cloud.openfeign.loadbalancer.LoadBalancerUtils.executeWithLoadBalancerLifecycleProcessing(LoadBalancerUtils.java:95)
	at org.springframework.cloud.openfeign.loadbalancer.FeignBlockingLoadBalancerClient.execute(FeignBlockingLoadBalancerClient.java:114)
	at feign.SynchronousMethodHandler.executeAndDecode(SynchronousMethodHandler.java:121)
	at feign.SynchronousMethodHandler.invoke(SynchronousMethodHandler.java:91)
	at feign.ReflectiveFeign$FeignInvocationHandler.invoke(ReflectiveFeign.java:100)
	at jdk.proxy2/jdk.proxy2.$Proxy135.eye_doctor_chat(Unknown Source)
	at com.luojiawei.his_service.controller.ChatController.ask(ChatController.java:39)
	at java.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at java.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:77)
	at java.base/jdk.internal.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.base/java.lang.reflect.Method.invoke(Method.java:568)
	at org.springframework.web.method.support.InvocableHandlerMethod.doInvoke(InvocableHandlerMethod.java:205)
	at org.springframework.web.method.support.InvocableHandlerMethod.invokeForRequest(InvocableHandlerMethod.java:150)
	at org.springframework.web.servlet.mvc.method.annotation.ServletInvocableHandlerMethod.invokeAndHandle(ServletInvocableHandlerMethod.java:117)
	at org.springframework.web.servlet.mvc.method.annotation.RequestMappingHandlerAdapter.invokeHandlerMethod(RequestMappingHandlerAdapter.java:895)
	at org.springframework.web.servlet.mvc.method.annotation.RequestMappingHandlerAdapter.handleInternal(RequestMappingHandlerAdapter.java:808)
	at org.springframework.web.servlet.mvc.method.AbstractHandlerMethodAdapter.handle(AbstractHandlerMethodAdapter.java:87)
	at org.springframework.web.servlet.DispatcherServlet.doDispatch(DispatcherServlet.java:1072)
	at org.springframework.web.servlet.DispatcherServlet.doService(DispatcherServlet.java:965)
	at org.springframework.web.servlet.FrameworkServlet.processRequest(FrameworkServlet.java:1006)
	at org.springframework.web.servlet.FrameworkServlet.doPost(FrameworkServlet.java:909)
	at javax.servlet.http.HttpServlet.service(HttpServlet.java:555)
	at org.springframework.web.servlet.FrameworkServlet.service(FrameworkServlet.java:883)
	at javax.servlet.http.HttpServlet.service(HttpServlet.java:623)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:209)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:153)
	at com.luojiawei.his_service.filter.RefreshTokenFilter.doFilterInternal(RefreshTokenFilter.java:58)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:117)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:178)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:153)
	at org.springframework.web.filter.RequestContextFilter.doFilterInternal(RequestContextFilter.java:100)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:117)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:178)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:153)
	at org.springframework.web.filter.FormContentFilter.doFilterInternal(FormContentFilter.java:93)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:117)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:178)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:153)
	at org.springframework.boot.actuate.metrics.web.servlet.WebMvcMetricsFilter.doFilterInternal(WebMvcMetricsFilter.java:96)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:117)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:178)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:153)
	at org.springframework.web.filter.CharacterEncodingFilter.doFilterInternal(CharacterEncodingFilter.java:201)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:117)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:178)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:153)
	at org.apache.catalina.core.StandardWrapperValve.invoke(StandardWrapperValve.java:167)
	at org.apache.catalina.core.StandardContextValve.invoke(StandardContextValve.java:90)
	at org.apache.catalina.authenticator.AuthenticatorBase.invoke(AuthenticatorBase.java:481)
	at org.apache.catalina.core.StandardHostValve.invoke(StandardHostValve.java:130)
	at org.apache.catalina.valves.ErrorReportValve.invoke(ErrorReportValve.java:93)
	at org.apache.catalina.core.StandardEngineValve.invoke(StandardEngineValve.java:74)
	at org.apache.catalina.connector.CoyoteAdapter.service(CoyoteAdapter.java:343)
	at org.apache.coyote.http11.Http11Processor.service(Http11Processor.java:390)
	at org.apache.coyote.AbstractProcessorLight.process(AbstractProcessorLight.java:63)
	at org.apache.coyote.AbstractProtocol$ConnectionHandler.process(AbstractProtocol.java:926)
	at org.apache.tomcat.util.net.NioEndpoint$SocketProcessor.doRun(NioEndpoint.java:1791)
	at org.apache.tomcat.util.net.SocketProcessorBase.run(SocketProcessorBase.java:52)
	at org.apache.tomcat.util.threads.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1191)
	at org.apache.tomcat.util.threads.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:659)
	at org.apache.tomcat.util.threads.TaskThread$WrappingRunnable.run(TaskThread.java:61)
	at java.base/java.lang.Thread.run(Thread.java:840)

20:30:26:673 DEBUG 35032 --- [http-nio-8080-exec-5] c.l.api.client.FlaskAiDoctorClient       : [FlaskAiDoctorClient#eye_doctor_chat] <--- END ERROR
20:30:26:678 ERROR 35032 --- [http-nio-8080-exec-5] o.a.c.c.C.[.[.[/].[dispatcherServlet]    : Servlet.service() for servlet [dispatcherServlet] in context with path [] threw exception [Request processing failed; nested exception is feign.RetryableException: Connection refused: getsockopt executing POST http://ai-service/api/eye-doctor/chat] with root cause

java.net.ConnectException: Connection refused: getsockopt
	at java.base/sun.nio.ch.Net.pollConnect(Native Method) ~[na:na]
	at java.base/sun.nio.ch.Net.pollConnectNow(Net.java:672) ~[na:na]
	at java.base/sun.nio.ch.NioSocketImpl.timedFinishConnect(NioSocketImpl.java:554) ~[na:na]
	at java.base/sun.nio.ch.NioSocketImpl.connect(NioSocketImpl.java:602) ~[na:na]
	at java.base/java.net.Socket.connect(Socket.java:633) ~[na:na]
	at java.base/sun.net.NetworkClient.doConnect(NetworkClient.java:178) ~[na:na]
	at java.base/sun.net.www.http.HttpClient.openServer(HttpClient.java:533) ~[na:na]
	at java.base/sun.net.www.http.HttpClient.openServer(HttpClient.java:638) ~[na:na]
	at java.base/sun.net.www.http.HttpClient.<init>(HttpClient.java:281) ~[na:na]
	at java.base/sun.net.www.http.HttpClient.New(HttpClient.java:386) ~[na:na]
	at java.base/sun.net.www.http.HttpClient.New(HttpClient.java:408) ~[na:na]
	at java.base/sun.net.www.protocol.http.HttpURLConnection.getNewHttpClient(HttpURLConnection.java:1309) ~[na:na]
	at java.base/sun.net.www.protocol.http.HttpURLConnection.plainConnect0(HttpURLConnection.java:1242) ~[na:na]
	at java.base/sun.net.www.protocol.http.HttpURLConnection.plainConnect(HttpURLConnection.java:1128) ~[na:na]
	at java.base/sun.net.www.protocol.http.HttpURLConnection.connect(HttpURLConnection.java:1057) ~[na:na]
	at java.base/sun.net.www.protocol.http.HttpURLConnection.getOutputStream0(HttpURLConnection.java:1451) ~[na:na]
	at java.base/sun.net.www.protocol.http.HttpURLConnection.getOutputStream(HttpURLConnection.java:1422) ~[na:na]
	at feign.Client$Default.convertAndSend(Client.java:208) ~[feign-core-11.10.jar:na]
	at feign.Client$Default.execute(Client.java:105) ~[feign-core-11.10.jar:na]
	at org.springframework.cloud.openfeign.loadbalancer.LoadBalancerUtils.executeWithLoadBalancerLifecycleProcessing(LoadBalancerUtils.java:57) ~[spring-cloud-openfeign-core-3.1.5.jar:3.1.5]
	at org.springframework.cloud.openfeign.loadbalancer.LoadBalancerUtils.executeWithLoadBalancerLifecycleProcessing(LoadBalancerUtils.java:95) ~[spring-cloud-openfeign-core-3.1.5.jar:3.1.5]
	at org.springframework.cloud.openfeign.loadbalancer.FeignBlockingLoadBalancerClient.execute(FeignBlockingLoadBalancerClient.java:114) ~[spring-cloud-openfeign-core-3.1.5.jar:3.1.5]
	at feign.SynchronousMethodHandler.executeAndDecode(SynchronousMethodHandler.java:121) ~[feign-core-11.10.jar:na]
	at feign.SynchronousMethodHandler.invoke(SynchronousMethodHandler.java:91) ~[feign-core-11.10.jar:na]
	at feign.ReflectiveFeign$FeignInvocationHandler.invoke(ReflectiveFeign.java:100) ~[feign-core-11.10.jar:na]
	at jdk.proxy2/jdk.proxy2.$Proxy135.eye_doctor_chat(Unknown Source) ~[na:na]
	at com.luojiawei.his_service.controller.ChatController.ask(ChatController.java:39) ~[classes/:na]
	at java.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke0(Native Method) ~[na:na]
	at java.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:77) ~[na:na]
	at java.base/jdk.internal.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43) ~[na:na]
	at java.base/java.lang.reflect.Method.invoke(Method.java:568) ~[na:na]
	at org.springframework.web.method.support.InvocableHandlerMethod.doInvoke(InvocableHandlerMethod.java:205) ~[spring-web-5.3.27.jar:5.3.27]
	at org.springframework.web.method.support.InvocableHandlerMethod.invokeForRequest(InvocableHandlerMethod.java:150) ~[spring-web-5.3.27.jar:5.3.27]
	at org.springframework.web.servlet.mvc.method.annotation.ServletInvocableHandlerMethod.invokeAndHandle(ServletInvocableHandlerMethod.java:117) ~[spring-webmvc-5.3.27.jar:5.3.27]
	at org.springframework.web.servlet.mvc.method.annotation.RequestMappingHandlerAdapter.invokeHandlerMethod(RequestMappingHandlerAdapter.java:895) ~[spring-webmvc-5.3.27.jar:5.3.27]
	at org.springframework.web.servlet.mvc.method.annotation.RequestMappingHandlerAdapter.handleInternal(RequestMappingHandlerAdapter.java:808) ~[spring-webmvc-5.3.27.jar:5.3.27]
	at org.springframework.web.servlet.mvc.method.AbstractHandlerMethodAdapter.handle(AbstractHandlerMethodAdapter.java:87) ~[spring-webmvc-5.3.27.jar:5.3.27]
	at org.springframework.web.servlet.DispatcherServlet.doDispatch(DispatcherServlet.java:1072) ~[spring-webmvc-5.3.27.jar:5.3.27]
	at org.springframework.web.servlet.DispatcherServlet.doService(DispatcherServlet.java:965) ~[spring-webmvc-5.3.27.jar:5.3.27]
	at org.springframework.web.servlet.FrameworkServlet.processRequest(FrameworkServlet.java:1006) ~[spring-webmvc-5.3.27.jar:5.3.27]
	at org.springframework.web.servlet.FrameworkServlet.doPost(FrameworkServlet.java:909) ~[spring-webmvc-5.3.27.jar:5.3.27]
	at javax.servlet.http.HttpServlet.service(HttpServlet.java:555) ~[tomcat-embed-core-9.0.75.jar:4.0.FR]
	at org.springframework.web.servlet.FrameworkServlet.service(FrameworkServlet.java:883) ~[spring-webmvc-5.3.27.jar:5.3.27]
	at javax.servlet.http.HttpServlet.service(HttpServlet.java:623) ~[tomcat-embed-core-9.0.75.jar:4.0.FR]
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:209) ~[tomcat-embed-core-9.0.75.jar:9.0.75]
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:153) ~[tomcat-embed-core-9.0.75.jar:9.0.75]
	at com.luojiawei.his_service.filter.RefreshTokenFilter.doFilterInternal(RefreshTokenFilter.java:58) ~[classes/:na]
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:117) ~[spring-web-5.3.27.jar:5.3.27]
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:178) ~[tomcat-embed-core-9.0.75.jar:9.0.75]
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:153) ~[tomcat-embed-core-9.0.75.jar:9.0.75]
	at org.springframework.web.filter.RequestContextFilter.doFilterInternal(RequestContextFilter.java:100) ~[spring-web-5.3.27.jar:5.3.27]
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:117) ~[spring-web-5.3.27.jar:5.3.27]
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:178) ~[tomcat-embed-core-9.0.75.jar:9.0.75]
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:153) ~[tomcat-embed-core-9.0.75.jar:9.0.75]
	at org.springframework.web.filter.FormContentFilter.doFilterInternal(FormContentFilter.java:93) ~[spring-web-5.3.27.jar:5.3.27]
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:117) ~[spring-web-5.3.27.jar:5.3.27]
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:178) ~[tomcat-embed-core-9.0.75.jar:9.0.75]
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:153) ~[tomcat-embed-core-9.0.75.jar:9.0.75]
	at org.springframework.boot.actuate.metrics.web.servlet.WebMvcMetricsFilter.doFilterInternal(WebMvcMetricsFilter.java:96) ~[spring-boot-actuator-2.7.12.jar:2.7.12]
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:117) ~[spring-web-5.3.27.jar:5.3.27]
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:178) ~[tomcat-embed-core-9.0.75.jar:9.0.75]
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:153) ~[tomcat-embed-core-9.0.75.jar:9.0.75]
	at org.springframework.web.filter.CharacterEncodingFilter.doFilterInternal(CharacterEncodingFilter.java:201) ~[spring-web-5.3.27.jar:5.3.27]
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:117) ~[spring-web-5.3.27.jar:5.3.27]
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:178) ~[tomcat-embed-core-9.0.75.jar:9.0.75]
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:153) ~[tomcat-embed-core-9.0.75.jar:9.0.75]
	at org.apache.catalina.core.StandardWrapperValve.invoke(StandardWrapperValve.java:167) ~[tomcat-embed-core-9.0.75.jar:9.0.75]
	at org.apache.catalina.core.StandardContextValve.invoke(StandardContextValve.java:90) ~[tomcat-embed-core-9.0.75.jar:9.0.75]
	at org.apache.catalina.authenticator.AuthenticatorBase.invoke(AuthenticatorBase.java:481) ~[tomcat-embed-core-9.0.75.jar:9.0.75]
	at org.apache.catalina.core.StandardHostValve.invoke(StandardHostValve.java:130) ~[tomcat-embed-core-9.0.75.jar:9.0.75]
	at org.apache.catalina.valves.ErrorReportValve.invoke(ErrorReportValve.java:93) ~[tomcat-embed-core-9.0.75.jar:9.0.75]
	at org.apache.catalina.core.StandardEngineValve.invoke(StandardEngineValve.java:74) ~[tomcat-embed-core-9.0.75.jar:9.0.75]
	at org.apache.catalina.connector.CoyoteAdapter.service(CoyoteAdapter.java:343) ~[tomcat-embed-core-9.0.75.jar:9.0.75]
	at org.apache.coyote.http11.Http11Processor.service(Http11Processor.java:390) ~[tomcat-embed-core-9.0.75.jar:9.0.75]
	at org.apache.coyote.AbstractProcessorLight.process(AbstractProcessorLight.java:63) ~[tomcat-embed-core-9.0.75.jar:9.0.75]
	at org.apache.coyote.AbstractProtocol$ConnectionHandler.process(AbstractProtocol.java:926) ~[tomcat-embed-core-9.0.75.jar:9.0.75]
	at org.apache.tomcat.util.net.NioEndpoint$SocketProcessor.doRun(NioEndpoint.java:1791) ~[tomcat-embed-core-9.0.75.jar:9.0.75]
	at org.apache.tomcat.util.net.SocketProcessorBase.run(SocketProcessorBase.java:52) ~[tomcat-embed-core-9.0.75.jar:9.0.75]
	at org.apache.tomcat.util.threads.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1191) ~[tomcat-embed-core-9.0.75.jar:9.0.75]
	at org.apache.tomcat.util.threads.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:659) ~[tomcat-embed-core-9.0.75.jar:9.0.75]
	at org.apache.tomcat.util.threads.TaskThread$WrappingRunnable.run(TaskThread.java:61) ~[tomcat-embed-core-9.0.75.jar:9.0.75]
	at java.base/java.lang.Thread.run(Thread.java:840) ~[na:na]

20:31:04:467  WARN 35032 --- [Thread-15] c.a.nacos.common.notify.NotifyCenter     : [NotifyCenter] Start destroying Publisher
20:31:04:467  WARN 35032 --- [Thread-15] c.a.nacos.common.notify.NotifyCenter     : [NotifyCenter] Destruction of the end
20:31:04:469  WARN 35032 --- [Thread-18] c.a.n.common.http.HttpClientBeanHolder   : [HttpClientBeanHolder] Start destroying common HttpClient
20:31:04:476  WARN 35032 --- [Thread-18] c.a.n.common.http.HttpClientBeanHolder   : [HttpClientBeanHolder] Destruction of the end
20:31:04:594  INFO 35032 --- [SpringApplicationShutdownHook] c.a.c.n.registry.NacosServiceRegistry    : De-registering from Nacos Server now...
20:31:04:610  INFO 35032 --- [SpringApplicationShutdownHook] c.a.c.n.registry.NacosServiceRegistry    : De-registration finished.
20:31:04:626  INFO 35032 --- [SpringApplicationShutdownHook] com.zaxxer.hikari.HikariDataSource       : HikariPool-1 - Shutdown initiated...
20:31:04:940  INFO 35032 --- [SpringApplicationShutdownHook] com.zaxxer.hikari.HikariDataSource       : HikariPool-1 - Shutdown completed.
20:31:10:039  INFO 33624 --- [main] c.l.his_service.HisServiceApplication    : Starting HisServiceApplication using Java 17.0.11 on luo with PID 33624 (A:\Desktop\workspace\HIS\his_service\target\classes started by 22407 in A:\Desktop\workspace\HIS)
20:31:10:040 DEBUG 33624 --- [main] c.l.his_service.HisServiceApplication    : Running with Spring Boot v2.7.12, Spring v5.3.27
20:31:10:041  INFO 33624 --- [main] c.l.his_service.HisServiceApplication    : The following 1 profile is active: "dev"
20:31:11:368  INFO 33624 --- [main] .s.d.r.c.RepositoryConfigurationDelegate : Multiple Spring Data modules found, entering strict repository configuration mode
20:31:11:371  INFO 33624 --- [main] .s.d.r.c.RepositoryConfigurationDelegate : Bootstrapping Spring Data Redis repositories in DEFAULT mode.
20:31:11:404  INFO 33624 --- [main] .s.d.r.c.RepositoryConfigurationDelegate : Finished Spring Data repository scanning in 17 ms. Found 0 Redis repository interfaces.
20:31:11:727  INFO 33624 --- [main] o.s.cloud.context.scope.GenericScope     : BeanFactory id=ac61872e-faec-371d-922e-ad941e5407d7
20:31:13:478  INFO 33624 --- [main] o.s.b.w.embedded.tomcat.TomcatWebServer  : Tomcat initialized with port(s): 8080 (http)
20:31:13:505  INFO 33624 --- [main] o.apache.catalina.core.StandardService   : Starting service [Tomcat]
20:31:13:506  INFO 33624 --- [main] org.apache.catalina.core.StandardEngine  : Starting Servlet engine: [Apache Tomcat/9.0.75]
20:31:13:796  INFO 33624 --- [main] o.a.c.c.C.[Tomcat].[localhost].[/]       : Initializing Spring embedded WebApplicationContext
20:31:13:797  INFO 33624 --- [main] w.s.c.ServletWebServerApplicationContext : Root WebApplicationContext: initialization completed in 3702 ms
20:31:14:118  INFO 33624 --- [main] org.redisson.Version                     : Redisson 3.17.7
20:31:14:533  INFO 33624 --- [redisson-netty-2-9] o.r.c.pool.MasterPubSubConnectionPool    : 1 connections initialized for 111.230.32.147/111.230.32.147:9631
20:31:15:211  INFO 33624 --- [redisson-netty-2-19] o.r.c.pool.MasterConnectionPool          : 24 connections initialized for 111.230.32.147/111.230.32.147:9631
20:31:15:554 DEBUG 33624 --- [main] c.l.h.filter.RefreshTokenFilter          : Filter 'refreshTokenFilter' configured for use
20:31:16:440  INFO 33624 --- [main] o.s.c.openfeign.FeignClientFactoryBean   : For 'flask-service' URL not provided. Will try picking an instance via load-balancing.
20:31:16:542  INFO 33624 --- [main] o.s.c.openfeign.FeignClientFactoryBean   : For 'ai-service' URL not provided. Will try picking an instance via load-balancing.
20:31:16:588  WARN 33624 --- [main] c.b.m.core.metadata.TableInfoHelper      : Can not find table primary key in Class: "java.lang.Object".
20:31:16:588  WARN 33624 --- [main] c.b.m.core.injector.DefaultSqlInjector   : class java.lang.Object ,Not found @TableId annotation, Cannot use Mybatis-Plus 'xxById' Method.
20:31:18:481  WARN 33624 --- [main] iguration$LoadBalancerCaffeineWarnLogger : Spring Cloud LoadBalancer is currently working with the default cache. While this cache implementation is useful for development and tests, it's recommended to use Caffeine cache in production.You can switch to using Caffeine cache, by adding it and org.springframework.cache.caffeine.CaffeineCacheManager to the classpath.
20:31:18:487  INFO 33624 --- [main] o.s.b.a.e.web.EndpointLinksResolver      : Exposing 1 endpoint(s) beneath base path '/actuator'
20:31:18:577  INFO 33624 --- [main] o.s.b.w.embedded.tomcat.TomcatWebServer  : Tomcat started on port(s): 8080 (http) with context path ''
20:31:18:621  INFO 33624 --- [main] c.a.n.p.a.s.c.ClientAuthPluginManager    : [ClientAuthPluginManager] Load ClientAuthService com.alibaba.nacos.client.auth.impl.NacosClientAuthServiceImpl success.
20:31:18:621  INFO 33624 --- [main] c.a.n.p.a.s.c.ClientAuthPluginManager    : [ClientAuthPluginManager] Load ClientAuthService com.alibaba.nacos.client.auth.ram.RamClientAuthServiceImpl success.
20:31:20:696  INFO 33624 --- [main] c.a.n.c.a.AbstractAbilityControlManager  : Ready to get current node abilities...
20:31:20:697  INFO 33624 --- [main] c.a.n.c.a.AbstractAbilityControlManager  : Ready to initialize current node abilities, support modes: [SDK_CLIENT]
20:31:20:698  INFO 33624 --- [main] c.a.n.c.a.AbstractAbilityControlManager  : Initialize current abilities finish...
20:31:20:698  INFO 33624 --- [main] c.a.n.c.a.d.NacosAbilityManagerHolder    : [AbilityControlManager] Successfully initialize AbilityControlManager
20:31:20:756  INFO 33624 --- [main] c.a.c.n.registry.NacosServiceRegistry    : nacos registry, DEFAULT_GROUP his-service 10.21.93.70:8080 register finished
20:31:21:010  INFO 33624 --- [main] c.l.his_service.HisServiceApplication    : Started HisServiceApplication in 11.942 seconds (JVM running for 13.325)
20:31:21:320  INFO 33624 --- [RMI TCP Connection(4)-10.21.93.70] o.a.c.c.C.[Tomcat].[localhost].[/]       : Initializing Spring DispatcherServlet 'dispatcherServlet'
20:31:21:321  INFO 33624 --- [RMI TCP Connection(4)-10.21.93.70] o.s.web.servlet.DispatcherServlet        : Initializing Servlet 'dispatcherServlet'
20:31:21:324  INFO 33624 --- [RMI TCP Connection(4)-10.21.93.70] o.s.web.servlet.DispatcherServlet        : Completed initialization in 3 ms
20:31:21:324  INFO 33624 --- [RMI TCP Connection(5)-10.21.93.70] com.zaxxer.hikari.HikariDataSource       : HikariPool-1 - Starting...
20:31:22:050  INFO 33624 --- [RMI TCP Connection(5)-10.21.93.70] com.zaxxer.hikari.HikariDataSource       : HikariPool-1 - Start completed.
20:33:35:428  WARN 33624 --- [Thread-15] c.a.nacos.common.notify.NotifyCenter     : [NotifyCenter] Start destroying Publisher
20:33:35:428  WARN 33624 --- [Thread-15] c.a.nacos.common.notify.NotifyCenter     : [NotifyCenter] Destruction of the end
20:33:35:429  WARN 33624 --- [Thread-18] c.a.n.common.http.HttpClientBeanHolder   : [HttpClientBeanHolder] Start destroying common HttpClient
20:33:35:431  WARN 33624 --- [Thread-18] c.a.n.common.http.HttpClientBeanHolder   : [HttpClientBeanHolder] Destruction of the end
20:33:35:515  INFO 33624 --- [SpringApplicationShutdownHook] c.a.c.n.registry.NacosServiceRegistry    : De-registering from Nacos Server now...
20:33:35:533  INFO 33624 --- [SpringApplicationShutdownHook] c.a.c.n.registry.NacosServiceRegistry    : De-registration finished.
20:33:35:572  INFO 33624 --- [SpringApplicationShutdownHook] com.zaxxer.hikari.HikariDataSource       : HikariPool-1 - Shutdown initiated...
20:33:35:880  INFO 33624 --- [SpringApplicationShutdownHook] com.zaxxer.hikari.HikariDataSource       : HikariPool-1 - Shutdown completed.
20:33:48:301  INFO 31492 --- [main] c.l.his_service.HisServiceApplication    : Starting HisServiceApplication using Java 17.0.11 on luo with PID 31492 (A:\Desktop\workspace\HIS\his_service\target\classes started by 22407 in A:\Desktop\workspace\HIS)
20:33:48:302 DEBUG 31492 --- [main] c.l.his_service.HisServiceApplication    : Running with Spring Boot v2.7.12, Spring v5.3.27
20:33:48:302  INFO 31492 --- [main] c.l.his_service.HisServiceApplication    : The following 1 profile is active: "dev"
20:33:49:778  INFO 31492 --- [main] .s.d.r.c.RepositoryConfigurationDelegate : Multiple Spring Data modules found, entering strict repository configuration mode
20:33:49:780  INFO 31492 --- [main] .s.d.r.c.RepositoryConfigurationDelegate : Bootstrapping Spring Data Redis repositories in DEFAULT mode.
20:33:49:818  INFO 31492 --- [main] .s.d.r.c.RepositoryConfigurationDelegate : Finished Spring Data repository scanning in 20 ms. Found 0 Redis repository interfaces.
20:33:50:163  INFO 31492 --- [main] o.s.cloud.context.scope.GenericScope     : BeanFactory id=93ec073a-d50a-3e20-8556-fa3097b20012
20:33:51:977  INFO 31492 --- [main] o.s.b.w.embedded.tomcat.TomcatWebServer  : Tomcat initialized with port(s): 8080 (http)
20:33:52:004  INFO 31492 --- [main] o.apache.catalina.core.StandardService   : Starting service [Tomcat]
20:33:52:004  INFO 31492 --- [main] org.apache.catalina.core.StandardEngine  : Starting Servlet engine: [Apache Tomcat/9.0.75]
20:33:52:298  INFO 31492 --- [main] o.a.c.c.C.[Tomcat].[localhost].[/]       : Initializing Spring embedded WebApplicationContext
20:33:52:299  INFO 31492 --- [main] w.s.c.ServletWebServerApplicationContext : Root WebApplicationContext: initialization completed in 3947 ms
20:33:52:554  INFO 31492 --- [main] org.redisson.Version                     : Redisson 3.17.7
20:33:52:977  INFO 31492 --- [redisson-netty-2-9] o.r.c.pool.MasterPubSubConnectionPool    : 1 connections initialized for 111.230.32.147/111.230.32.147:9631
20:33:53:665  INFO 31492 --- [redisson-netty-2-19] o.r.c.pool.MasterConnectionPool          : 24 connections initialized for 111.230.32.147/111.230.32.147:9631
20:33:53:966 DEBUG 31492 --- [main] c.l.h.filter.RefreshTokenFilter          : Filter 'refreshTokenFilter' configured for use
20:33:54:914  INFO 31492 --- [main] o.s.c.openfeign.FeignClientFactoryBean   : For 'flask-service' URL not provided. Will try picking an instance via load-balancing.
20:33:55:425  INFO 31492 --- [main] o.s.c.openfeign.FeignClientFactoryBean   : For 'ai-service' URL not provided. Will try picking an instance via load-balancing.
20:33:55:486  WARN 31492 --- [main] c.b.m.core.metadata.TableInfoHelper      : Can not find table primary key in Class: "java.lang.Object".
20:33:55:487  WARN 31492 --- [main] c.b.m.core.injector.DefaultSqlInjector   : class java.lang.Object ,Not found @TableId annotation, Cannot use Mybatis-Plus 'xxById' Method.
20:33:57:152  WARN 31492 --- [main] iguration$LoadBalancerCaffeineWarnLogger : Spring Cloud LoadBalancer is currently working with the default cache. While this cache implementation is useful for development and tests, it's recommended to use Caffeine cache in production.You can switch to using Caffeine cache, by adding it and org.springframework.cache.caffeine.CaffeineCacheManager to the classpath.
20:33:57:156  INFO 31492 --- [main] o.s.b.a.e.web.EndpointLinksResolver      : Exposing 1 endpoint(s) beneath base path '/actuator'
20:33:57:260  INFO 31492 --- [main] o.s.b.w.embedded.tomcat.TomcatWebServer  : Tomcat started on port(s): 8080 (http) with context path ''
20:33:57:319  INFO 31492 --- [main] c.a.n.p.a.s.c.ClientAuthPluginManager    : [ClientAuthPluginManager] Load ClientAuthService com.alibaba.nacos.client.auth.impl.NacosClientAuthServiceImpl success.
20:33:57:319  INFO 31492 --- [main] c.a.n.p.a.s.c.ClientAuthPluginManager    : [ClientAuthPluginManager] Load ClientAuthService com.alibaba.nacos.client.auth.ram.RamClientAuthServiceImpl success.
20:33:59:479  INFO 31492 --- [main] c.a.n.c.a.AbstractAbilityControlManager  : Ready to get current node abilities...
20:33:59:480  INFO 31492 --- [main] c.a.n.c.a.AbstractAbilityControlManager  : Ready to initialize current node abilities, support modes: [SDK_CLIENT]
20:33:59:481  INFO 31492 --- [main] c.a.n.c.a.AbstractAbilityControlManager  : Initialize current abilities finish...
20:33:59:481  INFO 31492 --- [main] c.a.n.c.a.d.NacosAbilityManagerHolder    : [AbilityControlManager] Successfully initialize AbilityControlManager
20:33:59:536  INFO 31492 --- [main] c.a.c.n.registry.NacosServiceRegistry    : nacos registry, DEFAULT_GROUP his-service 10.21.93.70:8080 register finished
20:33:59:814  INFO 31492 --- [main] c.l.his_service.HisServiceApplication    : Started HisServiceApplication in 12.538 seconds (JVM running for 13.795)
20:34:00:002  INFO 31492 --- [RMI TCP Connection(3)-10.21.93.70] o.a.c.c.C.[Tomcat].[localhost].[/]       : Initializing Spring DispatcherServlet 'dispatcherServlet'
20:34:00:002  INFO 31492 --- [RMI TCP Connection(3)-10.21.93.70] o.s.web.servlet.DispatcherServlet        : Initializing Servlet 'dispatcherServlet'
20:34:00:005  INFO 31492 --- [RMI TCP Connection(3)-10.21.93.70] o.s.web.servlet.DispatcherServlet        : Completed initialization in 2 ms
20:34:00:009  INFO 31492 --- [RMI TCP Connection(2)-10.21.93.70] com.zaxxer.hikari.HikariDataSource       : HikariPool-1 - Starting...
20:34:00:700  INFO 31492 --- [RMI TCP Connection(2)-10.21.93.70] com.zaxxer.hikari.HikariDataSource       : HikariPool-1 - Start completed.
20:34:24:836 DEBUG 31492 --- [http-nio-8080-exec-2] c.l.h.m.D.selectById                     : ==>  Preparing: SELECT id,patient_id,doctor_id,disease_name,disease_category,aimodel_id,result,create_time,status,id_card,name,score,remark FROM diagnosis_report WHERE id=?
20:34:24:881 DEBUG 31492 --- [http-nio-8080-exec-2] c.l.h.m.D.selectById                     : ==> Parameters: 1(Integer)
20:34:24:952 DEBUG 31492 --- [http-nio-8080-exec-2] c.l.h.m.D.selectById                     : <==      Total: 1
20:34:24:955 DEBUG 31492 --- [http-nio-8080-exec-2] c.l.h.mapper.PatientMapper.selectById    : ==>  Preparing: SELECT id,phone,id_card,name,verified,verified_by,verified_time,open_id,hospital_pid FROM patient WHERE id=?
20:34:24:956 DEBUG 31492 --- [http-nio-8080-exec-2] c.l.h.mapper.PatientMapper.selectById    : ==> Parameters: 1(Integer)
20:34:24:987 DEBUG 31492 --- [http-nio-8080-exec-2] c.l.h.mapper.PatientMapper.selectById    : <==      Total: 1
20:34:24:989 DEBUG 31492 --- [http-nio-8080-exec-2] c.l.h.mapper.DoctorMapper.selectById     : ==>  Preparing: SELECT id,phone,id_card,name,verified,verified_by,verified_time,license,department,hospital_pid FROM doctor WHERE id=?
20:34:24:989 DEBUG 31492 --- [http-nio-8080-exec-2] c.l.h.mapper.DoctorMapper.selectById     : ==> Parameters: 1(Integer)
20:34:25:021 DEBUG 31492 --- [http-nio-8080-exec-2] c.l.h.mapper.DoctorMapper.selectById     : <==      Total: 1
20:34:25:024 DEBUG 31492 --- [http-nio-8080-exec-2] c.l.h.m.E.selectListByDiagnosisId        : ==>  Preparing: select * from eye_images where dignosis_report_id = ?
20:34:25:024 DEBUG 31492 --- [http-nio-8080-exec-2] c.l.h.m.E.selectListByDiagnosisId        : ==> Parameters: 1(Integer)
20:34:25:055 DEBUG 31492 --- [http-nio-8080-exec-2] c.l.h.m.E.selectListByDiagnosisId        : <==      Total: 1
20:34:25:056 DEBUG 31492 --- [http-nio-8080-exec-2] c.l.h.m.T.selectByDiagnosisId            : ==>  Preparing: select * from treatment_plans where diagnosis_id = ?
20:34:25:056 DEBUG 31492 --- [http-nio-8080-exec-2] c.l.h.m.T.selectByDiagnosisId            : ==> Parameters: 1(Integer)
20:34:25:087 DEBUG 31492 --- [http-nio-8080-exec-2] c.l.h.m.T.selectByDiagnosisId            : <==      Total: 1
20:34:25:088 DEBUG 31492 --- [http-nio-8080-exec-2] c.l.h.m.M.selectByDiagnosisId            : ==>  Preparing: select * from medication_recommendations where diagnosis_id = ?
20:34:25:088 DEBUG 31492 --- [http-nio-8080-exec-2] c.l.h.m.M.selectByDiagnosisId            : ==> Parameters: 1(Integer)
20:34:25:120 DEBUG 31492 --- [http-nio-8080-exec-2] c.l.h.m.M.selectByDiagnosisId            : <==      Total: 1
20:34:25:120 DEBUG 31492 --- [http-nio-8080-exec-2] c.l.h.mapper.AiModelMapper.selectById    : ==>  Preparing: SELECT id,version,deploy_time,accuracy FROM ai_model WHERE id=?
20:34:25:121 DEBUG 31492 --- [http-nio-8080-exec-2] c.l.h.mapper.AiModelMapper.selectById    : ==> Parameters: 1(Integer)
20:34:25:151 DEBUG 31492 --- [http-nio-8080-exec-2] c.l.h.mapper.AiModelMapper.selectById    : <==      Total: 1
20:34:25:181 DEBUG 31492 --- [http-nio-8080-exec-2] c.l.api.client.FlaskAiDoctorClient       : [FlaskAiDoctorClient#eye_doctor_chat] ---> POST http://ai-service/api/eye-doctor/chat HTTP/1.1
20:34:25:182 DEBUG 31492 --- [http-nio-8080-exec-2] c.l.api.client.FlaskAiDoctorClient       : [FlaskAiDoctorClient#eye_doctor_chat] Content-Length: 753
20:34:25:182 DEBUG 31492 --- [http-nio-8080-exec-2] c.l.api.client.FlaskAiDoctorClient       : [FlaskAiDoctorClient#eye_doctor_chat] Content-Type: application/json
20:34:25:182 DEBUG 31492 --- [http-nio-8080-exec-2] c.l.api.client.FlaskAiDoctorClient       : [FlaskAiDoctorClient#eye_doctor_chat] 
20:34:25:182 DEBUG 31492 --- [http-nio-8080-exec-2] c.l.api.client.FlaskAiDoctorClient       : [FlaskAiDoctorClient#eye_doctor_chat] {"diagnosis_name":"","diagnosis_category":"","result":"A","remark":"A","treatment_plan":{"id":1,"treatmentType":1,"treatmentDetail":"","startTime":"2025-03-01 09:00:00","endDate":"2025-03-10 09:00:00","doctorId":1,"createdTime":"2025-03-01T09:00:00","updatedTime":"2025-03-01T09:00:00"},"medications":[{"id":1,"diagnosisId":1,"medicationName":"A","dosage":"10mg","frequency":"","sideEffects":"","startTime":"2025-03-01T09:00:00","endTime":"2025-03-10T09:00:00","doctorId":1,"createdTime":"2025-03-01 09:00:00","updatedTime":"2025-03-01 09:00:00"}],"previous_conversations":[{"role":"pariatur tempor do","content":"sit cupidatat commodo"}],"question":"irure eu esse","stream":false}
20:34:25:183 DEBUG 31492 --- [http-nio-8080-exec-2] c.l.api.client.FlaskAiDoctorClient       : [FlaskAiDoctorClient#eye_doctor_chat] ---> END HTTP (753-byte body)
20:34:27:496 DEBUG 31492 --- [http-nio-8080-exec-2] c.l.api.client.FlaskAiDoctorClient       : [FlaskAiDoctorClient#eye_doctor_chat] <--- ERROR ConnectException: Failed to connect to /10.21.93.70:8000 (2312ms)
20:34:27:498 DEBUG 31492 --- [http-nio-8080-exec-2] c.l.api.client.FlaskAiDoctorClient       : [FlaskAiDoctorClient#eye_doctor_chat] java.net.ConnectException: Failed to connect to /10.21.93.70:8000
	at okhttp3.internal.connection.RealConnection.connectSocket(RealConnection.kt:297)
	at okhttp3.internal.connection.RealConnection.connect(RealConnection.kt:207)
	at okhttp3.internal.connection.ExchangeFinder.findConnection(ExchangeFinder.kt:226)
	at okhttp3.internal.connection.ExchangeFinder.findHealthyConnection(ExchangeFinder.kt:106)
	at okhttp3.internal.connection.ExchangeFinder.find(ExchangeFinder.kt:74)
	at okhttp3.internal.connection.RealCall.initExchange$okhttp(RealCall.kt:255)
	at okhttp3.internal.connection.ConnectInterceptor.intercept(ConnectInterceptor.kt:32)
	at okhttp3.internal.http.RealInterceptorChain.proceed(RealInterceptorChain.kt:109)
	at okhttp3.internal.cache.CacheInterceptor.intercept(CacheInterceptor.kt:95)
	at okhttp3.internal.http.RealInterceptorChain.proceed(RealInterceptorChain.kt:109)
	at okhttp3.internal.http.BridgeInterceptor.intercept(BridgeInterceptor.kt:83)
	at okhttp3.internal.http.RealInterceptorChain.proceed(RealInterceptorChain.kt:109)
	at okhttp3.internal.http.RetryAndFollowUpInterceptor.intercept(RetryAndFollowUpInterceptor.kt:76)
	at okhttp3.internal.http.RealInterceptorChain.proceed(RealInterceptorChain.kt:109)
	at okhttp3.internal.connection.RealCall.getResponseWithInterceptorChain$okhttp(RealCall.kt:201)
	at okhttp3.internal.connection.RealCall.execute(RealCall.kt:154)
	at feign.okhttp.OkHttpClient.execute(OkHttpClient.java:180)
	at org.springframework.cloud.openfeign.loadbalancer.LoadBalancerUtils.executeWithLoadBalancerLifecycleProcessing(LoadBalancerUtils.java:57)
	at org.springframework.cloud.openfeign.loadbalancer.LoadBalancerUtils.executeWithLoadBalancerLifecycleProcessing(LoadBalancerUtils.java:95)
	at org.springframework.cloud.openfeign.loadbalancer.FeignBlockingLoadBalancerClient.execute(FeignBlockingLoadBalancerClient.java:114)
	at feign.SynchronousMethodHandler.executeAndDecode(SynchronousMethodHandler.java:121)
	at feign.SynchronousMethodHandler.invoke(SynchronousMethodHandler.java:91)
	at feign.ReflectiveFeign$FeignInvocationHandler.invoke(ReflectiveFeign.java:100)
	at jdk.proxy2/jdk.proxy2.$Proxy138.eye_doctor_chat(Unknown Source)
	at com.luojiawei.his_service.controller.ChatController.ask(ChatController.java:39)
	at java.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at java.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:77)
	at java.base/jdk.internal.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.base/java.lang.reflect.Method.invoke(Method.java:568)
	at org.springframework.web.method.support.InvocableHandlerMethod.doInvoke(InvocableHandlerMethod.java:205)
	at org.springframework.web.method.support.InvocableHandlerMethod.invokeForRequest(InvocableHandlerMethod.java:150)
	at org.springframework.web.servlet.mvc.method.annotation.ServletInvocableHandlerMethod.invokeAndHandle(ServletInvocableHandlerMethod.java:117)
	at org.springframework.web.servlet.mvc.method.annotation.RequestMappingHandlerAdapter.invokeHandlerMethod(RequestMappingHandlerAdapter.java:895)
	at org.springframework.web.servlet.mvc.method.annotation.RequestMappingHandlerAdapter.handleInternal(RequestMappingHandlerAdapter.java:808)
	at org.springframework.web.servlet.mvc.method.AbstractHandlerMethodAdapter.handle(AbstractHandlerMethodAdapter.java:87)
	at org.springframework.web.servlet.DispatcherServlet.doDispatch(DispatcherServlet.java:1072)
	at org.springframework.web.servlet.DispatcherServlet.doService(DispatcherServlet.java:965)
	at org.springframework.web.servlet.FrameworkServlet.processRequest(FrameworkServlet.java:1006)
	at org.springframework.web.servlet.FrameworkServlet.doPost(FrameworkServlet.java:909)
	at javax.servlet.http.HttpServlet.service(HttpServlet.java:555)
	at org.springframework.web.servlet.FrameworkServlet.service(FrameworkServlet.java:883)
	at javax.servlet.http.HttpServlet.service(HttpServlet.java:623)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:209)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:153)
	at com.luojiawei.his_service.filter.RefreshTokenFilter.doFilterInternal(RefreshTokenFilter.java:58)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:117)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:178)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:153)
	at org.springframework.web.filter.RequestContextFilter.doFilterInternal(RequestContextFilter.java:100)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:117)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:178)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:153)
	at org.springframework.web.filter.FormContentFilter.doFilterInternal(FormContentFilter.java:93)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:117)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:178)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:153)
	at org.springframework.boot.actuate.metrics.web.servlet.WebMvcMetricsFilter.doFilterInternal(WebMvcMetricsFilter.java:96)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:117)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:178)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:153)
	at org.springframework.web.filter.CharacterEncodingFilter.doFilterInternal(CharacterEncodingFilter.java:201)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:117)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:178)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:153)
	at org.apache.catalina.core.StandardWrapperValve.invoke(StandardWrapperValve.java:167)
	at org.apache.catalina.core.StandardContextValve.invoke(StandardContextValve.java:90)
	at org.apache.catalina.authenticator.AuthenticatorBase.invoke(AuthenticatorBase.java:481)
	at org.apache.catalina.core.StandardHostValve.invoke(StandardHostValve.java:130)
	at org.apache.catalina.valves.ErrorReportValve.invoke(ErrorReportValve.java:93)
	at org.apache.catalina.core.StandardEngineValve.invoke(StandardEngineValve.java:74)
	at org.apache.catalina.connector.CoyoteAdapter.service(CoyoteAdapter.java:343)
	at org.apache.coyote.http11.Http11Processor.service(Http11Processor.java:390)
	at org.apache.coyote.AbstractProcessorLight.process(AbstractProcessorLight.java:63)
	at org.apache.coyote.AbstractProtocol$ConnectionHandler.process(AbstractProtocol.java:926)
	at org.apache.tomcat.util.net.NioEndpoint$SocketProcessor.doRun(NioEndpoint.java:1791)
	at org.apache.tomcat.util.net.SocketProcessorBase.run(SocketProcessorBase.java:52)
	at org.apache.tomcat.util.threads.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1191)
	at org.apache.tomcat.util.threads.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:659)
	at org.apache.tomcat.util.threads.TaskThread$WrappingRunnable.run(TaskThread.java:61)
	at java.base/java.lang.Thread.run(Thread.java:840)
Caused by: java.net.ConnectException: Connection refused: getsockopt
	at java.base/sun.nio.ch.Net.pollConnect(Native Method)
	at java.base/sun.nio.ch.Net.pollConnectNow(Net.java:672)
	at java.base/sun.nio.ch.NioSocketImpl.timedFinishConnect(NioSocketImpl.java:554)
	at java.base/sun.nio.ch.NioSocketImpl.connect(NioSocketImpl.java:602)
	at java.base/java.net.SocksSocketImpl.connect(SocksSocketImpl.java:327)
	at java.base/java.net.Socket.connect(Socket.java:633)
	at okhttp3.internal.platform.Platform.connectSocket(Platform.kt:128)
	at okhttp3.internal.connection.RealConnection.connectSocket(RealConnection.kt:295)
	... 79 more

20:34:27:499 DEBUG 31492 --- [http-nio-8080-exec-2] c.l.api.client.FlaskAiDoctorClient       : [FlaskAiDoctorClient#eye_doctor_chat] <--- END ERROR
20:34:27:532 ERROR 31492 --- [http-nio-8080-exec-2] o.a.c.c.C.[.[.[/].[dispatcherServlet]    : Servlet.service() for servlet [dispatcherServlet] in context with path [] threw exception [Request processing failed; nested exception is feign.RetryableException: Failed to connect to /10.21.93.70:8000 executing POST http://ai-service/api/eye-doctor/chat] with root cause

java.net.ConnectException: Connection refused: getsockopt
	at java.base/sun.nio.ch.Net.pollConnect(Native Method) ~[na:na]
	at java.base/sun.nio.ch.Net.pollConnectNow(Net.java:672) ~[na:na]
	at java.base/sun.nio.ch.NioSocketImpl.timedFinishConnect(NioSocketImpl.java:554) ~[na:na]
	at java.base/sun.nio.ch.NioSocketImpl.connect(NioSocketImpl.java:602) ~[na:na]
	at java.base/java.net.SocksSocketImpl.connect(SocksSocketImpl.java:327) ~[na:na]
	at java.base/java.net.Socket.connect(Socket.java:633) ~[na:na]
	at okhttp3.internal.platform.Platform.connectSocket(Platform.kt:128) ~[okhttp-4.9.3.jar:na]
	at okhttp3.internal.connection.RealConnection.connectSocket(RealConnection.kt:295) ~[okhttp-4.9.3.jar:na]
	at okhttp3.internal.connection.RealConnection.connect(RealConnection.kt:207) ~[okhttp-4.9.3.jar:na]
	at okhttp3.internal.connection.ExchangeFinder.findConnection(ExchangeFinder.kt:226) ~[okhttp-4.9.3.jar:na]
	at okhttp3.internal.connection.ExchangeFinder.findHealthyConnection(ExchangeFinder.kt:106) ~[okhttp-4.9.3.jar:na]
	at okhttp3.internal.connection.ExchangeFinder.find(ExchangeFinder.kt:74) ~[okhttp-4.9.3.jar:na]
	at okhttp3.internal.connection.RealCall.initExchange$okhttp(RealCall.kt:255) ~[okhttp-4.9.3.jar:na]
	at okhttp3.internal.connection.ConnectInterceptor.intercept(ConnectInterceptor.kt:32) ~[okhttp-4.9.3.jar:na]
	at okhttp3.internal.http.RealInterceptorChain.proceed(RealInterceptorChain.kt:109) ~[okhttp-4.9.3.jar:na]
	at okhttp3.internal.cache.CacheInterceptor.intercept(CacheInterceptor.kt:95) ~[okhttp-4.9.3.jar:na]
	at okhttp3.internal.http.RealInterceptorChain.proceed(RealInterceptorChain.kt:109) ~[okhttp-4.9.3.jar:na]
	at okhttp3.internal.http.BridgeInterceptor.intercept(BridgeInterceptor.kt:83) ~[okhttp-4.9.3.jar:na]
	at okhttp3.internal.http.RealInterceptorChain.proceed(RealInterceptorChain.kt:109) ~[okhttp-4.9.3.jar:na]
	at okhttp3.internal.http.RetryAndFollowUpInterceptor.intercept(RetryAndFollowUpInterceptor.kt:76) ~[okhttp-4.9.3.jar:na]
	at okhttp3.internal.http.RealInterceptorChain.proceed(RealInterceptorChain.kt:109) ~[okhttp-4.9.3.jar:na]
	at okhttp3.internal.connection.RealCall.getResponseWithInterceptorChain$okhttp(RealCall.kt:201) ~[okhttp-4.9.3.jar:na]
	at okhttp3.internal.connection.RealCall.execute(RealCall.kt:154) ~[okhttp-4.9.3.jar:na]
	at feign.okhttp.OkHttpClient.execute(OkHttpClient.java:180) ~[feign-okhttp-11.10.jar:na]
	at org.springframework.cloud.openfeign.loadbalancer.LoadBalancerUtils.executeWithLoadBalancerLifecycleProcessing(LoadBalancerUtils.java:57) ~[spring-cloud-openfeign-core-3.1.5.jar:3.1.5]
	at org.springframework.cloud.openfeign.loadbalancer.LoadBalancerUtils.executeWithLoadBalancerLifecycleProcessing(LoadBalancerUtils.java:95) ~[spring-cloud-openfeign-core-3.1.5.jar:3.1.5]
	at org.springframework.cloud.openfeign.loadbalancer.FeignBlockingLoadBalancerClient.execute(FeignBlockingLoadBalancerClient.java:114) ~[spring-cloud-openfeign-core-3.1.5.jar:3.1.5]
	at feign.SynchronousMethodHandler.executeAndDecode(SynchronousMethodHandler.java:121) ~[feign-core-11.10.jar:na]
	at feign.SynchronousMethodHandler.invoke(SynchronousMethodHandler.java:91) ~[feign-core-11.10.jar:na]
	at feign.ReflectiveFeign$FeignInvocationHandler.invoke(ReflectiveFeign.java:100) ~[feign-core-11.10.jar:na]
	at jdk.proxy2/jdk.proxy2.$Proxy138.eye_doctor_chat(Unknown Source) ~[na:na]
	at com.luojiawei.his_service.controller.ChatController.ask(ChatController.java:39) ~[classes/:na]
	at java.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke0(Native Method) ~[na:na]
	at java.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:77) ~[na:na]
	at java.base/jdk.internal.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43) ~[na:na]
	at java.base/java.lang.reflect.Method.invoke(Method.java:568) ~[na:na]
	at org.springframework.web.method.support.InvocableHandlerMethod.doInvoke(InvocableHandlerMethod.java:205) ~[spring-web-5.3.27.jar:5.3.27]
	at org.springframework.web.method.support.InvocableHandlerMethod.invokeForRequest(InvocableHandlerMethod.java:150) ~[spring-web-5.3.27.jar:5.3.27]
	at org.springframework.web.servlet.mvc.method.annotation.ServletInvocableHandlerMethod.invokeAndHandle(ServletInvocableHandlerMethod.java:117) ~[spring-webmvc-5.3.27.jar:5.3.27]
	at org.springframework.web.servlet.mvc.method.annotation.RequestMappingHandlerAdapter.invokeHandlerMethod(RequestMappingHandlerAdapter.java:895) ~[spring-webmvc-5.3.27.jar:5.3.27]
	at org.springframework.web.servlet.mvc.method.annotation.RequestMappingHandlerAdapter.handleInternal(RequestMappingHandlerAdapter.java:808) ~[spring-webmvc-5.3.27.jar:5.3.27]
	at org.springframework.web.servlet.mvc.method.AbstractHandlerMethodAdapter.handle(AbstractHandlerMethodAdapter.java:87) ~[spring-webmvc-5.3.27.jar:5.3.27]
	at org.springframework.web.servlet.DispatcherServlet.doDispatch(DispatcherServlet.java:1072) ~[spring-webmvc-5.3.27.jar:5.3.27]
	at org.springframework.web.servlet.DispatcherServlet.doService(DispatcherServlet.java:965) ~[spring-webmvc-5.3.27.jar:5.3.27]
	at org.springframework.web.servlet.FrameworkServlet.processRequest(FrameworkServlet.java:1006) ~[spring-webmvc-5.3.27.jar:5.3.27]
	at org.springframework.web.servlet.FrameworkServlet.doPost(FrameworkServlet.java:909) ~[spring-webmvc-5.3.27.jar:5.3.27]
	at javax.servlet.http.HttpServlet.service(HttpServlet.java:555) ~[tomcat-embed-core-9.0.75.jar:4.0.FR]
	at org.springframework.web.servlet.FrameworkServlet.service(FrameworkServlet.java:883) ~[spring-webmvc-5.3.27.jar:5.3.27]
	at javax.servlet.http.HttpServlet.service(HttpServlet.java:623) ~[tomcat-embed-core-9.0.75.jar:4.0.FR]
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:209) ~[tomcat-embed-core-9.0.75.jar:9.0.75]
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:153) ~[tomcat-embed-core-9.0.75.jar:9.0.75]
	at com.luojiawei.his_service.filter.RefreshTokenFilter.doFilterInternal(RefreshTokenFilter.java:58) ~[classes/:na]
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:117) ~[spring-web-5.3.27.jar:5.3.27]
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:178) ~[tomcat-embed-core-9.0.75.jar:9.0.75]
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:153) ~[tomcat-embed-core-9.0.75.jar:9.0.75]
	at org.springframework.web.filter.RequestContextFilter.doFilterInternal(RequestContextFilter.java:100) ~[spring-web-5.3.27.jar:5.3.27]
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:117) ~[spring-web-5.3.27.jar:5.3.27]
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:178) ~[tomcat-embed-core-9.0.75.jar:9.0.75]
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:153) ~[tomcat-embed-core-9.0.75.jar:9.0.75]
	at org.springframework.web.filter.FormContentFilter.doFilterInternal(FormContentFilter.java:93) ~[spring-web-5.3.27.jar:5.3.27]
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:117) ~[spring-web-5.3.27.jar:5.3.27]
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:178) ~[tomcat-embed-core-9.0.75.jar:9.0.75]
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:153) ~[tomcat-embed-core-9.0.75.jar:9.0.75]
	at org.springframework.boot.actuate.metrics.web.servlet.WebMvcMetricsFilter.doFilterInternal(WebMvcMetricsFilter.java:96) ~[spring-boot-actuator-2.7.12.jar:2.7.12]
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:117) ~[spring-web-5.3.27.jar:5.3.27]
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:178) ~[tomcat-embed-core-9.0.75.jar:9.0.75]
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:153) ~[tomcat-embed-core-9.0.75.jar:9.0.75]
	at org.springframework.web.filter.CharacterEncodingFilter.doFilterInternal(CharacterEncodingFilter.java:201) ~[spring-web-5.3.27.jar:5.3.27]
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:117) ~[spring-web-5.3.27.jar:5.3.27]
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:178) ~[tomcat-embed-core-9.0.75.jar:9.0.75]
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:153) ~[tomcat-embed-core-9.0.75.jar:9.0.75]
	at org.apache.catalina.core.StandardWrapperValve.invoke(StandardWrapperValve.java:167) ~[tomcat-embed-core-9.0.75.jar:9.0.75]
	at org.apache.catalina.core.StandardContextValve.invoke(StandardContextValve.java:90) ~[tomcat-embed-core-9.0.75.jar:9.0.75]
	at org.apache.catalina.authenticator.AuthenticatorBase.invoke(AuthenticatorBase.java:481) ~[tomcat-embed-core-9.0.75.jar:9.0.75]
	at org.apache.catalina.core.StandardHostValve.invoke(StandardHostValve.java:130) ~[tomcat-embed-core-9.0.75.jar:9.0.75]
	at org.apache.catalina.valves.ErrorReportValve.invoke(ErrorReportValve.java:93) ~[tomcat-embed-core-9.0.75.jar:9.0.75]
	at org.apache.catalina.core.StandardEngineValve.invoke(StandardEngineValve.java:74) ~[tomcat-embed-core-9.0.75.jar:9.0.75]
	at org.apache.catalina.connector.CoyoteAdapter.service(CoyoteAdapter.java:343) ~[tomcat-embed-core-9.0.75.jar:9.0.75]
	at org.apache.coyote.http11.Http11Processor.service(Http11Processor.java:390) ~[tomcat-embed-core-9.0.75.jar:9.0.75]
	at org.apache.coyote.AbstractProcessorLight.process(AbstractProcessorLight.java:63) ~[tomcat-embed-core-9.0.75.jar:9.0.75]
	at org.apache.coyote.AbstractProtocol$ConnectionHandler.process(AbstractProtocol.java:926) ~[tomcat-embed-core-9.0.75.jar:9.0.75]
	at org.apache.tomcat.util.net.NioEndpoint$SocketProcessor.doRun(NioEndpoint.java:1791) ~[tomcat-embed-core-9.0.75.jar:9.0.75]
	at org.apache.tomcat.util.net.SocketProcessorBase.run(SocketProcessorBase.java:52) ~[tomcat-embed-core-9.0.75.jar:9.0.75]
	at org.apache.tomcat.util.threads.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1191) ~[tomcat-embed-core-9.0.75.jar:9.0.75]
	at org.apache.tomcat.util.threads.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:659) ~[tomcat-embed-core-9.0.75.jar:9.0.75]
	at org.apache.tomcat.util.threads.TaskThread$WrappingRunnable.run(TaskThread.java:61) ~[tomcat-embed-core-9.0.75.jar:9.0.75]
	at java.base/java.lang.Thread.run(Thread.java:840) ~[na:na]

20:35:38:023  WARN 31492 --- [Thread-15] c.a.nacos.common.notify.NotifyCenter     : [NotifyCenter] Start destroying Publisher
20:35:38:023  WARN 31492 --- [Thread-18] c.a.n.common.http.HttpClientBeanHolder   : [HttpClientBeanHolder] Start destroying common HttpClient
20:35:38:026  WARN 31492 --- [Thread-15] c.a.nacos.common.notify.NotifyCenter     : [NotifyCenter] Destruction of the end
20:35:38:029  WARN 31492 --- [Thread-18] c.a.n.common.http.HttpClientBeanHolder   : [HttpClientBeanHolder] Destruction of the end
20:35:38:111  INFO 31492 --- [SpringApplicationShutdownHook] c.a.c.n.registry.NacosServiceRegistry    : De-registering from Nacos Server now...
20:35:38:161  INFO 31492 --- [SpringApplicationShutdownHook] c.a.c.n.registry.NacosServiceRegistry    : De-registration finished.
20:35:38:213  INFO 31492 --- [SpringApplicationShutdownHook] com.zaxxer.hikari.HikariDataSource       : HikariPool-1 - Shutdown initiated...
20:35:38:518  INFO 31492 --- [SpringApplicationShutdownHook] com.zaxxer.hikari.HikariDataSource       : HikariPool-1 - Shutdown completed.
20:37:19:474  INFO 3812 --- [main] c.l.his_service.HisServiceApplication    : Starting HisServiceApplication using Java 17.0.11 on luo with PID 3812 (A:\Desktop\workspace\HIS\his_service\target\classes started by 22407 in A:\Desktop\workspace\HIS)
20:37:19:485 DEBUG 3812 --- [main] c.l.his_service.HisServiceApplication    : Running with Spring Boot v2.7.12, Spring v5.3.27
20:37:19:486  INFO 3812 --- [main] c.l.his_service.HisServiceApplication    : The following 1 profile is active: "dev"
20:37:22:599  INFO 3812 --- [main] .s.d.r.c.RepositoryConfigurationDelegate : Multiple Spring Data modules found, entering strict repository configuration mode
20:37:22:611  INFO 3812 --- [main] .s.d.r.c.RepositoryConfigurationDelegate : Bootstrapping Spring Data Redis repositories in DEFAULT mode.
20:37:22:734  INFO 3812 --- [main] .s.d.r.c.RepositoryConfigurationDelegate : Finished Spring Data repository scanning in 22 ms. Found 0 Redis repository interfaces.
20:37:23:419  INFO 3812 --- [main] o.s.cloud.context.scope.GenericScope     : BeanFactory id=93ec073a-d50a-3e20-8556-fa3097b20012
20:37:25:788  INFO 3812 --- [main] o.s.b.w.embedded.tomcat.TomcatWebServer  : Tomcat initialized with port(s): 8080 (http)
20:37:25:823  INFO 3812 --- [main] o.apache.catalina.core.StandardService   : Starting service [Tomcat]
20:37:25:823  INFO 3812 --- [main] org.apache.catalina.core.StandardEngine  : Starting Servlet engine: [Apache Tomcat/9.0.75]
20:37:26:089  INFO 3812 --- [main] o.a.c.c.C.[Tomcat].[localhost].[/]       : Initializing Spring embedded WebApplicationContext
20:37:26:089  INFO 3812 --- [main] w.s.c.ServletWebServerApplicationContext : Root WebApplicationContext: initialization completed in 6454 ms
20:37:27:090  INFO 3812 --- [main] org.redisson.Version                     : Redisson 3.17.7
20:37:27:960  INFO 3812 --- [redisson-netty-2-9] o.r.c.pool.MasterPubSubConnectionPool    : 1 connections initialized for 111.230.32.147/111.230.32.147:9631
20:37:28:640  INFO 3812 --- [redisson-netty-2-19] o.r.c.pool.MasterConnectionPool          : 24 connections initialized for 111.230.32.147/111.230.32.147:9631
20:37:29:322 DEBUG 3812 --- [main] c.l.h.filter.RefreshTokenFilter          : Filter 'refreshTokenFilter' configured for use
20:37:31:152  INFO 3812 --- [main] o.s.c.openfeign.FeignClientFactoryBean   : For 'flask-service' URL not provided. Will try picking an instance via load-balancing.
20:37:31:766  INFO 3812 --- [main] o.s.c.openfeign.FeignClientFactoryBean   : For 'ai-service' URL not provided. Will try picking an instance via load-balancing.
20:37:31:803  WARN 3812 --- [main] c.b.m.core.metadata.TableInfoHelper      : Can not find table primary key in Class: "java.lang.Object".
20:37:31:803  WARN 3812 --- [main] c.b.m.core.injector.DefaultSqlInjector   : class java.lang.Object ,Not found @TableId annotation, Cannot use Mybatis-Plus 'xxById' Method.
20:37:34:175  WARN 3812 --- [main] iguration$LoadBalancerCaffeineWarnLogger : Spring Cloud LoadBalancer is currently working with the default cache. While this cache implementation is useful for development and tests, it's recommended to use Caffeine cache in production.You can switch to using Caffeine cache, by adding it and org.springframework.cache.caffeine.CaffeineCacheManager to the classpath.
20:37:34:180  INFO 3812 --- [main] o.s.b.a.e.web.EndpointLinksResolver      : Exposing 1 endpoint(s) beneath base path '/actuator'
20:37:34:276  INFO 3812 --- [main] o.s.b.w.embedded.tomcat.TomcatWebServer  : Tomcat started on port(s): 8080 (http) with context path ''
20:37:34:360  INFO 3812 --- [main] c.a.n.p.a.s.c.ClientAuthPluginManager    : [ClientAuthPluginManager] Load ClientAuthService com.alibaba.nacos.client.auth.impl.NacosClientAuthServiceImpl success.
20:37:34:361  INFO 3812 --- [main] c.a.n.p.a.s.c.ClientAuthPluginManager    : [ClientAuthPluginManager] Load ClientAuthService com.alibaba.nacos.client.auth.ram.RamClientAuthServiceImpl success.
20:37:37:571  INFO 3812 --- [main] c.a.n.c.a.AbstractAbilityControlManager  : Ready to get current node abilities...
20:37:37:573  INFO 3812 --- [main] c.a.n.c.a.AbstractAbilityControlManager  : Ready to initialize current node abilities, support modes: [SDK_CLIENT]
20:37:37:573  INFO 3812 --- [main] c.a.n.c.a.AbstractAbilityControlManager  : Initialize current abilities finish...
20:37:37:574  INFO 3812 --- [main] c.a.n.c.a.d.NacosAbilityManagerHolder    : [AbilityControlManager] Successfully initialize AbilityControlManager
20:37:37:672  INFO 3812 --- [main] c.a.c.n.registry.NacosServiceRegistry    : nacos registry, DEFAULT_GROUP his-service 10.21.93.70:8080 register finished
20:37:37:931  INFO 3812 --- [main] c.l.his_service.HisServiceApplication    : Started HisServiceApplication in 20.385 seconds (JVM running for 22.185)
20:37:38:448  INFO 3812 --- [RMI TCP Connection(2)-10.21.93.70] o.a.c.c.C.[Tomcat].[localhost].[/]       : Initializing Spring DispatcherServlet 'dispatcherServlet'
20:37:38:449  INFO 3812 --- [RMI TCP Connection(2)-10.21.93.70] o.s.web.servlet.DispatcherServlet        : Initializing Servlet 'dispatcherServlet'
20:37:38:449  INFO 3812 --- [RMI TCP Connection(1)-10.21.93.70] com.zaxxer.hikari.HikariDataSource       : HikariPool-1 - Starting...
20:37:38:451  INFO 3812 --- [RMI TCP Connection(2)-10.21.93.70] o.s.web.servlet.DispatcherServlet        : Completed initialization in 2 ms
20:37:39:159  INFO 3812 --- [RMI TCP Connection(1)-10.21.93.70] com.zaxxer.hikari.HikariDataSource       : HikariPool-1 - Start completed.
20:38:41:424 DEBUG 3812 --- [http-nio-8080-exec-2] c.l.h.m.D.selectById                     : ==>  Preparing: SELECT id,patient_id,doctor_id,disease_name,disease_category,aimodel_id,result,create_time,status,id_card,name,score,remark FROM diagnosis_report WHERE id=?
20:38:41:485 DEBUG 3812 --- [http-nio-8080-exec-2] c.l.h.m.D.selectById                     : ==> Parameters: 1(Integer)
20:38:41:596 DEBUG 3812 --- [http-nio-8080-exec-2] c.l.h.m.D.selectById                     : <==      Total: 1
20:38:41:599 DEBUG 3812 --- [http-nio-8080-exec-2] c.l.h.mapper.PatientMapper.selectById    : ==>  Preparing: SELECT id,phone,id_card,name,verified,verified_by,verified_time,open_id,hospital_pid FROM patient WHERE id=?
20:38:41:600 DEBUG 3812 --- [http-nio-8080-exec-2] c.l.h.mapper.PatientMapper.selectById    : ==> Parameters: 1(Integer)
20:38:41:632 DEBUG 3812 --- [http-nio-8080-exec-2] c.l.h.mapper.PatientMapper.selectById    : <==      Total: 1
20:38:41:637 DEBUG 3812 --- [http-nio-8080-exec-2] c.l.h.mapper.DoctorMapper.selectById     : ==>  Preparing: SELECT id,phone,id_card,name,verified,verified_by,verified_time,license,department,hospital_pid FROM doctor WHERE id=?
20:38:41:638 DEBUG 3812 --- [http-nio-8080-exec-2] c.l.h.mapper.DoctorMapper.selectById     : ==> Parameters: 1(Integer)
20:38:41:673 DEBUG 3812 --- [http-nio-8080-exec-2] c.l.h.mapper.DoctorMapper.selectById     : <==      Total: 1
20:38:41:678 DEBUG 3812 --- [http-nio-8080-exec-2] c.l.h.m.E.selectListByDiagnosisId        : ==>  Preparing: select * from eye_images where dignosis_report_id = ?
20:38:41:679 DEBUG 3812 --- [http-nio-8080-exec-2] c.l.h.m.E.selectListByDiagnosisId        : ==> Parameters: 1(Integer)
20:38:41:710 DEBUG 3812 --- [http-nio-8080-exec-2] c.l.h.m.E.selectListByDiagnosisId        : <==      Total: 1
20:38:41:711 DEBUG 3812 --- [http-nio-8080-exec-2] c.l.h.m.T.selectByDiagnosisId            : ==>  Preparing: select * from treatment_plans where diagnosis_id = ?
20:38:41:711 DEBUG 3812 --- [http-nio-8080-exec-2] c.l.h.m.T.selectByDiagnosisId            : ==> Parameters: 1(Integer)
20:38:41:742 DEBUG 3812 --- [http-nio-8080-exec-2] c.l.h.m.T.selectByDiagnosisId            : <==      Total: 1
20:38:41:743 DEBUG 3812 --- [http-nio-8080-exec-2] c.l.h.m.M.selectByDiagnosisId            : ==>  Preparing: select * from medication_recommendations where diagnosis_id = ?
20:38:41:743 DEBUG 3812 --- [http-nio-8080-exec-2] c.l.h.m.M.selectByDiagnosisId            : ==> Parameters: 1(Integer)
20:38:41:775 DEBUG 3812 --- [http-nio-8080-exec-2] c.l.h.m.M.selectByDiagnosisId            : <==      Total: 1
20:38:41:776 DEBUG 3812 --- [http-nio-8080-exec-2] c.l.h.mapper.AiModelMapper.selectById    : ==>  Preparing: SELECT id,version,deploy_time,accuracy FROM ai_model WHERE id=?
20:38:41:776 DEBUG 3812 --- [http-nio-8080-exec-2] c.l.h.mapper.AiModelMapper.selectById    : ==> Parameters: 1(Integer)
20:38:41:807 DEBUG 3812 --- [http-nio-8080-exec-2] c.l.h.mapper.AiModelMapper.selectById    : <==      Total: 1
20:38:41:837 DEBUG 3812 --- [http-nio-8080-exec-2] c.l.api.client.FlaskAiDoctorClient       : [FlaskAiDoctorClient#eye_doctor_chat] ---> POST http://ai-service/api/eye-doctor/chat HTTP/1.1
20:38:41:838 DEBUG 3812 --- [http-nio-8080-exec-2] c.l.api.client.FlaskAiDoctorClient       : [FlaskAiDoctorClient#eye_doctor_chat] Content-Length: 753
20:38:41:838 DEBUG 3812 --- [http-nio-8080-exec-2] c.l.api.client.FlaskAiDoctorClient       : [FlaskAiDoctorClient#eye_doctor_chat] Content-Type: application/json
20:38:41:838 DEBUG 3812 --- [http-nio-8080-exec-2] c.l.api.client.FlaskAiDoctorClient       : [FlaskAiDoctorClient#eye_doctor_chat] 
20:38:41:838 DEBUG 3812 --- [http-nio-8080-exec-2] c.l.api.client.FlaskAiDoctorClient       : [FlaskAiDoctorClient#eye_doctor_chat] {"diagnosis_name":"","diagnosis_category":"","result":"A","remark":"A","treatment_plan":{"id":1,"treatmentType":1,"treatmentDetail":"","startTime":"2025-03-01 09:00:00","endDate":"2025-03-10 09:00:00","doctorId":1,"createdTime":"2025-03-01T09:00:00","updatedTime":"2025-03-01T09:00:00"},"medications":[{"id":1,"diagnosisId":1,"medicationName":"A","dosage":"10mg","frequency":"","sideEffects":"","startTime":"2025-03-01T09:00:00","endTime":"2025-03-10T09:00:00","doctorId":1,"createdTime":"2025-03-01 09:00:00","updatedTime":"2025-03-01 09:00:00"}],"previous_conversations":[{"role":"pariatur tempor do","content":"sit cupidatat commodo"}],"question":"irure eu esse","stream":false}
20:38:41:839 DEBUG 3812 --- [http-nio-8080-exec-2] c.l.api.client.FlaskAiDoctorClient       : [FlaskAiDoctorClient#eye_doctor_chat] ---> END HTTP (753-byte body)
20:38:44:865 DEBUG 3812 --- [http-nio-8080-exec-2] c.l.api.client.FlaskAiDoctorClient       : [FlaskAiDoctorClient#eye_doctor_chat] <--- ERROR ConnectException: Failed to connect to /10.21.93.70:8000 (3026ms)
20:38:44:866 DEBUG 3812 --- [http-nio-8080-exec-2] c.l.api.client.FlaskAiDoctorClient       : [FlaskAiDoctorClient#eye_doctor_chat] java.net.ConnectException: Failed to connect to /10.21.93.70:8000
	at okhttp3.internal.connection.RealConnection.connectSocket(RealConnection.kt:297)
	at okhttp3.internal.connection.RealConnection.connect(RealConnection.kt:207)
	at okhttp3.internal.connection.ExchangeFinder.findConnection(ExchangeFinder.kt:226)
	at okhttp3.internal.connection.ExchangeFinder.findHealthyConnection(ExchangeFinder.kt:106)
	at okhttp3.internal.connection.ExchangeFinder.find(ExchangeFinder.kt:74)
	at okhttp3.internal.connection.RealCall.initExchange$okhttp(RealCall.kt:255)
	at okhttp3.internal.connection.ConnectInterceptor.intercept(ConnectInterceptor.kt:32)
	at okhttp3.internal.http.RealInterceptorChain.proceed(RealInterceptorChain.kt:109)
	at okhttp3.internal.cache.CacheInterceptor.intercept(CacheInterceptor.kt:95)
	at okhttp3.internal.http.RealInterceptorChain.proceed(RealInterceptorChain.kt:109)
	at okhttp3.internal.http.BridgeInterceptor.intercept(BridgeInterceptor.kt:83)
	at okhttp3.internal.http.RealInterceptorChain.proceed(RealInterceptorChain.kt:109)
	at okhttp3.internal.http.RetryAndFollowUpInterceptor.intercept(RetryAndFollowUpInterceptor.kt:76)
	at okhttp3.internal.http.RealInterceptorChain.proceed(RealInterceptorChain.kt:109)
	at okhttp3.internal.connection.RealCall.getResponseWithInterceptorChain$okhttp(RealCall.kt:201)
	at okhttp3.internal.connection.RealCall.execute(RealCall.kt:154)
	at feign.okhttp.OkHttpClient.execute(OkHttpClient.java:180)
	at org.springframework.cloud.openfeign.loadbalancer.LoadBalancerUtils.executeWithLoadBalancerLifecycleProcessing(LoadBalancerUtils.java:57)
	at org.springframework.cloud.openfeign.loadbalancer.LoadBalancerUtils.executeWithLoadBalancerLifecycleProcessing(LoadBalancerUtils.java:95)
	at org.springframework.cloud.openfeign.loadbalancer.FeignBlockingLoadBalancerClient.execute(FeignBlockingLoadBalancerClient.java:114)
	at feign.SynchronousMethodHandler.executeAndDecode(SynchronousMethodHandler.java:121)
	at feign.SynchronousMethodHandler.invoke(SynchronousMethodHandler.java:91)
	at feign.ReflectiveFeign$FeignInvocationHandler.invoke(ReflectiveFeign.java:100)
	at jdk.proxy2/jdk.proxy2.$Proxy138.eye_doctor_chat(Unknown Source)
	at com.luojiawei.his_service.controller.ChatController.ask(ChatController.java:39)
	at java.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at java.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:77)
	at java.base/jdk.internal.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.base/java.lang.reflect.Method.invoke(Method.java:568)
	at org.springframework.web.method.support.InvocableHandlerMethod.doInvoke(InvocableHandlerMethod.java:205)
	at org.springframework.web.method.support.InvocableHandlerMethod.invokeForRequest(InvocableHandlerMethod.java:150)
	at org.springframework.web.servlet.mvc.method.annotation.ServletInvocableHandlerMethod.invokeAndHandle(ServletInvocableHandlerMethod.java:117)
	at org.springframework.web.servlet.mvc.method.annotation.RequestMappingHandlerAdapter.invokeHandlerMethod(RequestMappingHandlerAdapter.java:895)
	at org.springframework.web.servlet.mvc.method.annotation.RequestMappingHandlerAdapter.handleInternal(RequestMappingHandlerAdapter.java:808)
	at org.springframework.web.servlet.mvc.method.AbstractHandlerMethodAdapter.handle(AbstractHandlerMethodAdapter.java:87)
	at org.springframework.web.servlet.DispatcherServlet.doDispatch(DispatcherServlet.java:1072)
	at org.springframework.web.servlet.DispatcherServlet.doService(DispatcherServlet.java:965)
	at org.springframework.web.servlet.FrameworkServlet.processRequest(FrameworkServlet.java:1006)
	at org.springframework.web.servlet.FrameworkServlet.doPost(FrameworkServlet.java:909)
	at javax.servlet.http.HttpServlet.service(HttpServlet.java:555)
	at org.springframework.web.servlet.FrameworkServlet.service(FrameworkServlet.java:883)
	at javax.servlet.http.HttpServlet.service(HttpServlet.java:623)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:209)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:153)
	at com.luojiawei.his_service.filter.RefreshTokenFilter.doFilterInternal(RefreshTokenFilter.java:58)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:117)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:178)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:153)
	at org.springframework.web.filter.RequestContextFilter.doFilterInternal(RequestContextFilter.java:100)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:117)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:178)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:153)
	at org.springframework.web.filter.FormContentFilter.doFilterInternal(FormContentFilter.java:93)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:117)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:178)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:153)
	at org.springframework.boot.actuate.metrics.web.servlet.WebMvcMetricsFilter.doFilterInternal(WebMvcMetricsFilter.java:96)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:117)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:178)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:153)
	at org.springframework.web.filter.CharacterEncodingFilter.doFilterInternal(CharacterEncodingFilter.java:201)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:117)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:178)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:153)
	at org.apache.catalina.core.StandardWrapperValve.invoke(StandardWrapperValve.java:167)
	at org.apache.catalina.core.StandardContextValve.invoke(StandardContextValve.java:90)
	at org.apache.catalina.authenticator.AuthenticatorBase.invoke(AuthenticatorBase.java:481)
	at org.apache.catalina.core.StandardHostValve.invoke(StandardHostValve.java:130)
	at org.apache.catalina.valves.ErrorReportValve.invoke(ErrorReportValve.java:93)
	at org.apache.catalina.core.StandardEngineValve.invoke(StandardEngineValve.java:74)
	at org.apache.catalina.connector.CoyoteAdapter.service(CoyoteAdapter.java:343)
	at org.apache.coyote.http11.Http11Processor.service(Http11Processor.java:390)
	at org.apache.coyote.AbstractProcessorLight.process(AbstractProcessorLight.java:63)
	at org.apache.coyote.AbstractProtocol$ConnectionHandler.process(AbstractProtocol.java:926)
	at org.apache.tomcat.util.net.NioEndpoint$SocketProcessor.doRun(NioEndpoint.java:1791)
	at org.apache.tomcat.util.net.SocketProcessorBase.run(SocketProcessorBase.java:52)
	at org.apache.tomcat.util.threads.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1191)
	at org.apache.tomcat.util.threads.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:659)
	at org.apache.tomcat.util.threads.TaskThread$WrappingRunnable.run(TaskThread.java:61)
	at java.base/java.lang.Thread.run(Thread.java:840)
Caused by: java.net.ConnectException: Connection refused: getsockopt
	at java.base/sun.nio.ch.Net.pollConnect(Native Method)
	at java.base/sun.nio.ch.Net.pollConnectNow(Net.java:672)
	at java.base/sun.nio.ch.NioSocketImpl.timedFinishConnect(NioSocketImpl.java:554)
	at java.base/sun.nio.ch.NioSocketImpl.connect(NioSocketImpl.java:602)
	at java.base/java.net.SocksSocketImpl.connect(SocksSocketImpl.java:327)
	at java.base/java.net.Socket.connect(Socket.java:633)
	at okhttp3.internal.platform.Platform.connectSocket(Platform.kt:128)
	at okhttp3.internal.connection.RealConnection.connectSocket(RealConnection.kt:295)
	... 79 more

20:38:44:867 DEBUG 3812 --- [http-nio-8080-exec-2] c.l.api.client.FlaskAiDoctorClient       : [FlaskAiDoctorClient#eye_doctor_chat] <--- END ERROR
20:38:44:896 ERROR 3812 --- [http-nio-8080-exec-2] o.a.c.c.C.[.[.[/].[dispatcherServlet]    : Servlet.service() for servlet [dispatcherServlet] in context with path [] threw exception [Request processing failed; nested exception is feign.RetryableException: Failed to connect to /10.21.93.70:8000 executing POST http://ai-service/api/eye-doctor/chat] with root cause

java.net.ConnectException: Connection refused: getsockopt
	at java.base/sun.nio.ch.Net.pollConnect(Native Method) ~[na:na]
	at java.base/sun.nio.ch.Net.pollConnectNow(Net.java:672) ~[na:na]
	at java.base/sun.nio.ch.NioSocketImpl.timedFinishConnect(NioSocketImpl.java:554) ~[na:na]
	at java.base/sun.nio.ch.NioSocketImpl.connect(NioSocketImpl.java:602) ~[na:na]
	at java.base/java.net.SocksSocketImpl.connect(SocksSocketImpl.java:327) ~[na:na]
	at java.base/java.net.Socket.connect(Socket.java:633) ~[na:na]
	at okhttp3.internal.platform.Platform.connectSocket(Platform.kt:128) ~[okhttp-4.9.3.jar:na]
	at okhttp3.internal.connection.RealConnection.connectSocket(RealConnection.kt:295) ~[okhttp-4.9.3.jar:na]
	at okhttp3.internal.connection.RealConnection.connect(RealConnection.kt:207) ~[okhttp-4.9.3.jar:na]
	at okhttp3.internal.connection.ExchangeFinder.findConnection(ExchangeFinder.kt:226) ~[okhttp-4.9.3.jar:na]
	at okhttp3.internal.connection.ExchangeFinder.findHealthyConnection(ExchangeFinder.kt:106) ~[okhttp-4.9.3.jar:na]
	at okhttp3.internal.connection.ExchangeFinder.find(ExchangeFinder.kt:74) ~[okhttp-4.9.3.jar:na]
	at okhttp3.internal.connection.RealCall.initExchange$okhttp(RealCall.kt:255) ~[okhttp-4.9.3.jar:na]
	at okhttp3.internal.connection.ConnectInterceptor.intercept(ConnectInterceptor.kt:32) ~[okhttp-4.9.3.jar:na]
	at okhttp3.internal.http.RealInterceptorChain.proceed(RealInterceptorChain.kt:109) ~[okhttp-4.9.3.jar:na]
	at okhttp3.internal.cache.CacheInterceptor.intercept(CacheInterceptor.kt:95) ~[okhttp-4.9.3.jar:na]
	at okhttp3.internal.http.RealInterceptorChain.proceed(RealInterceptorChain.kt:109) ~[okhttp-4.9.3.jar:na]
	at okhttp3.internal.http.BridgeInterceptor.intercept(BridgeInterceptor.kt:83) ~[okhttp-4.9.3.jar:na]
	at okhttp3.internal.http.RealInterceptorChain.proceed(RealInterceptorChain.kt:109) ~[okhttp-4.9.3.jar:na]
	at okhttp3.internal.http.RetryAndFollowUpInterceptor.intercept(RetryAndFollowUpInterceptor.kt:76) ~[okhttp-4.9.3.jar:na]
	at okhttp3.internal.http.RealInterceptorChain.proceed(RealInterceptorChain.kt:109) ~[okhttp-4.9.3.jar:na]
	at okhttp3.internal.connection.RealCall.getResponseWithInterceptorChain$okhttp(RealCall.kt:201) ~[okhttp-4.9.3.jar:na]
	at okhttp3.internal.connection.RealCall.execute(RealCall.kt:154) ~[okhttp-4.9.3.jar:na]
	at feign.okhttp.OkHttpClient.execute(OkHttpClient.java:180) ~[feign-okhttp-11.10.jar:na]
	at org.springframework.cloud.openfeign.loadbalancer.LoadBalancerUtils.executeWithLoadBalancerLifecycleProcessing(LoadBalancerUtils.java:57) ~[spring-cloud-openfeign-core-3.1.5.jar:3.1.5]
	at org.springframework.cloud.openfeign.loadbalancer.LoadBalancerUtils.executeWithLoadBalancerLifecycleProcessing(LoadBalancerUtils.java:95) ~[spring-cloud-openfeign-core-3.1.5.jar:3.1.5]
	at org.springframework.cloud.openfeign.loadbalancer.FeignBlockingLoadBalancerClient.execute(FeignBlockingLoadBalancerClient.java:114) ~[spring-cloud-openfeign-core-3.1.5.jar:3.1.5]
	at feign.SynchronousMethodHandler.executeAndDecode(SynchronousMethodHandler.java:121) ~[feign-core-11.10.jar:na]
	at feign.SynchronousMethodHandler.invoke(SynchronousMethodHandler.java:91) ~[feign-core-11.10.jar:na]
	at feign.ReflectiveFeign$FeignInvocationHandler.invoke(ReflectiveFeign.java:100) ~[feign-core-11.10.jar:na]
	at jdk.proxy2/jdk.proxy2.$Proxy138.eye_doctor_chat(Unknown Source) ~[na:na]
	at com.luojiawei.his_service.controller.ChatController.ask(ChatController.java:39) ~[classes/:na]
	at java.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke0(Native Method) ~[na:na]
	at java.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:77) ~[na:na]
	at java.base/jdk.internal.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43) ~[na:na]
	at java.base/java.lang.reflect.Method.invoke(Method.java:568) ~[na:na]
	at org.springframework.web.method.support.InvocableHandlerMethod.doInvoke(InvocableHandlerMethod.java:205) ~[spring-web-5.3.27.jar:5.3.27]
	at org.springframework.web.method.support.InvocableHandlerMethod.invokeForRequest(InvocableHandlerMethod.java:150) ~[spring-web-5.3.27.jar:5.3.27]
	at org.springframework.web.servlet.mvc.method.annotation.ServletInvocableHandlerMethod.invokeAndHandle(ServletInvocableHandlerMethod.java:117) ~[spring-webmvc-5.3.27.jar:5.3.27]
	at org.springframework.web.servlet.mvc.method.annotation.RequestMappingHandlerAdapter.invokeHandlerMethod(RequestMappingHandlerAdapter.java:895) ~[spring-webmvc-5.3.27.jar:5.3.27]
	at org.springframework.web.servlet.mvc.method.annotation.RequestMappingHandlerAdapter.handleInternal(RequestMappingHandlerAdapter.java:808) ~[spring-webmvc-5.3.27.jar:5.3.27]
	at org.springframework.web.servlet.mvc.method.AbstractHandlerMethodAdapter.handle(AbstractHandlerMethodAdapter.java:87) ~[spring-webmvc-5.3.27.jar:5.3.27]
	at org.springframework.web.servlet.DispatcherServlet.doDispatch(DispatcherServlet.java:1072) ~[spring-webmvc-5.3.27.jar:5.3.27]
	at org.springframework.web.servlet.DispatcherServlet.doService(DispatcherServlet.java:965) ~[spring-webmvc-5.3.27.jar:5.3.27]
	at org.springframework.web.servlet.FrameworkServlet.processRequest(FrameworkServlet.java:1006) ~[spring-webmvc-5.3.27.jar:5.3.27]
	at org.springframework.web.servlet.FrameworkServlet.doPost(FrameworkServlet.java:909) ~[spring-webmvc-5.3.27.jar:5.3.27]
	at javax.servlet.http.HttpServlet.service(HttpServlet.java:555) ~[tomcat-embed-core-9.0.75.jar:4.0.FR]
	at org.springframework.web.servlet.FrameworkServlet.service(FrameworkServlet.java:883) ~[spring-webmvc-5.3.27.jar:5.3.27]
	at javax.servlet.http.HttpServlet.service(HttpServlet.java:623) ~[tomcat-embed-core-9.0.75.jar:4.0.FR]
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:209) ~[tomcat-embed-core-9.0.75.jar:9.0.75]
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:153) ~[tomcat-embed-core-9.0.75.jar:9.0.75]
	at com.luojiawei.his_service.filter.RefreshTokenFilter.doFilterInternal(RefreshTokenFilter.java:58) ~[classes/:na]
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:117) ~[spring-web-5.3.27.jar:5.3.27]
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:178) ~[tomcat-embed-core-9.0.75.jar:9.0.75]
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:153) ~[tomcat-embed-core-9.0.75.jar:9.0.75]
	at org.springframework.web.filter.RequestContextFilter.doFilterInternal(RequestContextFilter.java:100) ~[spring-web-5.3.27.jar:5.3.27]
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:117) ~[spring-web-5.3.27.jar:5.3.27]
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:178) ~[tomcat-embed-core-9.0.75.jar:9.0.75]
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:153) ~[tomcat-embed-core-9.0.75.jar:9.0.75]
	at org.springframework.web.filter.FormContentFilter.doFilterInternal(FormContentFilter.java:93) ~[spring-web-5.3.27.jar:5.3.27]
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:117) ~[spring-web-5.3.27.jar:5.3.27]
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:178) ~[tomcat-embed-core-9.0.75.jar:9.0.75]
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:153) ~[tomcat-embed-core-9.0.75.jar:9.0.75]
	at org.springframework.boot.actuate.metrics.web.servlet.WebMvcMetricsFilter.doFilterInternal(WebMvcMetricsFilter.java:96) ~[spring-boot-actuator-2.7.12.jar:2.7.12]
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:117) ~[spring-web-5.3.27.jar:5.3.27]
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:178) ~[tomcat-embed-core-9.0.75.jar:9.0.75]
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:153) ~[tomcat-embed-core-9.0.75.jar:9.0.75]
	at org.springframework.web.filter.CharacterEncodingFilter.doFilterInternal(CharacterEncodingFilter.java:201) ~[spring-web-5.3.27.jar:5.3.27]
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:117) ~[spring-web-5.3.27.jar:5.3.27]
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:178) ~[tomcat-embed-core-9.0.75.jar:9.0.75]
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:153) ~[tomcat-embed-core-9.0.75.jar:9.0.75]
	at org.apache.catalina.core.StandardWrapperValve.invoke(StandardWrapperValve.java:167) ~[tomcat-embed-core-9.0.75.jar:9.0.75]
	at org.apache.catalina.core.StandardContextValve.invoke(StandardContextValve.java:90) ~[tomcat-embed-core-9.0.75.jar:9.0.75]
	at org.apache.catalina.authenticator.AuthenticatorBase.invoke(AuthenticatorBase.java:481) ~[tomcat-embed-core-9.0.75.jar:9.0.75]
	at org.apache.catalina.core.StandardHostValve.invoke(StandardHostValve.java:130) ~[tomcat-embed-core-9.0.75.jar:9.0.75]
	at org.apache.catalina.valves.ErrorReportValve.invoke(ErrorReportValve.java:93) ~[tomcat-embed-core-9.0.75.jar:9.0.75]
	at org.apache.catalina.core.StandardEngineValve.invoke(StandardEngineValve.java:74) ~[tomcat-embed-core-9.0.75.jar:9.0.75]
	at org.apache.catalina.connector.CoyoteAdapter.service(CoyoteAdapter.java:343) ~[tomcat-embed-core-9.0.75.jar:9.0.75]
	at org.apache.coyote.http11.Http11Processor.service(Http11Processor.java:390) ~[tomcat-embed-core-9.0.75.jar:9.0.75]
	at org.apache.coyote.AbstractProcessorLight.process(AbstractProcessorLight.java:63) ~[tomcat-embed-core-9.0.75.jar:9.0.75]
	at org.apache.coyote.AbstractProtocol$ConnectionHandler.process(AbstractProtocol.java:926) ~[tomcat-embed-core-9.0.75.jar:9.0.75]
	at org.apache.tomcat.util.net.NioEndpoint$SocketProcessor.doRun(NioEndpoint.java:1791) ~[tomcat-embed-core-9.0.75.jar:9.0.75]
	at org.apache.tomcat.util.net.SocketProcessorBase.run(SocketProcessorBase.java:52) ~[tomcat-embed-core-9.0.75.jar:9.0.75]
	at org.apache.tomcat.util.threads.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1191) ~[tomcat-embed-core-9.0.75.jar:9.0.75]
	at org.apache.tomcat.util.threads.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:659) ~[tomcat-embed-core-9.0.75.jar:9.0.75]
	at org.apache.tomcat.util.threads.TaskThread$WrappingRunnable.run(TaskThread.java:61) ~[tomcat-embed-core-9.0.75.jar:9.0.75]
	at java.base/java.lang.Thread.run(Thread.java:840) ~[na:na]

20:42:12:355  WARN 3812 --- [Thread-18] c.a.n.common.http.HttpClientBeanHolder   : [HttpClientBeanHolder] Start destroying common HttpClient
20:42:12:355  WARN 3812 --- [Thread-15] c.a.nacos.common.notify.NotifyCenter     : [NotifyCenter] Start destroying Publisher
20:42:12:359  WARN 3812 --- [Thread-15] c.a.nacos.common.notify.NotifyCenter     : [NotifyCenter] Destruction of the end
20:42:12:363  WARN 3812 --- [Thread-18] c.a.n.common.http.HttpClientBeanHolder   : [HttpClientBeanHolder] Destruction of the end
20:42:12:445  INFO 3812 --- [SpringApplicationShutdownHook] c.a.c.n.registry.NacosServiceRegistry    : De-registering from Nacos Server now...
20:42:12:937  INFO 3812 --- [SpringApplicationShutdownHook] c.a.c.n.registry.NacosServiceRegistry    : De-registration finished.
20:42:13:021  INFO 3812 --- [SpringApplicationShutdownHook] com.zaxxer.hikari.HikariDataSource       : HikariPool-1 - Shutdown initiated...
20:42:13:348  INFO 3812 --- [SpringApplicationShutdownHook] com.zaxxer.hikari.HikariDataSource       : HikariPool-1 - Shutdown completed.
20:42:28:610  INFO 35212 --- [main] c.l.his_service.HisServiceApplication    : Starting HisServiceApplication using Java 17.0.11 on luo with PID 35212 (A:\Desktop\workspace\HIS\his_service\target\classes started by 22407 in A:\Desktop\workspace\HIS)
20:42:28:615 DEBUG 35212 --- [main] c.l.his_service.HisServiceApplication    : Running with Spring Boot v2.7.12, Spring v5.3.27
20:42:28:616  INFO 35212 --- [main] c.l.his_service.HisServiceApplication    : The following 1 profile is active: "dev"
20:42:32:211  INFO 35212 --- [main] .s.d.r.c.RepositoryConfigurationDelegate : Multiple Spring Data modules found, entering strict repository configuration mode
20:42:32:224  INFO 35212 --- [main] .s.d.r.c.RepositoryConfigurationDelegate : Bootstrapping Spring Data Redis repositories in DEFAULT mode.
20:42:32:358  INFO 35212 --- [main] .s.d.r.c.RepositoryConfigurationDelegate : Finished Spring Data repository scanning in 26 ms. Found 0 Redis repository interfaces.
20:42:33:122  INFO 35212 --- [main] o.s.cloud.context.scope.GenericScope     : BeanFactory id=93ec073a-d50a-3e20-8556-fa3097b20012
20:42:35:634  INFO 35212 --- [main] o.s.b.w.embedded.tomcat.TomcatWebServer  : Tomcat initialized with port(s): 8080 (http)
20:42:35:666  INFO 35212 --- [main] o.apache.catalina.core.StandardService   : Starting service [Tomcat]
20:42:35:667  INFO 35212 --- [main] org.apache.catalina.core.StandardEngine  : Starting Servlet engine: [Apache Tomcat/9.0.75]
20:42:35:933  INFO 35212 --- [main] o.a.c.c.C.[Tomcat].[localhost].[/]       : Initializing Spring embedded WebApplicationContext
20:42:35:934  INFO 35212 --- [main] w.s.c.ServletWebServerApplicationContext : Root WebApplicationContext: initialization completed in 7200 ms
20:42:37:025  INFO 35212 --- [main] org.redisson.Version                     : Redisson 3.17.7
20:42:37:984  INFO 35212 --- [redisson-netty-2-9] o.r.c.pool.MasterPubSubConnectionPool    : 1 connections initialized for 111.230.32.147/111.230.32.147:9631
20:42:38:727  INFO 35212 --- [redisson-netty-2-19] o.r.c.pool.MasterConnectionPool          : 24 connections initialized for 111.230.32.147/111.230.32.147:9631
20:42:39:409 DEBUG 35212 --- [main] c.l.h.filter.RefreshTokenFilter          : Filter 'refreshTokenFilter' configured for use
20:42:40:880  INFO 35212 --- [main] o.s.c.openfeign.FeignClientFactoryBean   : For 'flask-service' URL not provided. Will try picking an instance via load-balancing.
20:42:41:426  INFO 35212 --- [main] o.s.c.openfeign.FeignClientFactoryBean   : For 'ai-service' URL not provided. Will try picking an instance via load-balancing.
20:42:41:466  WARN 35212 --- [main] c.b.m.core.metadata.TableInfoHelper      : Can not find table primary key in Class: "java.lang.Object".
20:42:41:466  WARN 35212 --- [main] c.b.m.core.injector.DefaultSqlInjector   : class java.lang.Object ,Not found @TableId annotation, Cannot use Mybatis-Plus 'xxById' Method.
20:42:44:048  WARN 35212 --- [main] iguration$LoadBalancerCaffeineWarnLogger : Spring Cloud LoadBalancer is currently working with the default cache. While this cache implementation is useful for development and tests, it's recommended to use Caffeine cache in production.You can switch to using Caffeine cache, by adding it and org.springframework.cache.caffeine.CaffeineCacheManager to the classpath.
20:42:44:055  INFO 35212 --- [main] o.s.b.a.e.web.EndpointLinksResolver      : Exposing 1 endpoint(s) beneath base path '/actuator'
20:42:44:148  INFO 35212 --- [main] o.s.b.w.embedded.tomcat.TomcatWebServer  : Tomcat started on port(s): 8080 (http) with context path ''
20:42:44:225  INFO 35212 --- [main] c.a.n.p.a.s.c.ClientAuthPluginManager    : [ClientAuthPluginManager] Load ClientAuthService com.alibaba.nacos.client.auth.impl.NacosClientAuthServiceImpl success.
20:42:44:225  INFO 35212 --- [main] c.a.n.p.a.s.c.ClientAuthPluginManager    : [ClientAuthPluginManager] Load ClientAuthService com.alibaba.nacos.client.auth.ram.RamClientAuthServiceImpl success.
20:42:47:302  INFO 35212 --- [main] c.a.n.c.a.AbstractAbilityControlManager  : Ready to get current node abilities...
20:42:47:306  INFO 35212 --- [main] c.a.n.c.a.AbstractAbilityControlManager  : Ready to initialize current node abilities, support modes: [SDK_CLIENT]
20:42:47:307  INFO 35212 --- [main] c.a.n.c.a.AbstractAbilityControlManager  : Initialize current abilities finish...
20:42:47:308  INFO 35212 --- [main] c.a.n.c.a.d.NacosAbilityManagerHolder    : [AbilityControlManager] Successfully initialize AbilityControlManager
20:42:47:862  INFO 35212 --- [main] c.a.c.n.registry.NacosServiceRegistry    : nacos registry, DEFAULT_GROUP his-service 10.21.93.70:8080 register finished
20:42:48:183  INFO 35212 --- [main] c.l.his_service.HisServiceApplication    : Started HisServiceApplication in 21.484 seconds (JVM running for 23.673)
20:42:48:292  INFO 35212 --- [RMI TCP Connection(1)-10.21.93.70] o.a.c.c.C.[Tomcat].[localhost].[/]       : Initializing Spring DispatcherServlet 'dispatcherServlet'
20:42:48:293  INFO 35212 --- [RMI TCP Connection(1)-10.21.93.70] o.s.web.servlet.DispatcherServlet        : Initializing Servlet 'dispatcherServlet'
20:42:48:298  INFO 35212 --- [RMI TCP Connection(1)-10.21.93.70] o.s.web.servlet.DispatcherServlet        : Completed initialization in 5 ms
20:42:48:300  INFO 35212 --- [RMI TCP Connection(2)-10.21.93.70] com.zaxxer.hikari.HikariDataSource       : HikariPool-1 - Starting...
20:42:49:071  INFO 35212 --- [RMI TCP Connection(2)-10.21.93.70] com.zaxxer.hikari.HikariDataSource       : HikariPool-1 - Start completed.
20:43:40:320 DEBUG 35212 --- [http-nio-8080-exec-2] c.l.h.m.D.selectById                     : ==>  Preparing: SELECT id,patient_id,doctor_id,disease_name,disease_category,aimodel_id,result,create_time,status,id_card,name,score,remark FROM diagnosis_report WHERE id=?
20:43:40:347 DEBUG 35212 --- [http-nio-8080-exec-2] c.l.h.m.D.selectById                     : ==> Parameters: 1(Integer)
20:43:40:429 DEBUG 35212 --- [http-nio-8080-exec-2] c.l.h.m.D.selectById                     : <==      Total: 1
20:43:40:431 DEBUG 35212 --- [http-nio-8080-exec-2] c.l.h.mapper.PatientMapper.selectById    : ==>  Preparing: SELECT id,phone,id_card,name,verified,verified_by,verified_time,open_id,hospital_pid FROM patient WHERE id=?
20:43:40:432 DEBUG 35212 --- [http-nio-8080-exec-2] c.l.h.mapper.PatientMapper.selectById    : ==> Parameters: 1(Integer)
20:43:40:464 DEBUG 35212 --- [http-nio-8080-exec-2] c.l.h.mapper.PatientMapper.selectById    : <==      Total: 1
20:43:40:468 DEBUG 35212 --- [http-nio-8080-exec-2] c.l.h.mapper.DoctorMapper.selectById     : ==>  Preparing: SELECT id,phone,id_card,name,verified,verified_by,verified_time,license,department,hospital_pid FROM doctor WHERE id=?
20:43:40:469 DEBUG 35212 --- [http-nio-8080-exec-2] c.l.h.mapper.DoctorMapper.selectById     : ==> Parameters: 1(Integer)
20:43:40:502 DEBUG 35212 --- [http-nio-8080-exec-2] c.l.h.mapper.DoctorMapper.selectById     : <==      Total: 1
20:43:40:507 DEBUG 35212 --- [http-nio-8080-exec-2] c.l.h.m.E.selectListByDiagnosisId        : ==>  Preparing: select * from eye_images where dignosis_report_id = ?
20:43:40:507 DEBUG 35212 --- [http-nio-8080-exec-2] c.l.h.m.E.selectListByDiagnosisId        : ==> Parameters: 1(Integer)
20:43:40:540 DEBUG 35212 --- [http-nio-8080-exec-2] c.l.h.m.E.selectListByDiagnosisId        : <==      Total: 1
20:43:40:541 DEBUG 35212 --- [http-nio-8080-exec-2] c.l.h.m.T.selectByDiagnosisId            : ==>  Preparing: select * from treatment_plans where diagnosis_id = ?
20:43:40:541 DEBUG 35212 --- [http-nio-8080-exec-2] c.l.h.m.T.selectByDiagnosisId            : ==> Parameters: 1(Integer)
20:43:40:575 DEBUG 35212 --- [http-nio-8080-exec-2] c.l.h.m.T.selectByDiagnosisId            : <==      Total: 1
20:43:40:576 DEBUG 35212 --- [http-nio-8080-exec-2] c.l.h.m.M.selectByDiagnosisId            : ==>  Preparing: select * from medication_recommendations where diagnosis_id = ?
20:43:40:576 DEBUG 35212 --- [http-nio-8080-exec-2] c.l.h.m.M.selectByDiagnosisId            : ==> Parameters: 1(Integer)
20:43:40:612 DEBUG 35212 --- [http-nio-8080-exec-2] c.l.h.m.M.selectByDiagnosisId            : <==      Total: 1
20:43:40:613 DEBUG 35212 --- [http-nio-8080-exec-2] c.l.h.mapper.AiModelMapper.selectById    : ==>  Preparing: SELECT id,version,deploy_time,accuracy FROM ai_model WHERE id=?
20:43:40:613 DEBUG 35212 --- [http-nio-8080-exec-2] c.l.h.mapper.AiModelMapper.selectById    : ==> Parameters: 1(Integer)
20:43:40:645 DEBUG 35212 --- [http-nio-8080-exec-2] c.l.h.mapper.AiModelMapper.selectById    : <==      Total: 1
20:43:40:673 DEBUG 35212 --- [http-nio-8080-exec-2] c.l.api.client.FlaskAiDoctorClient       : [FlaskAiDoctorClient#eye_doctor_chat] ---> POST http://ai-service/api/eye-doctor/chat HTTP/1.1
20:43:40:673 DEBUG 35212 --- [http-nio-8080-exec-2] c.l.api.client.FlaskAiDoctorClient       : [FlaskAiDoctorClient#eye_doctor_chat] Content-Length: 753
20:43:40:673 DEBUG 35212 --- [http-nio-8080-exec-2] c.l.api.client.FlaskAiDoctorClient       : [FlaskAiDoctorClient#eye_doctor_chat] Content-Type: application/json
20:43:40:673 DEBUG 35212 --- [http-nio-8080-exec-2] c.l.api.client.FlaskAiDoctorClient       : [FlaskAiDoctorClient#eye_doctor_chat] 
20:43:40:673 DEBUG 35212 --- [http-nio-8080-exec-2] c.l.api.client.FlaskAiDoctorClient       : [FlaskAiDoctorClient#eye_doctor_chat] {"diagnosis_name":"","diagnosis_category":"","result":"A","remark":"A","treatment_plan":{"id":1,"treatmentType":1,"treatmentDetail":"","startTime":"2025-03-01 09:00:00","endDate":"2025-03-10 09:00:00","doctorId":1,"createdTime":"2025-03-01T09:00:00","updatedTime":"2025-03-01T09:00:00"},"medications":[{"id":1,"diagnosisId":1,"medicationName":"A","dosage":"10mg","frequency":"","sideEffects":"","startTime":"2025-03-01T09:00:00","endTime":"2025-03-10T09:00:00","doctorId":1,"createdTime":"2025-03-01 09:00:00","updatedTime":"2025-03-01 09:00:00"}],"previous_conversations":[{"role":"pariatur tempor do","content":"sit cupidatat commodo"}],"question":"irure eu esse","stream":false}
20:43:40:677 DEBUG 35212 --- [http-nio-8080-exec-2] c.l.api.client.FlaskAiDoctorClient       : [FlaskAiDoctorClient#eye_doctor_chat] ---> END HTTP (753-byte body)
20:43:43:461 DEBUG 35212 --- [http-nio-8080-exec-2] c.l.api.client.FlaskAiDoctorClient       : [FlaskAiDoctorClient#eye_doctor_chat] <--- ERROR ConnectException: Failed to connect to /10.21.93.70:8000 (2784ms)
20:43:43:462 DEBUG 35212 --- [http-nio-8080-exec-2] c.l.api.client.FlaskAiDoctorClient       : [FlaskAiDoctorClient#eye_doctor_chat] java.net.ConnectException: Failed to connect to /10.21.93.70:8000
	at okhttp3.internal.connection.RealConnection.connectSocket(RealConnection.kt:297)
	at okhttp3.internal.connection.RealConnection.connect(RealConnection.kt:207)
	at okhttp3.internal.connection.ExchangeFinder.findConnection(ExchangeFinder.kt:226)
	at okhttp3.internal.connection.ExchangeFinder.findHealthyConnection(ExchangeFinder.kt:106)
	at okhttp3.internal.connection.ExchangeFinder.find(ExchangeFinder.kt:74)
	at okhttp3.internal.connection.RealCall.initExchange$okhttp(RealCall.kt:255)
	at okhttp3.internal.connection.ConnectInterceptor.intercept(ConnectInterceptor.kt:32)
	at okhttp3.internal.http.RealInterceptorChain.proceed(RealInterceptorChain.kt:109)
	at okhttp3.internal.cache.CacheInterceptor.intercept(CacheInterceptor.kt:95)
	at okhttp3.internal.http.RealInterceptorChain.proceed(RealInterceptorChain.kt:109)
	at okhttp3.internal.http.BridgeInterceptor.intercept(BridgeInterceptor.kt:83)
	at okhttp3.internal.http.RealInterceptorChain.proceed(RealInterceptorChain.kt:109)
	at okhttp3.internal.http.RetryAndFollowUpInterceptor.intercept(RetryAndFollowUpInterceptor.kt:76)
	at okhttp3.internal.http.RealInterceptorChain.proceed(RealInterceptorChain.kt:109)
	at okhttp3.internal.connection.RealCall.getResponseWithInterceptorChain$okhttp(RealCall.kt:201)
	at okhttp3.internal.connection.RealCall.execute(RealCall.kt:154)
	at feign.okhttp.OkHttpClient.execute(OkHttpClient.java:180)
	at org.springframework.cloud.openfeign.loadbalancer.LoadBalancerUtils.executeWithLoadBalancerLifecycleProcessing(LoadBalancerUtils.java:57)
	at org.springframework.cloud.openfeign.loadbalancer.LoadBalancerUtils.executeWithLoadBalancerLifecycleProcessing(LoadBalancerUtils.java:95)
	at org.springframework.cloud.openfeign.loadbalancer.FeignBlockingLoadBalancerClient.execute(FeignBlockingLoadBalancerClient.java:114)
	at feign.SynchronousMethodHandler.executeAndDecode(SynchronousMethodHandler.java:121)
	at feign.SynchronousMethodHandler.invoke(SynchronousMethodHandler.java:91)
	at feign.ReflectiveFeign$FeignInvocationHandler.invoke(ReflectiveFeign.java:100)
	at jdk.proxy2/jdk.proxy2.$Proxy138.eye_doctor_chat(Unknown Source)
	at com.luojiawei.his_service.controller.ChatController.ask(ChatController.java:39)
	at java.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at java.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:77)
	at java.base/jdk.internal.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.base/java.lang.reflect.Method.invoke(Method.java:568)
	at org.springframework.web.method.support.InvocableHandlerMethod.doInvoke(InvocableHandlerMethod.java:205)
	at org.springframework.web.method.support.InvocableHandlerMethod.invokeForRequest(InvocableHandlerMethod.java:150)
	at org.springframework.web.servlet.mvc.method.annotation.ServletInvocableHandlerMethod.invokeAndHandle(ServletInvocableHandlerMethod.java:117)
	at org.springframework.web.servlet.mvc.method.annotation.RequestMappingHandlerAdapter.invokeHandlerMethod(RequestMappingHandlerAdapter.java:895)
	at org.springframework.web.servlet.mvc.method.annotation.RequestMappingHandlerAdapter.handleInternal(RequestMappingHandlerAdapter.java:808)
	at org.springframework.web.servlet.mvc.method.AbstractHandlerMethodAdapter.handle(AbstractHandlerMethodAdapter.java:87)
	at org.springframework.web.servlet.DispatcherServlet.doDispatch(DispatcherServlet.java:1072)
	at org.springframework.web.servlet.DispatcherServlet.doService(DispatcherServlet.java:965)
	at org.springframework.web.servlet.FrameworkServlet.processRequest(FrameworkServlet.java:1006)
	at org.springframework.web.servlet.FrameworkServlet.doPost(FrameworkServlet.java:909)
	at javax.servlet.http.HttpServlet.service(HttpServlet.java:555)
	at org.springframework.web.servlet.FrameworkServlet.service(FrameworkServlet.java:883)
	at javax.servlet.http.HttpServlet.service(HttpServlet.java:623)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:209)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:153)
	at com.luojiawei.his_service.filter.RefreshTokenFilter.doFilterInternal(RefreshTokenFilter.java:58)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:117)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:178)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:153)
	at org.springframework.web.filter.RequestContextFilter.doFilterInternal(RequestContextFilter.java:100)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:117)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:178)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:153)
	at org.springframework.web.filter.FormContentFilter.doFilterInternal(FormContentFilter.java:93)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:117)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:178)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:153)
	at org.springframework.boot.actuate.metrics.web.servlet.WebMvcMetricsFilter.doFilterInternal(WebMvcMetricsFilter.java:96)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:117)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:178)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:153)
	at org.springframework.web.filter.CharacterEncodingFilter.doFilterInternal(CharacterEncodingFilter.java:201)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:117)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:178)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:153)
	at org.apache.catalina.core.StandardWrapperValve.invoke(StandardWrapperValve.java:167)
	at org.apache.catalina.core.StandardContextValve.invoke(StandardContextValve.java:90)
	at org.apache.catalina.authenticator.AuthenticatorBase.invoke(AuthenticatorBase.java:481)
	at org.apache.catalina.core.StandardHostValve.invoke(StandardHostValve.java:130)
	at org.apache.catalina.valves.ErrorReportValve.invoke(ErrorReportValve.java:93)
	at org.apache.catalina.core.StandardEngineValve.invoke(StandardEngineValve.java:74)
	at org.apache.catalina.connector.CoyoteAdapter.service(CoyoteAdapter.java:343)
	at org.apache.coyote.http11.Http11Processor.service(Http11Processor.java:390)
	at org.apache.coyote.AbstractProcessorLight.process(AbstractProcessorLight.java:63)
	at org.apache.coyote.AbstractProtocol$ConnectionHandler.process(AbstractProtocol.java:926)
	at org.apache.tomcat.util.net.NioEndpoint$SocketProcessor.doRun(NioEndpoint.java:1791)
	at org.apache.tomcat.util.net.SocketProcessorBase.run(SocketProcessorBase.java:52)
	at org.apache.tomcat.util.threads.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1191)
	at org.apache.tomcat.util.threads.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:659)
	at org.apache.tomcat.util.threads.TaskThread$WrappingRunnable.run(TaskThread.java:61)
	at java.base/java.lang.Thread.run(Thread.java:840)
Caused by: java.net.ConnectException: Connection refused: getsockopt
	at java.base/sun.nio.ch.Net.pollConnect(Native Method)
	at java.base/sun.nio.ch.Net.pollConnectNow(Net.java:672)
	at java.base/sun.nio.ch.NioSocketImpl.timedFinishConnect(NioSocketImpl.java:554)
	at java.base/sun.nio.ch.NioSocketImpl.connect(NioSocketImpl.java:602)
	at java.base/java.net.SocksSocketImpl.connect(SocksSocketImpl.java:327)
	at java.base/java.net.Socket.connect(Socket.java:633)
	at okhttp3.internal.platform.Platform.connectSocket(Platform.kt:128)
	at okhttp3.internal.connection.RealConnection.connectSocket(RealConnection.kt:295)
	... 79 more

20:43:43:462 DEBUG 35212 --- [http-nio-8080-exec-2] c.l.api.client.FlaskAiDoctorClient       : [FlaskAiDoctorClient#eye_doctor_chat] <--- END ERROR
20:43:43:487 ERROR 35212 --- [http-nio-8080-exec-2] o.a.c.c.C.[.[.[/].[dispatcherServlet]    : Servlet.service() for servlet [dispatcherServlet] in context with path [] threw exception [Request processing failed; nested exception is feign.RetryableException: Failed to connect to /10.21.93.70:8000 executing POST http://ai-service/api/eye-doctor/chat] with root cause

java.net.ConnectException: Connection refused: getsockopt
	at java.base/sun.nio.ch.Net.pollConnect(Native Method) ~[na:na]
	at java.base/sun.nio.ch.Net.pollConnectNow(Net.java:672) ~[na:na]
	at java.base/sun.nio.ch.NioSocketImpl.timedFinishConnect(NioSocketImpl.java:554) ~[na:na]
	at java.base/sun.nio.ch.NioSocketImpl.connect(NioSocketImpl.java:602) ~[na:na]
	at java.base/java.net.SocksSocketImpl.connect(SocksSocketImpl.java:327) ~[na:na]
	at java.base/java.net.Socket.connect(Socket.java:633) ~[na:na]
	at okhttp3.internal.platform.Platform.connectSocket(Platform.kt:128) ~[okhttp-4.9.3.jar:na]
	at okhttp3.internal.connection.RealConnection.connectSocket(RealConnection.kt:295) ~[okhttp-4.9.3.jar:na]
	at okhttp3.internal.connection.RealConnection.connect(RealConnection.kt:207) ~[okhttp-4.9.3.jar:na]
	at okhttp3.internal.connection.ExchangeFinder.findConnection(ExchangeFinder.kt:226) ~[okhttp-4.9.3.jar:na]
	at okhttp3.internal.connection.ExchangeFinder.findHealthyConnection(ExchangeFinder.kt:106) ~[okhttp-4.9.3.jar:na]
	at okhttp3.internal.connection.ExchangeFinder.find(ExchangeFinder.kt:74) ~[okhttp-4.9.3.jar:na]
	at okhttp3.internal.connection.RealCall.initExchange$okhttp(RealCall.kt:255) ~[okhttp-4.9.3.jar:na]
	at okhttp3.internal.connection.ConnectInterceptor.intercept(ConnectInterceptor.kt:32) ~[okhttp-4.9.3.jar:na]
	at okhttp3.internal.http.RealInterceptorChain.proceed(RealInterceptorChain.kt:109) ~[okhttp-4.9.3.jar:na]
	at okhttp3.internal.cache.CacheInterceptor.intercept(CacheInterceptor.kt:95) ~[okhttp-4.9.3.jar:na]
	at okhttp3.internal.http.RealInterceptorChain.proceed(RealInterceptorChain.kt:109) ~[okhttp-4.9.3.jar:na]
	at okhttp3.internal.http.BridgeInterceptor.intercept(BridgeInterceptor.kt:83) ~[okhttp-4.9.3.jar:na]
	at okhttp3.internal.http.RealInterceptorChain.proceed(RealInterceptorChain.kt:109) ~[okhttp-4.9.3.jar:na]
	at okhttp3.internal.http.RetryAndFollowUpInterceptor.intercept(RetryAndFollowUpInterceptor.kt:76) ~[okhttp-4.9.3.jar:na]
	at okhttp3.internal.http.RealInterceptorChain.proceed(RealInterceptorChain.kt:109) ~[okhttp-4.9.3.jar:na]
	at okhttp3.internal.connection.RealCall.getResponseWithInterceptorChain$okhttp(RealCall.kt:201) ~[okhttp-4.9.3.jar:na]
	at okhttp3.internal.connection.RealCall.execute(RealCall.kt:154) ~[okhttp-4.9.3.jar:na]
	at feign.okhttp.OkHttpClient.execute(OkHttpClient.java:180) ~[feign-okhttp-11.10.jar:na]
	at org.springframework.cloud.openfeign.loadbalancer.LoadBalancerUtils.executeWithLoadBalancerLifecycleProcessing(LoadBalancerUtils.java:57) ~[spring-cloud-openfeign-core-3.1.5.jar:3.1.5]
	at org.springframework.cloud.openfeign.loadbalancer.LoadBalancerUtils.executeWithLoadBalancerLifecycleProcessing(LoadBalancerUtils.java:95) ~[spring-cloud-openfeign-core-3.1.5.jar:3.1.5]
	at org.springframework.cloud.openfeign.loadbalancer.FeignBlockingLoadBalancerClient.execute(FeignBlockingLoadBalancerClient.java:114) ~[spring-cloud-openfeign-core-3.1.5.jar:3.1.5]
	at feign.SynchronousMethodHandler.executeAndDecode(SynchronousMethodHandler.java:121) ~[feign-core-11.10.jar:na]
	at feign.SynchronousMethodHandler.invoke(SynchronousMethodHandler.java:91) ~[feign-core-11.10.jar:na]
	at feign.ReflectiveFeign$FeignInvocationHandler.invoke(ReflectiveFeign.java:100) ~[feign-core-11.10.jar:na]
	at jdk.proxy2/jdk.proxy2.$Proxy138.eye_doctor_chat(Unknown Source) ~[na:na]
	at com.luojiawei.his_service.controller.ChatController.ask(ChatController.java:39) ~[classes/:na]
	at java.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke0(Native Method) ~[na:na]
	at java.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:77) ~[na:na]
	at java.base/jdk.internal.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43) ~[na:na]
	at java.base/java.lang.reflect.Method.invoke(Method.java:568) ~[na:na]
	at org.springframework.web.method.support.InvocableHandlerMethod.doInvoke(InvocableHandlerMethod.java:205) ~[spring-web-5.3.27.jar:5.3.27]
	at org.springframework.web.method.support.InvocableHandlerMethod.invokeForRequest(InvocableHandlerMethod.java:150) ~[spring-web-5.3.27.jar:5.3.27]
	at org.springframework.web.servlet.mvc.method.annotation.ServletInvocableHandlerMethod.invokeAndHandle(ServletInvocableHandlerMethod.java:117) ~[spring-webmvc-5.3.27.jar:5.3.27]
	at org.springframework.web.servlet.mvc.method.annotation.RequestMappingHandlerAdapter.invokeHandlerMethod(RequestMappingHandlerAdapter.java:895) ~[spring-webmvc-5.3.27.jar:5.3.27]
	at org.springframework.web.servlet.mvc.method.annotation.RequestMappingHandlerAdapter.handleInternal(RequestMappingHandlerAdapter.java:808) ~[spring-webmvc-5.3.27.jar:5.3.27]
	at org.springframework.web.servlet.mvc.method.AbstractHandlerMethodAdapter.handle(AbstractHandlerMethodAdapter.java:87) ~[spring-webmvc-5.3.27.jar:5.3.27]
	at org.springframework.web.servlet.DispatcherServlet.doDispatch(DispatcherServlet.java:1072) ~[spring-webmvc-5.3.27.jar:5.3.27]
	at org.springframework.web.servlet.DispatcherServlet.doService(DispatcherServlet.java:965) ~[spring-webmvc-5.3.27.jar:5.3.27]
	at org.springframework.web.servlet.FrameworkServlet.processRequest(FrameworkServlet.java:1006) ~[spring-webmvc-5.3.27.jar:5.3.27]
	at org.springframework.web.servlet.FrameworkServlet.doPost(FrameworkServlet.java:909) ~[spring-webmvc-5.3.27.jar:5.3.27]
	at javax.servlet.http.HttpServlet.service(HttpServlet.java:555) ~[tomcat-embed-core-9.0.75.jar:4.0.FR]
	at org.springframework.web.servlet.FrameworkServlet.service(FrameworkServlet.java:883) ~[spring-webmvc-5.3.27.jar:5.3.27]
	at javax.servlet.http.HttpServlet.service(HttpServlet.java:623) ~[tomcat-embed-core-9.0.75.jar:4.0.FR]
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:209) ~[tomcat-embed-core-9.0.75.jar:9.0.75]
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:153) ~[tomcat-embed-core-9.0.75.jar:9.0.75]
	at com.luojiawei.his_service.filter.RefreshTokenFilter.doFilterInternal(RefreshTokenFilter.java:58) ~[classes/:na]
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:117) ~[spring-web-5.3.27.jar:5.3.27]
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:178) ~[tomcat-embed-core-9.0.75.jar:9.0.75]
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:153) ~[tomcat-embed-core-9.0.75.jar:9.0.75]
	at org.springframework.web.filter.RequestContextFilter.doFilterInternal(RequestContextFilter.java:100) ~[spring-web-5.3.27.jar:5.3.27]
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:117) ~[spring-web-5.3.27.jar:5.3.27]
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:178) ~[tomcat-embed-core-9.0.75.jar:9.0.75]
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:153) ~[tomcat-embed-core-9.0.75.jar:9.0.75]
	at org.springframework.web.filter.FormContentFilter.doFilterInternal(FormContentFilter.java:93) ~[spring-web-5.3.27.jar:5.3.27]
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:117) ~[spring-web-5.3.27.jar:5.3.27]
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:178) ~[tomcat-embed-core-9.0.75.jar:9.0.75]
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:153) ~[tomcat-embed-core-9.0.75.jar:9.0.75]
	at org.springframework.boot.actuate.metrics.web.servlet.WebMvcMetricsFilter.doFilterInternal(WebMvcMetricsFilter.java:96) ~[spring-boot-actuator-2.7.12.jar:2.7.12]
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:117) ~[spring-web-5.3.27.jar:5.3.27]
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:178) ~[tomcat-embed-core-9.0.75.jar:9.0.75]
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:153) ~[tomcat-embed-core-9.0.75.jar:9.0.75]
	at org.springframework.web.filter.CharacterEncodingFilter.doFilterInternal(CharacterEncodingFilter.java:201) ~[spring-web-5.3.27.jar:5.3.27]
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:117) ~[spring-web-5.3.27.jar:5.3.27]
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:178) ~[tomcat-embed-core-9.0.75.jar:9.0.75]
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:153) ~[tomcat-embed-core-9.0.75.jar:9.0.75]
	at org.apache.catalina.core.StandardWrapperValve.invoke(StandardWrapperValve.java:167) ~[tomcat-embed-core-9.0.75.jar:9.0.75]
	at org.apache.catalina.core.StandardContextValve.invoke(StandardContextValve.java:90) ~[tomcat-embed-core-9.0.75.jar:9.0.75]
	at org.apache.catalina.authenticator.AuthenticatorBase.invoke(AuthenticatorBase.java:481) ~[tomcat-embed-core-9.0.75.jar:9.0.75]
	at org.apache.catalina.core.StandardHostValve.invoke(StandardHostValve.java:130) ~[tomcat-embed-core-9.0.75.jar:9.0.75]
	at org.apache.catalina.valves.ErrorReportValve.invoke(ErrorReportValve.java:93) ~[tomcat-embed-core-9.0.75.jar:9.0.75]
	at org.apache.catalina.core.StandardEngineValve.invoke(StandardEngineValve.java:74) ~[tomcat-embed-core-9.0.75.jar:9.0.75]
	at org.apache.catalina.connector.CoyoteAdapter.service(CoyoteAdapter.java:343) ~[tomcat-embed-core-9.0.75.jar:9.0.75]
	at org.apache.coyote.http11.Http11Processor.service(Http11Processor.java:390) ~[tomcat-embed-core-9.0.75.jar:9.0.75]
	at org.apache.coyote.AbstractProcessorLight.process(AbstractProcessorLight.java:63) ~[tomcat-embed-core-9.0.75.jar:9.0.75]
	at org.apache.coyote.AbstractProtocol$ConnectionHandler.process(AbstractProtocol.java:926) ~[tomcat-embed-core-9.0.75.jar:9.0.75]
	at org.apache.tomcat.util.net.NioEndpoint$SocketProcessor.doRun(NioEndpoint.java:1791) ~[tomcat-embed-core-9.0.75.jar:9.0.75]
	at org.apache.tomcat.util.net.SocketProcessorBase.run(SocketProcessorBase.java:52) ~[tomcat-embed-core-9.0.75.jar:9.0.75]
	at org.apache.tomcat.util.threads.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1191) ~[tomcat-embed-core-9.0.75.jar:9.0.75]
	at org.apache.tomcat.util.threads.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:659) ~[tomcat-embed-core-9.0.75.jar:9.0.75]
	at org.apache.tomcat.util.threads.TaskThread$WrappingRunnable.run(TaskThread.java:61) ~[tomcat-embed-core-9.0.75.jar:9.0.75]
	at java.base/java.lang.Thread.run(Thread.java:840) ~[na:na]

20:49:11:820 DEBUG 35212 --- [http-nio-8080-exec-5] c.l.h.m.D.selectById                     : ==>  Preparing: SELECT id,patient_id,doctor_id,disease_name,disease_category,aimodel_id,result,create_time,status,id_card,name,score,remark FROM diagnosis_report WHERE id=?
20:49:11:823 DEBUG 35212 --- [http-nio-8080-exec-5] c.l.h.m.D.selectById                     : ==> Parameters: 1(Integer)
20:49:11:860 DEBUG 35212 --- [http-nio-8080-exec-5] c.l.h.m.D.selectById                     : <==      Total: 1
20:49:11:861 DEBUG 35212 --- [http-nio-8080-exec-5] c.l.h.mapper.PatientMapper.selectById    : ==>  Preparing: SELECT id,phone,id_card,name,verified,verified_by,verified_time,open_id,hospital_pid FROM patient WHERE id=?
20:49:11:861 DEBUG 35212 --- [http-nio-8080-exec-5] c.l.h.mapper.PatientMapper.selectById    : ==> Parameters: 1(Integer)
20:49:11:894 DEBUG 35212 --- [http-nio-8080-exec-5] c.l.h.mapper.PatientMapper.selectById    : <==      Total: 1
20:49:11:894 DEBUG 35212 --- [http-nio-8080-exec-5] c.l.h.mapper.DoctorMapper.selectById     : ==>  Preparing: SELECT id,phone,id_card,name,verified,verified_by,verified_time,license,department,hospital_pid FROM doctor WHERE id=?
20:49:11:895 DEBUG 35212 --- [http-nio-8080-exec-5] c.l.h.mapper.DoctorMapper.selectById     : ==> Parameters: 1(Integer)
20:49:11:928 DEBUG 35212 --- [http-nio-8080-exec-5] c.l.h.mapper.DoctorMapper.selectById     : <==      Total: 1
20:49:11:928 DEBUG 35212 --- [http-nio-8080-exec-5] c.l.h.m.E.selectListByDiagnosisId        : ==>  Preparing: select * from eye_images where dignosis_report_id = ?
20:49:11:928 DEBUG 35212 --- [http-nio-8080-exec-5] c.l.h.m.E.selectListByDiagnosisId        : ==> Parameters: 1(Integer)
20:49:11:968 DEBUG 35212 --- [http-nio-8080-exec-5] c.l.h.m.E.selectListByDiagnosisId        : <==      Total: 1
20:49:11:968 DEBUG 35212 --- [http-nio-8080-exec-5] c.l.h.m.T.selectByDiagnosisId            : ==>  Preparing: select * from treatment_plans where diagnosis_id = ?
20:49:11:968 DEBUG 35212 --- [http-nio-8080-exec-5] c.l.h.m.T.selectByDiagnosisId            : ==> Parameters: 1(Integer)
20:49:12:004 DEBUG 35212 --- [http-nio-8080-exec-5] c.l.h.m.T.selectByDiagnosisId            : <==      Total: 1
20:49:12:005 DEBUG 35212 --- [http-nio-8080-exec-5] c.l.h.m.M.selectByDiagnosisId            : ==>  Preparing: select * from medication_recommendations where diagnosis_id = ?
20:49:12:006 DEBUG 35212 --- [http-nio-8080-exec-5] c.l.h.m.M.selectByDiagnosisId            : ==> Parameters: 1(Integer)
20:49:12:038 DEBUG 35212 --- [http-nio-8080-exec-5] c.l.h.m.M.selectByDiagnosisId            : <==      Total: 1
20:49:12:039 DEBUG 35212 --- [http-nio-8080-exec-5] c.l.h.mapper.AiModelMapper.selectById    : ==>  Preparing: SELECT id,version,deploy_time,accuracy FROM ai_model WHERE id=?
20:49:12:040 DEBUG 35212 --- [http-nio-8080-exec-5] c.l.h.mapper.AiModelMapper.selectById    : ==> Parameters: 1(Integer)
20:49:12:071 DEBUG 35212 --- [http-nio-8080-exec-5] c.l.h.mapper.AiModelMapper.selectById    : <==      Total: 1
20:49:12:077 DEBUG 35212 --- [http-nio-8080-exec-5] c.l.api.client.FlaskAiDoctorClient       : [FlaskAiDoctorClient#eye_doctor_chat] ---> POST http://ai-service/api/eye-doctor/chat HTTP/1.1
20:49:12:078 DEBUG 35212 --- [http-nio-8080-exec-5] c.l.api.client.FlaskAiDoctorClient       : [FlaskAiDoctorClient#eye_doctor_chat] Content-Length: 753
20:49:12:078 DEBUG 35212 --- [http-nio-8080-exec-5] c.l.api.client.FlaskAiDoctorClient       : [FlaskAiDoctorClient#eye_doctor_chat] Content-Type: application/json
20:49:12:078 DEBUG 35212 --- [http-nio-8080-exec-5] c.l.api.client.FlaskAiDoctorClient       : [FlaskAiDoctorClient#eye_doctor_chat] 
20:49:12:078 DEBUG 35212 --- [http-nio-8080-exec-5] c.l.api.client.FlaskAiDoctorClient       : [FlaskAiDoctorClient#eye_doctor_chat] {"diagnosis_name":"","diagnosis_category":"","result":"A","remark":"A","treatment_plan":{"id":1,"treatmentType":1,"treatmentDetail":"","startTime":"2025-03-01 09:00:00","endDate":"2025-03-10 09:00:00","doctorId":1,"createdTime":"2025-03-01T09:00:00","updatedTime":"2025-03-01T09:00:00"},"medications":[{"id":1,"diagnosisId":1,"medicationName":"A","dosage":"10mg","frequency":"","sideEffects":"","startTime":"2025-03-01T09:00:00","endTime":"2025-03-10T09:00:00","doctorId":1,"createdTime":"2025-03-01 09:00:00","updatedTime":"2025-03-01 09:00:00"}],"previous_conversations":[{"role":"pariatur tempor do","content":"sit cupidatat commodo"}],"question":"irure eu esse","stream":false}
20:49:12:078 DEBUG 35212 --- [http-nio-8080-exec-5] c.l.api.client.FlaskAiDoctorClient       : [FlaskAiDoctorClient#eye_doctor_chat] ---> END HTTP (753-byte body)
20:49:14:132 DEBUG 35212 --- [http-nio-8080-exec-5] c.l.api.client.FlaskAiDoctorClient       : [FlaskAiDoctorClient#eye_doctor_chat] <--- ERROR ConnectException: Failed to connect to /10.21.93.70:8000 (2052ms)
20:49:14:133 DEBUG 35212 --- [http-nio-8080-exec-5] c.l.api.client.FlaskAiDoctorClient       : [FlaskAiDoctorClient#eye_doctor_chat] java.net.ConnectException: Failed to connect to /10.21.93.70:8000
	at okhttp3.internal.connection.RealConnection.connectSocket(RealConnection.kt:297)
	at okhttp3.internal.connection.RealConnection.connect(RealConnection.kt:207)
	at okhttp3.internal.connection.ExchangeFinder.findConnection(ExchangeFinder.kt:226)
	at okhttp3.internal.connection.ExchangeFinder.findHealthyConnection(ExchangeFinder.kt:106)
	at okhttp3.internal.connection.ExchangeFinder.find(ExchangeFinder.kt:74)
	at okhttp3.internal.connection.RealCall.initExchange$okhttp(RealCall.kt:255)
	at okhttp3.internal.connection.ConnectInterceptor.intercept(ConnectInterceptor.kt:32)
	at okhttp3.internal.http.RealInterceptorChain.proceed(RealInterceptorChain.kt:109)
	at okhttp3.internal.cache.CacheInterceptor.intercept(CacheInterceptor.kt:95)
	at okhttp3.internal.http.RealInterceptorChain.proceed(RealInterceptorChain.kt:109)
	at okhttp3.internal.http.BridgeInterceptor.intercept(BridgeInterceptor.kt:83)
	at okhttp3.internal.http.RealInterceptorChain.proceed(RealInterceptorChain.kt:109)
	at okhttp3.internal.http.RetryAndFollowUpInterceptor.intercept(RetryAndFollowUpInterceptor.kt:76)
	at okhttp3.internal.http.RealInterceptorChain.proceed(RealInterceptorChain.kt:109)
	at okhttp3.internal.connection.RealCall.getResponseWithInterceptorChain$okhttp(RealCall.kt:201)
	at okhttp3.internal.connection.RealCall.execute(RealCall.kt:154)
	at feign.okhttp.OkHttpClient.execute(OkHttpClient.java:180)
	at org.springframework.cloud.openfeign.loadbalancer.LoadBalancerUtils.executeWithLoadBalancerLifecycleProcessing(LoadBalancerUtils.java:57)
	at org.springframework.cloud.openfeign.loadbalancer.LoadBalancerUtils.executeWithLoadBalancerLifecycleProcessing(LoadBalancerUtils.java:95)
	at org.springframework.cloud.openfeign.loadbalancer.FeignBlockingLoadBalancerClient.execute(FeignBlockingLoadBalancerClient.java:114)
	at feign.SynchronousMethodHandler.executeAndDecode(SynchronousMethodHandler.java:121)
	at feign.SynchronousMethodHandler.invoke(SynchronousMethodHandler.java:91)
	at feign.ReflectiveFeign$FeignInvocationHandler.invoke(ReflectiveFeign.java:100)
	at jdk.proxy2/jdk.proxy2.$Proxy138.eye_doctor_chat(Unknown Source)
	at com.luojiawei.his_service.controller.ChatController.ask(ChatController.java:39)
	at java.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at java.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:77)
	at java.base/jdk.internal.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.base/java.lang.reflect.Method.invoke(Method.java:568)
	at org.springframework.web.method.support.InvocableHandlerMethod.doInvoke(InvocableHandlerMethod.java:205)
	at org.springframework.web.method.support.InvocableHandlerMethod.invokeForRequest(InvocableHandlerMethod.java:150)
	at org.springframework.web.servlet.mvc.method.annotation.ServletInvocableHandlerMethod.invokeAndHandle(ServletInvocableHandlerMethod.java:117)
	at org.springframework.web.servlet.mvc.method.annotation.RequestMappingHandlerAdapter.invokeHandlerMethod(RequestMappingHandlerAdapter.java:895)
	at org.springframework.web.servlet.mvc.method.annotation.RequestMappingHandlerAdapter.handleInternal(RequestMappingHandlerAdapter.java:808)
	at org.springframework.web.servlet.mvc.method.AbstractHandlerMethodAdapter.handle(AbstractHandlerMethodAdapter.java:87)
	at org.springframework.web.servlet.DispatcherServlet.doDispatch(DispatcherServlet.java:1072)
	at org.springframework.web.servlet.DispatcherServlet.doService(DispatcherServlet.java:965)
	at org.springframework.web.servlet.FrameworkServlet.processRequest(FrameworkServlet.java:1006)
	at org.springframework.web.servlet.FrameworkServlet.doPost(FrameworkServlet.java:909)
	at javax.servlet.http.HttpServlet.service(HttpServlet.java:555)
	at org.springframework.web.servlet.FrameworkServlet.service(FrameworkServlet.java:883)
	at javax.servlet.http.HttpServlet.service(HttpServlet.java:623)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:209)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:153)
	at com.luojiawei.his_service.filter.RefreshTokenFilter.doFilterInternal(RefreshTokenFilter.java:58)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:117)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:178)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:153)
	at org.springframework.web.filter.RequestContextFilter.doFilterInternal(RequestContextFilter.java:100)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:117)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:178)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:153)
	at org.springframework.web.filter.FormContentFilter.doFilterInternal(FormContentFilter.java:93)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:117)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:178)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:153)
	at org.springframework.boot.actuate.metrics.web.servlet.WebMvcMetricsFilter.doFilterInternal(WebMvcMetricsFilter.java:96)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:117)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:178)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:153)
	at org.springframework.web.filter.CharacterEncodingFilter.doFilterInternal(CharacterEncodingFilter.java:201)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:117)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:178)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:153)
	at org.apache.catalina.core.StandardWrapperValve.invoke(StandardWrapperValve.java:167)
	at org.apache.catalina.core.StandardContextValve.invoke(StandardContextValve.java:90)
	at org.apache.catalina.authenticator.AuthenticatorBase.invoke(AuthenticatorBase.java:481)
	at org.apache.catalina.core.StandardHostValve.invoke(StandardHostValve.java:130)
	at org.apache.catalina.valves.ErrorReportValve.invoke(ErrorReportValve.java:93)
	at org.apache.catalina.core.StandardEngineValve.invoke(StandardEngineValve.java:74)
	at org.apache.catalina.connector.CoyoteAdapter.service(CoyoteAdapter.java:343)
	at org.apache.coyote.http11.Http11Processor.service(Http11Processor.java:390)
	at org.apache.coyote.AbstractProcessorLight.process(AbstractProcessorLight.java:63)
	at org.apache.coyote.AbstractProtocol$ConnectionHandler.process(AbstractProtocol.java:926)
	at org.apache.tomcat.util.net.NioEndpoint$SocketProcessor.doRun(NioEndpoint.java:1791)
	at org.apache.tomcat.util.net.SocketProcessorBase.run(SocketProcessorBase.java:52)
	at org.apache.tomcat.util.threads.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1191)
	at org.apache.tomcat.util.threads.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:659)
	at org.apache.tomcat.util.threads.TaskThread$WrappingRunnable.run(TaskThread.java:61)
	at java.base/java.lang.Thread.run(Thread.java:840)
Caused by: java.net.ConnectException: Connection refused: getsockopt
	at java.base/sun.nio.ch.Net.pollConnect(Native Method)
	at java.base/sun.nio.ch.Net.pollConnectNow(Net.java:672)
	at java.base/sun.nio.ch.NioSocketImpl.timedFinishConnect(NioSocketImpl.java:554)
	at java.base/sun.nio.ch.NioSocketImpl.connect(NioSocketImpl.java:602)
	at java.base/java.net.SocksSocketImpl.connect(SocksSocketImpl.java:327)
	at java.base/java.net.Socket.connect(Socket.java:633)
	at okhttp3.internal.platform.Platform.connectSocket(Platform.kt:128)
	at okhttp3.internal.connection.RealConnection.connectSocket(RealConnection.kt:295)
	... 79 more

20:49:14:134 DEBUG 35212 --- [http-nio-8080-exec-5] c.l.api.client.FlaskAiDoctorClient       : [FlaskAiDoctorClient#eye_doctor_chat] <--- END ERROR
20:49:14:141 ERROR 35212 --- [http-nio-8080-exec-5] o.a.c.c.C.[.[.[/].[dispatcherServlet]    : Servlet.service() for servlet [dispatcherServlet] in context with path [] threw exception [Request processing failed; nested exception is feign.RetryableException: Failed to connect to /10.21.93.70:8000 executing POST http://ai-service/api/eye-doctor/chat] with root cause

java.net.ConnectException: Connection refused: getsockopt
	at java.base/sun.nio.ch.Net.pollConnect(Native Method) ~[na:na]
	at java.base/sun.nio.ch.Net.pollConnectNow(Net.java:672) ~[na:na]
	at java.base/sun.nio.ch.NioSocketImpl.timedFinishConnect(NioSocketImpl.java:554) ~[na:na]
	at java.base/sun.nio.ch.NioSocketImpl.connect(NioSocketImpl.java:602) ~[na:na]
	at java.base/java.net.SocksSocketImpl.connect(SocksSocketImpl.java:327) ~[na:na]
	at java.base/java.net.Socket.connect(Socket.java:633) ~[na:na]
	at okhttp3.internal.platform.Platform.connectSocket(Platform.kt:128) ~[okhttp-4.9.3.jar:na]
	at okhttp3.internal.connection.RealConnection.connectSocket(RealConnection.kt:295) ~[okhttp-4.9.3.jar:na]
	at okhttp3.internal.connection.RealConnection.connect(RealConnection.kt:207) ~[okhttp-4.9.3.jar:na]
	at okhttp3.internal.connection.ExchangeFinder.findConnection(ExchangeFinder.kt:226) ~[okhttp-4.9.3.jar:na]
	at okhttp3.internal.connection.ExchangeFinder.findHealthyConnection(ExchangeFinder.kt:106) ~[okhttp-4.9.3.jar:na]
	at okhttp3.internal.connection.ExchangeFinder.find(ExchangeFinder.kt:74) ~[okhttp-4.9.3.jar:na]
	at okhttp3.internal.connection.RealCall.initExchange$okhttp(RealCall.kt:255) ~[okhttp-4.9.3.jar:na]
	at okhttp3.internal.connection.ConnectInterceptor.intercept(ConnectInterceptor.kt:32) ~[okhttp-4.9.3.jar:na]
	at okhttp3.internal.http.RealInterceptorChain.proceed(RealInterceptorChain.kt:109) ~[okhttp-4.9.3.jar:na]
	at okhttp3.internal.cache.CacheInterceptor.intercept(CacheInterceptor.kt:95) ~[okhttp-4.9.3.jar:na]
	at okhttp3.internal.http.RealInterceptorChain.proceed(RealInterceptorChain.kt:109) ~[okhttp-4.9.3.jar:na]
	at okhttp3.internal.http.BridgeInterceptor.intercept(BridgeInterceptor.kt:83) ~[okhttp-4.9.3.jar:na]
	at okhttp3.internal.http.RealInterceptorChain.proceed(RealInterceptorChain.kt:109) ~[okhttp-4.9.3.jar:na]
	at okhttp3.internal.http.RetryAndFollowUpInterceptor.intercept(RetryAndFollowUpInterceptor.kt:76) ~[okhttp-4.9.3.jar:na]
	at okhttp3.internal.http.RealInterceptorChain.proceed(RealInterceptorChain.kt:109) ~[okhttp-4.9.3.jar:na]
	at okhttp3.internal.connection.RealCall.getResponseWithInterceptorChain$okhttp(RealCall.kt:201) ~[okhttp-4.9.3.jar:na]
	at okhttp3.internal.connection.RealCall.execute(RealCall.kt:154) ~[okhttp-4.9.3.jar:na]
	at feign.okhttp.OkHttpClient.execute(OkHttpClient.java:180) ~[feign-okhttp-11.10.jar:na]
	at org.springframework.cloud.openfeign.loadbalancer.LoadBalancerUtils.executeWithLoadBalancerLifecycleProcessing(LoadBalancerUtils.java:57) ~[spring-cloud-openfeign-core-3.1.5.jar:3.1.5]
	at org.springframework.cloud.openfeign.loadbalancer.LoadBalancerUtils.executeWithLoadBalancerLifecycleProcessing(LoadBalancerUtils.java:95) ~[spring-cloud-openfeign-core-3.1.5.jar:3.1.5]
	at org.springframework.cloud.openfeign.loadbalancer.FeignBlockingLoadBalancerClient.execute(FeignBlockingLoadBalancerClient.java:114) ~[spring-cloud-openfeign-core-3.1.5.jar:3.1.5]
	at feign.SynchronousMethodHandler.executeAndDecode(SynchronousMethodHandler.java:121) ~[feign-core-11.10.jar:na]
	at feign.SynchronousMethodHandler.invoke(SynchronousMethodHandler.java:91) ~[feign-core-11.10.jar:na]
	at feign.ReflectiveFeign$FeignInvocationHandler.invoke(ReflectiveFeign.java:100) ~[feign-core-11.10.jar:na]
	at jdk.proxy2/jdk.proxy2.$Proxy138.eye_doctor_chat(Unknown Source) ~[na:na]
	at com.luojiawei.his_service.controller.ChatController.ask(ChatController.java:39) ~[classes/:na]
	at java.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke0(Native Method) ~[na:na]
	at java.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:77) ~[na:na]
	at java.base/jdk.internal.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43) ~[na:na]
	at java.base/java.lang.reflect.Method.invoke(Method.java:568) ~[na:na]
	at org.springframework.web.method.support.InvocableHandlerMethod.doInvoke(InvocableHandlerMethod.java:205) ~[spring-web-5.3.27.jar:5.3.27]
	at org.springframework.web.method.support.InvocableHandlerMethod.invokeForRequest(InvocableHandlerMethod.java:150) ~[spring-web-5.3.27.jar:5.3.27]
	at org.springframework.web.servlet.mvc.method.annotation.ServletInvocableHandlerMethod.invokeAndHandle(ServletInvocableHandlerMethod.java:117) ~[spring-webmvc-5.3.27.jar:5.3.27]
	at org.springframework.web.servlet.mvc.method.annotation.RequestMappingHandlerAdapter.invokeHandlerMethod(RequestMappingHandlerAdapter.java:895) ~[spring-webmvc-5.3.27.jar:5.3.27]
	at org.springframework.web.servlet.mvc.method.annotation.RequestMappingHandlerAdapter.handleInternal(RequestMappingHandlerAdapter.java:808) ~[spring-webmvc-5.3.27.jar:5.3.27]
	at org.springframework.web.servlet.mvc.method.AbstractHandlerMethodAdapter.handle(AbstractHandlerMethodAdapter.java:87) ~[spring-webmvc-5.3.27.jar:5.3.27]
	at org.springframework.web.servlet.DispatcherServlet.doDispatch(DispatcherServlet.java:1072) ~[spring-webmvc-5.3.27.jar:5.3.27]
	at org.springframework.web.servlet.DispatcherServlet.doService(DispatcherServlet.java:965) ~[spring-webmvc-5.3.27.jar:5.3.27]
	at org.springframework.web.servlet.FrameworkServlet.processRequest(FrameworkServlet.java:1006) ~[spring-webmvc-5.3.27.jar:5.3.27]
	at org.springframework.web.servlet.FrameworkServlet.doPost(FrameworkServlet.java:909) ~[spring-webmvc-5.3.27.jar:5.3.27]
	at javax.servlet.http.HttpServlet.service(HttpServlet.java:555) ~[tomcat-embed-core-9.0.75.jar:4.0.FR]
	at org.springframework.web.servlet.FrameworkServlet.service(FrameworkServlet.java:883) ~[spring-webmvc-5.3.27.jar:5.3.27]
	at javax.servlet.http.HttpServlet.service(HttpServlet.java:623) ~[tomcat-embed-core-9.0.75.jar:4.0.FR]
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:209) ~[tomcat-embed-core-9.0.75.jar:9.0.75]
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:153) ~[tomcat-embed-core-9.0.75.jar:9.0.75]
	at com.luojiawei.his_service.filter.RefreshTokenFilter.doFilterInternal(RefreshTokenFilter.java:58) ~[classes/:na]
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:117) ~[spring-web-5.3.27.jar:5.3.27]
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:178) ~[tomcat-embed-core-9.0.75.jar:9.0.75]
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:153) ~[tomcat-embed-core-9.0.75.jar:9.0.75]
	at org.springframework.web.filter.RequestContextFilter.doFilterInternal(RequestContextFilter.java:100) ~[spring-web-5.3.27.jar:5.3.27]
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:117) ~[spring-web-5.3.27.jar:5.3.27]
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:178) ~[tomcat-embed-core-9.0.75.jar:9.0.75]
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:153) ~[tomcat-embed-core-9.0.75.jar:9.0.75]
	at org.springframework.web.filter.FormContentFilter.doFilterInternal(FormContentFilter.java:93) ~[spring-web-5.3.27.jar:5.3.27]
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:117) ~[spring-web-5.3.27.jar:5.3.27]
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:178) ~[tomcat-embed-core-9.0.75.jar:9.0.75]
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:153) ~[tomcat-embed-core-9.0.75.jar:9.0.75]
	at org.springframework.boot.actuate.metrics.web.servlet.WebMvcMetricsFilter.doFilterInternal(WebMvcMetricsFilter.java:96) ~[spring-boot-actuator-2.7.12.jar:2.7.12]
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:117) ~[spring-web-5.3.27.jar:5.3.27]
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:178) ~[tomcat-embed-core-9.0.75.jar:9.0.75]
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:153) ~[tomcat-embed-core-9.0.75.jar:9.0.75]
	at org.springframework.web.filter.CharacterEncodingFilter.doFilterInternal(CharacterEncodingFilter.java:201) ~[spring-web-5.3.27.jar:5.3.27]
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:117) ~[spring-web-5.3.27.jar:5.3.27]
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:178) ~[tomcat-embed-core-9.0.75.jar:9.0.75]
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:153) ~[tomcat-embed-core-9.0.75.jar:9.0.75]
	at org.apache.catalina.core.StandardWrapperValve.invoke(StandardWrapperValve.java:167) ~[tomcat-embed-core-9.0.75.jar:9.0.75]
	at org.apache.catalina.core.StandardContextValve.invoke(StandardContextValve.java:90) ~[tomcat-embed-core-9.0.75.jar:9.0.75]
	at org.apache.catalina.authenticator.AuthenticatorBase.invoke(AuthenticatorBase.java:481) ~[tomcat-embed-core-9.0.75.jar:9.0.75]
	at org.apache.catalina.core.StandardHostValve.invoke(StandardHostValve.java:130) ~[tomcat-embed-core-9.0.75.jar:9.0.75]
	at org.apache.catalina.valves.ErrorReportValve.invoke(ErrorReportValve.java:93) ~[tomcat-embed-core-9.0.75.jar:9.0.75]
	at org.apache.catalina.core.StandardEngineValve.invoke(StandardEngineValve.java:74) ~[tomcat-embed-core-9.0.75.jar:9.0.75]
	at org.apache.catalina.connector.CoyoteAdapter.service(CoyoteAdapter.java:343) ~[tomcat-embed-core-9.0.75.jar:9.0.75]
	at org.apache.coyote.http11.Http11Processor.service(Http11Processor.java:390) ~[tomcat-embed-core-9.0.75.jar:9.0.75]
	at org.apache.coyote.AbstractProcessorLight.process(AbstractProcessorLight.java:63) ~[tomcat-embed-core-9.0.75.jar:9.0.75]
	at org.apache.coyote.AbstractProtocol$ConnectionHandler.process(AbstractProtocol.java:926) ~[tomcat-embed-core-9.0.75.jar:9.0.75]
	at org.apache.tomcat.util.net.NioEndpoint$SocketProcessor.doRun(NioEndpoint.java:1791) ~[tomcat-embed-core-9.0.75.jar:9.0.75]
	at org.apache.tomcat.util.net.SocketProcessorBase.run(SocketProcessorBase.java:52) ~[tomcat-embed-core-9.0.75.jar:9.0.75]
	at org.apache.tomcat.util.threads.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1191) ~[tomcat-embed-core-9.0.75.jar:9.0.75]
	at org.apache.tomcat.util.threads.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:659) ~[tomcat-embed-core-9.0.75.jar:9.0.75]
	at org.apache.tomcat.util.threads.TaskThread$WrappingRunnable.run(TaskThread.java:61) ~[tomcat-embed-core-9.0.75.jar:9.0.75]
	at java.base/java.lang.Thread.run(Thread.java:840) ~[na:na]

20:49:22:457 DEBUG 35212 --- [http-nio-8080-exec-6] c.l.h.m.D.selectById                     : ==>  Preparing: SELECT id,patient_id,doctor_id,disease_name,disease_category,aimodel_id,result,create_time,status,id_card,name,score,remark FROM diagnosis_report WHERE id=?
20:49:22:458 DEBUG 35212 --- [http-nio-8080-exec-6] c.l.h.m.D.selectById                     : ==> Parameters: 1(Integer)
20:49:22:490 DEBUG 35212 --- [http-nio-8080-exec-6] c.l.h.m.D.selectById                     : <==      Total: 1
20:49:22:492 DEBUG 35212 --- [http-nio-8080-exec-6] c.l.h.mapper.PatientMapper.selectById    : ==>  Preparing: SELECT id,phone,id_card,name,verified,verified_by,verified_time,open_id,hospital_pid FROM patient WHERE id=?
20:49:22:495 DEBUG 35212 --- [http-nio-8080-exec-6] c.l.h.mapper.PatientMapper.selectById    : ==> Parameters: 1(Integer)
20:49:22:528 DEBUG 35212 --- [http-nio-8080-exec-6] c.l.h.mapper.PatientMapper.selectById    : <==      Total: 1
20:49:22:531 DEBUG 35212 --- [http-nio-8080-exec-6] c.l.h.mapper.DoctorMapper.selectById     : ==>  Preparing: SELECT id,phone,id_card,name,verified,verified_by,verified_time,license,department,hospital_pid FROM doctor WHERE id=?
20:49:22:531 DEBUG 35212 --- [http-nio-8080-exec-6] c.l.h.mapper.DoctorMapper.selectById     : ==> Parameters: 1(Integer)
20:49:22:565 DEBUG 35212 --- [http-nio-8080-exec-6] c.l.h.mapper.DoctorMapper.selectById     : <==      Total: 1
20:49:22:566 DEBUG 35212 --- [http-nio-8080-exec-6] c.l.h.m.E.selectListByDiagnosisId        : ==>  Preparing: select * from eye_images where dignosis_report_id = ?
20:49:22:566 DEBUG 35212 --- [http-nio-8080-exec-6] c.l.h.m.E.selectListByDiagnosisId        : ==> Parameters: 1(Integer)
20:49:22:598 DEBUG 35212 --- [http-nio-8080-exec-6] c.l.h.m.E.selectListByDiagnosisId        : <==      Total: 1
20:49:22:599 DEBUG 35212 --- [http-nio-8080-exec-6] c.l.h.m.T.selectByDiagnosisId            : ==>  Preparing: select * from treatment_plans where diagnosis_id = ?
20:49:22:599 DEBUG 35212 --- [http-nio-8080-exec-6] c.l.h.m.T.selectByDiagnosisId            : ==> Parameters: 1(Integer)
20:49:22:632 DEBUG 35212 --- [http-nio-8080-exec-6] c.l.h.m.T.selectByDiagnosisId            : <==      Total: 1
20:49:22:633 DEBUG 35212 --- [http-nio-8080-exec-6] c.l.h.m.M.selectByDiagnosisId            : ==>  Preparing: select * from medication_recommendations where diagnosis_id = ?
20:49:22:633 DEBUG 35212 --- [http-nio-8080-exec-6] c.l.h.m.M.selectByDiagnosisId            : ==> Parameters: 1(Integer)
20:49:22:667 DEBUG 35212 --- [http-nio-8080-exec-6] c.l.h.m.M.selectByDiagnosisId            : <==      Total: 1
20:49:22:667 DEBUG 35212 --- [http-nio-8080-exec-6] c.l.h.mapper.AiModelMapper.selectById    : ==>  Preparing: SELECT id,version,deploy_time,accuracy FROM ai_model WHERE id=?
20:49:22:668 DEBUG 35212 --- [http-nio-8080-exec-6] c.l.h.mapper.AiModelMapper.selectById    : ==> Parameters: 1(Integer)
20:49:22:699 DEBUG 35212 --- [http-nio-8080-exec-6] c.l.h.mapper.AiModelMapper.selectById    : <==      Total: 1
20:49:22:700 DEBUG 35212 --- [http-nio-8080-exec-6] c.l.api.client.FlaskAiDoctorClient       : [FlaskAiDoctorClient#eye_doctor_chat] ---> POST http://ai-service/api/eye-doctor/chat HTTP/1.1
20:49:22:700 DEBUG 35212 --- [http-nio-8080-exec-6] c.l.api.client.FlaskAiDoctorClient       : [FlaskAiDoctorClient#eye_doctor_chat] Content-Length: 753
20:49:22:700 DEBUG 35212 --- [http-nio-8080-exec-6] c.l.api.client.FlaskAiDoctorClient       : [FlaskAiDoctorClient#eye_doctor_chat] Content-Type: application/json
20:49:22:700 DEBUG 35212 --- [http-nio-8080-exec-6] c.l.api.client.FlaskAiDoctorClient       : [FlaskAiDoctorClient#eye_doctor_chat] 
20:49:22:700 DEBUG 35212 --- [http-nio-8080-exec-6] c.l.api.client.FlaskAiDoctorClient       : [FlaskAiDoctorClient#eye_doctor_chat] {"diagnosis_name":"","diagnosis_category":"","result":"A","remark":"A","treatment_plan":{"id":1,"treatmentType":1,"treatmentDetail":"","startTime":"2025-03-01 09:00:00","endDate":"2025-03-10 09:00:00","doctorId":1,"createdTime":"2025-03-01T09:00:00","updatedTime":"2025-03-01T09:00:00"},"medications":[{"id":1,"diagnosisId":1,"medicationName":"A","dosage":"10mg","frequency":"","sideEffects":"","startTime":"2025-03-01T09:00:00","endTime":"2025-03-10T09:00:00","doctorId":1,"createdTime":"2025-03-01 09:00:00","updatedTime":"2025-03-01 09:00:00"}],"previous_conversations":[{"role":"pariatur tempor do","content":"sit cupidatat commodo"}],"question":"irure eu esse","stream":false}
20:49:22:700 DEBUG 35212 --- [http-nio-8080-exec-6] c.l.api.client.FlaskAiDoctorClient       : [FlaskAiDoctorClient#eye_doctor_chat] ---> END HTTP (753-byte body)
20:49:24:751 DEBUG 35212 --- [http-nio-8080-exec-6] c.l.api.client.FlaskAiDoctorClient       : [FlaskAiDoctorClient#eye_doctor_chat] <--- ERROR ConnectException: Failed to connect to /10.21.93.70:8000 (2050ms)
20:49:24:752 DEBUG 35212 --- [http-nio-8080-exec-6] c.l.api.client.FlaskAiDoctorClient       : [FlaskAiDoctorClient#eye_doctor_chat] java.net.ConnectException: Failed to connect to /10.21.93.70:8000
	at okhttp3.internal.connection.RealConnection.connectSocket(RealConnection.kt:297)
	at okhttp3.internal.connection.RealConnection.connect(RealConnection.kt:207)
	at okhttp3.internal.connection.ExchangeFinder.findConnection(ExchangeFinder.kt:226)
	at okhttp3.internal.connection.ExchangeFinder.findHealthyConnection(ExchangeFinder.kt:106)
	at okhttp3.internal.connection.ExchangeFinder.find(ExchangeFinder.kt:74)
	at okhttp3.internal.connection.RealCall.initExchange$okhttp(RealCall.kt:255)
	at okhttp3.internal.connection.ConnectInterceptor.intercept(ConnectInterceptor.kt:32)
	at okhttp3.internal.http.RealInterceptorChain.proceed(RealInterceptorChain.kt:109)
	at okhttp3.internal.cache.CacheInterceptor.intercept(CacheInterceptor.kt:95)
	at okhttp3.internal.http.RealInterceptorChain.proceed(RealInterceptorChain.kt:109)
	at okhttp3.internal.http.BridgeInterceptor.intercept(BridgeInterceptor.kt:83)
	at okhttp3.internal.http.RealInterceptorChain.proceed(RealInterceptorChain.kt:109)
	at okhttp3.internal.http.RetryAndFollowUpInterceptor.intercept(RetryAndFollowUpInterceptor.kt:76)
	at okhttp3.internal.http.RealInterceptorChain.proceed(RealInterceptorChain.kt:109)
	at okhttp3.internal.connection.RealCall.getResponseWithInterceptorChain$okhttp(RealCall.kt:201)
	at okhttp3.internal.connection.RealCall.execute(RealCall.kt:154)
	at feign.okhttp.OkHttpClient.execute(OkHttpClient.java:180)
	at org.springframework.cloud.openfeign.loadbalancer.LoadBalancerUtils.executeWithLoadBalancerLifecycleProcessing(LoadBalancerUtils.java:57)
	at org.springframework.cloud.openfeign.loadbalancer.LoadBalancerUtils.executeWithLoadBalancerLifecycleProcessing(LoadBalancerUtils.java:95)
	at org.springframework.cloud.openfeign.loadbalancer.FeignBlockingLoadBalancerClient.execute(FeignBlockingLoadBalancerClient.java:114)
	at feign.SynchronousMethodHandler.executeAndDecode(SynchronousMethodHandler.java:121)
	at feign.SynchronousMethodHandler.invoke(SynchronousMethodHandler.java:91)
	at feign.ReflectiveFeign$FeignInvocationHandler.invoke(ReflectiveFeign.java:100)
	at jdk.proxy2/jdk.proxy2.$Proxy138.eye_doctor_chat(Unknown Source)
	at com.luojiawei.his_service.controller.ChatController.ask(ChatController.java:39)
	at java.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at java.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:77)
	at java.base/jdk.internal.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.base/java.lang.reflect.Method.invoke(Method.java:568)
	at org.springframework.web.method.support.InvocableHandlerMethod.doInvoke(InvocableHandlerMethod.java:205)
	at org.springframework.web.method.support.InvocableHandlerMethod.invokeForRequest(InvocableHandlerMethod.java:150)
	at org.springframework.web.servlet.mvc.method.annotation.ServletInvocableHandlerMethod.invokeAndHandle(ServletInvocableHandlerMethod.java:117)
	at org.springframework.web.servlet.mvc.method.annotation.RequestMappingHandlerAdapter.invokeHandlerMethod(RequestMappingHandlerAdapter.java:895)
	at org.springframework.web.servlet.mvc.method.annotation.RequestMappingHandlerAdapter.handleInternal(RequestMappingHandlerAdapter.java:808)
	at org.springframework.web.servlet.mvc.method.AbstractHandlerMethodAdapter.handle(AbstractHandlerMethodAdapter.java:87)
	at org.springframework.web.servlet.DispatcherServlet.doDispatch(DispatcherServlet.java:1072)
	at org.springframework.web.servlet.DispatcherServlet.doService(DispatcherServlet.java:965)
	at org.springframework.web.servlet.FrameworkServlet.processRequest(FrameworkServlet.java:1006)
	at org.springframework.web.servlet.FrameworkServlet.doPost(FrameworkServlet.java:909)
	at javax.servlet.http.HttpServlet.service(HttpServlet.java:555)
	at org.springframework.web.servlet.FrameworkServlet.service(FrameworkServlet.java:883)
	at javax.servlet.http.HttpServlet.service(HttpServlet.java:623)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:209)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:153)
	at com.luojiawei.his_service.filter.RefreshTokenFilter.doFilterInternal(RefreshTokenFilter.java:58)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:117)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:178)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:153)
	at org.springframework.web.filter.RequestContextFilter.doFilterInternal(RequestContextFilter.java:100)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:117)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:178)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:153)
	at org.springframework.web.filter.FormContentFilter.doFilterInternal(FormContentFilter.java:93)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:117)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:178)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:153)
	at org.springframework.boot.actuate.metrics.web.servlet.WebMvcMetricsFilter.doFilterInternal(WebMvcMetricsFilter.java:96)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:117)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:178)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:153)
	at org.springframework.web.filter.CharacterEncodingFilter.doFilterInternal(CharacterEncodingFilter.java:201)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:117)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:178)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:153)
	at org.apache.catalina.core.StandardWrapperValve.invoke(StandardWrapperValve.java:167)
	at org.apache.catalina.core.StandardContextValve.invoke(StandardContextValve.java:90)
	at org.apache.catalina.authenticator.AuthenticatorBase.invoke(AuthenticatorBase.java:481)
	at org.apache.catalina.core.StandardHostValve.invoke(StandardHostValve.java:130)
	at org.apache.catalina.valves.ErrorReportValve.invoke(ErrorReportValve.java:93)
	at org.apache.catalina.core.StandardEngineValve.invoke(StandardEngineValve.java:74)
	at org.apache.catalina.connector.CoyoteAdapter.service(CoyoteAdapter.java:343)
	at org.apache.coyote.http11.Http11Processor.service(Http11Processor.java:390)
	at org.apache.coyote.AbstractProcessorLight.process(AbstractProcessorLight.java:63)
	at org.apache.coyote.AbstractProtocol$ConnectionHandler.process(AbstractProtocol.java:926)
	at org.apache.tomcat.util.net.NioEndpoint$SocketProcessor.doRun(NioEndpoint.java:1791)
	at org.apache.tomcat.util.net.SocketProcessorBase.run(SocketProcessorBase.java:52)
	at org.apache.tomcat.util.threads.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1191)
	at org.apache.tomcat.util.threads.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:659)
	at org.apache.tomcat.util.threads.TaskThread$WrappingRunnable.run(TaskThread.java:61)
	at java.base/java.lang.Thread.run(Thread.java:840)
Caused by: java.net.ConnectException: Connection refused: getsockopt
	at java.base/sun.nio.ch.Net.pollConnect(Native Method)
	at java.base/sun.nio.ch.Net.pollConnectNow(Net.java:672)
	at java.base/sun.nio.ch.NioSocketImpl.timedFinishConnect(NioSocketImpl.java:554)
	at java.base/sun.nio.ch.NioSocketImpl.connect(NioSocketImpl.java:602)
	at java.base/java.net.SocksSocketImpl.connect(SocksSocketImpl.java:327)
	at java.base/java.net.Socket.connect(Socket.java:633)
	at okhttp3.internal.platform.Platform.connectSocket(Platform.kt:128)
	at okhttp3.internal.connection.RealConnection.connectSocket(RealConnection.kt:295)
	... 79 more

20:49:24:752 DEBUG 35212 --- [http-nio-8080-exec-6] c.l.api.client.FlaskAiDoctorClient       : [FlaskAiDoctorClient#eye_doctor_chat] <--- END ERROR
20:49:24:754 ERROR 35212 --- [http-nio-8080-exec-6] o.a.c.c.C.[.[.[/].[dispatcherServlet]    : Servlet.service() for servlet [dispatcherServlet] in context with path [] threw exception [Request processing failed; nested exception is feign.RetryableException: Failed to connect to /10.21.93.70:8000 executing POST http://ai-service/api/eye-doctor/chat] with root cause

java.net.ConnectException: Connection refused: getsockopt
	at java.base/sun.nio.ch.Net.pollConnect(Native Method) ~[na:na]
	at java.base/sun.nio.ch.Net.pollConnectNow(Net.java:672) ~[na:na]
	at java.base/sun.nio.ch.NioSocketImpl.timedFinishConnect(NioSocketImpl.java:554) ~[na:na]
	at java.base/sun.nio.ch.NioSocketImpl.connect(NioSocketImpl.java:602) ~[na:na]
	at java.base/java.net.SocksSocketImpl.connect(SocksSocketImpl.java:327) ~[na:na]
	at java.base/java.net.Socket.connect(Socket.java:633) ~[na:na]
	at okhttp3.internal.platform.Platform.connectSocket(Platform.kt:128) ~[okhttp-4.9.3.jar:na]
	at okhttp3.internal.connection.RealConnection.connectSocket(RealConnection.kt:295) ~[okhttp-4.9.3.jar:na]
	at okhttp3.internal.connection.RealConnection.connect(RealConnection.kt:207) ~[okhttp-4.9.3.jar:na]
	at okhttp3.internal.connection.ExchangeFinder.findConnection(ExchangeFinder.kt:226) ~[okhttp-4.9.3.jar:na]
	at okhttp3.internal.connection.ExchangeFinder.findHealthyConnection(ExchangeFinder.kt:106) ~[okhttp-4.9.3.jar:na]
	at okhttp3.internal.connection.ExchangeFinder.find(ExchangeFinder.kt:74) ~[okhttp-4.9.3.jar:na]
	at okhttp3.internal.connection.RealCall.initExchange$okhttp(RealCall.kt:255) ~[okhttp-4.9.3.jar:na]
	at okhttp3.internal.connection.ConnectInterceptor.intercept(ConnectInterceptor.kt:32) ~[okhttp-4.9.3.jar:na]
	at okhttp3.internal.http.RealInterceptorChain.proceed(RealInterceptorChain.kt:109) ~[okhttp-4.9.3.jar:na]
	at okhttp3.internal.cache.CacheInterceptor.intercept(CacheInterceptor.kt:95) ~[okhttp-4.9.3.jar:na]
	at okhttp3.internal.http.RealInterceptorChain.proceed(RealInterceptorChain.kt:109) ~[okhttp-4.9.3.jar:na]
	at okhttp3.internal.http.BridgeInterceptor.intercept(BridgeInterceptor.kt:83) ~[okhttp-4.9.3.jar:na]
	at okhttp3.internal.http.RealInterceptorChain.proceed(RealInterceptorChain.kt:109) ~[okhttp-4.9.3.jar:na]
	at okhttp3.internal.http.RetryAndFollowUpInterceptor.intercept(RetryAndFollowUpInterceptor.kt:76) ~[okhttp-4.9.3.jar:na]
	at okhttp3.internal.http.RealInterceptorChain.proceed(RealInterceptorChain.kt:109) ~[okhttp-4.9.3.jar:na]
	at okhttp3.internal.connection.RealCall.getResponseWithInterceptorChain$okhttp(RealCall.kt:201) ~[okhttp-4.9.3.jar:na]
	at okhttp3.internal.connection.RealCall.execute(RealCall.kt:154) ~[okhttp-4.9.3.jar:na]
	at feign.okhttp.OkHttpClient.execute(OkHttpClient.java:180) ~[feign-okhttp-11.10.jar:na]
	at org.springframework.cloud.openfeign.loadbalancer.LoadBalancerUtils.executeWithLoadBalancerLifecycleProcessing(LoadBalancerUtils.java:57) ~[spring-cloud-openfeign-core-3.1.5.jar:3.1.5]
	at org.springframework.cloud.openfeign.loadbalancer.LoadBalancerUtils.executeWithLoadBalancerLifecycleProcessing(LoadBalancerUtils.java:95) ~[spring-cloud-openfeign-core-3.1.5.jar:3.1.5]
	at org.springframework.cloud.openfeign.loadbalancer.FeignBlockingLoadBalancerClient.execute(FeignBlockingLoadBalancerClient.java:114) ~[spring-cloud-openfeign-core-3.1.5.jar:3.1.5]
	at feign.SynchronousMethodHandler.executeAndDecode(SynchronousMethodHandler.java:121) ~[feign-core-11.10.jar:na]
	at feign.SynchronousMethodHandler.invoke(SynchronousMethodHandler.java:91) ~[feign-core-11.10.jar:na]
	at feign.ReflectiveFeign$FeignInvocationHandler.invoke(ReflectiveFeign.java:100) ~[feign-core-11.10.jar:na]
	at jdk.proxy2/jdk.proxy2.$Proxy138.eye_doctor_chat(Unknown Source) ~[na:na]
	at com.luojiawei.his_service.controller.ChatController.ask(ChatController.java:39) ~[classes/:na]
	at java.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke0(Native Method) ~[na:na]
	at java.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:77) ~[na:na]
	at java.base/jdk.internal.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43) ~[na:na]
	at java.base/java.lang.reflect.Method.invoke(Method.java:568) ~[na:na]
	at org.springframework.web.method.support.InvocableHandlerMethod.doInvoke(InvocableHandlerMethod.java:205) ~[spring-web-5.3.27.jar:5.3.27]
	at org.springframework.web.method.support.InvocableHandlerMethod.invokeForRequest(InvocableHandlerMethod.java:150) ~[spring-web-5.3.27.jar:5.3.27]
	at org.springframework.web.servlet.mvc.method.annotation.ServletInvocableHandlerMethod.invokeAndHandle(ServletInvocableHandlerMethod.java:117) ~[spring-webmvc-5.3.27.jar:5.3.27]
	at org.springframework.web.servlet.mvc.method.annotation.RequestMappingHandlerAdapter.invokeHandlerMethod(RequestMappingHandlerAdapter.java:895) ~[spring-webmvc-5.3.27.jar:5.3.27]
	at org.springframework.web.servlet.mvc.method.annotation.RequestMappingHandlerAdapter.handleInternal(RequestMappingHandlerAdapter.java:808) ~[spring-webmvc-5.3.27.jar:5.3.27]
	at org.springframework.web.servlet.mvc.method.AbstractHandlerMethodAdapter.handle(AbstractHandlerMethodAdapter.java:87) ~[spring-webmvc-5.3.27.jar:5.3.27]
	at org.springframework.web.servlet.DispatcherServlet.doDispatch(DispatcherServlet.java:1072) ~[spring-webmvc-5.3.27.jar:5.3.27]
	at org.springframework.web.servlet.DispatcherServlet.doService(DispatcherServlet.java:965) ~[spring-webmvc-5.3.27.jar:5.3.27]
	at org.springframework.web.servlet.FrameworkServlet.processRequest(FrameworkServlet.java:1006) ~[spring-webmvc-5.3.27.jar:5.3.27]
	at org.springframework.web.servlet.FrameworkServlet.doPost(FrameworkServlet.java:909) ~[spring-webmvc-5.3.27.jar:5.3.27]
	at javax.servlet.http.HttpServlet.service(HttpServlet.java:555) ~[tomcat-embed-core-9.0.75.jar:4.0.FR]
	at org.springframework.web.servlet.FrameworkServlet.service(FrameworkServlet.java:883) ~[spring-webmvc-5.3.27.jar:5.3.27]
	at javax.servlet.http.HttpServlet.service(HttpServlet.java:623) ~[tomcat-embed-core-9.0.75.jar:4.0.FR]
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:209) ~[tomcat-embed-core-9.0.75.jar:9.0.75]
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:153) ~[tomcat-embed-core-9.0.75.jar:9.0.75]
	at com.luojiawei.his_service.filter.RefreshTokenFilter.doFilterInternal(RefreshTokenFilter.java:58) ~[classes/:na]
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:117) ~[spring-web-5.3.27.jar:5.3.27]
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:178) ~[tomcat-embed-core-9.0.75.jar:9.0.75]
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:153) ~[tomcat-embed-core-9.0.75.jar:9.0.75]
	at org.springframework.web.filter.RequestContextFilter.doFilterInternal(RequestContextFilter.java:100) ~[spring-web-5.3.27.jar:5.3.27]
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:117) ~[spring-web-5.3.27.jar:5.3.27]
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:178) ~[tomcat-embed-core-9.0.75.jar:9.0.75]
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:153) ~[tomcat-embed-core-9.0.75.jar:9.0.75]
	at org.springframework.web.filter.FormContentFilter.doFilterInternal(FormContentFilter.java:93) ~[spring-web-5.3.27.jar:5.3.27]
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:117) ~[spring-web-5.3.27.jar:5.3.27]
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:178) ~[tomcat-embed-core-9.0.75.jar:9.0.75]
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:153) ~[tomcat-embed-core-9.0.75.jar:9.0.75]
	at org.springframework.boot.actuate.metrics.web.servlet.WebMvcMetricsFilter.doFilterInternal(WebMvcMetricsFilter.java:96) ~[spring-boot-actuator-2.7.12.jar:2.7.12]
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:117) ~[spring-web-5.3.27.jar:5.3.27]
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:178) ~[tomcat-embed-core-9.0.75.jar:9.0.75]
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:153) ~[tomcat-embed-core-9.0.75.jar:9.0.75]
	at org.springframework.web.filter.CharacterEncodingFilter.doFilterInternal(CharacterEncodingFilter.java:201) ~[spring-web-5.3.27.jar:5.3.27]
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:117) ~[spring-web-5.3.27.jar:5.3.27]
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:178) ~[tomcat-embed-core-9.0.75.jar:9.0.75]
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:153) ~[tomcat-embed-core-9.0.75.jar:9.0.75]
	at org.apache.catalina.core.StandardWrapperValve.invoke(StandardWrapperValve.java:167) ~[tomcat-embed-core-9.0.75.jar:9.0.75]
	at org.apache.catalina.core.StandardContextValve.invoke(StandardContextValve.java:90) ~[tomcat-embed-core-9.0.75.jar:9.0.75]
	at org.apache.catalina.authenticator.AuthenticatorBase.invoke(AuthenticatorBase.java:481) ~[tomcat-embed-core-9.0.75.jar:9.0.75]
	at org.apache.catalina.core.StandardHostValve.invoke(StandardHostValve.java:130) ~[tomcat-embed-core-9.0.75.jar:9.0.75]
	at org.apache.catalina.valves.ErrorReportValve.invoke(ErrorReportValve.java:93) ~[tomcat-embed-core-9.0.75.jar:9.0.75]
	at org.apache.catalina.core.StandardEngineValve.invoke(StandardEngineValve.java:74) ~[tomcat-embed-core-9.0.75.jar:9.0.75]
	at org.apache.catalina.connector.CoyoteAdapter.service(CoyoteAdapter.java:343) ~[tomcat-embed-core-9.0.75.jar:9.0.75]
	at org.apache.coyote.http11.Http11Processor.service(Http11Processor.java:390) ~[tomcat-embed-core-9.0.75.jar:9.0.75]
	at org.apache.coyote.AbstractProcessorLight.process(AbstractProcessorLight.java:63) ~[tomcat-embed-core-9.0.75.jar:9.0.75]
	at org.apache.coyote.AbstractProtocol$ConnectionHandler.process(AbstractProtocol.java:926) ~[tomcat-embed-core-9.0.75.jar:9.0.75]
	at org.apache.tomcat.util.net.NioEndpoint$SocketProcessor.doRun(NioEndpoint.java:1791) ~[tomcat-embed-core-9.0.75.jar:9.0.75]
	at org.apache.tomcat.util.net.SocketProcessorBase.run(SocketProcessorBase.java:52) ~[tomcat-embed-core-9.0.75.jar:9.0.75]
	at org.apache.tomcat.util.threads.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1191) ~[tomcat-embed-core-9.0.75.jar:9.0.75]
	at org.apache.tomcat.util.threads.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:659) ~[tomcat-embed-core-9.0.75.jar:9.0.75]
	at org.apache.tomcat.util.threads.TaskThread$WrappingRunnable.run(TaskThread.java:61) ~[tomcat-embed-core-9.0.75.jar:9.0.75]
	at java.base/java.lang.Thread.run(Thread.java:840) ~[na:na]

20:49:32:298 DEBUG 35212 --- [http-nio-8080-exec-7] c.l.h.m.D.selectById                     : ==>  Preparing: SELECT id,patient_id,doctor_id,disease_name,disease_category,aimodel_id,result,create_time,status,id_card,name,score,remark FROM diagnosis_report WHERE id=?
20:49:32:299 DEBUG 35212 --- [http-nio-8080-exec-7] c.l.h.m.D.selectById                     : ==> Parameters: 1(Integer)
20:49:32:332 DEBUG 35212 --- [http-nio-8080-exec-7] c.l.h.m.D.selectById                     : <==      Total: 1
20:49:32:332 DEBUG 35212 --- [http-nio-8080-exec-7] c.l.h.mapper.PatientMapper.selectById    : ==>  Preparing: SELECT id,phone,id_card,name,verified,verified_by,verified_time,open_id,hospital_pid FROM patient WHERE id=?
20:49:32:333 DEBUG 35212 --- [http-nio-8080-exec-7] c.l.h.mapper.PatientMapper.selectById    : ==> Parameters: 1(Integer)
20:49:32:365 DEBUG 35212 --- [http-nio-8080-exec-7] c.l.h.mapper.PatientMapper.selectById    : <==      Total: 1
20:49:32:365 DEBUG 35212 --- [http-nio-8080-exec-7] c.l.h.mapper.DoctorMapper.selectById     : ==>  Preparing: SELECT id,phone,id_card,name,verified,verified_by,verified_time,license,department,hospital_pid FROM doctor WHERE id=?
20:49:32:366 DEBUG 35212 --- [http-nio-8080-exec-7] c.l.h.mapper.DoctorMapper.selectById     : ==> Parameters: 1(Integer)
20:49:32:399 DEBUG 35212 --- [http-nio-8080-exec-7] c.l.h.mapper.DoctorMapper.selectById     : <==      Total: 1
20:49:32:399 DEBUG 35212 --- [http-nio-8080-exec-7] c.l.h.m.E.selectListByDiagnosisId        : ==>  Preparing: select * from eye_images where dignosis_report_id = ?
20:49:32:400 DEBUG 35212 --- [http-nio-8080-exec-7] c.l.h.m.E.selectListByDiagnosisId        : ==> Parameters: 1(Integer)
20:49:32:431 DEBUG 35212 --- [http-nio-8080-exec-7] c.l.h.m.E.selectListByDiagnosisId        : <==      Total: 1
20:49:32:431 DEBUG 35212 --- [http-nio-8080-exec-7] c.l.h.m.T.selectByDiagnosisId            : ==>  Preparing: select * from treatment_plans where diagnosis_id = ?
20:49:32:431 DEBUG 35212 --- [http-nio-8080-exec-7] c.l.h.m.T.selectByDiagnosisId            : ==> Parameters: 1(Integer)
20:49:32:464 DEBUG 35212 --- [http-nio-8080-exec-7] c.l.h.m.T.selectByDiagnosisId            : <==      Total: 1
20:49:32:465 DEBUG 35212 --- [http-nio-8080-exec-7] c.l.h.m.M.selectByDiagnosisId            : ==>  Preparing: select * from medication_recommendations where diagnosis_id = ?
20:49:32:465 DEBUG 35212 --- [http-nio-8080-exec-7] c.l.h.m.M.selectByDiagnosisId            : ==> Parameters: 1(Integer)
20:49:32:498 DEBUG 35212 --- [http-nio-8080-exec-7] c.l.h.m.M.selectByDiagnosisId            : <==      Total: 1
20:49:32:498 DEBUG 35212 --- [http-nio-8080-exec-7] c.l.h.mapper.AiModelMapper.selectById    : ==>  Preparing: SELECT id,version,deploy_time,accuracy FROM ai_model WHERE id=?
20:49:32:498 DEBUG 35212 --- [http-nio-8080-exec-7] c.l.h.mapper.AiModelMapper.selectById    : ==> Parameters: 1(Integer)
20:49:32:531 DEBUG 35212 --- [http-nio-8080-exec-7] c.l.h.mapper.AiModelMapper.selectById    : <==      Total: 1
20:49:32:532 DEBUG 35212 --- [http-nio-8080-exec-7] c.l.api.client.FlaskAiDoctorClient       : [FlaskAiDoctorClient#eye_doctor_chat] ---> POST http://ai-service/api/eye-doctor/chat HTTP/1.1
20:49:32:532 DEBUG 35212 --- [http-nio-8080-exec-7] c.l.api.client.FlaskAiDoctorClient       : [FlaskAiDoctorClient#eye_doctor_chat] Content-Length: 753
20:49:32:532 DEBUG 35212 --- [http-nio-8080-exec-7] c.l.api.client.FlaskAiDoctorClient       : [FlaskAiDoctorClient#eye_doctor_chat] Content-Type: application/json
20:49:32:532 DEBUG 35212 --- [http-nio-8080-exec-7] c.l.api.client.FlaskAiDoctorClient       : [FlaskAiDoctorClient#eye_doctor_chat] 
20:49:32:532 DEBUG 35212 --- [http-nio-8080-exec-7] c.l.api.client.FlaskAiDoctorClient       : [FlaskAiDoctorClient#eye_doctor_chat] {"diagnosis_name":"","diagnosis_category":"","result":"A","remark":"A","treatment_plan":{"id":1,"treatmentType":1,"treatmentDetail":"","startTime":"2025-03-01 09:00:00","endDate":"2025-03-10 09:00:00","doctorId":1,"createdTime":"2025-03-01T09:00:00","updatedTime":"2025-03-01T09:00:00"},"medications":[{"id":1,"diagnosisId":1,"medicationName":"A","dosage":"10mg","frequency":"","sideEffects":"","startTime":"2025-03-01T09:00:00","endTime":"2025-03-10T09:00:00","doctorId":1,"createdTime":"2025-03-01 09:00:00","updatedTime":"2025-03-01 09:00:00"}],"previous_conversations":[{"role":"pariatur tempor do","content":"sit cupidatat commodo"}],"question":"irure eu esse","stream":false}
20:49:32:532 DEBUG 35212 --- [http-nio-8080-exec-7] c.l.api.client.FlaskAiDoctorClient       : [FlaskAiDoctorClient#eye_doctor_chat] ---> END HTTP (753-byte body)
20:49:34:570 DEBUG 35212 --- [http-nio-8080-exec-7] c.l.api.client.FlaskAiDoctorClient       : [FlaskAiDoctorClient#eye_doctor_chat] <--- ERROR ConnectException: Failed to connect to /10.21.93.70:8000 (2036ms)
20:49:34:571 DEBUG 35212 --- [http-nio-8080-exec-7] c.l.api.client.FlaskAiDoctorClient       : [FlaskAiDoctorClient#eye_doctor_chat] java.net.ConnectException: Failed to connect to /10.21.93.70:8000
	at okhttp3.internal.connection.RealConnection.connectSocket(RealConnection.kt:297)
	at okhttp3.internal.connection.RealConnection.connect(RealConnection.kt:207)
	at okhttp3.internal.connection.ExchangeFinder.findConnection(ExchangeFinder.kt:226)
	at okhttp3.internal.connection.ExchangeFinder.findHealthyConnection(ExchangeFinder.kt:106)
	at okhttp3.internal.connection.ExchangeFinder.find(ExchangeFinder.kt:74)
	at okhttp3.internal.connection.RealCall.initExchange$okhttp(RealCall.kt:255)
	at okhttp3.internal.connection.ConnectInterceptor.intercept(ConnectInterceptor.kt:32)
	at okhttp3.internal.http.RealInterceptorChain.proceed(RealInterceptorChain.kt:109)
	at okhttp3.internal.cache.CacheInterceptor.intercept(CacheInterceptor.kt:95)
	at okhttp3.internal.http.RealInterceptorChain.proceed(RealInterceptorChain.kt:109)
	at okhttp3.internal.http.BridgeInterceptor.intercept(BridgeInterceptor.kt:83)
	at okhttp3.internal.http.RealInterceptorChain.proceed(RealInterceptorChain.kt:109)
	at okhttp3.internal.http.RetryAndFollowUpInterceptor.intercept(RetryAndFollowUpInterceptor.kt:76)
	at okhttp3.internal.http.RealInterceptorChain.proceed(RealInterceptorChain.kt:109)
	at okhttp3.internal.connection.RealCall.getResponseWithInterceptorChain$okhttp(RealCall.kt:201)
	at okhttp3.internal.connection.RealCall.execute(RealCall.kt:154)
	at feign.okhttp.OkHttpClient.execute(OkHttpClient.java:180)
	at org.springframework.cloud.openfeign.loadbalancer.LoadBalancerUtils.executeWithLoadBalancerLifecycleProcessing(LoadBalancerUtils.java:57)
	at org.springframework.cloud.openfeign.loadbalancer.LoadBalancerUtils.executeWithLoadBalancerLifecycleProcessing(LoadBalancerUtils.java:95)
	at org.springframework.cloud.openfeign.loadbalancer.FeignBlockingLoadBalancerClient.execute(FeignBlockingLoadBalancerClient.java:114)
	at feign.SynchronousMethodHandler.executeAndDecode(SynchronousMethodHandler.java:121)
	at feign.SynchronousMethodHandler.invoke(SynchronousMethodHandler.java:91)
	at feign.ReflectiveFeign$FeignInvocationHandler.invoke(ReflectiveFeign.java:100)
	at jdk.proxy2/jdk.proxy2.$Proxy138.eye_doctor_chat(Unknown Source)
	at com.luojiawei.his_service.controller.ChatController.ask(ChatController.java:39)
	at java.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at java.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:77)
	at java.base/jdk.internal.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.base/java.lang.reflect.Method.invoke(Method.java:568)
	at org.springframework.web.method.support.InvocableHandlerMethod.doInvoke(InvocableHandlerMethod.java:205)
	at org.springframework.web.method.support.InvocableHandlerMethod.invokeForRequest(InvocableHandlerMethod.java:150)
	at org.springframework.web.servlet.mvc.method.annotation.ServletInvocableHandlerMethod.invokeAndHandle(ServletInvocableHandlerMethod.java:117)
	at org.springframework.web.servlet.mvc.method.annotation.RequestMappingHandlerAdapter.invokeHandlerMethod(RequestMappingHandlerAdapter.java:895)
	at org.springframework.web.servlet.mvc.method.annotation.RequestMappingHandlerAdapter.handleInternal(RequestMappingHandlerAdapter.java:808)
	at org.springframework.web.servlet.mvc.method.AbstractHandlerMethodAdapter.handle(AbstractHandlerMethodAdapter.java:87)
	at org.springframework.web.servlet.DispatcherServlet.doDispatch(DispatcherServlet.java:1072)
	at org.springframework.web.servlet.DispatcherServlet.doService(DispatcherServlet.java:965)
	at org.springframework.web.servlet.FrameworkServlet.processRequest(FrameworkServlet.java:1006)
	at org.springframework.web.servlet.FrameworkServlet.doPost(FrameworkServlet.java:909)
	at javax.servlet.http.HttpServlet.service(HttpServlet.java:555)
	at org.springframework.web.servlet.FrameworkServlet.service(FrameworkServlet.java:883)
	at javax.servlet.http.HttpServlet.service(HttpServlet.java:623)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:209)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:153)
	at com.luojiawei.his_service.filter.RefreshTokenFilter.doFilterInternal(RefreshTokenFilter.java:58)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:117)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:178)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:153)
	at org.springframework.web.filter.RequestContextFilter.doFilterInternal(RequestContextFilter.java:100)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:117)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:178)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:153)
	at org.springframework.web.filter.FormContentFilter.doFilterInternal(FormContentFilter.java:93)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:117)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:178)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:153)
	at org.springframework.boot.actuate.metrics.web.servlet.WebMvcMetricsFilter.doFilterInternal(WebMvcMetricsFilter.java:96)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:117)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:178)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:153)
	at org.springframework.web.filter.CharacterEncodingFilter.doFilterInternal(CharacterEncodingFilter.java:201)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:117)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:178)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:153)
	at org.apache.catalina.core.StandardWrapperValve.invoke(StandardWrapperValve.java:167)
	at org.apache.catalina.core.StandardContextValve.invoke(StandardContextValve.java:90)
	at org.apache.catalina.authenticator.AuthenticatorBase.invoke(AuthenticatorBase.java:481)
	at org.apache.catalina.core.StandardHostValve.invoke(StandardHostValve.java:130)
	at org.apache.catalina.valves.ErrorReportValve.invoke(ErrorReportValve.java:93)
	at org.apache.catalina.core.StandardEngineValve.invoke(StandardEngineValve.java:74)
	at org.apache.catalina.connector.CoyoteAdapter.service(CoyoteAdapter.java:343)
	at org.apache.coyote.http11.Http11Processor.service(Http11Processor.java:390)
	at org.apache.coyote.AbstractProcessorLight.process(AbstractProcessorLight.java:63)
	at org.apache.coyote.AbstractProtocol$ConnectionHandler.process(AbstractProtocol.java:926)
	at org.apache.tomcat.util.net.NioEndpoint$SocketProcessor.doRun(NioEndpoint.java:1791)
	at org.apache.tomcat.util.net.SocketProcessorBase.run(SocketProcessorBase.java:52)
	at org.apache.tomcat.util.threads.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1191)
	at org.apache.tomcat.util.threads.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:659)
	at org.apache.tomcat.util.threads.TaskThread$WrappingRunnable.run(TaskThread.java:61)
	at java.base/java.lang.Thread.run(Thread.java:840)
Caused by: java.net.ConnectException: Connection refused: getsockopt
	at java.base/sun.nio.ch.Net.pollConnect(Native Method)
	at java.base/sun.nio.ch.Net.pollConnectNow(Net.java:672)
	at java.base/sun.nio.ch.NioSocketImpl.timedFinishConnect(NioSocketImpl.java:554)
	at java.base/sun.nio.ch.NioSocketImpl.connect(NioSocketImpl.java:602)
	at java.base/java.net.SocksSocketImpl.connect(SocksSocketImpl.java:327)
	at java.base/java.net.Socket.connect(Socket.java:633)
	at okhttp3.internal.platform.Platform.connectSocket(Platform.kt:128)
	at okhttp3.internal.connection.RealConnection.connectSocket(RealConnection.kt:295)
	... 79 more

20:49:34:571 DEBUG 35212 --- [http-nio-8080-exec-7] c.l.api.client.FlaskAiDoctorClient       : [FlaskAiDoctorClient#eye_doctor_chat] <--- END ERROR
20:49:34:573 ERROR 35212 --- [http-nio-8080-exec-7] o.a.c.c.C.[.[.[/].[dispatcherServlet]    : Servlet.service() for servlet [dispatcherServlet] in context with path [] threw exception [Request processing failed; nested exception is feign.RetryableException: Failed to connect to /10.21.93.70:8000 executing POST http://ai-service/api/eye-doctor/chat] with root cause

java.net.ConnectException: Connection refused: getsockopt
	at java.base/sun.nio.ch.Net.pollConnect(Native Method) ~[na:na]
	at java.base/sun.nio.ch.Net.pollConnectNow(Net.java:672) ~[na:na]
	at java.base/sun.nio.ch.NioSocketImpl.timedFinishConnect(NioSocketImpl.java:554) ~[na:na]
	at java.base/sun.nio.ch.NioSocketImpl.connect(NioSocketImpl.java:602) ~[na:na]
	at java.base/java.net.SocksSocketImpl.connect(SocksSocketImpl.java:327) ~[na:na]
	at java.base/java.net.Socket.connect(Socket.java:633) ~[na:na]
	at okhttp3.internal.platform.Platform.connectSocket(Platform.kt:128) ~[okhttp-4.9.3.jar:na]
	at okhttp3.internal.connection.RealConnection.connectSocket(RealConnection.kt:295) ~[okhttp-4.9.3.jar:na]
	at okhttp3.internal.connection.RealConnection.connect(RealConnection.kt:207) ~[okhttp-4.9.3.jar:na]
	at okhttp3.internal.connection.ExchangeFinder.findConnection(ExchangeFinder.kt:226) ~[okhttp-4.9.3.jar:na]
	at okhttp3.internal.connection.ExchangeFinder.findHealthyConnection(ExchangeFinder.kt:106) ~[okhttp-4.9.3.jar:na]
	at okhttp3.internal.connection.ExchangeFinder.find(ExchangeFinder.kt:74) ~[okhttp-4.9.3.jar:na]
	at okhttp3.internal.connection.RealCall.initExchange$okhttp(RealCall.kt:255) ~[okhttp-4.9.3.jar:na]
	at okhttp3.internal.connection.ConnectInterceptor.intercept(ConnectInterceptor.kt:32) ~[okhttp-4.9.3.jar:na]
	at okhttp3.internal.http.RealInterceptorChain.proceed(RealInterceptorChain.kt:109) ~[okhttp-4.9.3.jar:na]
	at okhttp3.internal.cache.CacheInterceptor.intercept(CacheInterceptor.kt:95) ~[okhttp-4.9.3.jar:na]
	at okhttp3.internal.http.RealInterceptorChain.proceed(RealInterceptorChain.kt:109) ~[okhttp-4.9.3.jar:na]
	at okhttp3.internal.http.BridgeInterceptor.intercept(BridgeInterceptor.kt:83) ~[okhttp-4.9.3.jar:na]
	at okhttp3.internal.http.RealInterceptorChain.proceed(RealInterceptorChain.kt:109) ~[okhttp-4.9.3.jar:na]
	at okhttp3.internal.http.RetryAndFollowUpInterceptor.intercept(RetryAndFollowUpInterceptor.kt:76) ~[okhttp-4.9.3.jar:na]
	at okhttp3.internal.http.RealInterceptorChain.proceed(RealInterceptorChain.kt:109) ~[okhttp-4.9.3.jar:na]
	at okhttp3.internal.connection.RealCall.getResponseWithInterceptorChain$okhttp(RealCall.kt:201) ~[okhttp-4.9.3.jar:na]
	at okhttp3.internal.connection.RealCall.execute(RealCall.kt:154) ~[okhttp-4.9.3.jar:na]
	at feign.okhttp.OkHttpClient.execute(OkHttpClient.java:180) ~[feign-okhttp-11.10.jar:na]
	at org.springframework.cloud.openfeign.loadbalancer.LoadBalancerUtils.executeWithLoadBalancerLifecycleProcessing(LoadBalancerUtils.java:57) ~[spring-cloud-openfeign-core-3.1.5.jar:3.1.5]
	at org.springframework.cloud.openfeign.loadbalancer.LoadBalancerUtils.executeWithLoadBalancerLifecycleProcessing(LoadBalancerUtils.java:95) ~[spring-cloud-openfeign-core-3.1.5.jar:3.1.5]
	at org.springframework.cloud.openfeign.loadbalancer.FeignBlockingLoadBalancerClient.execute(FeignBlockingLoadBalancerClient.java:114) ~[spring-cloud-openfeign-core-3.1.5.jar:3.1.5]
	at feign.SynchronousMethodHandler.executeAndDecode(SynchronousMethodHandler.java:121) ~[feign-core-11.10.jar:na]
	at feign.SynchronousMethodHandler.invoke(SynchronousMethodHandler.java:91) ~[feign-core-11.10.jar:na]
	at feign.ReflectiveFeign$FeignInvocationHandler.invoke(ReflectiveFeign.java:100) ~[feign-core-11.10.jar:na]
	at jdk.proxy2/jdk.proxy2.$Proxy138.eye_doctor_chat(Unknown Source) ~[na:na]
	at com.luojiawei.his_service.controller.ChatController.ask(ChatController.java:39) ~[classes/:na]
	at java.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke0(Native Method) ~[na:na]
	at java.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:77) ~[na:na]
	at java.base/jdk.internal.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43) ~[na:na]
	at java.base/java.lang.reflect.Method.invoke(Method.java:568) ~[na:na]
	at org.springframework.web.method.support.InvocableHandlerMethod.doInvoke(InvocableHandlerMethod.java:205) ~[spring-web-5.3.27.jar:5.3.27]
	at org.springframework.web.method.support.InvocableHandlerMethod.invokeForRequest(InvocableHandlerMethod.java:150) ~[spring-web-5.3.27.jar:5.3.27]
	at org.springframework.web.servlet.mvc.method.annotation.ServletInvocableHandlerMethod.invokeAndHandle(ServletInvocableHandlerMethod.java:117) ~[spring-webmvc-5.3.27.jar:5.3.27]
	at org.springframework.web.servlet.mvc.method.annotation.RequestMappingHandlerAdapter.invokeHandlerMethod(RequestMappingHandlerAdapter.java:895) ~[spring-webmvc-5.3.27.jar:5.3.27]
	at org.springframework.web.servlet.mvc.method.annotation.RequestMappingHandlerAdapter.handleInternal(RequestMappingHandlerAdapter.java:808) ~[spring-webmvc-5.3.27.jar:5.3.27]
	at org.springframework.web.servlet.mvc.method.AbstractHandlerMethodAdapter.handle(AbstractHandlerMethodAdapter.java:87) ~[spring-webmvc-5.3.27.jar:5.3.27]
	at org.springframework.web.servlet.DispatcherServlet.doDispatch(DispatcherServlet.java:1072) ~[spring-webmvc-5.3.27.jar:5.3.27]
	at org.springframework.web.servlet.DispatcherServlet.doService(DispatcherServlet.java:965) ~[spring-webmvc-5.3.27.jar:5.3.27]
	at org.springframework.web.servlet.FrameworkServlet.processRequest(FrameworkServlet.java:1006) ~[spring-webmvc-5.3.27.jar:5.3.27]
	at org.springframework.web.servlet.FrameworkServlet.doPost(FrameworkServlet.java:909) ~[spring-webmvc-5.3.27.jar:5.3.27]
	at javax.servlet.http.HttpServlet.service(HttpServlet.java:555) ~[tomcat-embed-core-9.0.75.jar:4.0.FR]
	at org.springframework.web.servlet.FrameworkServlet.service(FrameworkServlet.java:883) ~[spring-webmvc-5.3.27.jar:5.3.27]
	at javax.servlet.http.HttpServlet.service(HttpServlet.java:623) ~[tomcat-embed-core-9.0.75.jar:4.0.FR]
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:209) ~[tomcat-embed-core-9.0.75.jar:9.0.75]
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:153) ~[tomcat-embed-core-9.0.75.jar:9.0.75]
	at com.luojiawei.his_service.filter.RefreshTokenFilter.doFilterInternal(RefreshTokenFilter.java:58) ~[classes/:na]
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:117) ~[spring-web-5.3.27.jar:5.3.27]
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:178) ~[tomcat-embed-core-9.0.75.jar:9.0.75]
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:153) ~[tomcat-embed-core-9.0.75.jar:9.0.75]
	at org.springframework.web.filter.RequestContextFilter.doFilterInternal(RequestContextFilter.java:100) ~[spring-web-5.3.27.jar:5.3.27]
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:117) ~[spring-web-5.3.27.jar:5.3.27]
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:178) ~[tomcat-embed-core-9.0.75.jar:9.0.75]
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:153) ~[tomcat-embed-core-9.0.75.jar:9.0.75]
	at org.springframework.web.filter.FormContentFilter.doFilterInternal(FormContentFilter.java:93) ~[spring-web-5.3.27.jar:5.3.27]
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:117) ~[spring-web-5.3.27.jar:5.3.27]
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:178) ~[tomcat-embed-core-9.0.75.jar:9.0.75]
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:153) ~[tomcat-embed-core-9.0.75.jar:9.0.75]
	at org.springframework.boot.actuate.metrics.web.servlet.WebMvcMetricsFilter.doFilterInternal(WebMvcMetricsFilter.java:96) ~[spring-boot-actuator-2.7.12.jar:2.7.12]
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:117) ~[spring-web-5.3.27.jar:5.3.27]
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:178) ~[tomcat-embed-core-9.0.75.jar:9.0.75]
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:153) ~[tomcat-embed-core-9.0.75.jar:9.0.75]
	at org.springframework.web.filter.CharacterEncodingFilter.doFilterInternal(CharacterEncodingFilter.java:201) ~[spring-web-5.3.27.jar:5.3.27]
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:117) ~[spring-web-5.3.27.jar:5.3.27]
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:178) ~[tomcat-embed-core-9.0.75.jar:9.0.75]
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:153) ~[tomcat-embed-core-9.0.75.jar:9.0.75]
	at org.apache.catalina.core.StandardWrapperValve.invoke(StandardWrapperValve.java:167) ~[tomcat-embed-core-9.0.75.jar:9.0.75]
	at org.apache.catalina.core.StandardContextValve.invoke(StandardContextValve.java:90) ~[tomcat-embed-core-9.0.75.jar:9.0.75]
	at org.apache.catalina.authenticator.AuthenticatorBase.invoke(AuthenticatorBase.java:481) ~[tomcat-embed-core-9.0.75.jar:9.0.75]
	at org.apache.catalina.core.StandardHostValve.invoke(StandardHostValve.java:130) ~[tomcat-embed-core-9.0.75.jar:9.0.75]
	at org.apache.catalina.valves.ErrorReportValve.invoke(ErrorReportValve.java:93) ~[tomcat-embed-core-9.0.75.jar:9.0.75]
	at org.apache.catalina.core.StandardEngineValve.invoke(StandardEngineValve.java:74) ~[tomcat-embed-core-9.0.75.jar:9.0.75]
	at org.apache.catalina.connector.CoyoteAdapter.service(CoyoteAdapter.java:343) ~[tomcat-embed-core-9.0.75.jar:9.0.75]
	at org.apache.coyote.http11.Http11Processor.service(Http11Processor.java:390) ~[tomcat-embed-core-9.0.75.jar:9.0.75]
	at org.apache.coyote.AbstractProcessorLight.process(AbstractProcessorLight.java:63) ~[tomcat-embed-core-9.0.75.jar:9.0.75]
	at org.apache.coyote.AbstractProtocol$ConnectionHandler.process(AbstractProtocol.java:926) ~[tomcat-embed-core-9.0.75.jar:9.0.75]
	at org.apache.tomcat.util.net.NioEndpoint$SocketProcessor.doRun(NioEndpoint.java:1791) ~[tomcat-embed-core-9.0.75.jar:9.0.75]
	at org.apache.tomcat.util.net.SocketProcessorBase.run(SocketProcessorBase.java:52) ~[tomcat-embed-core-9.0.75.jar:9.0.75]
	at org.apache.tomcat.util.threads.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1191) ~[tomcat-embed-core-9.0.75.jar:9.0.75]
	at org.apache.tomcat.util.threads.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:659) ~[tomcat-embed-core-9.0.75.jar:9.0.75]
	at org.apache.tomcat.util.threads.TaskThread$WrappingRunnable.run(TaskThread.java:61) ~[tomcat-embed-core-9.0.75.jar:9.0.75]
	at java.base/java.lang.Thread.run(Thread.java:840) ~[na:na]

20:51:33:853  WARN 35212 --- [Thread-15] c.a.nacos.common.notify.NotifyCenter     : [NotifyCenter] Start destroying Publisher
20:51:33:854  WARN 35212 --- [Thread-15] c.a.nacos.common.notify.NotifyCenter     : [NotifyCenter] Destruction of the end
20:51:33:868  WARN 35212 --- [Thread-18] c.a.n.common.http.HttpClientBeanHolder   : [HttpClientBeanHolder] Start destroying common HttpClient
20:51:33:878  WARN 35212 --- [Thread-18] c.a.n.common.http.HttpClientBeanHolder   : [HttpClientBeanHolder] Destruction of the end
20:51:34:132  INFO 35212 --- [SpringApplicationShutdownHook] c.a.c.n.registry.NacosServiceRegistry    : De-registering from Nacos Server now...
20:51:35:685  INFO 35212 --- [SpringApplicationShutdownHook] c.a.c.n.registry.NacosServiceRegistry    : De-registration finished.
20:51:35:765  INFO 35212 --- [SpringApplicationShutdownHook] com.zaxxer.hikari.HikariDataSource       : HikariPool-1 - Shutdown initiated...
20:51:36:077  INFO 35212 --- [SpringApplicationShutdownHook] com.zaxxer.hikari.HikariDataSource       : HikariPool-1 - Shutdown completed.
20:51:41:351  INFO 33984 --- [main] c.l.his_service.HisServiceApplication    : Starting HisServiceApplication using Java 17.0.11 on luo with PID 33984 (A:\Desktop\workspace\HIS\his_service\target\classes started by 22407 in A:\Desktop\workspace\HIS)
20:51:41:353 DEBUG 33984 --- [main] c.l.his_service.HisServiceApplication    : Running with Spring Boot v2.7.12, Spring v5.3.27
20:51:41:353  INFO 33984 --- [main] c.l.his_service.HisServiceApplication    : The following 1 profile is active: "dev"
20:51:42:217 DEBUG 33984 --- [main] o.s.c.openfeign.FeignClientsRegistrar$1  : Identified candidate component class: file [A:\Desktop\workspace\HIS\his_api\target\classes\com\luojiawei\api\client\FlaskAiDoctorClient.class]
20:51:42:219 DEBUG 33984 --- [main] o.s.c.openfeign.FeignClientsRegistrar$1  : Identified candidate component class: file [A:\Desktop\workspace\HIS\his_api\target\classes\com\luojiawei\api\client\FlaskModelAnalyzeClient.class]
20:51:42:221 DEBUG 33984 --- [main] o.s.c.openfeign.FeignClientsRegistrar$1  : Identified candidate component class: file [A:\Desktop\workspace\HIS\his_api\target\classes\com\luojiawei\api\client\FlaskUploadClient.class]
20:51:42:551  INFO 33984 --- [main] .s.d.r.c.RepositoryConfigurationDelegate : Multiple Spring Data modules found, entering strict repository configuration mode
20:51:42:554  INFO 33984 --- [main] .s.d.r.c.RepositoryConfigurationDelegate : Bootstrapping Spring Data Redis repositories in DEFAULT mode.
20:51:42:582  INFO 33984 --- [main] .s.d.r.c.RepositoryConfigurationDelegate : Finished Spring Data repository scanning in 15 ms. Found 0 Redis repository interfaces.
20:51:42:863  INFO 33984 --- [main] o.s.cloud.context.scope.GenericScope     : BeanFactory id=93ec073a-d50a-3e20-8556-fa3097b20012
20:51:44:441  INFO 33984 --- [main] o.s.b.w.embedded.tomcat.TomcatWebServer  : Tomcat initialized with port(s): 8080 (http)
20:51:44:489  INFO 33984 --- [main] o.apache.catalina.core.StandardService   : Starting service [Tomcat]
20:51:44:490  INFO 33984 --- [main] org.apache.catalina.core.StandardEngine  : Starting Servlet engine: [Apache Tomcat/9.0.75]
20:51:44:759  INFO 33984 --- [main] o.a.c.c.C.[Tomcat].[localhost].[/]       : Initializing Spring embedded WebApplicationContext
20:51:44:759  INFO 33984 --- [main] w.s.c.ServletWebServerApplicationContext : Root WebApplicationContext: initialization completed in 3360 ms
20:51:45:189  INFO 33984 --- [main] org.redisson.Version                     : Redisson 3.17.7
20:51:45:681  INFO 33984 --- [redisson-netty-2-9] o.r.c.pool.MasterPubSubConnectionPool    : 1 connections initialized for 111.230.32.147/111.230.32.147:9631
20:51:46:373  INFO 33984 --- [redisson-netty-2-19] o.r.c.pool.MasterConnectionPool          : 24 connections initialized for 111.230.32.147/111.230.32.147:9631
20:51:46:906 DEBUG 33984 --- [main] c.l.h.filter.RefreshTokenFilter          : Filter 'refreshTokenFilter' configured for use
20:51:47:780  INFO 33984 --- [main] o.s.c.openfeign.FeignClientFactoryBean   : For 'flask-service' URL not provided. Will try picking an instance via load-balancing.
20:51:48:129  INFO 33984 --- [main] o.s.c.openfeign.FeignClientFactoryBean   : For 'ai-service' URL not provided. Will try picking an instance via load-balancing.
20:51:48:182  WARN 33984 --- [main] c.b.m.core.metadata.TableInfoHelper      : Can not find table primary key in Class: "java.lang.Object".
20:51:48:182  WARN 33984 --- [main] c.b.m.core.injector.DefaultSqlInjector   : class java.lang.Object ,Not found @TableId annotation, Cannot use Mybatis-Plus 'xxById' Method.
20:51:49:744  WARN 33984 --- [main] iguration$LoadBalancerCaffeineWarnLogger : Spring Cloud LoadBalancer is currently working with the default cache. While this cache implementation is useful for development and tests, it's recommended to use Caffeine cache in production.You can switch to using Caffeine cache, by adding it and org.springframework.cache.caffeine.CaffeineCacheManager to the classpath.
20:51:49:748  INFO 33984 --- [main] o.s.b.a.e.web.EndpointLinksResolver      : Exposing 1 endpoint(s) beneath base path '/actuator'
20:51:49:846  INFO 33984 --- [main] o.s.b.w.embedded.tomcat.TomcatWebServer  : Tomcat started on port(s): 8080 (http) with context path ''
20:51:49:899  INFO 33984 --- [main] c.a.n.p.a.s.c.ClientAuthPluginManager    : [ClientAuthPluginManager] Load ClientAuthService com.alibaba.nacos.client.auth.impl.NacosClientAuthServiceImpl success.
20:51:49:899  INFO 33984 --- [main] c.a.n.p.a.s.c.ClientAuthPluginManager    : [ClientAuthPluginManager] Load ClientAuthService com.alibaba.nacos.client.auth.ram.RamClientAuthServiceImpl success.
20:51:51:713  INFO 33984 --- [main] c.a.n.c.a.AbstractAbilityControlManager  : Ready to get current node abilities...
20:51:51:714  INFO 33984 --- [main] c.a.n.c.a.AbstractAbilityControlManager  : Ready to initialize current node abilities, support modes: [SDK_CLIENT]
20:51:51:715  INFO 33984 --- [main] c.a.n.c.a.AbstractAbilityControlManager  : Initialize current abilities finish...
20:51:51:715  INFO 33984 --- [main] c.a.n.c.a.d.NacosAbilityManagerHolder    : [AbilityControlManager] Successfully initialize AbilityControlManager
20:51:51:837  INFO 33984 --- [main] c.a.c.n.registry.NacosServiceRegistry    : nacos registry, DEFAULT_GROUP his-service 10.21.93.70:8080 register finished
20:51:52:135  INFO 33984 --- [main] c.l.his_service.HisServiceApplication    : Started HisServiceApplication in 11.916 seconds (JVM running for 13.099)
20:51:52:543  INFO 33984 --- [RMI TCP Connection(2)-10.21.93.70] o.a.c.c.C.[Tomcat].[localhost].[/]       : Initializing Spring DispatcherServlet 'dispatcherServlet'
20:51:52:544  INFO 33984 --- [RMI TCP Connection(2)-10.21.93.70] o.s.web.servlet.DispatcherServlet        : Initializing Servlet 'dispatcherServlet'
20:51:52:545  INFO 33984 --- [RMI TCP Connection(2)-10.21.93.70] o.s.web.servlet.DispatcherServlet        : Completed initialization in 1 ms
20:51:52:565  INFO 33984 --- [RMI TCP Connection(3)-10.21.93.70] com.zaxxer.hikari.HikariDataSource       : HikariPool-1 - Starting...
20:51:53:139  INFO 33984 --- [RMI TCP Connection(3)-10.21.93.70] com.zaxxer.hikari.HikariDataSource       : HikariPool-1 - Start completed.
20:52:01:131 DEBUG 33984 --- [http-nio-8080-exec-2] c.l.h.m.D.selectById                     : ==>  Preparing: SELECT id,patient_id,doctor_id,disease_name,disease_category,aimodel_id,result,create_time,status,id_card,name,score,remark FROM diagnosis_report WHERE id=?
20:52:01:165 DEBUG 33984 --- [http-nio-8080-exec-2] c.l.h.m.D.selectById                     : ==> Parameters: 1(Integer)
20:52:01:241 DEBUG 33984 --- [http-nio-8080-exec-2] c.l.h.m.D.selectById                     : <==      Total: 1
20:52:01:243 DEBUG 33984 --- [http-nio-8080-exec-2] c.l.h.mapper.PatientMapper.selectById    : ==>  Preparing: SELECT id,phone,id_card,name,verified,verified_by,verified_time,open_id,hospital_pid FROM patient WHERE id=?
20:52:01:244 DEBUG 33984 --- [http-nio-8080-exec-2] c.l.h.mapper.PatientMapper.selectById    : ==> Parameters: 1(Integer)
20:52:01:279 DEBUG 33984 --- [http-nio-8080-exec-2] c.l.h.mapper.PatientMapper.selectById    : <==      Total: 1
20:52:01:284 DEBUG 33984 --- [http-nio-8080-exec-2] c.l.h.mapper.DoctorMapper.selectById     : ==>  Preparing: SELECT id,phone,id_card,name,verified,verified_by,verified_time,license,department,hospital_pid FROM doctor WHERE id=?
20:52:01:284 DEBUG 33984 --- [http-nio-8080-exec-2] c.l.h.mapper.DoctorMapper.selectById     : ==> Parameters: 1(Integer)
20:52:01:319 DEBUG 33984 --- [http-nio-8080-exec-2] c.l.h.mapper.DoctorMapper.selectById     : <==      Total: 1
20:52:01:325 DEBUG 33984 --- [http-nio-8080-exec-2] c.l.h.m.E.selectListByDiagnosisId        : ==>  Preparing: select * from eye_images where dignosis_report_id = ?
20:52:01:326 DEBUG 33984 --- [http-nio-8080-exec-2] c.l.h.m.E.selectListByDiagnosisId        : ==> Parameters: 1(Integer)
20:52:01:360 DEBUG 33984 --- [http-nio-8080-exec-2] c.l.h.m.E.selectListByDiagnosisId        : <==      Total: 1
20:52:01:361 DEBUG 33984 --- [http-nio-8080-exec-2] c.l.h.m.T.selectByDiagnosisId            : ==>  Preparing: select * from treatment_plans where diagnosis_id = ?
20:52:01:361 DEBUG 33984 --- [http-nio-8080-exec-2] c.l.h.m.T.selectByDiagnosisId            : ==> Parameters: 1(Integer)
20:52:01:395 DEBUG 33984 --- [http-nio-8080-exec-2] c.l.h.m.T.selectByDiagnosisId            : <==      Total: 1
20:52:01:396 DEBUG 33984 --- [http-nio-8080-exec-2] c.l.h.m.M.selectByDiagnosisId            : ==>  Preparing: select * from medication_recommendations where diagnosis_id = ?
20:52:01:396 DEBUG 33984 --- [http-nio-8080-exec-2] c.l.h.m.M.selectByDiagnosisId            : ==> Parameters: 1(Integer)
20:52:01:432 DEBUG 33984 --- [http-nio-8080-exec-2] c.l.h.m.M.selectByDiagnosisId            : <==      Total: 1
20:52:01:433 DEBUG 33984 --- [http-nio-8080-exec-2] c.l.h.mapper.AiModelMapper.selectById    : ==>  Preparing: SELECT id,version,deploy_time,accuracy FROM ai_model WHERE id=?
20:52:01:433 DEBUG 33984 --- [http-nio-8080-exec-2] c.l.h.mapper.AiModelMapper.selectById    : ==> Parameters: 1(Integer)
20:52:01:468 DEBUG 33984 --- [http-nio-8080-exec-2] c.l.h.mapper.AiModelMapper.selectById    : <==      Total: 1
20:52:01:507 DEBUG 33984 --- [http-nio-8080-exec-2] o.s.c.openfeign.support.SpringEncoder    : Writing [ChatForm(diseaseName=, diseaseCategory=, result=A, remark=A, treatmentPlan=TreatmentPlans(id=1, diagnosisId=1, treatmentType=1, treatmentDetail=, startTime=2025-03-01T09:00, endDate=2025-03-10T09:00, doctorId=1, createdTime=2025-03-01T09:00, updatedTime=2025-03-01T09:00), medications=[MedicationRecommendations(id=1, diagnosisId=1, medicationName=A, dosage=10mg, frequency=, sideEffects=, startTime=2025-03-01T09:00, endTime=2025-03-10T09:00, doctorId=1, createdTime=2025-03-01T09:00, updatedTime=2025-03-01T09:00)], previousConversations=[DialogueInfo(role=pariatur tempor do, content=sit cupidatat commodo)], question=irure eu esse, stream=false)] using [org.springframework.http.converter.json.MappingJackson2HttpMessageConverter@3bf40c74]
20:52:01:529 DEBUG 33984 --- [http-nio-8080-exec-2] c.l.api.client.FlaskAiDoctorClient       : [FlaskAiDoctorClient#eye_doctor_chat] ---> POST http://ai-service/api/eye-doctor/chat HTTP/1.1
20:52:01:529 DEBUG 33984 --- [http-nio-8080-exec-2] c.l.api.client.FlaskAiDoctorClient       : [FlaskAiDoctorClient#eye_doctor_chat] Content-Length: 753
20:52:01:529 DEBUG 33984 --- [http-nio-8080-exec-2] c.l.api.client.FlaskAiDoctorClient       : [FlaskAiDoctorClient#eye_doctor_chat] Content-Type: application/json
20:52:01:530 DEBUG 33984 --- [http-nio-8080-exec-2] c.l.api.client.FlaskAiDoctorClient       : [FlaskAiDoctorClient#eye_doctor_chat] 
20:52:01:530 DEBUG 33984 --- [http-nio-8080-exec-2] c.l.api.client.FlaskAiDoctorClient       : [FlaskAiDoctorClient#eye_doctor_chat] {"diagnosis_name":"","diagnosis_category":"","result":"A","remark":"A","treatment_plan":{"id":1,"treatmentType":1,"treatmentDetail":"","startTime":"2025-03-01 09:00:00","endDate":"2025-03-10 09:00:00","doctorId":1,"createdTime":"2025-03-01T09:00:00","updatedTime":"2025-03-01T09:00:00"},"medications":[{"id":1,"diagnosisId":1,"medicationName":"A","dosage":"10mg","frequency":"","sideEffects":"","startTime":"2025-03-01T09:00:00","endTime":"2025-03-10T09:00:00","doctorId":1,"createdTime":"2025-03-01 09:00:00","updatedTime":"2025-03-01 09:00:00"}],"previous_conversations":[{"role":"pariatur tempor do","content":"sit cupidatat commodo"}],"question":"irure eu esse","stream":false}
20:52:01:530 DEBUG 33984 --- [http-nio-8080-exec-2] c.l.api.client.FlaskAiDoctorClient       : [FlaskAiDoctorClient#eye_doctor_chat] ---> END HTTP (753-byte body)
20:52:04:454 DEBUG 33984 --- [http-nio-8080-exec-2] c.l.api.client.FlaskAiDoctorClient       : [FlaskAiDoctorClient#eye_doctor_chat] <--- ERROR ConnectException: Failed to connect to /10.21.93.70:8000 (2922ms)
20:52:04:455 DEBUG 33984 --- [http-nio-8080-exec-2] c.l.api.client.FlaskAiDoctorClient       : [FlaskAiDoctorClient#eye_doctor_chat] java.net.ConnectException: Failed to connect to /10.21.93.70:8000
	at okhttp3.internal.connection.RealConnection.connectSocket(RealConnection.kt:297)
	at okhttp3.internal.connection.RealConnection.connect(RealConnection.kt:207)
	at okhttp3.internal.connection.ExchangeFinder.findConnection(ExchangeFinder.kt:226)
	at okhttp3.internal.connection.ExchangeFinder.findHealthyConnection(ExchangeFinder.kt:106)
	at okhttp3.internal.connection.ExchangeFinder.find(ExchangeFinder.kt:74)
	at okhttp3.internal.connection.RealCall.initExchange$okhttp(RealCall.kt:255)
	at okhttp3.internal.connection.ConnectInterceptor.intercept(ConnectInterceptor.kt:32)
	at okhttp3.internal.http.RealInterceptorChain.proceed(RealInterceptorChain.kt:109)
	at okhttp3.internal.cache.CacheInterceptor.intercept(CacheInterceptor.kt:95)
	at okhttp3.internal.http.RealInterceptorChain.proceed(RealInterceptorChain.kt:109)
	at okhttp3.internal.http.BridgeInterceptor.intercept(BridgeInterceptor.kt:83)
	at okhttp3.internal.http.RealInterceptorChain.proceed(RealInterceptorChain.kt:109)
	at okhttp3.internal.http.RetryAndFollowUpInterceptor.intercept(RetryAndFollowUpInterceptor.kt:76)
	at okhttp3.internal.http.RealInterceptorChain.proceed(RealInterceptorChain.kt:109)
	at okhttp3.internal.connection.RealCall.getResponseWithInterceptorChain$okhttp(RealCall.kt:201)
	at okhttp3.internal.connection.RealCall.execute(RealCall.kt:154)
	at feign.okhttp.OkHttpClient.execute(OkHttpClient.java:180)
	at org.springframework.cloud.openfeign.loadbalancer.LoadBalancerUtils.executeWithLoadBalancerLifecycleProcessing(LoadBalancerUtils.java:57)
	at org.springframework.cloud.openfeign.loadbalancer.LoadBalancerUtils.executeWithLoadBalancerLifecycleProcessing(LoadBalancerUtils.java:95)
	at org.springframework.cloud.openfeign.loadbalancer.FeignBlockingLoadBalancerClient.execute(FeignBlockingLoadBalancerClient.java:114)
	at feign.SynchronousMethodHandler.executeAndDecode(SynchronousMethodHandler.java:121)
	at feign.SynchronousMethodHandler.invoke(SynchronousMethodHandler.java:91)
	at feign.ReflectiveFeign$FeignInvocationHandler.invoke(ReflectiveFeign.java:100)
	at jdk.proxy2/jdk.proxy2.$Proxy138.eye_doctor_chat(Unknown Source)
	at com.luojiawei.his_service.controller.ChatController.ask(ChatController.java:39)
	at java.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at java.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:77)
	at java.base/jdk.internal.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.base/java.lang.reflect.Method.invoke(Method.java:568)
	at org.springframework.web.method.support.InvocableHandlerMethod.doInvoke(InvocableHandlerMethod.java:205)
	at org.springframework.web.method.support.InvocableHandlerMethod.invokeForRequest(InvocableHandlerMethod.java:150)
	at org.springframework.web.servlet.mvc.method.annotation.ServletInvocableHandlerMethod.invokeAndHandle(ServletInvocableHandlerMethod.java:117)
	at org.springframework.web.servlet.mvc.method.annotation.RequestMappingHandlerAdapter.invokeHandlerMethod(RequestMappingHandlerAdapter.java:895)
	at org.springframework.web.servlet.mvc.method.annotation.RequestMappingHandlerAdapter.handleInternal(RequestMappingHandlerAdapter.java:808)
	at org.springframework.web.servlet.mvc.method.AbstractHandlerMethodAdapter.handle(AbstractHandlerMethodAdapter.java:87)
	at org.springframework.web.servlet.DispatcherServlet.doDispatch(DispatcherServlet.java:1072)
	at org.springframework.web.servlet.DispatcherServlet.doService(DispatcherServlet.java:965)
	at org.springframework.web.servlet.FrameworkServlet.processRequest(FrameworkServlet.java:1006)
	at org.springframework.web.servlet.FrameworkServlet.doPost(FrameworkServlet.java:909)
	at javax.servlet.http.HttpServlet.service(HttpServlet.java:555)
	at org.springframework.web.servlet.FrameworkServlet.service(FrameworkServlet.java:883)
	at javax.servlet.http.HttpServlet.service(HttpServlet.java:623)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:209)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:153)
	at com.luojiawei.his_service.filter.RefreshTokenFilter.doFilterInternal(RefreshTokenFilter.java:58)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:117)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:178)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:153)
	at org.springframework.web.filter.RequestContextFilter.doFilterInternal(RequestContextFilter.java:100)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:117)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:178)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:153)
	at org.springframework.web.filter.FormContentFilter.doFilterInternal(FormContentFilter.java:93)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:117)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:178)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:153)
	at org.springframework.boot.actuate.metrics.web.servlet.WebMvcMetricsFilter.doFilterInternal(WebMvcMetricsFilter.java:96)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:117)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:178)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:153)
	at org.springframework.web.filter.CharacterEncodingFilter.doFilterInternal(CharacterEncodingFilter.java:201)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:117)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:178)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:153)
	at org.apache.catalina.core.StandardWrapperValve.invoke(StandardWrapperValve.java:167)
	at org.apache.catalina.core.StandardContextValve.invoke(StandardContextValve.java:90)
	at org.apache.catalina.authenticator.AuthenticatorBase.invoke(AuthenticatorBase.java:481)
	at org.apache.catalina.core.StandardHostValve.invoke(StandardHostValve.java:130)
	at org.apache.catalina.valves.ErrorReportValve.invoke(ErrorReportValve.java:93)
	at org.apache.catalina.core.StandardEngineValve.invoke(StandardEngineValve.java:74)
	at org.apache.catalina.connector.CoyoteAdapter.service(CoyoteAdapter.java:343)
	at org.apache.coyote.http11.Http11Processor.service(Http11Processor.java:390)
	at org.apache.coyote.AbstractProcessorLight.process(AbstractProcessorLight.java:63)
	at org.apache.coyote.AbstractProtocol$ConnectionHandler.process(AbstractProtocol.java:926)
	at org.apache.tomcat.util.net.NioEndpoint$SocketProcessor.doRun(NioEndpoint.java:1791)
	at org.apache.tomcat.util.net.SocketProcessorBase.run(SocketProcessorBase.java:52)
	at org.apache.tomcat.util.threads.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1191)
	at org.apache.tomcat.util.threads.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:659)
	at org.apache.tomcat.util.threads.TaskThread$WrappingRunnable.run(TaskThread.java:61)
	at java.base/java.lang.Thread.run(Thread.java:840)
Caused by: java.net.ConnectException: Connection refused: getsockopt
	at java.base/sun.nio.ch.Net.pollConnect(Native Method)
	at java.base/sun.nio.ch.Net.pollConnectNow(Net.java:672)
	at java.base/sun.nio.ch.NioSocketImpl.timedFinishConnect(NioSocketImpl.java:554)
	at java.base/sun.nio.ch.NioSocketImpl.connect(NioSocketImpl.java:602)
	at java.base/java.net.SocksSocketImpl.connect(SocksSocketImpl.java:327)
	at java.base/java.net.Socket.connect(Socket.java:633)
	at okhttp3.internal.platform.Platform.connectSocket(Platform.kt:128)
	at okhttp3.internal.connection.RealConnection.connectSocket(RealConnection.kt:295)
	... 79 more

20:52:04:456 DEBUG 33984 --- [http-nio-8080-exec-2] c.l.api.client.FlaskAiDoctorClient       : [FlaskAiDoctorClient#eye_doctor_chat] <--- END ERROR
20:52:04:471 ERROR 33984 --- [http-nio-8080-exec-2] o.a.c.c.C.[.[.[/].[dispatcherServlet]    : Servlet.service() for servlet [dispatcherServlet] in context with path [] threw exception [Request processing failed; nested exception is feign.RetryableException: Failed to connect to /10.21.93.70:8000 executing POST http://ai-service/api/eye-doctor/chat] with root cause

java.net.ConnectException: Connection refused: getsockopt
	at java.base/sun.nio.ch.Net.pollConnect(Native Method) ~[na:na]
	at java.base/sun.nio.ch.Net.pollConnectNow(Net.java:672) ~[na:na]
	at java.base/sun.nio.ch.NioSocketImpl.timedFinishConnect(NioSocketImpl.java:554) ~[na:na]
	at java.base/sun.nio.ch.NioSocketImpl.connect(NioSocketImpl.java:602) ~[na:na]
	at java.base/java.net.SocksSocketImpl.connect(SocksSocketImpl.java:327) ~[na:na]
	at java.base/java.net.Socket.connect(Socket.java:633) ~[na:na]
	at okhttp3.internal.platform.Platform.connectSocket(Platform.kt:128) ~[okhttp-4.9.3.jar:na]
	at okhttp3.internal.connection.RealConnection.connectSocket(RealConnection.kt:295) ~[okhttp-4.9.3.jar:na]
	at okhttp3.internal.connection.RealConnection.connect(RealConnection.kt:207) ~[okhttp-4.9.3.jar:na]
	at okhttp3.internal.connection.ExchangeFinder.findConnection(ExchangeFinder.kt:226) ~[okhttp-4.9.3.jar:na]
	at okhttp3.internal.connection.ExchangeFinder.findHealthyConnection(ExchangeFinder.kt:106) ~[okhttp-4.9.3.jar:na]
	at okhttp3.internal.connection.ExchangeFinder.find(ExchangeFinder.kt:74) ~[okhttp-4.9.3.jar:na]
	at okhttp3.internal.connection.RealCall.initExchange$okhttp(RealCall.kt:255) ~[okhttp-4.9.3.jar:na]
	at okhttp3.internal.connection.ConnectInterceptor.intercept(ConnectInterceptor.kt:32) ~[okhttp-4.9.3.jar:na]
	at okhttp3.internal.http.RealInterceptorChain.proceed(RealInterceptorChain.kt:109) ~[okhttp-4.9.3.jar:na]
	at okhttp3.internal.cache.CacheInterceptor.intercept(CacheInterceptor.kt:95) ~[okhttp-4.9.3.jar:na]
	at okhttp3.internal.http.RealInterceptorChain.proceed(RealInterceptorChain.kt:109) ~[okhttp-4.9.3.jar:na]
	at okhttp3.internal.http.BridgeInterceptor.intercept(BridgeInterceptor.kt:83) ~[okhttp-4.9.3.jar:na]
	at okhttp3.internal.http.RealInterceptorChain.proceed(RealInterceptorChain.kt:109) ~[okhttp-4.9.3.jar:na]
	at okhttp3.internal.http.RetryAndFollowUpInterceptor.intercept(RetryAndFollowUpInterceptor.kt:76) ~[okhttp-4.9.3.jar:na]
	at okhttp3.internal.http.RealInterceptorChain.proceed(RealInterceptorChain.kt:109) ~[okhttp-4.9.3.jar:na]
	at okhttp3.internal.connection.RealCall.getResponseWithInterceptorChain$okhttp(RealCall.kt:201) ~[okhttp-4.9.3.jar:na]
	at okhttp3.internal.connection.RealCall.execute(RealCall.kt:154) ~[okhttp-4.9.3.jar:na]
	at feign.okhttp.OkHttpClient.execute(OkHttpClient.java:180) ~[feign-okhttp-11.10.jar:na]
	at org.springframework.cloud.openfeign.loadbalancer.LoadBalancerUtils.executeWithLoadBalancerLifecycleProcessing(LoadBalancerUtils.java:57) ~[spring-cloud-openfeign-core-3.1.5.jar:3.1.5]
	at org.springframework.cloud.openfeign.loadbalancer.LoadBalancerUtils.executeWithLoadBalancerLifecycleProcessing(LoadBalancerUtils.java:95) ~[spring-cloud-openfeign-core-3.1.5.jar:3.1.5]
	at org.springframework.cloud.openfeign.loadbalancer.FeignBlockingLoadBalancerClient.execute(FeignBlockingLoadBalancerClient.java:114) ~[spring-cloud-openfeign-core-3.1.5.jar:3.1.5]
	at feign.SynchronousMethodHandler.executeAndDecode(SynchronousMethodHandler.java:121) ~[feign-core-11.10.jar:na]
	at feign.SynchronousMethodHandler.invoke(SynchronousMethodHandler.java:91) ~[feign-core-11.10.jar:na]
	at feign.ReflectiveFeign$FeignInvocationHandler.invoke(ReflectiveFeign.java:100) ~[feign-core-11.10.jar:na]
	at jdk.proxy2/jdk.proxy2.$Proxy138.eye_doctor_chat(Unknown Source) ~[na:na]
	at com.luojiawei.his_service.controller.ChatController.ask(ChatController.java:39) ~[classes/:na]
	at java.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke0(Native Method) ~[na:na]
	at java.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:77) ~[na:na]
	at java.base/jdk.internal.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43) ~[na:na]
	at java.base/java.lang.reflect.Method.invoke(Method.java:568) ~[na:na]
	at org.springframework.web.method.support.InvocableHandlerMethod.doInvoke(InvocableHandlerMethod.java:205) ~[spring-web-5.3.27.jar:5.3.27]
	at org.springframework.web.method.support.InvocableHandlerMethod.invokeForRequest(InvocableHandlerMethod.java:150) ~[spring-web-5.3.27.jar:5.3.27]
	at org.springframework.web.servlet.mvc.method.annotation.ServletInvocableHandlerMethod.invokeAndHandle(ServletInvocableHandlerMethod.java:117) ~[spring-webmvc-5.3.27.jar:5.3.27]
	at org.springframework.web.servlet.mvc.method.annotation.RequestMappingHandlerAdapter.invokeHandlerMethod(RequestMappingHandlerAdapter.java:895) ~[spring-webmvc-5.3.27.jar:5.3.27]
	at org.springframework.web.servlet.mvc.method.annotation.RequestMappingHandlerAdapter.handleInternal(RequestMappingHandlerAdapter.java:808) ~[spring-webmvc-5.3.27.jar:5.3.27]
	at org.springframework.web.servlet.mvc.method.AbstractHandlerMethodAdapter.handle(AbstractHandlerMethodAdapter.java:87) ~[spring-webmvc-5.3.27.jar:5.3.27]
	at org.springframework.web.servlet.DispatcherServlet.doDispatch(DispatcherServlet.java:1072) ~[spring-webmvc-5.3.27.jar:5.3.27]
	at org.springframework.web.servlet.DispatcherServlet.doService(DispatcherServlet.java:965) ~[spring-webmvc-5.3.27.jar:5.3.27]
	at org.springframework.web.servlet.FrameworkServlet.processRequest(FrameworkServlet.java:1006) ~[spring-webmvc-5.3.27.jar:5.3.27]
	at org.springframework.web.servlet.FrameworkServlet.doPost(FrameworkServlet.java:909) ~[spring-webmvc-5.3.27.jar:5.3.27]
	at javax.servlet.http.HttpServlet.service(HttpServlet.java:555) ~[tomcat-embed-core-9.0.75.jar:4.0.FR]
	at org.springframework.web.servlet.FrameworkServlet.service(FrameworkServlet.java:883) ~[spring-webmvc-5.3.27.jar:5.3.27]
	at javax.servlet.http.HttpServlet.service(HttpServlet.java:623) ~[tomcat-embed-core-9.0.75.jar:4.0.FR]
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:209) ~[tomcat-embed-core-9.0.75.jar:9.0.75]
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:153) ~[tomcat-embed-core-9.0.75.jar:9.0.75]
	at com.luojiawei.his_service.filter.RefreshTokenFilter.doFilterInternal(RefreshTokenFilter.java:58) ~[classes/:na]
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:117) ~[spring-web-5.3.27.jar:5.3.27]
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:178) ~[tomcat-embed-core-9.0.75.jar:9.0.75]
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:153) ~[tomcat-embed-core-9.0.75.jar:9.0.75]
	at org.springframework.web.filter.RequestContextFilter.doFilterInternal(RequestContextFilter.java:100) ~[spring-web-5.3.27.jar:5.3.27]
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:117) ~[spring-web-5.3.27.jar:5.3.27]
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:178) ~[tomcat-embed-core-9.0.75.jar:9.0.75]
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:153) ~[tomcat-embed-core-9.0.75.jar:9.0.75]
	at org.springframework.web.filter.FormContentFilter.doFilterInternal(FormContentFilter.java:93) ~[spring-web-5.3.27.jar:5.3.27]
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:117) ~[spring-web-5.3.27.jar:5.3.27]
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:178) ~[tomcat-embed-core-9.0.75.jar:9.0.75]
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:153) ~[tomcat-embed-core-9.0.75.jar:9.0.75]
	at org.springframework.boot.actuate.metrics.web.servlet.WebMvcMetricsFilter.doFilterInternal(WebMvcMetricsFilter.java:96) ~[spring-boot-actuator-2.7.12.jar:2.7.12]
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:117) ~[spring-web-5.3.27.jar:5.3.27]
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:178) ~[tomcat-embed-core-9.0.75.jar:9.0.75]
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:153) ~[tomcat-embed-core-9.0.75.jar:9.0.75]
	at org.springframework.web.filter.CharacterEncodingFilter.doFilterInternal(CharacterEncodingFilter.java:201) ~[spring-web-5.3.27.jar:5.3.27]
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:117) ~[spring-web-5.3.27.jar:5.3.27]
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:178) ~[tomcat-embed-core-9.0.75.jar:9.0.75]
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:153) ~[tomcat-embed-core-9.0.75.jar:9.0.75]
	at org.apache.catalina.core.StandardWrapperValve.invoke(StandardWrapperValve.java:167) ~[tomcat-embed-core-9.0.75.jar:9.0.75]
	at org.apache.catalina.core.StandardContextValve.invoke(StandardContextValve.java:90) ~[tomcat-embed-core-9.0.75.jar:9.0.75]
	at org.apache.catalina.authenticator.AuthenticatorBase.invoke(AuthenticatorBase.java:481) ~[tomcat-embed-core-9.0.75.jar:9.0.75]
	at org.apache.catalina.core.StandardHostValve.invoke(StandardHostValve.java:130) ~[tomcat-embed-core-9.0.75.jar:9.0.75]
	at org.apache.catalina.valves.ErrorReportValve.invoke(ErrorReportValve.java:93) ~[tomcat-embed-core-9.0.75.jar:9.0.75]
	at org.apache.catalina.core.StandardEngineValve.invoke(StandardEngineValve.java:74) ~[tomcat-embed-core-9.0.75.jar:9.0.75]
	at org.apache.catalina.connector.CoyoteAdapter.service(CoyoteAdapter.java:343) ~[tomcat-embed-core-9.0.75.jar:9.0.75]
	at org.apache.coyote.http11.Http11Processor.service(Http11Processor.java:390) ~[tomcat-embed-core-9.0.75.jar:9.0.75]
	at org.apache.coyote.AbstractProcessorLight.process(AbstractProcessorLight.java:63) ~[tomcat-embed-core-9.0.75.jar:9.0.75]
	at org.apache.coyote.AbstractProtocol$ConnectionHandler.process(AbstractProtocol.java:926) ~[tomcat-embed-core-9.0.75.jar:9.0.75]
	at org.apache.tomcat.util.net.NioEndpoint$SocketProcessor.doRun(NioEndpoint.java:1791) ~[tomcat-embed-core-9.0.75.jar:9.0.75]
	at org.apache.tomcat.util.net.SocketProcessorBase.run(SocketProcessorBase.java:52) ~[tomcat-embed-core-9.0.75.jar:9.0.75]
	at org.apache.tomcat.util.threads.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1191) ~[tomcat-embed-core-9.0.75.jar:9.0.75]
	at org.apache.tomcat.util.threads.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:659) ~[tomcat-embed-core-9.0.75.jar:9.0.75]
	at org.apache.tomcat.util.threads.TaskThread$WrappingRunnable.run(TaskThread.java:61) ~[tomcat-embed-core-9.0.75.jar:9.0.75]
	at java.base/java.lang.Thread.run(Thread.java:840) ~[na:na]

20:57:14:754  WARN 33984 --- [http-nio-8080-exec-5] com.zaxxer.hikari.pool.PoolBase          : HikariPool-1 - Failed to validate connection com.mysql.cj.jdbc.ConnectionImpl@20b5692d (No operations allowed after connection closed.). Possibly consider using a shorter maxLifetime value.
20:57:14:761  WARN 33984 --- [http-nio-8080-exec-5] com.zaxxer.hikari.pool.PoolBase          : HikariPool-1 - Failed to validate connection com.mysql.cj.jdbc.ConnectionImpl@18c44daa (No operations allowed after connection closed.). Possibly consider using a shorter maxLifetime value.
20:57:14:762  WARN 33984 --- [http-nio-8080-exec-5] com.zaxxer.hikari.pool.PoolBase          : HikariPool-1 - Failed to validate connection com.mysql.cj.jdbc.ConnectionImpl@1333a39e (No operations allowed after connection closed.). Possibly consider using a shorter maxLifetime value.
20:57:14:764  WARN 33984 --- [http-nio-8080-exec-5] com.zaxxer.hikari.pool.PoolBase          : HikariPool-1 - Failed to validate connection com.mysql.cj.jdbc.ConnectionImpl@7c33f2bc (No operations allowed after connection closed.). Possibly consider using a shorter maxLifetime value.
20:57:14:765  WARN 33984 --- [http-nio-8080-exec-5] com.zaxxer.hikari.pool.PoolBase          : HikariPool-1 - Failed to validate connection com.mysql.cj.jdbc.ConnectionImpl@a6d0e2b (No operations allowed after connection closed.). Possibly consider using a shorter maxLifetime value.
20:57:14:767  WARN 33984 --- [http-nio-8080-exec-5] com.zaxxer.hikari.pool.PoolBase          : HikariPool-1 - Failed to validate connection com.mysql.cj.jdbc.ConnectionImpl@307ebbd1 (No operations allowed after connection closed.). Possibly consider using a shorter maxLifetime value.
20:57:14:768  WARN 33984 --- [http-nio-8080-exec-5] com.zaxxer.hikari.pool.PoolBase          : HikariPool-1 - Failed to validate connection com.mysql.cj.jdbc.ConnectionImpl@3e5fd113 (No operations allowed after connection closed.). Possibly consider using a shorter maxLifetime value.
20:57:14:769  WARN 33984 --- [http-nio-8080-exec-5] com.zaxxer.hikari.pool.PoolBase          : HikariPool-1 - Failed to validate connection com.mysql.cj.jdbc.ConnectionImpl@5d9a7276 (No operations allowed after connection closed.). Possibly consider using a shorter maxLifetime value.
20:57:14:771  WARN 33984 --- [http-nio-8080-exec-5] com.zaxxer.hikari.pool.PoolBase          : HikariPool-1 - Failed to validate connection com.mysql.cj.jdbc.ConnectionImpl@3fe423b8 (No operations allowed after connection closed.). Possibly consider using a shorter maxLifetime value.
20:57:14:773  WARN 33984 --- [http-nio-8080-exec-5] com.zaxxer.hikari.pool.PoolBase          : HikariPool-1 - Failed to validate connection com.mysql.cj.jdbc.ConnectionImpl@7a01a7a6 (No operations allowed after connection closed.). Possibly consider using a shorter maxLifetime value.
20:57:15:207 DEBUG 33984 --- [http-nio-8080-exec-5] c.l.h.m.D.selectById                     : ==>  Preparing: SELECT id,patient_id,doctor_id,disease_name,disease_category,aimodel_id,result,create_time,status,id_card,name,score,remark FROM diagnosis_report WHERE id=?
20:57:15:208 DEBUG 33984 --- [http-nio-8080-exec-5] c.l.h.m.D.selectById                     : ==> Parameters: 1(Integer)
20:57:15:253 DEBUG 33984 --- [http-nio-8080-exec-5] c.l.h.m.D.selectById                     : <==      Total: 1
20:57:15:254 DEBUG 33984 --- [http-nio-8080-exec-5] c.l.h.mapper.PatientMapper.selectById    : ==>  Preparing: SELECT id,phone,id_card,name,verified,verified_by,verified_time,open_id,hospital_pid FROM patient WHERE id=?
20:57:15:254 DEBUG 33984 --- [http-nio-8080-exec-5] c.l.h.mapper.PatientMapper.selectById    : ==> Parameters: 1(Integer)
20:57:15:306 DEBUG 33984 --- [http-nio-8080-exec-5] c.l.h.mapper.PatientMapper.selectById    : <==      Total: 1
20:57:15:307 DEBUG 33984 --- [http-nio-8080-exec-5] c.l.h.mapper.DoctorMapper.selectById     : ==>  Preparing: SELECT id,phone,id_card,name,verified,verified_by,verified_time,license,department,hospital_pid FROM doctor WHERE id=?
20:57:15:307 DEBUG 33984 --- [http-nio-8080-exec-5] c.l.h.mapper.DoctorMapper.selectById     : ==> Parameters: 1(Integer)
20:57:15:403 DEBUG 33984 --- [http-nio-8080-exec-5] c.l.h.mapper.DoctorMapper.selectById     : <==      Total: 1
20:57:15:404 DEBUG 33984 --- [http-nio-8080-exec-5] c.l.h.m.E.selectListByDiagnosisId        : ==>  Preparing: select * from eye_images where dignosis_report_id = ?
20:57:15:404 DEBUG 33984 --- [http-nio-8080-exec-5] c.l.h.m.E.selectListByDiagnosisId        : ==> Parameters: 1(Integer)
20:57:15:450 DEBUG 33984 --- [http-nio-8080-exec-5] c.l.h.m.E.selectListByDiagnosisId        : <==      Total: 1
20:57:15:450 DEBUG 33984 --- [http-nio-8080-exec-5] c.l.h.m.T.selectByDiagnosisId            : ==>  Preparing: select * from treatment_plans where diagnosis_id = ?
20:57:15:451 DEBUG 33984 --- [http-nio-8080-exec-5] c.l.h.m.T.selectByDiagnosisId            : ==> Parameters: 1(Integer)
20:57:15:492 DEBUG 33984 --- [http-nio-8080-exec-5] c.l.h.m.T.selectByDiagnosisId            : <==      Total: 1
20:57:15:493 DEBUG 33984 --- [http-nio-8080-exec-5] c.l.h.m.M.selectByDiagnosisId            : ==>  Preparing: select * from medication_recommendations where diagnosis_id = ?
20:57:15:494 DEBUG 33984 --- [http-nio-8080-exec-5] c.l.h.m.M.selectByDiagnosisId            : ==> Parameters: 1(Integer)
20:57:15:533 DEBUG 33984 --- [http-nio-8080-exec-5] c.l.h.m.M.selectByDiagnosisId            : <==      Total: 1
20:57:15:534 DEBUG 33984 --- [http-nio-8080-exec-5] c.l.h.mapper.AiModelMapper.selectById    : ==>  Preparing: SELECT id,version,deploy_time,accuracy FROM ai_model WHERE id=?
20:57:15:534 DEBUG 33984 --- [http-nio-8080-exec-5] c.l.h.mapper.AiModelMapper.selectById    : ==> Parameters: 1(Integer)
20:57:15:576 DEBUG 33984 --- [http-nio-8080-exec-5] c.l.h.mapper.AiModelMapper.selectById    : <==      Total: 1
20:57:15:582 DEBUG 33984 --- [http-nio-8080-exec-5] o.s.c.openfeign.support.SpringEncoder    : Writing [ChatForm(diseaseName=, diseaseCategory=, result=A, remark=A, treatmentPlan=TreatmentPlans(id=1, diagnosisId=1, treatmentType=1, treatmentDetail=, startTime=2025-03-01T09:00, endDate=2025-03-10T09:00, doctorId=1, createdTime=2025-03-01T09:00, updatedTime=2025-03-01T09:00), medications=[MedicationRecommendations(id=1, diagnosisId=1, medicationName=A, dosage=10mg, frequency=, sideEffects=, startTime=2025-03-01T09:00, endTime=2025-03-10T09:00, doctorId=1, createdTime=2025-03-01T09:00, updatedTime=2025-03-01T09:00)], previousConversations=[DialogueInfo(role=pariatur tempor do, content=sit cupidatat commodo)], question=irure eu esse, stream=false)] using [org.springframework.http.converter.json.MappingJackson2HttpMessageConverter@3bf40c74]
20:57:15:587 DEBUG 33984 --- [http-nio-8080-exec-5] c.l.api.client.FlaskAiDoctorClient       : [FlaskAiDoctorClient#eye_doctor_chat] ---> POST http://ai-service/api/eye-doctor/chat HTTP/1.1
20:57:15:587 DEBUG 33984 --- [http-nio-8080-exec-5] c.l.api.client.FlaskAiDoctorClient       : [FlaskAiDoctorClient#eye_doctor_chat] Content-Length: 753
20:57:15:587 DEBUG 33984 --- [http-nio-8080-exec-5] c.l.api.client.FlaskAiDoctorClient       : [FlaskAiDoctorClient#eye_doctor_chat] Content-Type: application/json
20:57:15:587 DEBUG 33984 --- [http-nio-8080-exec-5] c.l.api.client.FlaskAiDoctorClient       : [FlaskAiDoctorClient#eye_doctor_chat] 
20:57:15:587 DEBUG 33984 --- [http-nio-8080-exec-5] c.l.api.client.FlaskAiDoctorClient       : [FlaskAiDoctorClient#eye_doctor_chat] {"diagnosis_name":"","diagnosis_category":"","result":"A","remark":"A","treatment_plan":{"id":1,"treatmentType":1,"treatmentDetail":"","startTime":"2025-03-01 09:00:00","endDate":"2025-03-10 09:00:00","doctorId":1,"createdTime":"2025-03-01T09:00:00","updatedTime":"2025-03-01T09:00:00"},"medications":[{"id":1,"diagnosisId":1,"medicationName":"A","dosage":"10mg","frequency":"","sideEffects":"","startTime":"2025-03-01T09:00:00","endTime":"2025-03-10T09:00:00","doctorId":1,"createdTime":"2025-03-01 09:00:00","updatedTime":"2025-03-01 09:00:00"}],"previous_conversations":[{"role":"pariatur tempor do","content":"sit cupidatat commodo"}],"question":"irure eu esse","stream":false}
20:57:15:588 DEBUG 33984 --- [http-nio-8080-exec-5] c.l.api.client.FlaskAiDoctorClient       : [FlaskAiDoctorClient#eye_doctor_chat] ---> END HTTP (753-byte body)
20:57:20:610 DEBUG 33984 --- [http-nio-8080-exec-5] c.l.api.client.FlaskAiDoctorClient       : [FlaskAiDoctorClient#eye_doctor_chat] <--- ERROR SocketTimeoutException: Connect timed out (5021ms)
20:57:20:612 DEBUG 33984 --- [http-nio-8080-exec-5] c.l.api.client.FlaskAiDoctorClient       : [FlaskAiDoctorClient#eye_doctor_chat] java.net.SocketTimeoutException: Connect timed out
	at java.base/sun.nio.ch.NioSocketImpl.timedFinishConnect(NioSocketImpl.java:551)
	at java.base/sun.nio.ch.NioSocketImpl.connect(NioSocketImpl.java:602)
	at java.base/java.net.SocksSocketImpl.connect(SocksSocketImpl.java:327)
	at java.base/java.net.Socket.connect(Socket.java:633)
	at okhttp3.internal.platform.Platform.connectSocket(Platform.kt:128)
	at okhttp3.internal.connection.RealConnection.connectSocket(RealConnection.kt:295)
	at okhttp3.internal.connection.RealConnection.connect(RealConnection.kt:207)
	at okhttp3.internal.connection.ExchangeFinder.findConnection(ExchangeFinder.kt:226)
	at okhttp3.internal.connection.ExchangeFinder.findHealthyConnection(ExchangeFinder.kt:106)
	at okhttp3.internal.connection.ExchangeFinder.find(ExchangeFinder.kt:74)
	at okhttp3.internal.connection.RealCall.initExchange$okhttp(RealCall.kt:255)
	at okhttp3.internal.connection.ConnectInterceptor.intercept(ConnectInterceptor.kt:32)
	at okhttp3.internal.http.RealInterceptorChain.proceed(RealInterceptorChain.kt:109)
	at okhttp3.internal.cache.CacheInterceptor.intercept(CacheInterceptor.kt:95)
	at okhttp3.internal.http.RealInterceptorChain.proceed(RealInterceptorChain.kt:109)
	at okhttp3.internal.http.BridgeInterceptor.intercept(BridgeInterceptor.kt:83)
	at okhttp3.internal.http.RealInterceptorChain.proceed(RealInterceptorChain.kt:109)
	at okhttp3.internal.http.RetryAndFollowUpInterceptor.intercept(RetryAndFollowUpInterceptor.kt:76)
	at okhttp3.internal.http.RealInterceptorChain.proceed(RealInterceptorChain.kt:109)
	at okhttp3.internal.connection.RealCall.getResponseWithInterceptorChain$okhttp(RealCall.kt:201)
	at okhttp3.internal.connection.RealCall.execute(RealCall.kt:154)
	at feign.okhttp.OkHttpClient.execute(OkHttpClient.java:180)
	at org.springframework.cloud.openfeign.loadbalancer.LoadBalancerUtils.executeWithLoadBalancerLifecycleProcessing(LoadBalancerUtils.java:57)
	at org.springframework.cloud.openfeign.loadbalancer.LoadBalancerUtils.executeWithLoadBalancerLifecycleProcessing(LoadBalancerUtils.java:95)
	at org.springframework.cloud.openfeign.loadbalancer.FeignBlockingLoadBalancerClient.execute(FeignBlockingLoadBalancerClient.java:114)
	at feign.SynchronousMethodHandler.executeAndDecode(SynchronousMethodHandler.java:121)
	at feign.SynchronousMethodHandler.invoke(SynchronousMethodHandler.java:91)
	at feign.ReflectiveFeign$FeignInvocationHandler.invoke(ReflectiveFeign.java:100)
	at jdk.proxy2/jdk.proxy2.$Proxy138.eye_doctor_chat(Unknown Source)
	at com.luojiawei.his_service.controller.ChatController.ask(ChatController.java:39)
	at java.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at java.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:77)
	at java.base/jdk.internal.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.base/java.lang.reflect.Method.invoke(Method.java:568)
	at org.springframework.web.method.support.InvocableHandlerMethod.doInvoke(InvocableHandlerMethod.java:205)
	at org.springframework.web.method.support.InvocableHandlerMethod.invokeForRequest(InvocableHandlerMethod.java:150)
	at org.springframework.web.servlet.mvc.method.annotation.ServletInvocableHandlerMethod.invokeAndHandle(ServletInvocableHandlerMethod.java:117)
	at org.springframework.web.servlet.mvc.method.annotation.RequestMappingHandlerAdapter.invokeHandlerMethod(RequestMappingHandlerAdapter.java:895)
	at org.springframework.web.servlet.mvc.method.annotation.RequestMappingHandlerAdapter.handleInternal(RequestMappingHandlerAdapter.java:808)
	at org.springframework.web.servlet.mvc.method.AbstractHandlerMethodAdapter.handle(AbstractHandlerMethodAdapter.java:87)
	at org.springframework.web.servlet.DispatcherServlet.doDispatch(DispatcherServlet.java:1072)
	at org.springframework.web.servlet.DispatcherServlet.doService(DispatcherServlet.java:965)
	at org.springframework.web.servlet.FrameworkServlet.processRequest(FrameworkServlet.java:1006)
	at org.springframework.web.servlet.FrameworkServlet.doPost(FrameworkServlet.java:909)
	at javax.servlet.http.HttpServlet.service(HttpServlet.java:555)
	at org.springframework.web.servlet.FrameworkServlet.service(FrameworkServlet.java:883)
	at javax.servlet.http.HttpServlet.service(HttpServlet.java:623)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:209)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:153)
	at com.luojiawei.his_service.filter.RefreshTokenFilter.doFilterInternal(RefreshTokenFilter.java:58)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:117)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:178)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:153)
	at org.springframework.web.filter.RequestContextFilter.doFilterInternal(RequestContextFilter.java:100)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:117)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:178)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:153)
	at org.springframework.web.filter.FormContentFilter.doFilterInternal(FormContentFilter.java:93)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:117)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:178)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:153)
	at org.springframework.boot.actuate.metrics.web.servlet.WebMvcMetricsFilter.doFilterInternal(WebMvcMetricsFilter.java:96)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:117)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:178)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:153)
	at org.springframework.web.filter.CharacterEncodingFilter.doFilterInternal(CharacterEncodingFilter.java:201)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:117)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:178)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:153)
	at org.apache.catalina.core.StandardWrapperValve.invoke(StandardWrapperValve.java:167)
	at org.apache.catalina.core.StandardContextValve.invoke(StandardContextValve.java:90)
	at org.apache.catalina.authenticator.AuthenticatorBase.invoke(AuthenticatorBase.java:481)
	at org.apache.catalina.core.StandardHostValve.invoke(StandardHostValve.java:130)
	at org.apache.catalina.valves.ErrorReportValve.invoke(ErrorReportValve.java:93)
	at org.apache.catalina.core.StandardEngineValve.invoke(StandardEngineValve.java:74)
	at org.apache.catalina.connector.CoyoteAdapter.service(CoyoteAdapter.java:343)
	at org.apache.coyote.http11.Http11Processor.service(Http11Processor.java:390)
	at org.apache.coyote.AbstractProcessorLight.process(AbstractProcessorLight.java:63)
	at org.apache.coyote.AbstractProtocol$ConnectionHandler.process(AbstractProtocol.java:926)
	at org.apache.tomcat.util.net.NioEndpoint$SocketProcessor.doRun(NioEndpoint.java:1791)
	at org.apache.tomcat.util.net.SocketProcessorBase.run(SocketProcessorBase.java:52)
	at org.apache.tomcat.util.threads.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1191)
	at org.apache.tomcat.util.threads.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:659)
	at org.apache.tomcat.util.threads.TaskThread$WrappingRunnable.run(TaskThread.java:61)
	at java.base/java.lang.Thread.run(Thread.java:840)

20:57:20:613 DEBUG 33984 --- [http-nio-8080-exec-5] c.l.api.client.FlaskAiDoctorClient       : [FlaskAiDoctorClient#eye_doctor_chat] <--- END ERROR
20:57:20:621 ERROR 33984 --- [http-nio-8080-exec-5] o.a.c.c.C.[.[.[/].[dispatcherServlet]    : Servlet.service() for servlet [dispatcherServlet] in context with path [] threw exception [Request processing failed; nested exception is feign.RetryableException: Connect timed out executing POST http://ai-service/api/eye-doctor/chat] with root cause

java.net.SocketTimeoutException: Connect timed out
	at java.base/sun.nio.ch.NioSocketImpl.timedFinishConnect(NioSocketImpl.java:551) ~[na:na]
	at java.base/sun.nio.ch.NioSocketImpl.connect(NioSocketImpl.java:602) ~[na:na]
	at java.base/java.net.SocksSocketImpl.connect(SocksSocketImpl.java:327) ~[na:na]
	at java.base/java.net.Socket.connect(Socket.java:633) ~[na:na]
	at okhttp3.internal.platform.Platform.connectSocket(Platform.kt:128) ~[okhttp-4.9.3.jar:na]
	at okhttp3.internal.connection.RealConnection.connectSocket(RealConnection.kt:295) ~[okhttp-4.9.3.jar:na]
	at okhttp3.internal.connection.RealConnection.connect(RealConnection.kt:207) ~[okhttp-4.9.3.jar:na]
	at okhttp3.internal.connection.ExchangeFinder.findConnection(ExchangeFinder.kt:226) ~[okhttp-4.9.3.jar:na]
	at okhttp3.internal.connection.ExchangeFinder.findHealthyConnection(ExchangeFinder.kt:106) ~[okhttp-4.9.3.jar:na]
	at okhttp3.internal.connection.ExchangeFinder.find(ExchangeFinder.kt:74) ~[okhttp-4.9.3.jar:na]
	at okhttp3.internal.connection.RealCall.initExchange$okhttp(RealCall.kt:255) ~[okhttp-4.9.3.jar:na]
	at okhttp3.internal.connection.ConnectInterceptor.intercept(ConnectInterceptor.kt:32) ~[okhttp-4.9.3.jar:na]
	at okhttp3.internal.http.RealInterceptorChain.proceed(RealInterceptorChain.kt:109) ~[okhttp-4.9.3.jar:na]
	at okhttp3.internal.cache.CacheInterceptor.intercept(CacheInterceptor.kt:95) ~[okhttp-4.9.3.jar:na]
	at okhttp3.internal.http.RealInterceptorChain.proceed(RealInterceptorChain.kt:109) ~[okhttp-4.9.3.jar:na]
	at okhttp3.internal.http.BridgeInterceptor.intercept(BridgeInterceptor.kt:83) ~[okhttp-4.9.3.jar:na]
	at okhttp3.internal.http.RealInterceptorChain.proceed(RealInterceptorChain.kt:109) ~[okhttp-4.9.3.jar:na]
	at okhttp3.internal.http.RetryAndFollowUpInterceptor.intercept(RetryAndFollowUpInterceptor.kt:76) ~[okhttp-4.9.3.jar:na]
	at okhttp3.internal.http.RealInterceptorChain.proceed(RealInterceptorChain.kt:109) ~[okhttp-4.9.3.jar:na]
	at okhttp3.internal.connection.RealCall.getResponseWithInterceptorChain$okhttp(RealCall.kt:201) ~[okhttp-4.9.3.jar:na]
	at okhttp3.internal.connection.RealCall.execute(RealCall.kt:154) ~[okhttp-4.9.3.jar:na]
	at feign.okhttp.OkHttpClient.execute(OkHttpClient.java:180) ~[feign-okhttp-11.10.jar:na]
	at org.springframework.cloud.openfeign.loadbalancer.LoadBalancerUtils.executeWithLoadBalancerLifecycleProcessing(LoadBalancerUtils.java:57) ~[spring-cloud-openfeign-core-3.1.5.jar:3.1.5]
	at org.springframework.cloud.openfeign.loadbalancer.LoadBalancerUtils.executeWithLoadBalancerLifecycleProcessing(LoadBalancerUtils.java:95) ~[spring-cloud-openfeign-core-3.1.5.jar:3.1.5]
	at org.springframework.cloud.openfeign.loadbalancer.FeignBlockingLoadBalancerClient.execute(FeignBlockingLoadBalancerClient.java:114) ~[spring-cloud-openfeign-core-3.1.5.jar:3.1.5]
	at feign.SynchronousMethodHandler.executeAndDecode(SynchronousMethodHandler.java:121) ~[feign-core-11.10.jar:na]
	at feign.SynchronousMethodHandler.invoke(SynchronousMethodHandler.java:91) ~[feign-core-11.10.jar:na]
	at feign.ReflectiveFeign$FeignInvocationHandler.invoke(ReflectiveFeign.java:100) ~[feign-core-11.10.jar:na]
	at jdk.proxy2/jdk.proxy2.$Proxy138.eye_doctor_chat(Unknown Source) ~[na:na]
	at com.luojiawei.his_service.controller.ChatController.ask(ChatController.java:39) ~[classes/:na]
	at java.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke0(Native Method) ~[na:na]
	at java.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:77) ~[na:na]
	at java.base/jdk.internal.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43) ~[na:na]
	at java.base/java.lang.reflect.Method.invoke(Method.java:568) ~[na:na]
	at org.springframework.web.method.support.InvocableHandlerMethod.doInvoke(InvocableHandlerMethod.java:205) ~[spring-web-5.3.27.jar:5.3.27]
	at org.springframework.web.method.support.InvocableHandlerMethod.invokeForRequest(InvocableHandlerMethod.java:150) ~[spring-web-5.3.27.jar:5.3.27]
	at org.springframework.web.servlet.mvc.method.annotation.ServletInvocableHandlerMethod.invokeAndHandle(ServletInvocableHandlerMethod.java:117) ~[spring-webmvc-5.3.27.jar:5.3.27]
	at org.springframework.web.servlet.mvc.method.annotation.RequestMappingHandlerAdapter.invokeHandlerMethod(RequestMappingHandlerAdapter.java:895) ~[spring-webmvc-5.3.27.jar:5.3.27]
	at org.springframework.web.servlet.mvc.method.annotation.RequestMappingHandlerAdapter.handleInternal(RequestMappingHandlerAdapter.java:808) ~[spring-webmvc-5.3.27.jar:5.3.27]
	at org.springframework.web.servlet.mvc.method.AbstractHandlerMethodAdapter.handle(AbstractHandlerMethodAdapter.java:87) ~[spring-webmvc-5.3.27.jar:5.3.27]
	at org.springframework.web.servlet.DispatcherServlet.doDispatch(DispatcherServlet.java:1072) ~[spring-webmvc-5.3.27.jar:5.3.27]
	at org.springframework.web.servlet.DispatcherServlet.doService(DispatcherServlet.java:965) ~[spring-webmvc-5.3.27.jar:5.3.27]
	at org.springframework.web.servlet.FrameworkServlet.processRequest(FrameworkServlet.java:1006) ~[spring-webmvc-5.3.27.jar:5.3.27]
	at org.springframework.web.servlet.FrameworkServlet.doPost(FrameworkServlet.java:909) ~[spring-webmvc-5.3.27.jar:5.3.27]
	at javax.servlet.http.HttpServlet.service(HttpServlet.java:555) ~[tomcat-embed-core-9.0.75.jar:4.0.FR]
	at org.springframework.web.servlet.FrameworkServlet.service(FrameworkServlet.java:883) ~[spring-webmvc-5.3.27.jar:5.3.27]
	at javax.servlet.http.HttpServlet.service(HttpServlet.java:623) ~[tomcat-embed-core-9.0.75.jar:4.0.FR]
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:209) ~[tomcat-embed-core-9.0.75.jar:9.0.75]
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:153) ~[tomcat-embed-core-9.0.75.jar:9.0.75]
	at com.luojiawei.his_service.filter.RefreshTokenFilter.doFilterInternal(RefreshTokenFilter.java:58) ~[classes/:na]
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:117) ~[spring-web-5.3.27.jar:5.3.27]
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:178) ~[tomcat-embed-core-9.0.75.jar:9.0.75]
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:153) ~[tomcat-embed-core-9.0.75.jar:9.0.75]
	at org.springframework.web.filter.RequestContextFilter.doFilterInternal(RequestContextFilter.java:100) ~[spring-web-5.3.27.jar:5.3.27]
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:117) ~[spring-web-5.3.27.jar:5.3.27]
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:178) ~[tomcat-embed-core-9.0.75.jar:9.0.75]
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:153) ~[tomcat-embed-core-9.0.75.jar:9.0.75]
	at org.springframework.web.filter.FormContentFilter.doFilterInternal(FormContentFilter.java:93) ~[spring-web-5.3.27.jar:5.3.27]
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:117) ~[spring-web-5.3.27.jar:5.3.27]
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:178) ~[tomcat-embed-core-9.0.75.jar:9.0.75]
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:153) ~[tomcat-embed-core-9.0.75.jar:9.0.75]
	at org.springframework.boot.actuate.metrics.web.servlet.WebMvcMetricsFilter.doFilterInternal(WebMvcMetricsFilter.java:96) ~[spring-boot-actuator-2.7.12.jar:2.7.12]
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:117) ~[spring-web-5.3.27.jar:5.3.27]
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:178) ~[tomcat-embed-core-9.0.75.jar:9.0.75]
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:153) ~[tomcat-embed-core-9.0.75.jar:9.0.75]
	at org.springframework.web.filter.CharacterEncodingFilter.doFilterInternal(CharacterEncodingFilter.java:201) ~[spring-web-5.3.27.jar:5.3.27]
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:117) ~[spring-web-5.3.27.jar:5.3.27]
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:178) ~[tomcat-embed-core-9.0.75.jar:9.0.75]
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:153) ~[tomcat-embed-core-9.0.75.jar:9.0.75]
	at org.apache.catalina.core.StandardWrapperValve.invoke(StandardWrapperValve.java:167) ~[tomcat-embed-core-9.0.75.jar:9.0.75]
	at org.apache.catalina.core.StandardContextValve.invoke(StandardContextValve.java:90) ~[tomcat-embed-core-9.0.75.jar:9.0.75]
	at org.apache.catalina.authenticator.AuthenticatorBase.invoke(AuthenticatorBase.java:481) ~[tomcat-embed-core-9.0.75.jar:9.0.75]
	at org.apache.catalina.core.StandardHostValve.invoke(StandardHostValve.java:130) ~[tomcat-embed-core-9.0.75.jar:9.0.75]
	at org.apache.catalina.valves.ErrorReportValve.invoke(ErrorReportValve.java:93) ~[tomcat-embed-core-9.0.75.jar:9.0.75]
	at org.apache.catalina.core.StandardEngineValve.invoke(StandardEngineValve.java:74) ~[tomcat-embed-core-9.0.75.jar:9.0.75]
	at org.apache.catalina.connector.CoyoteAdapter.service(CoyoteAdapter.java:343) ~[tomcat-embed-core-9.0.75.jar:9.0.75]
	at org.apache.coyote.http11.Http11Processor.service(Http11Processor.java:390) ~[tomcat-embed-core-9.0.75.jar:9.0.75]
	at org.apache.coyote.AbstractProcessorLight.process(AbstractProcessorLight.java:63) ~[tomcat-embed-core-9.0.75.jar:9.0.75]
	at org.apache.coyote.AbstractProtocol$ConnectionHandler.process(AbstractProtocol.java:926) ~[tomcat-embed-core-9.0.75.jar:9.0.75]
	at org.apache.tomcat.util.net.NioEndpoint$SocketProcessor.doRun(NioEndpoint.java:1791) ~[tomcat-embed-core-9.0.75.jar:9.0.75]
	at org.apache.tomcat.util.net.SocketProcessorBase.run(SocketProcessorBase.java:52) ~[tomcat-embed-core-9.0.75.jar:9.0.75]
	at org.apache.tomcat.util.threads.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1191) ~[tomcat-embed-core-9.0.75.jar:9.0.75]
	at org.apache.tomcat.util.threads.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:659) ~[tomcat-embed-core-9.0.75.jar:9.0.75]
	at org.apache.tomcat.util.threads.TaskThread$WrappingRunnable.run(TaskThread.java:61) ~[tomcat-embed-core-9.0.75.jar:9.0.75]
	at java.base/java.lang.Thread.run(Thread.java:840) ~[na:na]

20:58:30:164 DEBUG 33984 --- [http-nio-8080-exec-8] c.l.h.m.D.selectById                     : ==>  Preparing: SELECT id,patient_id,doctor_id,disease_name,disease_category,aimodel_id,result,create_time,status,id_card,name,score,remark FROM diagnosis_report WHERE id=?
20:58:30:168 DEBUG 33984 --- [http-nio-8080-exec-8] c.l.h.m.D.selectById                     : ==> Parameters: 1(Integer)
20:58:30:229 DEBUG 33984 --- [http-nio-8080-exec-8] c.l.h.m.D.selectById                     : <==      Total: 1
20:58:30:270 DEBUG 33984 --- [http-nio-8080-exec-8] c.l.h.mapper.PatientMapper.selectById    : ==>  Preparing: SELECT id,phone,id_card,name,verified,verified_by,verified_time,open_id,hospital_pid FROM patient WHERE id=?
20:58:30:285 DEBUG 33984 --- [http-nio-8080-exec-8] c.l.h.mapper.PatientMapper.selectById    : ==> Parameters: 1(Integer)
20:58:30:371 DEBUG 33984 --- [http-nio-8080-exec-8] c.l.h.mapper.PatientMapper.selectById    : <==      Total: 1
20:58:30:403 DEBUG 33984 --- [http-nio-8080-exec-8] c.l.h.mapper.DoctorMapper.selectById     : ==>  Preparing: SELECT id,phone,id_card,name,verified,verified_by,verified_time,license,department,hospital_pid FROM doctor WHERE id=?
20:58:30:404 DEBUG 33984 --- [http-nio-8080-exec-8] c.l.h.mapper.DoctorMapper.selectById     : ==> Parameters: 1(Integer)
20:58:30:448 DEBUG 33984 --- [http-nio-8080-exec-8] c.l.h.mapper.DoctorMapper.selectById     : <==      Total: 1
20:58:30:449 DEBUG 33984 --- [http-nio-8080-exec-8] c.l.h.m.E.selectListByDiagnosisId        : ==>  Preparing: select * from eye_images where dignosis_report_id = ?
20:58:30:457 DEBUG 33984 --- [http-nio-8080-exec-8] c.l.h.m.E.selectListByDiagnosisId        : ==> Parameters: 1(Integer)
20:58:30:494 DEBUG 33984 --- [http-nio-8080-exec-8] c.l.h.m.E.selectListByDiagnosisId        : <==      Total: 1
20:58:30:494 DEBUG 33984 --- [http-nio-8080-exec-8] c.l.h.m.T.selectByDiagnosisId            : ==>  Preparing: select * from treatment_plans where diagnosis_id = ?
20:58:30:495 DEBUG 33984 --- [http-nio-8080-exec-8] c.l.h.m.T.selectByDiagnosisId            : ==> Parameters: 1(Integer)
20:58:30:532 DEBUG 33984 --- [http-nio-8080-exec-8] c.l.h.m.T.selectByDiagnosisId            : <==      Total: 1
20:58:30:533 DEBUG 33984 --- [http-nio-8080-exec-8] c.l.h.m.M.selectByDiagnosisId            : ==>  Preparing: select * from medication_recommendations where diagnosis_id = ?
20:58:30:534 DEBUG 33984 --- [http-nio-8080-exec-8] c.l.h.m.M.selectByDiagnosisId            : ==> Parameters: 1(Integer)
20:58:30:594 DEBUG 33984 --- [http-nio-8080-exec-8] c.l.h.m.M.selectByDiagnosisId            : <==      Total: 1
20:58:30:594 DEBUG 33984 --- [http-nio-8080-exec-8] c.l.h.mapper.AiModelMapper.selectById    : ==>  Preparing: SELECT id,version,deploy_time,accuracy FROM ai_model WHERE id=?
20:58:30:594 DEBUG 33984 --- [http-nio-8080-exec-8] c.l.h.mapper.AiModelMapper.selectById    : ==> Parameters: 1(Integer)
20:58:30:637 DEBUG 33984 --- [http-nio-8080-exec-8] c.l.h.mapper.AiModelMapper.selectById    : <==      Total: 1
20:58:30:638 DEBUG 33984 --- [http-nio-8080-exec-8] o.s.c.openfeign.support.SpringEncoder    : Writing [ChatForm(diseaseName=, diseaseCategory=, result=A, remark=A, treatmentPlan=TreatmentPlans(id=1, diagnosisId=1, treatmentType=1, treatmentDetail=, startTime=2025-03-01T09:00, endDate=2025-03-10T09:00, doctorId=1, createdTime=2025-03-01T09:00, updatedTime=2025-03-01T09:00), medications=[MedicationRecommendations(id=1, diagnosisId=1, medicationName=A, dosage=10mg, frequency=, sideEffects=, startTime=2025-03-01T09:00, endTime=2025-03-10T09:00, doctorId=1, createdTime=2025-03-01T09:00, updatedTime=2025-03-01T09:00)], previousConversations=[DialogueInfo(role=pariatur tempor do, content=sit cupidatat commodo)], question=irure eu esse, stream=false)] using [org.springframework.http.converter.json.MappingJackson2HttpMessageConverter@3bf40c74]
20:58:30:656 DEBUG 33984 --- [http-nio-8080-exec-8] c.l.api.client.FlaskAiDoctorClient       : [FlaskAiDoctorClient#eye_doctor_chat] ---> POST http://ai-service/api/eye-doctor/chat HTTP/1.1
20:58:30:656 DEBUG 33984 --- [http-nio-8080-exec-8] c.l.api.client.FlaskAiDoctorClient       : [FlaskAiDoctorClient#eye_doctor_chat] Content-Length: 753
20:58:30:656 DEBUG 33984 --- [http-nio-8080-exec-8] c.l.api.client.FlaskAiDoctorClient       : [FlaskAiDoctorClient#eye_doctor_chat] Content-Type: application/json
20:58:30:656 DEBUG 33984 --- [http-nio-8080-exec-8] c.l.api.client.FlaskAiDoctorClient       : [FlaskAiDoctorClient#eye_doctor_chat] 
20:58:30:657 DEBUG 33984 --- [http-nio-8080-exec-8] c.l.api.client.FlaskAiDoctorClient       : [FlaskAiDoctorClient#eye_doctor_chat] {"diagnosis_name":"","diagnosis_category":"","result":"A","remark":"A","treatment_plan":{"id":1,"treatmentType":1,"treatmentDetail":"","startTime":"2025-03-01 09:00:00","endDate":"2025-03-10 09:00:00","doctorId":1,"createdTime":"2025-03-01T09:00:00","updatedTime":"2025-03-01T09:00:00"},"medications":[{"id":1,"diagnosisId":1,"medicationName":"A","dosage":"10mg","frequency":"","sideEffects":"","startTime":"2025-03-01T09:00:00","endTime":"2025-03-10T09:00:00","doctorId":1,"createdTime":"2025-03-01 09:00:00","updatedTime":"2025-03-01 09:00:00"}],"previous_conversations":[{"role":"pariatur tempor do","content":"sit cupidatat commodo"}],"question":"irure eu esse","stream":false}
20:58:30:657 DEBUG 33984 --- [http-nio-8080-exec-8] c.l.api.client.FlaskAiDoctorClient       : [FlaskAiDoctorClient#eye_doctor_chat] ---> END HTTP (753-byte body)
20:58:35:660 DEBUG 33984 --- [http-nio-8080-exec-8] c.l.api.client.FlaskAiDoctorClient       : [FlaskAiDoctorClient#eye_doctor_chat] <--- ERROR SocketTimeoutException: Connect timed out (5003ms)
20:58:35:662 DEBUG 33984 --- [http-nio-8080-exec-8] c.l.api.client.FlaskAiDoctorClient       : [FlaskAiDoctorClient#eye_doctor_chat] java.net.SocketTimeoutException: Connect timed out
	at java.base/sun.nio.ch.NioSocketImpl.timedFinishConnect(NioSocketImpl.java:551)
	at java.base/sun.nio.ch.NioSocketImpl.connect(NioSocketImpl.java:602)
	at java.base/java.net.SocksSocketImpl.connect(SocksSocketImpl.java:327)
	at java.base/java.net.Socket.connect(Socket.java:633)
	at okhttp3.internal.platform.Platform.connectSocket(Platform.kt:128)
	at okhttp3.internal.connection.RealConnection.connectSocket(RealConnection.kt:295)
	at okhttp3.internal.connection.RealConnection.connect(RealConnection.kt:207)
	at okhttp3.internal.connection.ExchangeFinder.findConnection(ExchangeFinder.kt:226)
	at okhttp3.internal.connection.ExchangeFinder.findHealthyConnection(ExchangeFinder.kt:106)
	at okhttp3.internal.connection.ExchangeFinder.find(ExchangeFinder.kt:74)
	at okhttp3.internal.connection.RealCall.initExchange$okhttp(RealCall.kt:255)
	at okhttp3.internal.connection.ConnectInterceptor.intercept(ConnectInterceptor.kt:32)
	at okhttp3.internal.http.RealInterceptorChain.proceed(RealInterceptorChain.kt:109)
	at okhttp3.internal.cache.CacheInterceptor.intercept(CacheInterceptor.kt:95)
	at okhttp3.internal.http.RealInterceptorChain.proceed(RealInterceptorChain.kt:109)
	at okhttp3.internal.http.BridgeInterceptor.intercept(BridgeInterceptor.kt:83)
	at okhttp3.internal.http.RealInterceptorChain.proceed(RealInterceptorChain.kt:109)
	at okhttp3.internal.http.RetryAndFollowUpInterceptor.intercept(RetryAndFollowUpInterceptor.kt:76)
	at okhttp3.internal.http.RealInterceptorChain.proceed(RealInterceptorChain.kt:109)
	at okhttp3.internal.connection.RealCall.getResponseWithInterceptorChain$okhttp(RealCall.kt:201)
	at okhttp3.internal.connection.RealCall.execute(RealCall.kt:154)
	at feign.okhttp.OkHttpClient.execute(OkHttpClient.java:180)
	at org.springframework.cloud.openfeign.loadbalancer.LoadBalancerUtils.executeWithLoadBalancerLifecycleProcessing(LoadBalancerUtils.java:57)
	at org.springframework.cloud.openfeign.loadbalancer.LoadBalancerUtils.executeWithLoadBalancerLifecycleProcessing(LoadBalancerUtils.java:95)
	at org.springframework.cloud.openfeign.loadbalancer.FeignBlockingLoadBalancerClient.execute(FeignBlockingLoadBalancerClient.java:114)
	at feign.SynchronousMethodHandler.executeAndDecode(SynchronousMethodHandler.java:121)
	at feign.SynchronousMethodHandler.invoke(SynchronousMethodHandler.java:91)
	at feign.ReflectiveFeign$FeignInvocationHandler.invoke(ReflectiveFeign.java:100)
	at jdk.proxy2/jdk.proxy2.$Proxy138.eye_doctor_chat(Unknown Source)
	at com.luojiawei.his_service.controller.ChatController.ask(ChatController.java:39)
	at java.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at java.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:77)
	at java.base/jdk.internal.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.base/java.lang.reflect.Method.invoke(Method.java:568)
	at org.springframework.web.method.support.InvocableHandlerMethod.doInvoke(InvocableHandlerMethod.java:205)
	at org.springframework.web.method.support.InvocableHandlerMethod.invokeForRequest(InvocableHandlerMethod.java:150)
	at org.springframework.web.servlet.mvc.method.annotation.ServletInvocableHandlerMethod.invokeAndHandle(ServletInvocableHandlerMethod.java:117)
	at org.springframework.web.servlet.mvc.method.annotation.RequestMappingHandlerAdapter.invokeHandlerMethod(RequestMappingHandlerAdapter.java:895)
	at org.springframework.web.servlet.mvc.method.annotation.RequestMappingHandlerAdapter.handleInternal(RequestMappingHandlerAdapter.java:808)
	at org.springframework.web.servlet.mvc.method.AbstractHandlerMethodAdapter.handle(AbstractHandlerMethodAdapter.java:87)
	at org.springframework.web.servlet.DispatcherServlet.doDispatch(DispatcherServlet.java:1072)
	at org.springframework.web.servlet.DispatcherServlet.doService(DispatcherServlet.java:965)
	at org.springframework.web.servlet.FrameworkServlet.processRequest(FrameworkServlet.java:1006)
	at org.springframework.web.servlet.FrameworkServlet.doPost(FrameworkServlet.java:909)
	at javax.servlet.http.HttpServlet.service(HttpServlet.java:555)
	at org.springframework.web.servlet.FrameworkServlet.service(FrameworkServlet.java:883)
	at javax.servlet.http.HttpServlet.service(HttpServlet.java:623)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:209)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:153)
	at com.luojiawei.his_service.filter.RefreshTokenFilter.doFilterInternal(RefreshTokenFilter.java:58)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:117)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:178)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:153)
	at org.springframework.web.filter.RequestContextFilter.doFilterInternal(RequestContextFilter.java:100)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:117)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:178)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:153)
	at org.springframework.web.filter.FormContentFilter.doFilterInternal(FormContentFilter.java:93)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:117)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:178)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:153)
	at org.springframework.boot.actuate.metrics.web.servlet.WebMvcMetricsFilter.doFilterInternal(WebMvcMetricsFilter.java:96)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:117)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:178)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:153)
	at org.springframework.web.filter.CharacterEncodingFilter.doFilterInternal(CharacterEncodingFilter.java:201)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:117)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:178)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:153)
	at org.apache.catalina.core.StandardWrapperValve.invoke(StandardWrapperValve.java:167)
	at org.apache.catalina.core.StandardContextValve.invoke(StandardContextValve.java:90)
	at org.apache.catalina.authenticator.AuthenticatorBase.invoke(AuthenticatorBase.java:481)
	at org.apache.catalina.core.StandardHostValve.invoke(StandardHostValve.java:130)
	at org.apache.catalina.valves.ErrorReportValve.invoke(ErrorReportValve.java:93)
	at org.apache.catalina.core.StandardEngineValve.invoke(StandardEngineValve.java:74)
	at org.apache.catalina.connector.CoyoteAdapter.service(CoyoteAdapter.java:343)
	at org.apache.coyote.http11.Http11Processor.service(Http11Processor.java:390)
	at org.apache.coyote.AbstractProcessorLight.process(AbstractProcessorLight.java:63)
	at org.apache.coyote.AbstractProtocol$ConnectionHandler.process(AbstractProtocol.java:926)
	at org.apache.tomcat.util.net.NioEndpoint$SocketProcessor.doRun(NioEndpoint.java:1791)
	at org.apache.tomcat.util.net.SocketProcessorBase.run(SocketProcessorBase.java:52)
	at org.apache.tomcat.util.threads.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1191)
	at org.apache.tomcat.util.threads.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:659)
	at org.apache.tomcat.util.threads.TaskThread$WrappingRunnable.run(TaskThread.java:61)
	at java.base/java.lang.Thread.run(Thread.java:840)

20:58:35:662 DEBUG 33984 --- [http-nio-8080-exec-8] c.l.api.client.FlaskAiDoctorClient       : [FlaskAiDoctorClient#eye_doctor_chat] <--- END ERROR
20:58:35:665 ERROR 33984 --- [http-nio-8080-exec-8] o.a.c.c.C.[.[.[/].[dispatcherServlet]    : Servlet.service() for servlet [dispatcherServlet] in context with path [] threw exception [Request processing failed; nested exception is feign.RetryableException: Connect timed out executing POST http://ai-service/api/eye-doctor/chat] with root cause

java.net.SocketTimeoutException: Connect timed out
	at java.base/sun.nio.ch.NioSocketImpl.timedFinishConnect(NioSocketImpl.java:551) ~[na:na]
	at java.base/sun.nio.ch.NioSocketImpl.connect(NioSocketImpl.java:602) ~[na:na]
	at java.base/java.net.SocksSocketImpl.connect(SocksSocketImpl.java:327) ~[na:na]
	at java.base/java.net.Socket.connect(Socket.java:633) ~[na:na]
	at okhttp3.internal.platform.Platform.connectSocket(Platform.kt:128) ~[okhttp-4.9.3.jar:na]
	at okhttp3.internal.connection.RealConnection.connectSocket(RealConnection.kt:295) ~[okhttp-4.9.3.jar:na]
	at okhttp3.internal.connection.RealConnection.connect(RealConnection.kt:207) ~[okhttp-4.9.3.jar:na]
	at okhttp3.internal.connection.ExchangeFinder.findConnection(ExchangeFinder.kt:226) ~[okhttp-4.9.3.jar:na]
	at okhttp3.internal.connection.ExchangeFinder.findHealthyConnection(ExchangeFinder.kt:106) ~[okhttp-4.9.3.jar:na]
	at okhttp3.internal.connection.ExchangeFinder.find(ExchangeFinder.kt:74) ~[okhttp-4.9.3.jar:na]
	at okhttp3.internal.connection.RealCall.initExchange$okhttp(RealCall.kt:255) ~[okhttp-4.9.3.jar:na]
	at okhttp3.internal.connection.ConnectInterceptor.intercept(ConnectInterceptor.kt:32) ~[okhttp-4.9.3.jar:na]
	at okhttp3.internal.http.RealInterceptorChain.proceed(RealInterceptorChain.kt:109) ~[okhttp-4.9.3.jar:na]
	at okhttp3.internal.cache.CacheInterceptor.intercept(CacheInterceptor.kt:95) ~[okhttp-4.9.3.jar:na]
	at okhttp3.internal.http.RealInterceptorChain.proceed(RealInterceptorChain.kt:109) ~[okhttp-4.9.3.jar:na]
	at okhttp3.internal.http.BridgeInterceptor.intercept(BridgeInterceptor.kt:83) ~[okhttp-4.9.3.jar:na]
	at okhttp3.internal.http.RealInterceptorChain.proceed(RealInterceptorChain.kt:109) ~[okhttp-4.9.3.jar:na]
	at okhttp3.internal.http.RetryAndFollowUpInterceptor.intercept(RetryAndFollowUpInterceptor.kt:76) ~[okhttp-4.9.3.jar:na]
	at okhttp3.internal.http.RealInterceptorChain.proceed(RealInterceptorChain.kt:109) ~[okhttp-4.9.3.jar:na]
	at okhttp3.internal.connection.RealCall.getResponseWithInterceptorChain$okhttp(RealCall.kt:201) ~[okhttp-4.9.3.jar:na]
	at okhttp3.internal.connection.RealCall.execute(RealCall.kt:154) ~[okhttp-4.9.3.jar:na]
	at feign.okhttp.OkHttpClient.execute(OkHttpClient.java:180) ~[feign-okhttp-11.10.jar:na]
	at org.springframework.cloud.openfeign.loadbalancer.LoadBalancerUtils.executeWithLoadBalancerLifecycleProcessing(LoadBalancerUtils.java:57) ~[spring-cloud-openfeign-core-3.1.5.jar:3.1.5]
	at org.springframework.cloud.openfeign.loadbalancer.LoadBalancerUtils.executeWithLoadBalancerLifecycleProcessing(LoadBalancerUtils.java:95) ~[spring-cloud-openfeign-core-3.1.5.jar:3.1.5]
	at org.springframework.cloud.openfeign.loadbalancer.FeignBlockingLoadBalancerClient.execute(FeignBlockingLoadBalancerClient.java:114) ~[spring-cloud-openfeign-core-3.1.5.jar:3.1.5]
	at feign.SynchronousMethodHandler.executeAndDecode(SynchronousMethodHandler.java:121) ~[feign-core-11.10.jar:na]
	at feign.SynchronousMethodHandler.invoke(SynchronousMethodHandler.java:91) ~[feign-core-11.10.jar:na]
	at feign.ReflectiveFeign$FeignInvocationHandler.invoke(ReflectiveFeign.java:100) ~[feign-core-11.10.jar:na]
	at jdk.proxy2/jdk.proxy2.$Proxy138.eye_doctor_chat(Unknown Source) ~[na:na]
	at com.luojiawei.his_service.controller.ChatController.ask(ChatController.java:39) ~[classes/:na]
	at java.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke0(Native Method) ~[na:na]
	at java.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:77) ~[na:na]
	at java.base/jdk.internal.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43) ~[na:na]
	at java.base/java.lang.reflect.Method.invoke(Method.java:568) ~[na:na]
	at org.springframework.web.method.support.InvocableHandlerMethod.doInvoke(InvocableHandlerMethod.java:205) ~[spring-web-5.3.27.jar:5.3.27]
	at org.springframework.web.method.support.InvocableHandlerMethod.invokeForRequest(InvocableHandlerMethod.java:150) ~[spring-web-5.3.27.jar:5.3.27]
	at org.springframework.web.servlet.mvc.method.annotation.ServletInvocableHandlerMethod.invokeAndHandle(ServletInvocableHandlerMethod.java:117) ~[spring-webmvc-5.3.27.jar:5.3.27]
	at org.springframework.web.servlet.mvc.method.annotation.RequestMappingHandlerAdapter.invokeHandlerMethod(RequestMappingHandlerAdapter.java:895) ~[spring-webmvc-5.3.27.jar:5.3.27]
	at org.springframework.web.servlet.mvc.method.annotation.RequestMappingHandlerAdapter.handleInternal(RequestMappingHandlerAdapter.java:808) ~[spring-webmvc-5.3.27.jar:5.3.27]
	at org.springframework.web.servlet.mvc.method.AbstractHandlerMethodAdapter.handle(AbstractHandlerMethodAdapter.java:87) ~[spring-webmvc-5.3.27.jar:5.3.27]
	at org.springframework.web.servlet.DispatcherServlet.doDispatch(DispatcherServlet.java:1072) ~[spring-webmvc-5.3.27.jar:5.3.27]
	at org.springframework.web.servlet.DispatcherServlet.doService(DispatcherServlet.java:965) ~[spring-webmvc-5.3.27.jar:5.3.27]
	at org.springframework.web.servlet.FrameworkServlet.processRequest(FrameworkServlet.java:1006) ~[spring-webmvc-5.3.27.jar:5.3.27]
	at org.springframework.web.servlet.FrameworkServlet.doPost(FrameworkServlet.java:909) ~[spring-webmvc-5.3.27.jar:5.3.27]
	at javax.servlet.http.HttpServlet.service(HttpServlet.java:555) ~[tomcat-embed-core-9.0.75.jar:4.0.FR]
	at org.springframework.web.servlet.FrameworkServlet.service(FrameworkServlet.java:883) ~[spring-webmvc-5.3.27.jar:5.3.27]
	at javax.servlet.http.HttpServlet.service(HttpServlet.java:623) ~[tomcat-embed-core-9.0.75.jar:4.0.FR]
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:209) ~[tomcat-embed-core-9.0.75.jar:9.0.75]
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:153) ~[tomcat-embed-core-9.0.75.jar:9.0.75]
	at com.luojiawei.his_service.filter.RefreshTokenFilter.doFilterInternal(RefreshTokenFilter.java:58) ~[classes/:na]
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:117) ~[spring-web-5.3.27.jar:5.3.27]
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:178) ~[tomcat-embed-core-9.0.75.jar:9.0.75]
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:153) ~[tomcat-embed-core-9.0.75.jar:9.0.75]
	at org.springframework.web.filter.RequestContextFilter.doFilterInternal(RequestContextFilter.java:100) ~[spring-web-5.3.27.jar:5.3.27]
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:117) ~[spring-web-5.3.27.jar:5.3.27]
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:178) ~[tomcat-embed-core-9.0.75.jar:9.0.75]
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:153) ~[tomcat-embed-core-9.0.75.jar:9.0.75]
	at org.springframework.web.filter.FormContentFilter.doFilterInternal(FormContentFilter.java:93) ~[spring-web-5.3.27.jar:5.3.27]
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:117) ~[spring-web-5.3.27.jar:5.3.27]
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:178) ~[tomcat-embed-core-9.0.75.jar:9.0.75]
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:153) ~[tomcat-embed-core-9.0.75.jar:9.0.75]
	at org.springframework.boot.actuate.metrics.web.servlet.WebMvcMetricsFilter.doFilterInternal(WebMvcMetricsFilter.java:96) ~[spring-boot-actuator-2.7.12.jar:2.7.12]
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:117) ~[spring-web-5.3.27.jar:5.3.27]
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:178) ~[tomcat-embed-core-9.0.75.jar:9.0.75]
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:153) ~[tomcat-embed-core-9.0.75.jar:9.0.75]
	at org.springframework.web.filter.CharacterEncodingFilter.doFilterInternal(CharacterEncodingFilter.java:201) ~[spring-web-5.3.27.jar:5.3.27]
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:117) ~[spring-web-5.3.27.jar:5.3.27]
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:178) ~[tomcat-embed-core-9.0.75.jar:9.0.75]
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:153) ~[tomcat-embed-core-9.0.75.jar:9.0.75]
	at org.apache.catalina.core.StandardWrapperValve.invoke(StandardWrapperValve.java:167) ~[tomcat-embed-core-9.0.75.jar:9.0.75]
	at org.apache.catalina.core.StandardContextValve.invoke(StandardContextValve.java:90) ~[tomcat-embed-core-9.0.75.jar:9.0.75]
	at org.apache.catalina.authenticator.AuthenticatorBase.invoke(AuthenticatorBase.java:481) ~[tomcat-embed-core-9.0.75.jar:9.0.75]
	at org.apache.catalina.core.StandardHostValve.invoke(StandardHostValve.java:130) ~[tomcat-embed-core-9.0.75.jar:9.0.75]
	at org.apache.catalina.valves.ErrorReportValve.invoke(ErrorReportValve.java:93) ~[tomcat-embed-core-9.0.75.jar:9.0.75]
	at org.apache.catalina.core.StandardEngineValve.invoke(StandardEngineValve.java:74) ~[tomcat-embed-core-9.0.75.jar:9.0.75]
	at org.apache.catalina.connector.CoyoteAdapter.service(CoyoteAdapter.java:343) ~[tomcat-embed-core-9.0.75.jar:9.0.75]
	at org.apache.coyote.http11.Http11Processor.service(Http11Processor.java:390) ~[tomcat-embed-core-9.0.75.jar:9.0.75]
	at org.apache.coyote.AbstractProcessorLight.process(AbstractProcessorLight.java:63) ~[tomcat-embed-core-9.0.75.jar:9.0.75]
	at org.apache.coyote.AbstractProtocol$ConnectionHandler.process(AbstractProtocol.java:926) ~[tomcat-embed-core-9.0.75.jar:9.0.75]
	at org.apache.tomcat.util.net.NioEndpoint$SocketProcessor.doRun(NioEndpoint.java:1791) ~[tomcat-embed-core-9.0.75.jar:9.0.75]
	at org.apache.tomcat.util.net.SocketProcessorBase.run(SocketProcessorBase.java:52) ~[tomcat-embed-core-9.0.75.jar:9.0.75]
	at org.apache.tomcat.util.threads.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1191) ~[tomcat-embed-core-9.0.75.jar:9.0.75]
	at org.apache.tomcat.util.threads.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:659) ~[tomcat-embed-core-9.0.75.jar:9.0.75]
	at org.apache.tomcat.util.threads.TaskThread$WrappingRunnable.run(TaskThread.java:61) ~[tomcat-embed-core-9.0.75.jar:9.0.75]
	at java.base/java.lang.Thread.run(Thread.java:840) ~[na:na]

21:12:27:600  WARN 33984 --- [http-nio-8080-exec-1] com.zaxxer.hikari.pool.PoolBase          : HikariPool-1 - Failed to validate connection com.mysql.cj.jdbc.ConnectionImpl@31b82346 (No operations allowed after connection closed.). Possibly consider using a shorter maxLifetime value.
21:12:27:610  WARN 33984 --- [http-nio-8080-exec-1] com.zaxxer.hikari.pool.PoolBase          : HikariPool-1 - Failed to validate connection com.mysql.cj.jdbc.ConnectionImpl@778ea4bd (No operations allowed after connection closed.). Possibly consider using a shorter maxLifetime value.
21:12:27:612  WARN 33984 --- [http-nio-8080-exec-1] com.zaxxer.hikari.pool.PoolBase          : HikariPool-1 - Failed to validate connection com.mysql.cj.jdbc.ConnectionImpl@b68125e (No operations allowed after connection closed.). Possibly consider using a shorter maxLifetime value.
21:12:27:614  WARN 33984 --- [http-nio-8080-exec-1] com.zaxxer.hikari.pool.PoolBase          : HikariPool-1 - Failed to validate connection com.mysql.cj.jdbc.ConnectionImpl@7bbaa266 (No operations allowed after connection closed.). Possibly consider using a shorter maxLifetime value.
21:12:27:616  WARN 33984 --- [http-nio-8080-exec-1] com.zaxxer.hikari.pool.PoolBase          : HikariPool-1 - Failed to validate connection com.mysql.cj.jdbc.ConnectionImpl@2b3e08c8 (No operations allowed after connection closed.). Possibly consider using a shorter maxLifetime value.
21:12:27:620  WARN 33984 --- [http-nio-8080-exec-1] com.zaxxer.hikari.pool.PoolBase          : HikariPool-1 - Failed to validate connection com.mysql.cj.jdbc.ConnectionImpl@4c21c060 (No operations allowed after connection closed.). Possibly consider using a shorter maxLifetime value.
21:12:27:622  WARN 33984 --- [http-nio-8080-exec-1] com.zaxxer.hikari.pool.PoolBase          : HikariPool-1 - Failed to validate connection com.mysql.cj.jdbc.ConnectionImpl@1782e964 (No operations allowed after connection closed.). Possibly consider using a shorter maxLifetime value.
21:12:27:624  WARN 33984 --- [http-nio-8080-exec-1] com.zaxxer.hikari.pool.PoolBase          : HikariPool-1 - Failed to validate connection com.mysql.cj.jdbc.ConnectionImpl@1d134d0 (No operations allowed after connection closed.). Possibly consider using a shorter maxLifetime value.
21:12:27:626  WARN 33984 --- [http-nio-8080-exec-1] com.zaxxer.hikari.pool.PoolBase          : HikariPool-1 - Failed to validate connection com.mysql.cj.jdbc.ConnectionImpl@541ccb4d (No operations allowed after connection closed.). Possibly consider using a shorter maxLifetime value.
21:12:27:628  WARN 33984 --- [http-nio-8080-exec-1] com.zaxxer.hikari.pool.PoolBase          : HikariPool-1 - Failed to validate connection com.mysql.cj.jdbc.ConnectionImpl@16fc336e (No operations allowed after connection closed.). Possibly consider using a shorter maxLifetime value.
21:12:27:914 DEBUG 33984 --- [http-nio-8080-exec-1] c.l.h.m.D.selectById                     : ==>  Preparing: SELECT id,patient_id,doctor_id,disease_name,disease_category,aimodel_id,result,create_time,status,id_card,name,score,remark FROM diagnosis_report WHERE id=?
21:12:27:916 DEBUG 33984 --- [http-nio-8080-exec-1] c.l.h.m.D.selectById                     : ==> Parameters: 1(Integer)
21:12:27:949 DEBUG 33984 --- [http-nio-8080-exec-1] c.l.h.m.D.selectById                     : <==      Total: 1
21:12:27:951 DEBUG 33984 --- [http-nio-8080-exec-1] c.l.h.mapper.PatientMapper.selectById    : ==>  Preparing: SELECT id,phone,id_card,name,verified,verified_by,verified_time,open_id,hospital_pid FROM patient WHERE id=?
21:12:27:951 DEBUG 33984 --- [http-nio-8080-exec-1] c.l.h.mapper.PatientMapper.selectById    : ==> Parameters: 1(Integer)
21:12:27:980 DEBUG 33984 --- [http-nio-8080-exec-1] c.l.h.mapper.PatientMapper.selectById    : <==      Total: 1
21:12:27:981 DEBUG 33984 --- [http-nio-8080-exec-1] c.l.h.mapper.DoctorMapper.selectById     : ==>  Preparing: SELECT id,phone,id_card,name,verified,verified_by,verified_time,license,department,hospital_pid FROM doctor WHERE id=?
21:12:27:981 DEBUG 33984 --- [http-nio-8080-exec-1] c.l.h.mapper.DoctorMapper.selectById     : ==> Parameters: 1(Integer)
21:12:28:008 DEBUG 33984 --- [http-nio-8080-exec-1] c.l.h.mapper.DoctorMapper.selectById     : <==      Total: 1
21:12:28:009 DEBUG 33984 --- [http-nio-8080-exec-1] c.l.h.m.E.selectListByDiagnosisId        : ==>  Preparing: select * from eye_images where dignosis_report_id = ?
21:12:28:010 DEBUG 33984 --- [http-nio-8080-exec-1] c.l.h.m.E.selectListByDiagnosisId        : ==> Parameters: 1(Integer)
21:12:28:038 DEBUG 33984 --- [http-nio-8080-exec-1] c.l.h.m.E.selectListByDiagnosisId        : <==      Total: 1
21:12:28:039 DEBUG 33984 --- [http-nio-8080-exec-1] c.l.h.m.T.selectByDiagnosisId            : ==>  Preparing: select * from treatment_plans where diagnosis_id = ?
21:12:28:039 DEBUG 33984 --- [http-nio-8080-exec-1] c.l.h.m.T.selectByDiagnosisId            : ==> Parameters: 1(Integer)
21:12:28:068 DEBUG 33984 --- [http-nio-8080-exec-1] c.l.h.m.T.selectByDiagnosisId            : <==      Total: 1
21:12:28:069 DEBUG 33984 --- [http-nio-8080-exec-1] c.l.h.m.M.selectByDiagnosisId            : ==>  Preparing: select * from medication_recommendations where diagnosis_id = ?
21:12:28:070 DEBUG 33984 --- [http-nio-8080-exec-1] c.l.h.m.M.selectByDiagnosisId            : ==> Parameters: 1(Integer)
21:12:28:100 DEBUG 33984 --- [http-nio-8080-exec-1] c.l.h.m.M.selectByDiagnosisId            : <==      Total: 1
21:12:28:100 DEBUG 33984 --- [http-nio-8080-exec-1] c.l.h.mapper.AiModelMapper.selectById    : ==>  Preparing: SELECT id,version,deploy_time,accuracy FROM ai_model WHERE id=?
21:12:28:100 DEBUG 33984 --- [http-nio-8080-exec-1] c.l.h.mapper.AiModelMapper.selectById    : ==> Parameters: 1(Integer)
21:12:28:128 DEBUG 33984 --- [http-nio-8080-exec-1] c.l.h.mapper.AiModelMapper.selectById    : <==      Total: 1
21:12:28:138 DEBUG 33984 --- [http-nio-8080-exec-1] o.s.c.openfeign.support.SpringEncoder    : Writing [ChatForm(diseaseName=, diseaseCategory=, result=A, remark=A, treatmentPlan=TreatmentPlans(id=1, diagnosisId=1, treatmentType=1, treatmentDetail=, startTime=2025-03-01T09:00, endDate=2025-03-10T09:00, doctorId=1, createdTime=2025-03-01T09:00, updatedTime=2025-03-01T09:00), medications=[MedicationRecommendations(id=1, diagnosisId=1, medicationName=A, dosage=10mg, frequency=, sideEffects=, startTime=2025-03-01T09:00, endTime=2025-03-10T09:00, doctorId=1, createdTime=2025-03-01T09:00, updatedTime=2025-03-01T09:00)], previousConversations=[DialogueInfo(role=pariatur tempor do, content=sit cupidatat commodo)], question=irure eu esse, stream=false)] using [org.springframework.http.converter.json.MappingJackson2HttpMessageConverter@3bf40c74]
21:12:28:143 DEBUG 33984 --- [http-nio-8080-exec-1] c.l.api.client.FlaskAiDoctorClient       : [FlaskAiDoctorClient#eye_doctor_chat] ---> POST http://ai-service/api/eye-doctor/chat HTTP/1.1
21:12:28:143 DEBUG 33984 --- [http-nio-8080-exec-1] c.l.api.client.FlaskAiDoctorClient       : [FlaskAiDoctorClient#eye_doctor_chat] Content-Length: 753
21:12:28:143 DEBUG 33984 --- [http-nio-8080-exec-1] c.l.api.client.FlaskAiDoctorClient       : [FlaskAiDoctorClient#eye_doctor_chat] Content-Type: application/json
21:12:28:143 DEBUG 33984 --- [http-nio-8080-exec-1] c.l.api.client.FlaskAiDoctorClient       : [FlaskAiDoctorClient#eye_doctor_chat] 
21:12:28:144 DEBUG 33984 --- [http-nio-8080-exec-1] c.l.api.client.FlaskAiDoctorClient       : [FlaskAiDoctorClient#eye_doctor_chat] {"diagnosis_name":"","diagnosis_category":"","result":"A","remark":"A","treatment_plan":{"id":1,"treatmentType":1,"treatmentDetail":"","startTime":"2025-03-01 09:00:00","endDate":"2025-03-10 09:00:00","doctorId":1,"createdTime":"2025-03-01T09:00:00","updatedTime":"2025-03-01T09:00:00"},"medications":[{"id":1,"diagnosisId":1,"medicationName":"A","dosage":"10mg","frequency":"","sideEffects":"","startTime":"2025-03-01T09:00:00","endTime":"2025-03-10T09:00:00","doctorId":1,"createdTime":"2025-03-01 09:00:00","updatedTime":"2025-03-01 09:00:00"}],"previous_conversations":[{"role":"pariatur tempor do","content":"sit cupidatat commodo"}],"question":"irure eu esse","stream":false}
21:12:28:144 DEBUG 33984 --- [http-nio-8080-exec-1] c.l.api.client.FlaskAiDoctorClient       : [FlaskAiDoctorClient#eye_doctor_chat] ---> END HTTP (753-byte body)
21:12:28:532 DEBUG 33984 --- [http-nio-8080-exec-1] c.l.api.client.FlaskAiDoctorClient       : [FlaskAiDoctorClient#eye_doctor_chat] <--- HTTP/1.1 422 Unprocessable Entity (388ms)
21:12:28:532 DEBUG 33984 --- [http-nio-8080-exec-1] c.l.api.client.FlaskAiDoctorClient       : [FlaskAiDoctorClient#eye_doctor_chat] content-length: 1784
21:12:28:532 DEBUG 33984 --- [http-nio-8080-exec-1] c.l.api.client.FlaskAiDoctorClient       : [FlaskAiDoctorClient#eye_doctor_chat] content-type: application/json
21:12:28:533 DEBUG 33984 --- [http-nio-8080-exec-1] c.l.api.client.FlaskAiDoctorClient       : [FlaskAiDoctorClient#eye_doctor_chat] date: Thu, 13 Mar 2025 13:12:27 GMT
21:12:28:533 DEBUG 33984 --- [http-nio-8080-exec-1] c.l.api.client.FlaskAiDoctorClient       : [FlaskAiDoctorClient#eye_doctor_chat] server: uvicorn
21:12:28:533 DEBUG 33984 --- [http-nio-8080-exec-1] c.l.api.client.FlaskAiDoctorClient       : [FlaskAiDoctorClient#eye_doctor_chat] 
21:12:28:537 DEBUG 33984 --- [http-nio-8080-exec-1] c.l.api.client.FlaskAiDoctorClient       : [FlaskAiDoctorClient#eye_doctor_chat] {"detail":[{"type":"missing","loc":["body","disease_name"],"msg":"Field required","input":{"diagnosis_name":"","diagnosis_category":"","result":"A","remark":"A","treatment_plan":{"id":1,"treatmentType":1,"treatmentDetail":"","startTime":"2025-03-01 09:00:00","endDate":"2025-03-10 09:00:00","doctorId":1,"createdTime":"2025-03-01T09:00:00","updatedTime":"2025-03-01T09:00:00"},"medications":[{"id":1,"diagnosisId":1,"medicationName":"A","dosage":"10mg","frequency":"","sideEffects":"","startTime":"2025-03-01T09:00:00","endTime":"2025-03-10T09:00:00","doctorId":1,"createdTime":"2025-03-01 09:00:00","updatedTime":"2025-03-01 09:00:00"}],"previous_conversations":[{"role":"pariatur tempor do","content":"sit cupidatat commodo"}],"question":"irure eu esse","stream":false},"url":"https://errors.pydantic.dev/2.4/v/missing"},{"type":"missing","loc":["body","disease_category"],"msg":"Field required","input":{"diagnosis_name":"","diagnosis_category":"","result":"A","remark":"A","treatment_plan":{"id":1,"treatmentType":1,"treatmentDetail":"","startTime":"2025-03-01 09:00:00","endDate":"2025-03-10 09:00:00","doctorId":1,"createdTime":"2025-03-01T09:00:00","updatedTime":"2025-03-01T09:00:00"},"medications":[{"id":1,"diagnosisId":1,"medicationName":"A","dosage":"10mg","frequency":"","sideEffects":"","startTime":"2025-03-01T09:00:00","endTime":"2025-03-10T09:00:00","doctorId":1,"createdTime":"2025-03-01 09:00:00","updatedTime":"2025-03-01 09:00:00"}],"previous_conversations":[{"role":"pariatur tempor do","content":"sit cupidatat commodo"}],"question":"irure eu esse","stream":false},"url":"https://errors.pydantic.dev/2.4/v/missing"}]}
21:12:28:537 DEBUG 33984 --- [http-nio-8080-exec-1] c.l.api.client.FlaskAiDoctorClient       : [FlaskAiDoctorClient#eye_doctor_chat] <--- END HTTP (1784-byte body)
21:12:28:571 ERROR 33984 --- [http-nio-8080-exec-1] o.a.c.c.C.[.[.[/].[dispatcherServlet]    : Servlet.service() for servlet [dispatcherServlet] in context with path [] threw exception [Request processing failed; nested exception is feign.FeignException$UnprocessableEntity: [422 Unprocessable Entity] during [POST] to [http://ai-service/api/eye-doctor/chat] [FlaskAiDoctorClient#eye_doctor_chat(ChatForm)]: [{"detail":[{"type":"missing","loc":["body","disease_name"],"msg":"Field required","input":{"diagnosis_name":"","diagnosis_category":"","result":"A","remark":"A","treatment_plan":{"id":1,"... (1784 bytes)]] with root cause

feign.FeignException$UnprocessableEntity: [422 Unprocessable Entity] during [POST] to [http://ai-service/api/eye-doctor/chat] [FlaskAiDoctorClient#eye_doctor_chat(ChatForm)]: [{"detail":[{"type":"missing","loc":["body","disease_name"],"msg":"Field required","input":{"diagnosis_name":"","diagnosis_category":"","result":"A","remark":"A","treatment_plan":{"id":1,"... (1784 bytes)]
	at feign.FeignException.clientErrorStatus(FeignException.java:233) ~[feign-core-11.10.jar:na]
	at feign.FeignException.errorStatus(FeignException.java:194) ~[feign-core-11.10.jar:na]
	at feign.FeignException.errorStatus(FeignException.java:185) ~[feign-core-11.10.jar:na]
	at feign.codec.ErrorDecoder$Default.decode(ErrorDecoder.java:92) ~[feign-core-11.10.jar:na]
	at feign.AsyncResponseHandler.handleResponse(AsyncResponseHandler.java:98) ~[feign-core-11.10.jar:na]
	at feign.SynchronousMethodHandler.executeAndDecode(SynchronousMethodHandler.java:141) ~[feign-core-11.10.jar:na]
	at feign.SynchronousMethodHandler.invoke(SynchronousMethodHandler.java:91) ~[feign-core-11.10.jar:na]
	at feign.ReflectiveFeign$FeignInvocationHandler.invoke(ReflectiveFeign.java:100) ~[feign-core-11.10.jar:na]
	at jdk.proxy2/jdk.proxy2.$Proxy138.eye_doctor_chat(Unknown Source) ~[na:na]
	at com.luojiawei.his_service.controller.ChatController.ask(ChatController.java:39) ~[classes/:na]
	at java.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke0(Native Method) ~[na:na]
	at java.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:77) ~[na:na]
	at java.base/jdk.internal.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43) ~[na:na]
	at java.base/java.lang.reflect.Method.invoke(Method.java:568) ~[na:na]
	at org.springframework.web.method.support.InvocableHandlerMethod.doInvoke(InvocableHandlerMethod.java:205) ~[spring-web-5.3.27.jar:5.3.27]
	at org.springframework.web.method.support.InvocableHandlerMethod.invokeForRequest(InvocableHandlerMethod.java:150) ~[spring-web-5.3.27.jar:5.3.27]
	at org.springframework.web.servlet.mvc.method.annotation.ServletInvocableHandlerMethod.invokeAndHandle(ServletInvocableHandlerMethod.java:117) ~[spring-webmvc-5.3.27.jar:5.3.27]
	at org.springframework.web.servlet.mvc.method.annotation.RequestMappingHandlerAdapter.invokeHandlerMethod(RequestMappingHandlerAdapter.java:895) ~[spring-webmvc-5.3.27.jar:5.3.27]
	at org.springframework.web.servlet.mvc.method.annotation.RequestMappingHandlerAdapter.handleInternal(RequestMappingHandlerAdapter.java:808) ~[spring-webmvc-5.3.27.jar:5.3.27]
	at org.springframework.web.servlet.mvc.method.AbstractHandlerMethodAdapter.handle(AbstractHandlerMethodAdapter.java:87) ~[spring-webmvc-5.3.27.jar:5.3.27]
	at org.springframework.web.servlet.DispatcherServlet.doDispatch(DispatcherServlet.java:1072) ~[spring-webmvc-5.3.27.jar:5.3.27]
	at org.springframework.web.servlet.DispatcherServlet.doService(DispatcherServlet.java:965) ~[spring-webmvc-5.3.27.jar:5.3.27]
	at org.springframework.web.servlet.FrameworkServlet.processRequest(FrameworkServlet.java:1006) ~[spring-webmvc-5.3.27.jar:5.3.27]
	at org.springframework.web.servlet.FrameworkServlet.doPost(FrameworkServlet.java:909) ~[spring-webmvc-5.3.27.jar:5.3.27]
	at javax.servlet.http.HttpServlet.service(HttpServlet.java:555) ~[tomcat-embed-core-9.0.75.jar:4.0.FR]
	at org.springframework.web.servlet.FrameworkServlet.service(FrameworkServlet.java:883) ~[spring-webmvc-5.3.27.jar:5.3.27]
	at javax.servlet.http.HttpServlet.service(HttpServlet.java:623) ~[tomcat-embed-core-9.0.75.jar:4.0.FR]
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:209) ~[tomcat-embed-core-9.0.75.jar:9.0.75]
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:153) ~[tomcat-embed-core-9.0.75.jar:9.0.75]
	at com.luojiawei.his_service.filter.RefreshTokenFilter.doFilterInternal(RefreshTokenFilter.java:58) ~[classes/:na]
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:117) ~[spring-web-5.3.27.jar:5.3.27]
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:178) ~[tomcat-embed-core-9.0.75.jar:9.0.75]
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:153) ~[tomcat-embed-core-9.0.75.jar:9.0.75]
	at org.springframework.web.filter.RequestContextFilter.doFilterInternal(RequestContextFilter.java:100) ~[spring-web-5.3.27.jar:5.3.27]
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:117) ~[spring-web-5.3.27.jar:5.3.27]
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:178) ~[tomcat-embed-core-9.0.75.jar:9.0.75]
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:153) ~[tomcat-embed-core-9.0.75.jar:9.0.75]
	at org.springframework.web.filter.FormContentFilter.doFilterInternal(FormContentFilter.java:93) ~[spring-web-5.3.27.jar:5.3.27]
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:117) ~[spring-web-5.3.27.jar:5.3.27]
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:178) ~[tomcat-embed-core-9.0.75.jar:9.0.75]
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:153) ~[tomcat-embed-core-9.0.75.jar:9.0.75]
	at org.springframework.boot.actuate.metrics.web.servlet.WebMvcMetricsFilter.doFilterInternal(WebMvcMetricsFilter.java:96) ~[spring-boot-actuator-2.7.12.jar:2.7.12]
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:117) ~[spring-web-5.3.27.jar:5.3.27]
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:178) ~[tomcat-embed-core-9.0.75.jar:9.0.75]
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:153) ~[tomcat-embed-core-9.0.75.jar:9.0.75]
	at org.springframework.web.filter.CharacterEncodingFilter.doFilterInternal(CharacterEncodingFilter.java:201) ~[spring-web-5.3.27.jar:5.3.27]
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:117) ~[spring-web-5.3.27.jar:5.3.27]
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:178) ~[tomcat-embed-core-9.0.75.jar:9.0.75]
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:153) ~[tomcat-embed-core-9.0.75.jar:9.0.75]
	at org.apache.catalina.core.StandardWrapperValve.invoke(StandardWrapperValve.java:167) ~[tomcat-embed-core-9.0.75.jar:9.0.75]
	at org.apache.catalina.core.StandardContextValve.invoke(StandardContextValve.java:90) ~[tomcat-embed-core-9.0.75.jar:9.0.75]
	at org.apache.catalina.authenticator.AuthenticatorBase.invoke(AuthenticatorBase.java:481) ~[tomcat-embed-core-9.0.75.jar:9.0.75]
	at org.apache.catalina.core.StandardHostValve.invoke(StandardHostValve.java:130) ~[tomcat-embed-core-9.0.75.jar:9.0.75]
	at org.apache.catalina.valves.ErrorReportValve.invoke(ErrorReportValve.java:93) ~[tomcat-embed-core-9.0.75.jar:9.0.75]
	at org.apache.catalina.core.StandardEngineValve.invoke(StandardEngineValve.java:74) ~[tomcat-embed-core-9.0.75.jar:9.0.75]
	at org.apache.catalina.connector.CoyoteAdapter.service(CoyoteAdapter.java:343) ~[tomcat-embed-core-9.0.75.jar:9.0.75]
	at org.apache.coyote.http11.Http11Processor.service(Http11Processor.java:390) ~[tomcat-embed-core-9.0.75.jar:9.0.75]
	at org.apache.coyote.AbstractProcessorLight.process(AbstractProcessorLight.java:63) ~[tomcat-embed-core-9.0.75.jar:9.0.75]
	at org.apache.coyote.AbstractProtocol$ConnectionHandler.process(AbstractProtocol.java:926) ~[tomcat-embed-core-9.0.75.jar:9.0.75]
	at org.apache.tomcat.util.net.NioEndpoint$SocketProcessor.doRun(NioEndpoint.java:1791) ~[tomcat-embed-core-9.0.75.jar:9.0.75]
	at org.apache.tomcat.util.net.SocketProcessorBase.run(SocketProcessorBase.java:52) ~[tomcat-embed-core-9.0.75.jar:9.0.75]
	at org.apache.tomcat.util.threads.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1191) ~[tomcat-embed-core-9.0.75.jar:9.0.75]
	at org.apache.tomcat.util.threads.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:659) ~[tomcat-embed-core-9.0.75.jar:9.0.75]
	at org.apache.tomcat.util.threads.TaskThread$WrappingRunnable.run(TaskThread.java:61) ~[tomcat-embed-core-9.0.75.jar:9.0.75]
	at java.base/java.lang.Thread.run(Thread.java:840) ~[na:na]

21:12:47:317 DEBUG 33984 --- [http-nio-8080-exec-2] c.l.h.m.D.selectById                     : ==>  Preparing: SELECT id,patient_id,doctor_id,disease_name,disease_category,aimodel_id,result,create_time,status,id_card,name,score,remark FROM diagnosis_report WHERE id=?
21:12:47:317 DEBUG 33984 --- [http-nio-8080-exec-2] c.l.h.m.D.selectById                     : ==> Parameters: 1(Integer)
21:12:47:346 DEBUG 33984 --- [http-nio-8080-exec-2] c.l.h.m.D.selectById                     : <==      Total: 1
21:12:47:347 DEBUG 33984 --- [http-nio-8080-exec-2] c.l.h.mapper.PatientMapper.selectById    : ==>  Preparing: SELECT id,phone,id_card,name,verified,verified_by,verified_time,open_id,hospital_pid FROM patient WHERE id=?
21:12:47:350 DEBUG 33984 --- [http-nio-8080-exec-2] c.l.h.mapper.PatientMapper.selectById    : ==> Parameters: 1(Integer)
21:12:47:379 DEBUG 33984 --- [http-nio-8080-exec-2] c.l.h.mapper.PatientMapper.selectById    : <==      Total: 1
21:12:47:380 DEBUG 33984 --- [http-nio-8080-exec-2] c.l.h.mapper.DoctorMapper.selectById     : ==>  Preparing: SELECT id,phone,id_card,name,verified,verified_by,verified_time,license,department,hospital_pid FROM doctor WHERE id=?
21:12:47:380 DEBUG 33984 --- [http-nio-8080-exec-2] c.l.h.mapper.DoctorMapper.selectById     : ==> Parameters: 1(Integer)
21:12:47:409 DEBUG 33984 --- [http-nio-8080-exec-2] c.l.h.mapper.DoctorMapper.selectById     : <==      Total: 1
21:12:47:410 DEBUG 33984 --- [http-nio-8080-exec-2] c.l.h.m.E.selectListByDiagnosisId        : ==>  Preparing: select * from eye_images where dignosis_report_id = ?
21:12:47:410 DEBUG 33984 --- [http-nio-8080-exec-2] c.l.h.m.E.selectListByDiagnosisId        : ==> Parameters: 1(Integer)
21:12:47:438 DEBUG 33984 --- [http-nio-8080-exec-2] c.l.h.m.E.selectListByDiagnosisId        : <==      Total: 1
21:12:47:439 DEBUG 33984 --- [http-nio-8080-exec-2] c.l.h.m.T.selectByDiagnosisId            : ==>  Preparing: select * from treatment_plans where diagnosis_id = ?
21:12:47:439 DEBUG 33984 --- [http-nio-8080-exec-2] c.l.h.m.T.selectByDiagnosisId            : ==> Parameters: 1(Integer)
21:12:47:473 DEBUG 33984 --- [http-nio-8080-exec-2] c.l.h.m.T.selectByDiagnosisId            : <==      Total: 1
21:12:47:474 DEBUG 33984 --- [http-nio-8080-exec-2] c.l.h.m.M.selectByDiagnosisId            : ==>  Preparing: select * from medication_recommendations where diagnosis_id = ?
21:12:47:475 DEBUG 33984 --- [http-nio-8080-exec-2] c.l.h.m.M.selectByDiagnosisId            : ==> Parameters: 1(Integer)
21:12:47:503 DEBUG 33984 --- [http-nio-8080-exec-2] c.l.h.m.M.selectByDiagnosisId            : <==      Total: 1
21:12:47:504 DEBUG 33984 --- [http-nio-8080-exec-2] c.l.h.mapper.AiModelMapper.selectById    : ==>  Preparing: SELECT id,version,deploy_time,accuracy FROM ai_model WHERE id=?
21:12:47:504 DEBUG 33984 --- [http-nio-8080-exec-2] c.l.h.mapper.AiModelMapper.selectById    : ==> Parameters: 1(Integer)
21:12:47:532 DEBUG 33984 --- [http-nio-8080-exec-2] c.l.h.mapper.AiModelMapper.selectById    : <==      Total: 1
21:12:47:533 DEBUG 33984 --- [http-nio-8080-exec-2] o.s.c.openfeign.support.SpringEncoder    : Writing [ChatForm(diseaseName=, diseaseCategory=, result=A, remark=A, treatmentPlan=TreatmentPlans(id=1, diagnosisId=1, treatmentType=1, treatmentDetail=, startTime=2025-03-01T09:00, endDate=2025-03-10T09:00, doctorId=1, createdTime=2025-03-01T09:00, updatedTime=2025-03-01T09:00), medications=[MedicationRecommendations(id=1, diagnosisId=1, medicationName=A, dosage=10mg, frequency=, sideEffects=, startTime=2025-03-01T09:00, endTime=2025-03-10T09:00, doctorId=1, createdTime=2025-03-01T09:00, updatedTime=2025-03-01T09:00)], previousConversations=[DialogueInfo(role=pariatur tempor do, content=sit cupidatat commodo)], question=irure eu esse, stream=false)] using [org.springframework.http.converter.json.MappingJackson2HttpMessageConverter@3bf40c74]
21:12:47:534 DEBUG 33984 --- [http-nio-8080-exec-2] c.l.api.client.FlaskAiDoctorClient       : [FlaskAiDoctorClient#eye_doctor_chat] ---> POST http://ai-service/api/eye-doctor/chat HTTP/1.1
21:12:47:534 DEBUG 33984 --- [http-nio-8080-exec-2] c.l.api.client.FlaskAiDoctorClient       : [FlaskAiDoctorClient#eye_doctor_chat] Content-Length: 753
21:12:47:534 DEBUG 33984 --- [http-nio-8080-exec-2] c.l.api.client.FlaskAiDoctorClient       : [FlaskAiDoctorClient#eye_doctor_chat] Content-Type: application/json
21:12:47:534 DEBUG 33984 --- [http-nio-8080-exec-2] c.l.api.client.FlaskAiDoctorClient       : [FlaskAiDoctorClient#eye_doctor_chat] 
21:12:47:537 DEBUG 33984 --- [http-nio-8080-exec-2] c.l.api.client.FlaskAiDoctorClient       : [FlaskAiDoctorClient#eye_doctor_chat] {"diagnosis_name":"","diagnosis_category":"","result":"A","remark":"A","treatment_plan":{"id":1,"treatmentType":1,"treatmentDetail":"","startTime":"2025-03-01 09:00:00","endDate":"2025-03-10 09:00:00","doctorId":1,"createdTime":"2025-03-01T09:00:00","updatedTime":"2025-03-01T09:00:00"},"medications":[{"id":1,"diagnosisId":1,"medicationName":"A","dosage":"10mg","frequency":"","sideEffects":"","startTime":"2025-03-01T09:00:00","endTime":"2025-03-10T09:00:00","doctorId":1,"createdTime":"2025-03-01 09:00:00","updatedTime":"2025-03-01 09:00:00"}],"previous_conversations":[{"role":"pariatur tempor do","content":"sit cupidatat commodo"}],"question":"irure eu esse","stream":false}
21:12:47:537 DEBUG 33984 --- [http-nio-8080-exec-2] c.l.api.client.FlaskAiDoctorClient       : [FlaskAiDoctorClient#eye_doctor_chat] ---> END HTTP (753-byte body)
21:12:47:637 DEBUG 33984 --- [http-nio-8080-exec-2] c.l.api.client.FlaskAiDoctorClient       : [FlaskAiDoctorClient#eye_doctor_chat] <--- HTTP/1.1 422 Unprocessable Entity (99ms)
21:12:47:638 DEBUG 33984 --- [http-nio-8080-exec-2] c.l.api.client.FlaskAiDoctorClient       : [FlaskAiDoctorClient#eye_doctor_chat] content-length: 1784
21:12:47:638 DEBUG 33984 --- [http-nio-8080-exec-2] c.l.api.client.FlaskAiDoctorClient       : [FlaskAiDoctorClient#eye_doctor_chat] content-type: application/json
21:12:47:638 DEBUG 33984 --- [http-nio-8080-exec-2] c.l.api.client.FlaskAiDoctorClient       : [FlaskAiDoctorClient#eye_doctor_chat] date: Thu, 13 Mar 2025 13:12:47 GMT
21:12:47:638 DEBUG 33984 --- [http-nio-8080-exec-2] c.l.api.client.FlaskAiDoctorClient       : [FlaskAiDoctorClient#eye_doctor_chat] server: uvicorn
21:12:47:638 DEBUG 33984 --- [http-nio-8080-exec-2] c.l.api.client.FlaskAiDoctorClient       : [FlaskAiDoctorClient#eye_doctor_chat] 
21:12:47:638 DEBUG 33984 --- [http-nio-8080-exec-2] c.l.api.client.FlaskAiDoctorClient       : [FlaskAiDoctorClient#eye_doctor_chat] {"detail":[{"type":"missing","loc":["body","disease_name"],"msg":"Field required","input":{"diagnosis_name":"","diagnosis_category":"","result":"A","remark":"A","treatment_plan":{"id":1,"treatmentType":1,"treatmentDetail":"","startTime":"2025-03-01 09:00:00","endDate":"2025-03-10 09:00:00","doctorId":1,"createdTime":"2025-03-01T09:00:00","updatedTime":"2025-03-01T09:00:00"},"medications":[{"id":1,"diagnosisId":1,"medicationName":"A","dosage":"10mg","frequency":"","sideEffects":"","startTime":"2025-03-01T09:00:00","endTime":"2025-03-10T09:00:00","doctorId":1,"createdTime":"2025-03-01 09:00:00","updatedTime":"2025-03-01 09:00:00"}],"previous_conversations":[{"role":"pariatur tempor do","content":"sit cupidatat commodo"}],"question":"irure eu esse","stream":false},"url":"https://errors.pydantic.dev/2.4/v/missing"},{"type":"missing","loc":["body","disease_category"],"msg":"Field required","input":{"diagnosis_name":"","diagnosis_category":"","result":"A","remark":"A","treatment_plan":{"id":1,"treatmentType":1,"treatmentDetail":"","startTime":"2025-03-01 09:00:00","endDate":"2025-03-10 09:00:00","doctorId":1,"createdTime":"2025-03-01T09:00:00","updatedTime":"2025-03-01T09:00:00"},"medications":[{"id":1,"diagnosisId":1,"medicationName":"A","dosage":"10mg","frequency":"","sideEffects":"","startTime":"2025-03-01T09:00:00","endTime":"2025-03-10T09:00:00","doctorId":1,"createdTime":"2025-03-01 09:00:00","updatedTime":"2025-03-01 09:00:00"}],"previous_conversations":[{"role":"pariatur tempor do","content":"sit cupidatat commodo"}],"question":"irure eu esse","stream":false},"url":"https://errors.pydantic.dev/2.4/v/missing"}]}
21:12:47:639 DEBUG 33984 --- [http-nio-8080-exec-2] c.l.api.client.FlaskAiDoctorClient       : [FlaskAiDoctorClient#eye_doctor_chat] <--- END HTTP (1784-byte body)
21:12:47:648 ERROR 33984 --- [http-nio-8080-exec-2] o.a.c.c.C.[.[.[/].[dispatcherServlet]    : Servlet.service() for servlet [dispatcherServlet] in context with path [] threw exception [Request processing failed; nested exception is feign.FeignException$UnprocessableEntity: [422 Unprocessable Entity] during [POST] to [http://ai-service/api/eye-doctor/chat] [FlaskAiDoctorClient#eye_doctor_chat(ChatForm)]: [{"detail":[{"type":"missing","loc":["body","disease_name"],"msg":"Field required","input":{"diagnosis_name":"","diagnosis_category":"","result":"A","remark":"A","treatment_plan":{"id":1,"... (1784 bytes)]] with root cause

feign.FeignException$UnprocessableEntity: [422 Unprocessable Entity] during [POST] to [http://ai-service/api/eye-doctor/chat] [FlaskAiDoctorClient#eye_doctor_chat(ChatForm)]: [{"detail":[{"type":"missing","loc":["body","disease_name"],"msg":"Field required","input":{"diagnosis_name":"","diagnosis_category":"","result":"A","remark":"A","treatment_plan":{"id":1,"... (1784 bytes)]
	at feign.FeignException.clientErrorStatus(FeignException.java:233) ~[feign-core-11.10.jar:na]
	at feign.FeignException.errorStatus(FeignException.java:194) ~[feign-core-11.10.jar:na]
	at feign.FeignException.errorStatus(FeignException.java:185) ~[feign-core-11.10.jar:na]
	at feign.codec.ErrorDecoder$Default.decode(ErrorDecoder.java:92) ~[feign-core-11.10.jar:na]
	at feign.AsyncResponseHandler.handleResponse(AsyncResponseHandler.java:98) ~[feign-core-11.10.jar:na]
	at feign.SynchronousMethodHandler.executeAndDecode(SynchronousMethodHandler.java:141) ~[feign-core-11.10.jar:na]
	at feign.SynchronousMethodHandler.invoke(SynchronousMethodHandler.java:91) ~[feign-core-11.10.jar:na]
	at feign.ReflectiveFeign$FeignInvocationHandler.invoke(ReflectiveFeign.java:100) ~[feign-core-11.10.jar:na]
	at jdk.proxy2/jdk.proxy2.$Proxy138.eye_doctor_chat(Unknown Source) ~[na:na]
	at com.luojiawei.his_service.controller.ChatController.ask(ChatController.java:39) ~[classes/:na]
	at java.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke0(Native Method) ~[na:na]
	at java.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:77) ~[na:na]
	at java.base/jdk.internal.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43) ~[na:na]
	at java.base/java.lang.reflect.Method.invoke(Method.java:568) ~[na:na]
	at org.springframework.web.method.support.InvocableHandlerMethod.doInvoke(InvocableHandlerMethod.java:205) ~[spring-web-5.3.27.jar:5.3.27]
	at org.springframework.web.method.support.InvocableHandlerMethod.invokeForRequest(InvocableHandlerMethod.java:150) ~[spring-web-5.3.27.jar:5.3.27]
	at org.springframework.web.servlet.mvc.method.annotation.ServletInvocableHandlerMethod.invokeAndHandle(ServletInvocableHandlerMethod.java:117) ~[spring-webmvc-5.3.27.jar:5.3.27]
	at org.springframework.web.servlet.mvc.method.annotation.RequestMappingHandlerAdapter.invokeHandlerMethod(RequestMappingHandlerAdapter.java:895) ~[spring-webmvc-5.3.27.jar:5.3.27]
	at org.springframework.web.servlet.mvc.method.annotation.RequestMappingHandlerAdapter.handleInternal(RequestMappingHandlerAdapter.java:808) ~[spring-webmvc-5.3.27.jar:5.3.27]
	at org.springframework.web.servlet.mvc.method.AbstractHandlerMethodAdapter.handle(AbstractHandlerMethodAdapter.java:87) ~[spring-webmvc-5.3.27.jar:5.3.27]
	at org.springframework.web.servlet.DispatcherServlet.doDispatch(DispatcherServlet.java:1072) ~[spring-webmvc-5.3.27.jar:5.3.27]
	at org.springframework.web.servlet.DispatcherServlet.doService(DispatcherServlet.java:965) ~[spring-webmvc-5.3.27.jar:5.3.27]
	at org.springframework.web.servlet.FrameworkServlet.processRequest(FrameworkServlet.java:1006) ~[spring-webmvc-5.3.27.jar:5.3.27]
	at org.springframework.web.servlet.FrameworkServlet.doPost(FrameworkServlet.java:909) ~[spring-webmvc-5.3.27.jar:5.3.27]
	at javax.servlet.http.HttpServlet.service(HttpServlet.java:555) ~[tomcat-embed-core-9.0.75.jar:4.0.FR]
	at org.springframework.web.servlet.FrameworkServlet.service(FrameworkServlet.java:883) ~[spring-webmvc-5.3.27.jar:5.3.27]
	at javax.servlet.http.HttpServlet.service(HttpServlet.java:623) ~[tomcat-embed-core-9.0.75.jar:4.0.FR]
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:209) ~[tomcat-embed-core-9.0.75.jar:9.0.75]
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:153) ~[tomcat-embed-core-9.0.75.jar:9.0.75]
	at com.luojiawei.his_service.filter.RefreshTokenFilter.doFilterInternal(RefreshTokenFilter.java:58) ~[classes/:na]
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:117) ~[spring-web-5.3.27.jar:5.3.27]
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:178) ~[tomcat-embed-core-9.0.75.jar:9.0.75]
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:153) ~[tomcat-embed-core-9.0.75.jar:9.0.75]
	at org.springframework.web.filter.RequestContextFilter.doFilterInternal(RequestContextFilter.java:100) ~[spring-web-5.3.27.jar:5.3.27]
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:117) ~[spring-web-5.3.27.jar:5.3.27]
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:178) ~[tomcat-embed-core-9.0.75.jar:9.0.75]
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:153) ~[tomcat-embed-core-9.0.75.jar:9.0.75]
	at org.springframework.web.filter.FormContentFilter.doFilterInternal(FormContentFilter.java:93) ~[spring-web-5.3.27.jar:5.3.27]
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:117) ~[spring-web-5.3.27.jar:5.3.27]
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:178) ~[tomcat-embed-core-9.0.75.jar:9.0.75]
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:153) ~[tomcat-embed-core-9.0.75.jar:9.0.75]
	at org.springframework.boot.actuate.metrics.web.servlet.WebMvcMetricsFilter.doFilterInternal(WebMvcMetricsFilter.java:96) ~[spring-boot-actuator-2.7.12.jar:2.7.12]
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:117) ~[spring-web-5.3.27.jar:5.3.27]
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:178) ~[tomcat-embed-core-9.0.75.jar:9.0.75]
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:153) ~[tomcat-embed-core-9.0.75.jar:9.0.75]
	at org.springframework.web.filter.CharacterEncodingFilter.doFilterInternal(CharacterEncodingFilter.java:201) ~[spring-web-5.3.27.jar:5.3.27]
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:117) ~[spring-web-5.3.27.jar:5.3.27]
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:178) ~[tomcat-embed-core-9.0.75.jar:9.0.75]
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:153) ~[tomcat-embed-core-9.0.75.jar:9.0.75]
	at org.apache.catalina.core.StandardWrapperValve.invoke(StandardWrapperValve.java:167) ~[tomcat-embed-core-9.0.75.jar:9.0.75]
	at org.apache.catalina.core.StandardContextValve.invoke(StandardContextValve.java:90) ~[tomcat-embed-core-9.0.75.jar:9.0.75]
	at org.apache.catalina.authenticator.AuthenticatorBase.invoke(AuthenticatorBase.java:481) ~[tomcat-embed-core-9.0.75.jar:9.0.75]
	at org.apache.catalina.core.StandardHostValve.invoke(StandardHostValve.java:130) ~[tomcat-embed-core-9.0.75.jar:9.0.75]
	at org.apache.catalina.valves.ErrorReportValve.invoke(ErrorReportValve.java:93) ~[tomcat-embed-core-9.0.75.jar:9.0.75]
	at org.apache.catalina.core.StandardEngineValve.invoke(StandardEngineValve.java:74) ~[tomcat-embed-core-9.0.75.jar:9.0.75]
	at org.apache.catalina.connector.CoyoteAdapter.service(CoyoteAdapter.java:343) ~[tomcat-embed-core-9.0.75.jar:9.0.75]
	at org.apache.coyote.http11.Http11Processor.service(Http11Processor.java:390) ~[tomcat-embed-core-9.0.75.jar:9.0.75]
	at org.apache.coyote.AbstractProcessorLight.process(AbstractProcessorLight.java:63) ~[tomcat-embed-core-9.0.75.jar:9.0.75]
	at org.apache.coyote.AbstractProtocol$ConnectionHandler.process(AbstractProtocol.java:926) ~[tomcat-embed-core-9.0.75.jar:9.0.75]
	at org.apache.tomcat.util.net.NioEndpoint$SocketProcessor.doRun(NioEndpoint.java:1791) ~[tomcat-embed-core-9.0.75.jar:9.0.75]
	at org.apache.tomcat.util.net.SocketProcessorBase.run(SocketProcessorBase.java:52) ~[tomcat-embed-core-9.0.75.jar:9.0.75]
	at org.apache.tomcat.util.threads.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1191) ~[tomcat-embed-core-9.0.75.jar:9.0.75]
	at org.apache.tomcat.util.threads.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:659) ~[tomcat-embed-core-9.0.75.jar:9.0.75]
	at org.apache.tomcat.util.threads.TaskThread$WrappingRunnable.run(TaskThread.java:61) ~[tomcat-embed-core-9.0.75.jar:9.0.75]
	at java.base/java.lang.Thread.run(Thread.java:840) ~[na:na]

21:13:06:589 DEBUG 33984 --- [http-nio-8080-exec-3] c.l.h.m.D.selectById                     : ==>  Preparing: SELECT id,patient_id,doctor_id,disease_name,disease_category,aimodel_id,result,create_time,status,id_card,name,score,remark FROM diagnosis_report WHERE id=?
21:13:06:590 DEBUG 33984 --- [http-nio-8080-exec-3] c.l.h.m.D.selectById                     : ==> Parameters: 1(Integer)
21:13:06:620 DEBUG 33984 --- [http-nio-8080-exec-3] c.l.h.m.D.selectById                     : <==      Total: 1
21:13:06:621 DEBUG 33984 --- [http-nio-8080-exec-3] c.l.h.mapper.PatientMapper.selectById    : ==>  Preparing: SELECT id,phone,id_card,name,verified,verified_by,verified_time,open_id,hospital_pid FROM patient WHERE id=?
21:13:06:622 DEBUG 33984 --- [http-nio-8080-exec-3] c.l.h.mapper.PatientMapper.selectById    : ==> Parameters: 1(Integer)
21:13:06:651 DEBUG 33984 --- [http-nio-8080-exec-3] c.l.h.mapper.PatientMapper.selectById    : <==      Total: 1
21:13:06:652 DEBUG 33984 --- [http-nio-8080-exec-3] c.l.h.mapper.DoctorMapper.selectById     : ==>  Preparing: SELECT id,phone,id_card,name,verified,verified_by,verified_time,license,department,hospital_pid FROM doctor WHERE id=?
21:13:06:652 DEBUG 33984 --- [http-nio-8080-exec-3] c.l.h.mapper.DoctorMapper.selectById     : ==> Parameters: 1(Integer)
21:13:06:680 DEBUG 33984 --- [http-nio-8080-exec-3] c.l.h.mapper.DoctorMapper.selectById     : <==      Total: 1
21:13:06:682 DEBUG 33984 --- [http-nio-8080-exec-3] c.l.h.m.E.selectListByDiagnosisId        : ==>  Preparing: select * from eye_images where dignosis_report_id = ?
21:13:06:682 DEBUG 33984 --- [http-nio-8080-exec-3] c.l.h.m.E.selectListByDiagnosisId        : ==> Parameters: 1(Integer)
21:13:06:710 DEBUG 33984 --- [http-nio-8080-exec-3] c.l.h.m.E.selectListByDiagnosisId        : <==      Total: 1
21:13:06:710 DEBUG 33984 --- [http-nio-8080-exec-3] c.l.h.m.T.selectByDiagnosisId            : ==>  Preparing: select * from treatment_plans where diagnosis_id = ?
21:13:06:711 DEBUG 33984 --- [http-nio-8080-exec-3] c.l.h.m.T.selectByDiagnosisId            : ==> Parameters: 1(Integer)
21:13:06:739 DEBUG 33984 --- [http-nio-8080-exec-3] c.l.h.m.T.selectByDiagnosisId            : <==      Total: 1
21:13:06:740 DEBUG 33984 --- [http-nio-8080-exec-3] c.l.h.m.M.selectByDiagnosisId            : ==>  Preparing: select * from medication_recommendations where diagnosis_id = ?
21:13:06:740 DEBUG 33984 --- [http-nio-8080-exec-3] c.l.h.m.M.selectByDiagnosisId            : ==> Parameters: 1(Integer)
21:13:06:768 DEBUG 33984 --- [http-nio-8080-exec-3] c.l.h.m.M.selectByDiagnosisId            : <==      Total: 1
21:13:06:769 DEBUG 33984 --- [http-nio-8080-exec-3] c.l.h.mapper.AiModelMapper.selectById    : ==>  Preparing: SELECT id,version,deploy_time,accuracy FROM ai_model WHERE id=?
21:13:06:769 DEBUG 33984 --- [http-nio-8080-exec-3] c.l.h.mapper.AiModelMapper.selectById    : ==> Parameters: 1(Integer)
21:13:06:798 DEBUG 33984 --- [http-nio-8080-exec-3] c.l.h.mapper.AiModelMapper.selectById    : <==      Total: 1
21:13:06:799 DEBUG 33984 --- [http-nio-8080-exec-3] o.s.c.openfeign.support.SpringEncoder    : Writing [ChatForm(diseaseName=, diseaseCategory=, result=A, remark=A, treatmentPlan=TreatmentPlans(id=1, diagnosisId=1, treatmentType=1, treatmentDetail=, startTime=2025-03-01T09:00, endDate=2025-03-10T09:00, doctorId=1, createdTime=2025-03-01T09:00, updatedTime=2025-03-01T09:00), medications=[MedicationRecommendations(id=1, diagnosisId=1, medicationName=A, dosage=10mg, frequency=, sideEffects=, startTime=2025-03-01T09:00, endTime=2025-03-10T09:00, doctorId=1, createdTime=2025-03-01T09:00, updatedTime=2025-03-01T09:00)], previousConversations=[DialogueInfo(role=pariatur tempor do, content=sit cupidatat commodo)], question=irure eu esse, stream=false)] using [org.springframework.http.converter.json.MappingJackson2HttpMessageConverter@3bf40c74]
21:13:06:802 DEBUG 33984 --- [http-nio-8080-exec-3] c.l.api.client.FlaskAiDoctorClient       : [FlaskAiDoctorClient#eye_doctor_chat] ---> POST http://ai-service/api/eye-doctor/chat HTTP/1.1
21:13:06:802 DEBUG 33984 --- [http-nio-8080-exec-3] c.l.api.client.FlaskAiDoctorClient       : [FlaskAiDoctorClient#eye_doctor_chat] Content-Length: 753
21:13:06:802 DEBUG 33984 --- [http-nio-8080-exec-3] c.l.api.client.FlaskAiDoctorClient       : [FlaskAiDoctorClient#eye_doctor_chat] Content-Type: application/json
21:13:06:802 DEBUG 33984 --- [http-nio-8080-exec-3] c.l.api.client.FlaskAiDoctorClient       : [FlaskAiDoctorClient#eye_doctor_chat] 
21:13:06:802 DEBUG 33984 --- [http-nio-8080-exec-3] c.l.api.client.FlaskAiDoctorClient       : [FlaskAiDoctorClient#eye_doctor_chat] {"diagnosis_name":"","diagnosis_category":"","result":"A","remark":"A","treatment_plan":{"id":1,"treatmentType":1,"treatmentDetail":"","startTime":"2025-03-01 09:00:00","endDate":"2025-03-10 09:00:00","doctorId":1,"createdTime":"2025-03-01T09:00:00","updatedTime":"2025-03-01T09:00:00"},"medications":[{"id":1,"diagnosisId":1,"medicationName":"A","dosage":"10mg","frequency":"","sideEffects":"","startTime":"2025-03-01T09:00:00","endTime":"2025-03-10T09:00:00","doctorId":1,"createdTime":"2025-03-01 09:00:00","updatedTime":"2025-03-01 09:00:00"}],"previous_conversations":[{"role":"pariatur tempor do","content":"sit cupidatat commodo"}],"question":"irure eu esse","stream":false}
21:13:06:804 DEBUG 33984 --- [http-nio-8080-exec-3] c.l.api.client.FlaskAiDoctorClient       : [FlaskAiDoctorClient#eye_doctor_chat] ---> END HTTP (753-byte body)
21:13:06:813 DEBUG 33984 --- [http-nio-8080-exec-3] c.l.api.client.FlaskAiDoctorClient       : [FlaskAiDoctorClient#eye_doctor_chat] <--- HTTP/1.1 422 Unprocessable Entity (8ms)
21:13:06:813 DEBUG 33984 --- [http-nio-8080-exec-3] c.l.api.client.FlaskAiDoctorClient       : [FlaskAiDoctorClient#eye_doctor_chat] content-length: 1784
21:13:06:813 DEBUG 33984 --- [http-nio-8080-exec-3] c.l.api.client.FlaskAiDoctorClient       : [FlaskAiDoctorClient#eye_doctor_chat] content-type: application/json
21:13:06:813 DEBUG 33984 --- [http-nio-8080-exec-3] c.l.api.client.FlaskAiDoctorClient       : [FlaskAiDoctorClient#eye_doctor_chat] date: Thu, 13 Mar 2025 13:13:06 GMT
21:13:06:813 DEBUG 33984 --- [http-nio-8080-exec-3] c.l.api.client.FlaskAiDoctorClient       : [FlaskAiDoctorClient#eye_doctor_chat] server: uvicorn
21:13:06:814 DEBUG 33984 --- [http-nio-8080-exec-3] c.l.api.client.FlaskAiDoctorClient       : [FlaskAiDoctorClient#eye_doctor_chat] 
21:13:06:814 DEBUG 33984 --- [http-nio-8080-exec-3] c.l.api.client.FlaskAiDoctorClient       : [FlaskAiDoctorClient#eye_doctor_chat] {"detail":[{"type":"missing","loc":["body","disease_name"],"msg":"Field required","input":{"diagnosis_name":"","diagnosis_category":"","result":"A","remark":"A","treatment_plan":{"id":1,"treatmentType":1,"treatmentDetail":"","startTime":"2025-03-01 09:00:00","endDate":"2025-03-10 09:00:00","doctorId":1,"createdTime":"2025-03-01T09:00:00","updatedTime":"2025-03-01T09:00:00"},"medications":[{"id":1,"diagnosisId":1,"medicationName":"A","dosage":"10mg","frequency":"","sideEffects":"","startTime":"2025-03-01T09:00:00","endTime":"2025-03-10T09:00:00","doctorId":1,"createdTime":"2025-03-01 09:00:00","updatedTime":"2025-03-01 09:00:00"}],"previous_conversations":[{"role":"pariatur tempor do","content":"sit cupidatat commodo"}],"question":"irure eu esse","stream":false},"url":"https://errors.pydantic.dev/2.4/v/missing"},{"type":"missing","loc":["body","disease_category"],"msg":"Field required","input":{"diagnosis_name":"","diagnosis_category":"","result":"A","remark":"A","treatment_plan":{"id":1,"treatmentType":1,"treatmentDetail":"","startTime":"2025-03-01 09:00:00","endDate":"2025-03-10 09:00:00","doctorId":1,"createdTime":"2025-03-01T09:00:00","updatedTime":"2025-03-01T09:00:00"},"medications":[{"id":1,"diagnosisId":1,"medicationName":"A","dosage":"10mg","frequency":"","sideEffects":"","startTime":"2025-03-01T09:00:00","endTime":"2025-03-10T09:00:00","doctorId":1,"createdTime":"2025-03-01 09:00:00","updatedTime":"2025-03-01 09:00:00"}],"previous_conversations":[{"role":"pariatur tempor do","content":"sit cupidatat commodo"}],"question":"irure eu esse","stream":false},"url":"https://errors.pydantic.dev/2.4/v/missing"}]}
21:13:06:815 DEBUG 33984 --- [http-nio-8080-exec-3] c.l.api.client.FlaskAiDoctorClient       : [FlaskAiDoctorClient#eye_doctor_chat] <--- END HTTP (1784-byte body)
21:13:06:817 ERROR 33984 --- [http-nio-8080-exec-3] o.a.c.c.C.[.[.[/].[dispatcherServlet]    : Servlet.service() for servlet [dispatcherServlet] in context with path [] threw exception [Request processing failed; nested exception is feign.FeignException$UnprocessableEntity: [422 Unprocessable Entity] during [POST] to [http://ai-service/api/eye-doctor/chat] [FlaskAiDoctorClient#eye_doctor_chat(ChatForm)]: [{"detail":[{"type":"missing","loc":["body","disease_name"],"msg":"Field required","input":{"diagnosis_name":"","diagnosis_category":"","result":"A","remark":"A","treatment_plan":{"id":1,"... (1784 bytes)]] with root cause

feign.FeignException$UnprocessableEntity: [422 Unprocessable Entity] during [POST] to [http://ai-service/api/eye-doctor/chat] [FlaskAiDoctorClient#eye_doctor_chat(ChatForm)]: [{"detail":[{"type":"missing","loc":["body","disease_name"],"msg":"Field required","input":{"diagnosis_name":"","diagnosis_category":"","result":"A","remark":"A","treatment_plan":{"id":1,"... (1784 bytes)]
	at feign.FeignException.clientErrorStatus(FeignException.java:233) ~[feign-core-11.10.jar:na]
	at feign.FeignException.errorStatus(FeignException.java:194) ~[feign-core-11.10.jar:na]
	at feign.FeignException.errorStatus(FeignException.java:185) ~[feign-core-11.10.jar:na]
	at feign.codec.ErrorDecoder$Default.decode(ErrorDecoder.java:92) ~[feign-core-11.10.jar:na]
	at feign.AsyncResponseHandler.handleResponse(AsyncResponseHandler.java:98) ~[feign-core-11.10.jar:na]
	at feign.SynchronousMethodHandler.executeAndDecode(SynchronousMethodHandler.java:141) ~[feign-core-11.10.jar:na]
	at feign.SynchronousMethodHandler.invoke(SynchronousMethodHandler.java:91) ~[feign-core-11.10.jar:na]
	at feign.ReflectiveFeign$FeignInvocationHandler.invoke(ReflectiveFeign.java:100) ~[feign-core-11.10.jar:na]
	at jdk.proxy2/jdk.proxy2.$Proxy138.eye_doctor_chat(Unknown Source) ~[na:na]
	at com.luojiawei.his_service.controller.ChatController.ask(ChatController.java:39) ~[classes/:na]
	at java.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke0(Native Method) ~[na:na]
	at java.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:77) ~[na:na]
	at java.base/jdk.internal.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43) ~[na:na]
	at java.base/java.lang.reflect.Method.invoke(Method.java:568) ~[na:na]
	at org.springframework.web.method.support.InvocableHandlerMethod.doInvoke(InvocableHandlerMethod.java:205) ~[spring-web-5.3.27.jar:5.3.27]
	at org.springframework.web.method.support.InvocableHandlerMethod.invokeForRequest(InvocableHandlerMethod.java:150) ~[spring-web-5.3.27.jar:5.3.27]
	at org.springframework.web.servlet.mvc.method.annotation.ServletInvocableHandlerMethod.invokeAndHandle(ServletInvocableHandlerMethod.java:117) ~[spring-webmvc-5.3.27.jar:5.3.27]
	at org.springframework.web.servlet.mvc.method.annotation.RequestMappingHandlerAdapter.invokeHandlerMethod(RequestMappingHandlerAdapter.java:895) ~[spring-webmvc-5.3.27.jar:5.3.27]
	at org.springframework.web.servlet.mvc.method.annotation.RequestMappingHandlerAdapter.handleInternal(RequestMappingHandlerAdapter.java:808) ~[spring-webmvc-5.3.27.jar:5.3.27]
	at org.springframework.web.servlet.mvc.method.AbstractHandlerMethodAdapter.handle(AbstractHandlerMethodAdapter.java:87) ~[spring-webmvc-5.3.27.jar:5.3.27]
	at org.springframework.web.servlet.DispatcherServlet.doDispatch(DispatcherServlet.java:1072) ~[spring-webmvc-5.3.27.jar:5.3.27]
	at org.springframework.web.servlet.DispatcherServlet.doService(DispatcherServlet.java:965) ~[spring-webmvc-5.3.27.jar:5.3.27]
	at org.springframework.web.servlet.FrameworkServlet.processRequest(FrameworkServlet.java:1006) ~[spring-webmvc-5.3.27.jar:5.3.27]
	at org.springframework.web.servlet.FrameworkServlet.doPost(FrameworkServlet.java:909) ~[spring-webmvc-5.3.27.jar:5.3.27]
	at javax.servlet.http.HttpServlet.service(HttpServlet.java:555) ~[tomcat-embed-core-9.0.75.jar:4.0.FR]
	at org.springframework.web.servlet.FrameworkServlet.service(FrameworkServlet.java:883) ~[spring-webmvc-5.3.27.jar:5.3.27]
	at javax.servlet.http.HttpServlet.service(HttpServlet.java:623) ~[tomcat-embed-core-9.0.75.jar:4.0.FR]
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:209) ~[tomcat-embed-core-9.0.75.jar:9.0.75]
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:153) ~[tomcat-embed-core-9.0.75.jar:9.0.75]
	at com.luojiawei.his_service.filter.RefreshTokenFilter.doFilterInternal(RefreshTokenFilter.java:58) ~[classes/:na]
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:117) ~[spring-web-5.3.27.jar:5.3.27]
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:178) ~[tomcat-embed-core-9.0.75.jar:9.0.75]
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:153) ~[tomcat-embed-core-9.0.75.jar:9.0.75]
	at org.springframework.web.filter.RequestContextFilter.doFilterInternal(RequestContextFilter.java:100) ~[spring-web-5.3.27.jar:5.3.27]
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:117) ~[spring-web-5.3.27.jar:5.3.27]
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:178) ~[tomcat-embed-core-9.0.75.jar:9.0.75]
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:153) ~[tomcat-embed-core-9.0.75.jar:9.0.75]
	at org.springframework.web.filter.FormContentFilter.doFilterInternal(FormContentFilter.java:93) ~[spring-web-5.3.27.jar:5.3.27]
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:117) ~[spring-web-5.3.27.jar:5.3.27]
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:178) ~[tomcat-embed-core-9.0.75.jar:9.0.75]
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:153) ~[tomcat-embed-core-9.0.75.jar:9.0.75]
	at org.springframework.boot.actuate.metrics.web.servlet.WebMvcMetricsFilter.doFilterInternal(WebMvcMetricsFilter.java:96) ~[spring-boot-actuator-2.7.12.jar:2.7.12]
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:117) ~[spring-web-5.3.27.jar:5.3.27]
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:178) ~[tomcat-embed-core-9.0.75.jar:9.0.75]
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:153) ~[tomcat-embed-core-9.0.75.jar:9.0.75]
	at org.springframework.web.filter.CharacterEncodingFilter.doFilterInternal(CharacterEncodingFilter.java:201) ~[spring-web-5.3.27.jar:5.3.27]
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:117) ~[spring-web-5.3.27.jar:5.3.27]
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:178) ~[tomcat-embed-core-9.0.75.jar:9.0.75]
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:153) ~[tomcat-embed-core-9.0.75.jar:9.0.75]
	at org.apache.catalina.core.StandardWrapperValve.invoke(StandardWrapperValve.java:167) ~[tomcat-embed-core-9.0.75.jar:9.0.75]
	at org.apache.catalina.core.StandardContextValve.invoke(StandardContextValve.java:90) ~[tomcat-embed-core-9.0.75.jar:9.0.75]
	at org.apache.catalina.authenticator.AuthenticatorBase.invoke(AuthenticatorBase.java:481) ~[tomcat-embed-core-9.0.75.jar:9.0.75]
	at org.apache.catalina.core.StandardHostValve.invoke(StandardHostValve.java:130) ~[tomcat-embed-core-9.0.75.jar:9.0.75]
	at org.apache.catalina.valves.ErrorReportValve.invoke(ErrorReportValve.java:93) ~[tomcat-embed-core-9.0.75.jar:9.0.75]
	at org.apache.catalina.core.StandardEngineValve.invoke(StandardEngineValve.java:74) ~[tomcat-embed-core-9.0.75.jar:9.0.75]
	at org.apache.catalina.connector.CoyoteAdapter.service(CoyoteAdapter.java:343) ~[tomcat-embed-core-9.0.75.jar:9.0.75]
	at org.apache.coyote.http11.Http11Processor.service(Http11Processor.java:390) ~[tomcat-embed-core-9.0.75.jar:9.0.75]
	at org.apache.coyote.AbstractProcessorLight.process(AbstractProcessorLight.java:63) ~[tomcat-embed-core-9.0.75.jar:9.0.75]
	at org.apache.coyote.AbstractProtocol$ConnectionHandler.process(AbstractProtocol.java:926) ~[tomcat-embed-core-9.0.75.jar:9.0.75]
	at org.apache.tomcat.util.net.NioEndpoint$SocketProcessor.doRun(NioEndpoint.java:1791) ~[tomcat-embed-core-9.0.75.jar:9.0.75]
	at org.apache.tomcat.util.net.SocketProcessorBase.run(SocketProcessorBase.java:52) ~[tomcat-embed-core-9.0.75.jar:9.0.75]
	at org.apache.tomcat.util.threads.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1191) ~[tomcat-embed-core-9.0.75.jar:9.0.75]
	at org.apache.tomcat.util.threads.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:659) ~[tomcat-embed-core-9.0.75.jar:9.0.75]
	at org.apache.tomcat.util.threads.TaskThread$WrappingRunnable.run(TaskThread.java:61) ~[tomcat-embed-core-9.0.75.jar:9.0.75]
	at java.base/java.lang.Thread.run(Thread.java:840) ~[na:na]

21:13:19:021  WARN 33984 --- [Thread-15] c.a.nacos.common.notify.NotifyCenter     : [NotifyCenter] Start destroying Publisher
21:13:19:021  WARN 33984 --- [Thread-15] c.a.nacos.common.notify.NotifyCenter     : [NotifyCenter] Destruction of the end
21:13:19:022  WARN 33984 --- [Thread-18] c.a.n.common.http.HttpClientBeanHolder   : [HttpClientBeanHolder] Start destroying common HttpClient
21:13:19:033  WARN 33984 --- [Thread-18] c.a.n.common.http.HttpClientBeanHolder   : [HttpClientBeanHolder] Destruction of the end
21:13:19:353  INFO 33984 --- [SpringApplicationShutdownHook] c.a.c.n.registry.NacosServiceRegistry    : De-registering from Nacos Server now...
21:13:19:577  INFO 33984 --- [SpringApplicationShutdownHook] c.a.c.n.registry.NacosServiceRegistry    : De-registration finished.
21:13:19:615  INFO 33984 --- [SpringApplicationShutdownHook] com.zaxxer.hikari.HikariDataSource       : HikariPool-1 - Shutdown initiated...
21:13:19:926  INFO 33984 --- [SpringApplicationShutdownHook] com.zaxxer.hikari.HikariDataSource       : HikariPool-1 - Shutdown completed.
21:13:34:617  INFO 24340 --- [main] c.l.his_service.HisServiceApplication    : Starting HisServiceApplication using Java 17.0.11 on luo with PID 24340 (A:\Desktop\workspace\HIS\his_service\target\classes started by 22407 in A:\Desktop\workspace\HIS)
21:13:34:618 DEBUG 24340 --- [main] c.l.his_service.HisServiceApplication    : Running with Spring Boot v2.7.12, Spring v5.3.27
21:13:34:618  INFO 24340 --- [main] c.l.his_service.HisServiceApplication    : The following 1 profile is active: "dev"
21:13:37:340 DEBUG 24340 --- [main] o.s.c.openfeign.FeignClientsRegistrar$1  : Identified candidate component class: file [A:\Desktop\workspace\HIS\his_api\target\classes\com\luojiawei\api\client\FlaskAiDoctorClient.class]
21:13:37:354 DEBUG 24340 --- [main] o.s.c.openfeign.FeignClientsRegistrar$1  : Identified candidate component class: file [A:\Desktop\workspace\HIS\his_api\target\classes\com\luojiawei\api\client\FlaskModelAnalyzeClient.class]
21:13:37:364 DEBUG 24340 --- [main] o.s.c.openfeign.FeignClientsRegistrar$1  : Identified candidate component class: file [A:\Desktop\workspace\HIS\his_api\target\classes\com\luojiawei\api\client\FlaskUploadClient.class]
21:13:38:240  INFO 24340 --- [main] .s.d.r.c.RepositoryConfigurationDelegate : Multiple Spring Data modules found, entering strict repository configuration mode
21:13:38:248  INFO 24340 --- [main] .s.d.r.c.RepositoryConfigurationDelegate : Bootstrapping Spring Data Redis repositories in DEFAULT mode.
21:13:38:358  INFO 24340 --- [main] .s.d.r.c.RepositoryConfigurationDelegate : Finished Spring Data repository scanning in 23 ms. Found 0 Redis repository interfaces.
21:13:38:992  INFO 24340 --- [main] o.s.cloud.context.scope.GenericScope     : BeanFactory id=93ec073a-d50a-3e20-8556-fa3097b20012
21:13:41:444  INFO 24340 --- [main] o.s.b.w.embedded.tomcat.TomcatWebServer  : Tomcat initialized with port(s): 8080 (http)
21:13:41:480  INFO 24340 --- [main] o.apache.catalina.core.StandardService   : Starting service [Tomcat]
21:13:41:481  INFO 24340 --- [main] org.apache.catalina.core.StandardEngine  : Starting Servlet engine: [Apache Tomcat/9.0.75]
21:13:41:763  INFO 24340 --- [main] o.a.c.c.C.[Tomcat].[localhost].[/]       : Initializing Spring embedded WebApplicationContext
21:13:41:763  INFO 24340 --- [main] w.s.c.ServletWebServerApplicationContext : Root WebApplicationContext: initialization completed in 7022 ms
21:13:42:783  INFO 24340 --- [main] org.redisson.Version                     : Redisson 3.17.7
21:13:43:758  INFO 24340 --- [redisson-netty-2-9] o.r.c.pool.MasterPubSubConnectionPool    : 1 connections initialized for 111.230.32.147/111.230.32.147:9631
21:13:44:454  INFO 24340 --- [redisson-netty-2-19] o.r.c.pool.MasterConnectionPool          : 24 connections initialized for 111.230.32.147/111.230.32.147:9631
21:13:45:129 DEBUG 24340 --- [main] c.l.h.filter.RefreshTokenFilter          : Filter 'refreshTokenFilter' configured for use
21:13:46:886  INFO 24340 --- [main] o.s.c.openfeign.FeignClientFactoryBean   : For 'flask-service' URL not provided. Will try picking an instance via load-balancing.
21:13:47:534  INFO 24340 --- [main] o.s.c.openfeign.FeignClientFactoryBean   : For 'ai-service' URL not provided. Will try picking an instance via load-balancing.
21:13:47:610  WARN 24340 --- [main] c.b.m.core.metadata.TableInfoHelper      : Can not find table primary key in Class: "java.lang.Object".
21:13:47:611  WARN 24340 --- [main] c.b.m.core.injector.DefaultSqlInjector   : class java.lang.Object ,Not found @TableId annotation, Cannot use Mybatis-Plus 'xxById' Method.
21:13:49:932  WARN 24340 --- [main] iguration$LoadBalancerCaffeineWarnLogger : Spring Cloud LoadBalancer is currently working with the default cache. While this cache implementation is useful for development and tests, it's recommended to use Caffeine cache in production.You can switch to using Caffeine cache, by adding it and org.springframework.cache.caffeine.CaffeineCacheManager to the classpath.
21:13:49:937  INFO 24340 --- [main] o.s.b.a.e.web.EndpointLinksResolver      : Exposing 1 endpoint(s) beneath base path '/actuator'
21:13:50:052  INFO 24340 --- [main] o.s.b.w.embedded.tomcat.TomcatWebServer  : Tomcat started on port(s): 8080 (http) with context path ''
21:13:50:140  INFO 24340 --- [main] c.a.n.p.a.s.c.ClientAuthPluginManager    : [ClientAuthPluginManager] Load ClientAuthService com.alibaba.nacos.client.auth.impl.NacosClientAuthServiceImpl success.
21:13:50:140  INFO 24340 --- [main] c.a.n.p.a.s.c.ClientAuthPluginManager    : [ClientAuthPluginManager] Load ClientAuthService com.alibaba.nacos.client.auth.ram.RamClientAuthServiceImpl success.
21:13:52:206  INFO 24340 --- [http-nio-8080-exec-2] o.a.c.c.C.[Tomcat].[localhost].[/]       : Initializing Spring DispatcherServlet 'dispatcherServlet'
21:13:52:206  INFO 24340 --- [http-nio-8080-exec-2] o.s.web.servlet.DispatcherServlet        : Initializing Servlet 'dispatcherServlet'
21:13:52:209  INFO 24340 --- [http-nio-8080-exec-2] o.s.web.servlet.DispatcherServlet        : Completed initialization in 3 ms
21:13:52:802  INFO 24340 --- [http-nio-8080-exec-2] com.zaxxer.hikari.HikariDataSource       : HikariPool-1 - Starting...
21:13:53:583  INFO 24340 --- [main] c.a.n.c.a.AbstractAbilityControlManager  : Ready to get current node abilities...
21:13:53:587  INFO 24340 --- [main] c.a.n.c.a.AbstractAbilityControlManager  : Ready to initialize current node abilities, support modes: [SDK_CLIENT]
21:13:53:588  INFO 24340 --- [main] c.a.n.c.a.AbstractAbilityControlManager  : Initialize current abilities finish...
21:13:53:589  INFO 24340 --- [main] c.a.n.c.a.d.NacosAbilityManagerHolder    : [AbilityControlManager] Successfully initialize AbilityControlManager
21:13:53:610  INFO 24340 --- [http-nio-8080-exec-2] com.zaxxer.hikari.HikariDataSource       : HikariPool-1 - Start completed.
21:13:53:625 DEBUG 24340 --- [http-nio-8080-exec-2] c.l.h.m.D.selectById                     : ==>  Preparing: SELECT id,patient_id,doctor_id,disease_name,disease_category,aimodel_id,result,create_time,status,id_card,name,score,remark FROM diagnosis_report WHERE id=?
21:13:53:668 DEBUG 24340 --- [http-nio-8080-exec-2] c.l.h.m.D.selectById                     : ==> Parameters: 1(Integer)
21:13:53:755 DEBUG 24340 --- [http-nio-8080-exec-2] c.l.h.m.D.selectById                     : <==      Total: 1
21:13:53:763 DEBUG 24340 --- [http-nio-8080-exec-2] c.l.h.mapper.PatientMapper.selectById    : ==>  Preparing: SELECT id,phone,id_card,name,verified,verified_by,verified_time,open_id,hospital_pid FROM patient WHERE id=?
21:13:53:763 DEBUG 24340 --- [http-nio-8080-exec-2] c.l.h.mapper.PatientMapper.selectById    : ==> Parameters: 1(Integer)
21:13:53:800 DEBUG 24340 --- [http-nio-8080-exec-2] c.l.h.mapper.PatientMapper.selectById    : <==      Total: 1
21:13:53:827 DEBUG 24340 --- [http-nio-8080-exec-2] c.l.h.mapper.DoctorMapper.selectById     : ==>  Preparing: SELECT id,phone,id_card,name,verified,verified_by,verified_time,license,department,hospital_pid FROM doctor WHERE id=?
21:13:53:828 DEBUG 24340 --- [http-nio-8080-exec-2] c.l.h.mapper.DoctorMapper.selectById     : ==> Parameters: 1(Integer)
21:13:53:865 DEBUG 24340 --- [http-nio-8080-exec-2] c.l.h.mapper.DoctorMapper.selectById     : <==      Total: 1
21:13:53:885  INFO 24340 --- [main] c.a.c.n.registry.NacosServiceRegistry    : nacos registry, DEFAULT_GROUP his-service 10.21.93.70:8080 register finished
21:13:53:886 DEBUG 24340 --- [http-nio-8080-exec-2] c.l.h.m.E.selectListByDiagnosisId        : ==>  Preparing: select * from eye_images where dignosis_report_id = ?
21:13:53:888 DEBUG 24340 --- [http-nio-8080-exec-2] c.l.h.m.E.selectListByDiagnosisId        : ==> Parameters: 1(Integer)
21:13:53:922 DEBUG 24340 --- [http-nio-8080-exec-2] c.l.h.m.E.selectListByDiagnosisId        : <==      Total: 1
21:13:53:923 DEBUG 24340 --- [http-nio-8080-exec-2] c.l.h.m.T.selectByDiagnosisId            : ==>  Preparing: select * from treatment_plans where diagnosis_id = ?
21:13:53:923 DEBUG 24340 --- [http-nio-8080-exec-2] c.l.h.m.T.selectByDiagnosisId            : ==> Parameters: 1(Integer)
21:13:53:959 DEBUG 24340 --- [http-nio-8080-exec-2] c.l.h.m.T.selectByDiagnosisId            : <==      Total: 1
21:13:53:960 DEBUG 24340 --- [http-nio-8080-exec-2] c.l.h.m.M.selectByDiagnosisId            : ==>  Preparing: select * from medication_recommendations where diagnosis_id = ?
21:13:53:960 DEBUG 24340 --- [http-nio-8080-exec-2] c.l.h.m.M.selectByDiagnosisId            : ==> Parameters: 1(Integer)
21:13:53:996 DEBUG 24340 --- [http-nio-8080-exec-2] c.l.h.m.M.selectByDiagnosisId            : <==      Total: 1
21:13:53:996 DEBUG 24340 --- [http-nio-8080-exec-2] c.l.h.mapper.AiModelMapper.selectById    : ==>  Preparing: SELECT id,version,deploy_time,accuracy FROM ai_model WHERE id=?
21:13:53:997 DEBUG 24340 --- [http-nio-8080-exec-2] c.l.h.mapper.AiModelMapper.selectById    : ==> Parameters: 1(Integer)
21:13:54:031 DEBUG 24340 --- [http-nio-8080-exec-2] c.l.h.mapper.AiModelMapper.selectById    : <==      Total: 1
21:13:54:082 DEBUG 24340 --- [http-nio-8080-exec-2] o.s.c.openfeign.support.SpringEncoder    : Writing [ChatForm(diseaseName=, diseaseCategory=, result=A, remark=A, treatmentPlan=TreatmentPlans(id=1, diagnosisId=1, treatmentType=1, treatmentDetail=, startTime=2025-03-01T09:00, endDate=2025-03-10T09:00, doctorId=1, createdTime=2025-03-01T09:00, updatedTime=2025-03-01T09:00), medications=[MedicationRecommendations(id=1, diagnosisId=1, medicationName=A, dosage=10mg, frequency=, sideEffects=, startTime=2025-03-01T09:00, endTime=2025-03-10T09:00, doctorId=1, createdTime=2025-03-01T09:00, updatedTime=2025-03-01T09:00)], previousConversations=[DialogueInfo(role=pariatur tempor do, content=sit cupidatat commodo)], question=irure eu esse, stream=false)] using [org.springframework.http.converter.json.MappingJackson2HttpMessageConverter@198c0f1c]
21:13:54:100 DEBUG 24340 --- [http-nio-8080-exec-2] c.l.api.client.FlaskAiDoctorClient       : [FlaskAiDoctorClient#eye_doctor_chat] ---> POST http://ai-service/api/eye-doctor/chat HTTP/1.1
21:13:54:100 DEBUG 24340 --- [http-nio-8080-exec-2] c.l.api.client.FlaskAiDoctorClient       : [FlaskAiDoctorClient#eye_doctor_chat] Content-Length: 753
21:13:54:100 DEBUG 24340 --- [http-nio-8080-exec-2] c.l.api.client.FlaskAiDoctorClient       : [FlaskAiDoctorClient#eye_doctor_chat] Content-Type: application/json
21:13:54:100 DEBUG 24340 --- [http-nio-8080-exec-2] c.l.api.client.FlaskAiDoctorClient       : [FlaskAiDoctorClient#eye_doctor_chat] 
21:13:54:100 DEBUG 24340 --- [http-nio-8080-exec-2] c.l.api.client.FlaskAiDoctorClient       : [FlaskAiDoctorClient#eye_doctor_chat] {"diagnosis_name":"","diagnosis_category":"","result":"A","remark":"A","treatment_plan":{"id":1,"treatmentType":1,"treatmentDetail":"","startTime":"2025-03-01 09:00:00","endDate":"2025-03-10 09:00:00","doctorId":1,"createdTime":"2025-03-01T09:00:00","updatedTime":"2025-03-01T09:00:00"},"medications":[{"id":1,"diagnosisId":1,"medicationName":"A","dosage":"10mg","frequency":"","sideEffects":"","startTime":"2025-03-01T09:00:00","endTime":"2025-03-10T09:00:00","doctorId":1,"createdTime":"2025-03-01 09:00:00","updatedTime":"2025-03-01 09:00:00"}],"previous_conversations":[{"role":"pariatur tempor do","content":"sit cupidatat commodo"}],"question":"irure eu esse","stream":false}
21:13:54:101 DEBUG 24340 --- [http-nio-8080-exec-2] c.l.api.client.FlaskAiDoctorClient       : [FlaskAiDoctorClient#eye_doctor_chat] ---> END HTTP (753-byte body)
21:13:54:204  INFO 24340 --- [main] c.l.his_service.HisServiceApplication    : Started HisServiceApplication in 21.177 seconds (JVM running for 30.246)
21:13:54:650 DEBUG 24340 --- [http-nio-8080-exec-2] c.l.api.client.FlaskAiDoctorClient       : [FlaskAiDoctorClient#eye_doctor_chat] <--- HTTP/1.1 422 Unprocessable Entity (549ms)
21:13:54:651 DEBUG 24340 --- [http-nio-8080-exec-2] c.l.api.client.FlaskAiDoctorClient       : [FlaskAiDoctorClient#eye_doctor_chat] content-length: 1784
21:13:54:651 DEBUG 24340 --- [http-nio-8080-exec-2] c.l.api.client.FlaskAiDoctorClient       : [FlaskAiDoctorClient#eye_doctor_chat] content-type: application/json
21:13:54:651 DEBUG 24340 --- [http-nio-8080-exec-2] c.l.api.client.FlaskAiDoctorClient       : [FlaskAiDoctorClient#eye_doctor_chat] date: Thu, 13 Mar 2025 13:13:54 GMT
21:13:54:651 DEBUG 24340 --- [http-nio-8080-exec-2] c.l.api.client.FlaskAiDoctorClient       : [FlaskAiDoctorClient#eye_doctor_chat] server: uvicorn
21:13:54:651 DEBUG 24340 --- [http-nio-8080-exec-2] c.l.api.client.FlaskAiDoctorClient       : [FlaskAiDoctorClient#eye_doctor_chat] 
21:13:54:652 DEBUG 24340 --- [http-nio-8080-exec-2] c.l.api.client.FlaskAiDoctorClient       : [FlaskAiDoctorClient#eye_doctor_chat] {"detail":[{"type":"missing","loc":["body","disease_name"],"msg":"Field required","input":{"diagnosis_name":"","diagnosis_category":"","result":"A","remark":"A","treatment_plan":{"id":1,"treatmentType":1,"treatmentDetail":"","startTime":"2025-03-01 09:00:00","endDate":"2025-03-10 09:00:00","doctorId":1,"createdTime":"2025-03-01T09:00:00","updatedTime":"2025-03-01T09:00:00"},"medications":[{"id":1,"diagnosisId":1,"medicationName":"A","dosage":"10mg","frequency":"","sideEffects":"","startTime":"2025-03-01T09:00:00","endTime":"2025-03-10T09:00:00","doctorId":1,"createdTime":"2025-03-01 09:00:00","updatedTime":"2025-03-01 09:00:00"}],"previous_conversations":[{"role":"pariatur tempor do","content":"sit cupidatat commodo"}],"question":"irure eu esse","stream":false},"url":"https://errors.pydantic.dev/2.4/v/missing"},{"type":"missing","loc":["body","disease_category"],"msg":"Field required","input":{"diagnosis_name":"","diagnosis_category":"","result":"A","remark":"A","treatment_plan":{"id":1,"treatmentType":1,"treatmentDetail":"","startTime":"2025-03-01 09:00:00","endDate":"2025-03-10 09:00:00","doctorId":1,"createdTime":"2025-03-01T09:00:00","updatedTime":"2025-03-01T09:00:00"},"medications":[{"id":1,"diagnosisId":1,"medicationName":"A","dosage":"10mg","frequency":"","sideEffects":"","startTime":"2025-03-01T09:00:00","endTime":"2025-03-10T09:00:00","doctorId":1,"createdTime":"2025-03-01 09:00:00","updatedTime":"2025-03-01 09:00:00"}],"previous_conversations":[{"role":"pariatur tempor do","content":"sit cupidatat commodo"}],"question":"irure eu esse","stream":false},"url":"https://errors.pydantic.dev/2.4/v/missing"}]}
21:13:54:653 DEBUG 24340 --- [http-nio-8080-exec-2] c.l.api.client.FlaskAiDoctorClient       : [FlaskAiDoctorClient#eye_doctor_chat] <--- END HTTP (1784-byte body)
21:13:54:686 ERROR 24340 --- [http-nio-8080-exec-2] o.a.c.c.C.[.[.[/].[dispatcherServlet]    : Servlet.service() for servlet [dispatcherServlet] in context with path [] threw exception [Request processing failed; nested exception is feign.FeignException$UnprocessableEntity: [422 Unprocessable Entity] during [POST] to [http://ai-service/api/eye-doctor/chat] [FlaskAiDoctorClient#eye_doctor_chat(ChatForm)]: [{"detail":[{"type":"missing","loc":["body","disease_name"],"msg":"Field required","input":{"diagnosis_name":"","diagnosis_category":"","result":"A","remark":"A","treatment_plan":{"id":1,"... (1784 bytes)]] with root cause

feign.FeignException$UnprocessableEntity: [422 Unprocessable Entity] during [POST] to [http://ai-service/api/eye-doctor/chat] [FlaskAiDoctorClient#eye_doctor_chat(ChatForm)]: [{"detail":[{"type":"missing","loc":["body","disease_name"],"msg":"Field required","input":{"diagnosis_name":"","diagnosis_category":"","result":"A","remark":"A","treatment_plan":{"id":1,"... (1784 bytes)]
	at feign.FeignException.clientErrorStatus(FeignException.java:233) ~[feign-core-11.10.jar:na]
	at feign.FeignException.errorStatus(FeignException.java:194) ~[feign-core-11.10.jar:na]
	at feign.FeignException.errorStatus(FeignException.java:185) ~[feign-core-11.10.jar:na]
	at feign.codec.ErrorDecoder$Default.decode(ErrorDecoder.java:92) ~[feign-core-11.10.jar:na]
	at feign.AsyncResponseHandler.handleResponse(AsyncResponseHandler.java:98) ~[feign-core-11.10.jar:na]
	at feign.SynchronousMethodHandler.executeAndDecode(SynchronousMethodHandler.java:141) ~[feign-core-11.10.jar:na]
	at feign.SynchronousMethodHandler.invoke(SynchronousMethodHandler.java:91) ~[feign-core-11.10.jar:na]
	at feign.ReflectiveFeign$FeignInvocationHandler.invoke(ReflectiveFeign.java:100) ~[feign-core-11.10.jar:na]
	at jdk.proxy2/jdk.proxy2.$Proxy138.eye_doctor_chat(Unknown Source) ~[na:na]
	at com.luojiawei.his_service.controller.ChatController.ask(ChatController.java:39) ~[classes/:na]
	at java.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke0(Native Method) ~[na:na]
	at java.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:77) ~[na:na]
	at java.base/jdk.internal.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43) ~[na:na]
	at java.base/java.lang.reflect.Method.invoke(Method.java:568) ~[na:na]
	at org.springframework.web.method.support.InvocableHandlerMethod.doInvoke(InvocableHandlerMethod.java:205) ~[spring-web-5.3.27.jar:5.3.27]
	at org.springframework.web.method.support.InvocableHandlerMethod.invokeForRequest(InvocableHandlerMethod.java:150) ~[spring-web-5.3.27.jar:5.3.27]
	at org.springframework.web.servlet.mvc.method.annotation.ServletInvocableHandlerMethod.invokeAndHandle(ServletInvocableHandlerMethod.java:117) ~[spring-webmvc-5.3.27.jar:5.3.27]
	at org.springframework.web.servlet.mvc.method.annotation.RequestMappingHandlerAdapter.invokeHandlerMethod(RequestMappingHandlerAdapter.java:895) ~[spring-webmvc-5.3.27.jar:5.3.27]
	at org.springframework.web.servlet.mvc.method.annotation.RequestMappingHandlerAdapter.handleInternal(RequestMappingHandlerAdapter.java:808) ~[spring-webmvc-5.3.27.jar:5.3.27]
	at org.springframework.web.servlet.mvc.method.AbstractHandlerMethodAdapter.handle(AbstractHandlerMethodAdapter.java:87) ~[spring-webmvc-5.3.27.jar:5.3.27]
	at org.springframework.web.servlet.DispatcherServlet.doDispatch(DispatcherServlet.java:1072) ~[spring-webmvc-5.3.27.jar:5.3.27]
	at org.springframework.web.servlet.DispatcherServlet.doService(DispatcherServlet.java:965) ~[spring-webmvc-5.3.27.jar:5.3.27]
	at org.springframework.web.servlet.FrameworkServlet.processRequest(FrameworkServlet.java:1006) ~[spring-webmvc-5.3.27.jar:5.3.27]
	at org.springframework.web.servlet.FrameworkServlet.doPost(FrameworkServlet.java:909) ~[spring-webmvc-5.3.27.jar:5.3.27]
	at javax.servlet.http.HttpServlet.service(HttpServlet.java:555) ~[tomcat-embed-core-9.0.75.jar:4.0.FR]
	at org.springframework.web.servlet.FrameworkServlet.service(FrameworkServlet.java:883) ~[spring-webmvc-5.3.27.jar:5.3.27]
	at javax.servlet.http.HttpServlet.service(HttpServlet.java:623) ~[tomcat-embed-core-9.0.75.jar:4.0.FR]
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:209) ~[tomcat-embed-core-9.0.75.jar:9.0.75]
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:153) ~[tomcat-embed-core-9.0.75.jar:9.0.75]
	at com.luojiawei.his_service.filter.RefreshTokenFilter.doFilterInternal(RefreshTokenFilter.java:58) ~[classes/:na]
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:117) ~[spring-web-5.3.27.jar:5.3.27]
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:178) ~[tomcat-embed-core-9.0.75.jar:9.0.75]
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:153) ~[tomcat-embed-core-9.0.75.jar:9.0.75]
	at org.springframework.web.filter.RequestContextFilter.doFilterInternal(RequestContextFilter.java:100) ~[spring-web-5.3.27.jar:5.3.27]
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:117) ~[spring-web-5.3.27.jar:5.3.27]
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:178) ~[tomcat-embed-core-9.0.75.jar:9.0.75]
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:153) ~[tomcat-embed-core-9.0.75.jar:9.0.75]
	at org.springframework.web.filter.FormContentFilter.doFilterInternal(FormContentFilter.java:93) ~[spring-web-5.3.27.jar:5.3.27]
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:117) ~[spring-web-5.3.27.jar:5.3.27]
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:178) ~[tomcat-embed-core-9.0.75.jar:9.0.75]
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:153) ~[tomcat-embed-core-9.0.75.jar:9.0.75]
	at org.springframework.boot.actuate.metrics.web.servlet.WebMvcMetricsFilter.doFilterInternal(WebMvcMetricsFilter.java:96) ~[spring-boot-actuator-2.7.12.jar:2.7.12]
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:117) ~[spring-web-5.3.27.jar:5.3.27]
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:178) ~[tomcat-embed-core-9.0.75.jar:9.0.75]
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:153) ~[tomcat-embed-core-9.0.75.jar:9.0.75]
	at org.springframework.web.filter.CharacterEncodingFilter.doFilterInternal(CharacterEncodingFilter.java:201) ~[spring-web-5.3.27.jar:5.3.27]
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:117) ~[spring-web-5.3.27.jar:5.3.27]
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:178) ~[tomcat-embed-core-9.0.75.jar:9.0.75]
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:153) ~[tomcat-embed-core-9.0.75.jar:9.0.75]
	at org.apache.catalina.core.StandardWrapperValve.invoke(StandardWrapperValve.java:167) ~[tomcat-embed-core-9.0.75.jar:9.0.75]
	at org.apache.catalina.core.StandardContextValve.invoke(StandardContextValve.java:90) ~[tomcat-embed-core-9.0.75.jar:9.0.75]
	at org.apache.catalina.authenticator.AuthenticatorBase.invoke(AuthenticatorBase.java:481) ~[tomcat-embed-core-9.0.75.jar:9.0.75]
	at org.apache.catalina.core.StandardHostValve.invoke(StandardHostValve.java:130) ~[tomcat-embed-core-9.0.75.jar:9.0.75]
	at org.apache.catalina.valves.ErrorReportValve.invoke(ErrorReportValve.java:93) ~[tomcat-embed-core-9.0.75.jar:9.0.75]
	at org.apache.catalina.core.StandardEngineValve.invoke(StandardEngineValve.java:74) ~[tomcat-embed-core-9.0.75.jar:9.0.75]
	at org.apache.catalina.connector.CoyoteAdapter.service(CoyoteAdapter.java:343) ~[tomcat-embed-core-9.0.75.jar:9.0.75]
	at org.apache.coyote.http11.Http11Processor.service(Http11Processor.java:390) ~[tomcat-embed-core-9.0.75.jar:9.0.75]
	at org.apache.coyote.AbstractProcessorLight.process(AbstractProcessorLight.java:63) ~[tomcat-embed-core-9.0.75.jar:9.0.75]
	at org.apache.coyote.AbstractProtocol$ConnectionHandler.process(AbstractProtocol.java:926) ~[tomcat-embed-core-9.0.75.jar:9.0.75]
	at org.apache.tomcat.util.net.NioEndpoint$SocketProcessor.doRun(NioEndpoint.java:1791) ~[tomcat-embed-core-9.0.75.jar:9.0.75]
	at org.apache.tomcat.util.net.SocketProcessorBase.run(SocketProcessorBase.java:52) ~[tomcat-embed-core-9.0.75.jar:9.0.75]
	at org.apache.tomcat.util.threads.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1191) ~[tomcat-embed-core-9.0.75.jar:9.0.75]
	at org.apache.tomcat.util.threads.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:659) ~[tomcat-embed-core-9.0.75.jar:9.0.75]
	at org.apache.tomcat.util.threads.TaskThread$WrappingRunnable.run(TaskThread.java:61) ~[tomcat-embed-core-9.0.75.jar:9.0.75]
	at java.base/java.lang.Thread.run(Thread.java:840) ~[na:na]

21:15:18:749 DEBUG 24340 --- [http-nio-8080-exec-5] c.l.h.m.D.selectById                     : ==>  Preparing: SELECT id,patient_id,doctor_id,disease_name,disease_category,aimodel_id,result,create_time,status,id_card,name,score,remark FROM diagnosis_report WHERE id=?
21:15:18:750 DEBUG 24340 --- [http-nio-8080-exec-5] c.l.h.m.D.selectById                     : ==> Parameters: 1(Integer)
21:15:18:786 DEBUG 24340 --- [http-nio-8080-exec-5] c.l.h.m.D.selectById                     : <==      Total: 1
21:15:18:786 DEBUG 24340 --- [http-nio-8080-exec-5] c.l.h.mapper.PatientMapper.selectById    : ==>  Preparing: SELECT id,phone,id_card,name,verified,verified_by,verified_time,open_id,hospital_pid FROM patient WHERE id=?
21:15:18:787 DEBUG 24340 --- [http-nio-8080-exec-5] c.l.h.mapper.PatientMapper.selectById    : ==> Parameters: 1(Integer)
21:15:18:822 DEBUG 24340 --- [http-nio-8080-exec-5] c.l.h.mapper.PatientMapper.selectById    : <==      Total: 1
21:15:18:823 DEBUG 24340 --- [http-nio-8080-exec-5] c.l.h.mapper.DoctorMapper.selectById     : ==>  Preparing: SELECT id,phone,id_card,name,verified,verified_by,verified_time,license,department,hospital_pid FROM doctor WHERE id=?
21:15:18:823 DEBUG 24340 --- [http-nio-8080-exec-5] c.l.h.mapper.DoctorMapper.selectById     : ==> Parameters: 1(Integer)
21:15:18:858 DEBUG 24340 --- [http-nio-8080-exec-5] c.l.h.mapper.DoctorMapper.selectById     : <==      Total: 1
21:15:18:858 DEBUG 24340 --- [http-nio-8080-exec-5] c.l.h.m.E.selectListByDiagnosisId        : ==>  Preparing: select * from eye_images where dignosis_report_id = ?
21:15:18:859 DEBUG 24340 --- [http-nio-8080-exec-5] c.l.h.m.E.selectListByDiagnosisId        : ==> Parameters: 1(Integer)
21:15:18:893 DEBUG 24340 --- [http-nio-8080-exec-5] c.l.h.m.E.selectListByDiagnosisId        : <==      Total: 1
21:15:18:894 DEBUG 24340 --- [http-nio-8080-exec-5] c.l.h.m.T.selectByDiagnosisId            : ==>  Preparing: select * from treatment_plans where diagnosis_id = ?
21:15:18:894 DEBUG 24340 --- [http-nio-8080-exec-5] c.l.h.m.T.selectByDiagnosisId            : ==> Parameters: 1(Integer)
21:15:18:929 DEBUG 24340 --- [http-nio-8080-exec-5] c.l.h.m.T.selectByDiagnosisId            : <==      Total: 1
21:15:18:929 DEBUG 24340 --- [http-nio-8080-exec-5] c.l.h.m.M.selectByDiagnosisId            : ==>  Preparing: select * from medication_recommendations where diagnosis_id = ?
21:15:18:929 DEBUG 24340 --- [http-nio-8080-exec-5] c.l.h.m.M.selectByDiagnosisId            : ==> Parameters: 1(Integer)
21:15:18:966 DEBUG 24340 --- [http-nio-8080-exec-5] c.l.h.m.M.selectByDiagnosisId            : <==      Total: 1
21:15:18:967 DEBUG 24340 --- [http-nio-8080-exec-5] c.l.h.mapper.AiModelMapper.selectById    : ==>  Preparing: SELECT id,version,deploy_time,accuracy FROM ai_model WHERE id=?
21:15:18:967 DEBUG 24340 --- [http-nio-8080-exec-5] c.l.h.mapper.AiModelMapper.selectById    : ==> Parameters: 1(Integer)
21:15:19:002 DEBUG 24340 --- [http-nio-8080-exec-5] c.l.h.mapper.AiModelMapper.selectById    : <==      Total: 1
21:15:37:097 DEBUG 24340 --- [http-nio-8080-exec-5] o.s.c.openfeign.support.SpringEncoder    : Writing [ChatForm(diseaseName=, diseaseCategory=, result=A, remark=A, treatmentPlan=TreatmentPlans(id=1, diagnosisId=1, treatmentType=1, treatmentDetail=, startTime=2025-03-01T09:00, endDate=2025-03-10T09:00, doctorId=1, createdTime=2025-03-01T09:00, updatedTime=2025-03-01T09:00), medications=[MedicationRecommendations(id=1, diagnosisId=1, medicationName=A, dosage=10mg, frequency=, sideEffects=, startTime=2025-03-01T09:00, endTime=2025-03-10T09:00, doctorId=1, createdTime=2025-03-01T09:00, updatedTime=2025-03-01T09:00)], previousConversations=[DialogueInfo(role=pariatur tempor do, content=sit cupidatat commodo)], question=irure eu esse, stream=false)] using [org.springframework.http.converter.json.MappingJackson2HttpMessageConverter@198c0f1c]
21:15:37:099 DEBUG 24340 --- [http-nio-8080-exec-5] c.l.api.client.FlaskAiDoctorClient       : [FlaskAiDoctorClient#eye_doctor_chat] ---> POST http://ai-service/api/eye-doctor/chat HTTP/1.1
21:15:37:099 DEBUG 24340 --- [http-nio-8080-exec-5] c.l.api.client.FlaskAiDoctorClient       : [FlaskAiDoctorClient#eye_doctor_chat] Content-Length: 753
21:15:37:099 DEBUG 24340 --- [http-nio-8080-exec-5] c.l.api.client.FlaskAiDoctorClient       : [FlaskAiDoctorClient#eye_doctor_chat] Content-Type: application/json
21:15:37:099 DEBUG 24340 --- [http-nio-8080-exec-5] c.l.api.client.FlaskAiDoctorClient       : [FlaskAiDoctorClient#eye_doctor_chat] 
21:15:37:099 DEBUG 24340 --- [http-nio-8080-exec-5] c.l.api.client.FlaskAiDoctorClient       : [FlaskAiDoctorClient#eye_doctor_chat] {"diagnosis_name":"","diagnosis_category":"","result":"A","remark":"A","treatment_plan":{"id":1,"treatmentType":1,"treatmentDetail":"","startTime":"2025-03-01 09:00:00","endDate":"2025-03-10 09:00:00","doctorId":1,"createdTime":"2025-03-01T09:00:00","updatedTime":"2025-03-01T09:00:00"},"medications":[{"id":1,"diagnosisId":1,"medicationName":"A","dosage":"10mg","frequency":"","sideEffects":"","startTime":"2025-03-01T09:00:00","endTime":"2025-03-10T09:00:00","doctorId":1,"createdTime":"2025-03-01 09:00:00","updatedTime":"2025-03-01 09:00:00"}],"previous_conversations":[{"role":"pariatur tempor do","content":"sit cupidatat commodo"}],"question":"irure eu esse","stream":false}
21:15:37:099 DEBUG 24340 --- [http-nio-8080-exec-5] c.l.api.client.FlaskAiDoctorClient       : [FlaskAiDoctorClient#eye_doctor_chat] ---> END HTTP (753-byte body)
21:15:37:110 DEBUG 24340 --- [http-nio-8080-exec-5] c.l.api.client.FlaskAiDoctorClient       : [FlaskAiDoctorClient#eye_doctor_chat] <--- HTTP/1.1 422 Unprocessable Entity (10ms)
21:15:37:110 DEBUG 24340 --- [http-nio-8080-exec-5] c.l.api.client.FlaskAiDoctorClient       : [FlaskAiDoctorClient#eye_doctor_chat] content-length: 1784
21:15:37:110 DEBUG 24340 --- [http-nio-8080-exec-5] c.l.api.client.FlaskAiDoctorClient       : [FlaskAiDoctorClient#eye_doctor_chat] content-type: application/json
21:15:37:111 DEBUG 24340 --- [http-nio-8080-exec-5] c.l.api.client.FlaskAiDoctorClient       : [FlaskAiDoctorClient#eye_doctor_chat] date: Thu, 13 Mar 2025 13:15:36 GMT
21:15:37:111 DEBUG 24340 --- [http-nio-8080-exec-5] c.l.api.client.FlaskAiDoctorClient       : [FlaskAiDoctorClient#eye_doctor_chat] server: uvicorn
21:15:37:111 DEBUG 24340 --- [http-nio-8080-exec-5] c.l.api.client.FlaskAiDoctorClient       : [FlaskAiDoctorClient#eye_doctor_chat] 
21:15:37:111 DEBUG 24340 --- [http-nio-8080-exec-5] c.l.api.client.FlaskAiDoctorClient       : [FlaskAiDoctorClient#eye_doctor_chat] {"detail":[{"type":"missing","loc":["body","disease_name"],"msg":"Field required","input":{"diagnosis_name":"","diagnosis_category":"","result":"A","remark":"A","treatment_plan":{"id":1,"treatmentType":1,"treatmentDetail":"","startTime":"2025-03-01 09:00:00","endDate":"2025-03-10 09:00:00","doctorId":1,"createdTime":"2025-03-01T09:00:00","updatedTime":"2025-03-01T09:00:00"},"medications":[{"id":1,"diagnosisId":1,"medicationName":"A","dosage":"10mg","frequency":"","sideEffects":"","startTime":"2025-03-01T09:00:00","endTime":"2025-03-10T09:00:00","doctorId":1,"createdTime":"2025-03-01 09:00:00","updatedTime":"2025-03-01 09:00:00"}],"previous_conversations":[{"role":"pariatur tempor do","content":"sit cupidatat commodo"}],"question":"irure eu esse","stream":false},"url":"https://errors.pydantic.dev/2.4/v/missing"},{"type":"missing","loc":["body","disease_category"],"msg":"Field required","input":{"diagnosis_name":"","diagnosis_category":"","result":"A","remark":"A","treatment_plan":{"id":1,"treatmentType":1,"treatmentDetail":"","startTime":"2025-03-01 09:00:00","endDate":"2025-03-10 09:00:00","doctorId":1,"createdTime":"2025-03-01T09:00:00","updatedTime":"2025-03-01T09:00:00"},"medications":[{"id":1,"diagnosisId":1,"medicationName":"A","dosage":"10mg","frequency":"","sideEffects":"","startTime":"2025-03-01T09:00:00","endTime":"2025-03-10T09:00:00","doctorId":1,"createdTime":"2025-03-01 09:00:00","updatedTime":"2025-03-01 09:00:00"}],"previous_conversations":[{"role":"pariatur tempor do","content":"sit cupidatat commodo"}],"question":"irure eu esse","stream":false},"url":"https://errors.pydantic.dev/2.4/v/missing"}]}
21:15:37:111 DEBUG 24340 --- [http-nio-8080-exec-5] c.l.api.client.FlaskAiDoctorClient       : [FlaskAiDoctorClient#eye_doctor_chat] <--- END HTTP (1784-byte body)
21:15:37:113 ERROR 24340 --- [http-nio-8080-exec-5] o.a.c.c.C.[.[.[/].[dispatcherServlet]    : Servlet.service() for servlet [dispatcherServlet] in context with path [] threw exception [Request processing failed; nested exception is feign.FeignException$UnprocessableEntity: [422 Unprocessable Entity] during [POST] to [http://ai-service/api/eye-doctor/chat] [FlaskAiDoctorClient#eye_doctor_chat(ChatForm)]: [{"detail":[{"type":"missing","loc":["body","disease_name"],"msg":"Field required","input":{"diagnosis_name":"","diagnosis_category":"","result":"A","remark":"A","treatment_plan":{"id":1,"... (1784 bytes)]] with root cause

feign.FeignException$UnprocessableEntity: [422 Unprocessable Entity] during [POST] to [http://ai-service/api/eye-doctor/chat] [FlaskAiDoctorClient#eye_doctor_chat(ChatForm)]: [{"detail":[{"type":"missing","loc":["body","disease_name"],"msg":"Field required","input":{"diagnosis_name":"","diagnosis_category":"","result":"A","remark":"A","treatment_plan":{"id":1,"... (1784 bytes)]
	at feign.FeignException.clientErrorStatus(FeignException.java:233) ~[feign-core-11.10.jar:na]
	at feign.FeignException.errorStatus(FeignException.java:194) ~[feign-core-11.10.jar:na]
	at feign.FeignException.errorStatus(FeignException.java:185) ~[feign-core-11.10.jar:na]
	at feign.codec.ErrorDecoder$Default.decode(ErrorDecoder.java:92) ~[feign-core-11.10.jar:na]
	at feign.AsyncResponseHandler.handleResponse(AsyncResponseHandler.java:98) ~[feign-core-11.10.jar:na]
	at feign.SynchronousMethodHandler.executeAndDecode(SynchronousMethodHandler.java:141) ~[feign-core-11.10.jar:na]
	at feign.SynchronousMethodHandler.invoke(SynchronousMethodHandler.java:91) ~[feign-core-11.10.jar:na]
	at feign.ReflectiveFeign$FeignInvocationHandler.invoke(ReflectiveFeign.java:100) ~[feign-core-11.10.jar:na]
	at jdk.proxy2/jdk.proxy2.$Proxy138.eye_doctor_chat(Unknown Source) ~[na:na]
	at com.luojiawei.his_service.controller.ChatController.ask(ChatController.java:39) ~[classes/:na]
	at java.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke0(Native Method) ~[na:na]
	at java.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:77) ~[na:na]
	at java.base/jdk.internal.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43) ~[na:na]
	at java.base/java.lang.reflect.Method.invoke(Method.java:568) ~[na:na]
	at org.springframework.web.method.support.InvocableHandlerMethod.doInvoke(InvocableHandlerMethod.java:205) ~[spring-web-5.3.27.jar:5.3.27]
	at org.springframework.web.method.support.InvocableHandlerMethod.invokeForRequest(InvocableHandlerMethod.java:150) ~[spring-web-5.3.27.jar:5.3.27]
	at org.springframework.web.servlet.mvc.method.annotation.ServletInvocableHandlerMethod.invokeAndHandle(ServletInvocableHandlerMethod.java:117) ~[spring-webmvc-5.3.27.jar:5.3.27]
	at org.springframework.web.servlet.mvc.method.annotation.RequestMappingHandlerAdapter.invokeHandlerMethod(RequestMappingHandlerAdapter.java:895) ~[spring-webmvc-5.3.27.jar:5.3.27]
	at org.springframework.web.servlet.mvc.method.annotation.RequestMappingHandlerAdapter.handleInternal(RequestMappingHandlerAdapter.java:808) ~[spring-webmvc-5.3.27.jar:5.3.27]
	at org.springframework.web.servlet.mvc.method.AbstractHandlerMethodAdapter.handle(AbstractHandlerMethodAdapter.java:87) ~[spring-webmvc-5.3.27.jar:5.3.27]
	at org.springframework.web.servlet.DispatcherServlet.doDispatch(DispatcherServlet.java:1072) ~[spring-webmvc-5.3.27.jar:5.3.27]
	at org.springframework.web.servlet.DispatcherServlet.doService(DispatcherServlet.java:965) ~[spring-webmvc-5.3.27.jar:5.3.27]
	at org.springframework.web.servlet.FrameworkServlet.processRequest(FrameworkServlet.java:1006) ~[spring-webmvc-5.3.27.jar:5.3.27]
	at org.springframework.web.servlet.FrameworkServlet.doPost(FrameworkServlet.java:909) ~[spring-webmvc-5.3.27.jar:5.3.27]
	at javax.servlet.http.HttpServlet.service(HttpServlet.java:555) ~[tomcat-embed-core-9.0.75.jar:4.0.FR]
	at org.springframework.web.servlet.FrameworkServlet.service(FrameworkServlet.java:883) ~[spring-webmvc-5.3.27.jar:5.3.27]
	at javax.servlet.http.HttpServlet.service(HttpServlet.java:623) ~[tomcat-embed-core-9.0.75.jar:4.0.FR]
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:209) ~[tomcat-embed-core-9.0.75.jar:9.0.75]
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:153) ~[tomcat-embed-core-9.0.75.jar:9.0.75]
	at com.luojiawei.his_service.filter.RefreshTokenFilter.doFilterInternal(RefreshTokenFilter.java:58) ~[classes/:na]
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:117) ~[spring-web-5.3.27.jar:5.3.27]
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:178) ~[tomcat-embed-core-9.0.75.jar:9.0.75]
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:153) ~[tomcat-embed-core-9.0.75.jar:9.0.75]
	at org.springframework.web.filter.RequestContextFilter.doFilterInternal(RequestContextFilter.java:100) ~[spring-web-5.3.27.jar:5.3.27]
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:117) ~[spring-web-5.3.27.jar:5.3.27]
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:178) ~[tomcat-embed-core-9.0.75.jar:9.0.75]
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:153) ~[tomcat-embed-core-9.0.75.jar:9.0.75]
	at org.springframework.web.filter.FormContentFilter.doFilterInternal(FormContentFilter.java:93) ~[spring-web-5.3.27.jar:5.3.27]
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:117) ~[spring-web-5.3.27.jar:5.3.27]
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:178) ~[tomcat-embed-core-9.0.75.jar:9.0.75]
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:153) ~[tomcat-embed-core-9.0.75.jar:9.0.75]
	at org.springframework.boot.actuate.metrics.web.servlet.WebMvcMetricsFilter.doFilterInternal(WebMvcMetricsFilter.java:96) ~[spring-boot-actuator-2.7.12.jar:2.7.12]
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:117) ~[spring-web-5.3.27.jar:5.3.27]
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:178) ~[tomcat-embed-core-9.0.75.jar:9.0.75]
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:153) ~[tomcat-embed-core-9.0.75.jar:9.0.75]
	at org.springframework.web.filter.CharacterEncodingFilter.doFilterInternal(CharacterEncodingFilter.java:201) ~[spring-web-5.3.27.jar:5.3.27]
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:117) ~[spring-web-5.3.27.jar:5.3.27]
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:178) ~[tomcat-embed-core-9.0.75.jar:9.0.75]
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:153) ~[tomcat-embed-core-9.0.75.jar:9.0.75]
	at org.apache.catalina.core.StandardWrapperValve.invoke(StandardWrapperValve.java:167) ~[tomcat-embed-core-9.0.75.jar:9.0.75]
	at org.apache.catalina.core.StandardContextValve.invoke(StandardContextValve.java:90) ~[tomcat-embed-core-9.0.75.jar:9.0.75]
	at org.apache.catalina.authenticator.AuthenticatorBase.invoke(AuthenticatorBase.java:481) ~[tomcat-embed-core-9.0.75.jar:9.0.75]
	at org.apache.catalina.core.StandardHostValve.invoke(StandardHostValve.java:130) ~[tomcat-embed-core-9.0.75.jar:9.0.75]
	at org.apache.catalina.valves.ErrorReportValve.invoke(ErrorReportValve.java:93) ~[tomcat-embed-core-9.0.75.jar:9.0.75]
	at org.apache.catalina.core.StandardEngineValve.invoke(StandardEngineValve.java:74) ~[tomcat-embed-core-9.0.75.jar:9.0.75]
	at org.apache.catalina.connector.CoyoteAdapter.service(CoyoteAdapter.java:343) ~[tomcat-embed-core-9.0.75.jar:9.0.75]
	at org.apache.coyote.http11.Http11Processor.service(Http11Processor.java:390) ~[tomcat-embed-core-9.0.75.jar:9.0.75]
	at org.apache.coyote.AbstractProcessorLight.process(AbstractProcessorLight.java:63) ~[tomcat-embed-core-9.0.75.jar:9.0.75]
	at org.apache.coyote.AbstractProtocol$ConnectionHandler.process(AbstractProtocol.java:926) ~[tomcat-embed-core-9.0.75.jar:9.0.75]
	at org.apache.tomcat.util.net.NioEndpoint$SocketProcessor.doRun(NioEndpoint.java:1791) ~[tomcat-embed-core-9.0.75.jar:9.0.75]
	at org.apache.tomcat.util.net.SocketProcessorBase.run(SocketProcessorBase.java:52) ~[tomcat-embed-core-9.0.75.jar:9.0.75]
	at org.apache.tomcat.util.threads.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1191) ~[tomcat-embed-core-9.0.75.jar:9.0.75]
	at org.apache.tomcat.util.threads.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:659) ~[tomcat-embed-core-9.0.75.jar:9.0.75]
	at org.apache.tomcat.util.threads.TaskThread$WrappingRunnable.run(TaskThread.java:61) ~[tomcat-embed-core-9.0.75.jar:9.0.75]
	at java.base/java.lang.Thread.run(Thread.java:840) ~[na:na]

21:17:15:784  WARN 24340 --- [Thread-15] c.a.nacos.common.notify.NotifyCenter     : [NotifyCenter] Start destroying Publisher
21:17:15:784  WARN 24340 --- [Thread-18] c.a.n.common.http.HttpClientBeanHolder   : [HttpClientBeanHolder] Start destroying common HttpClient
21:17:15:784  WARN 24340 --- [Thread-15] c.a.nacos.common.notify.NotifyCenter     : [NotifyCenter] Destruction of the end
21:17:15:785  WARN 24340 --- [Thread-18] c.a.n.common.http.HttpClientBeanHolder   : [HttpClientBeanHolder] Destruction of the end
21:17:15:842  INFO 24340 --- [SpringApplicationShutdownHook] c.a.c.n.registry.NacosServiceRegistry    : De-registering from Nacos Server now...
21:17:15:851  INFO 24340 --- [SpringApplicationShutdownHook] c.a.c.n.registry.NacosServiceRegistry    : De-registration finished.
21:17:15:867  INFO 24340 --- [SpringApplicationShutdownHook] com.zaxxer.hikari.HikariDataSource       : HikariPool-1 - Shutdown initiated...
21:17:16:182  INFO 24340 --- [SpringApplicationShutdownHook] com.zaxxer.hikari.HikariDataSource       : HikariPool-1 - Shutdown completed.
21:17:45:835  INFO 36348 --- [main] c.l.his_service.HisServiceApplication    : Starting HisServiceApplication using Java 17.0.11 on luo with PID 36348 (A:\Desktop\workspace\HIS\his_service\target\classes started by 22407 in A:\Desktop\workspace\HIS)
21:17:45:836 DEBUG 36348 --- [main] c.l.his_service.HisServiceApplication    : Running with Spring Boot v2.7.12, Spring v5.3.27
21:17:45:837  INFO 36348 --- [main] c.l.his_service.HisServiceApplication    : The following 1 profile is active: "dev"
21:17:46:579 DEBUG 36348 --- [main] o.s.c.openfeign.FeignClientsRegistrar$1  : Identified candidate component class: file [A:\Desktop\workspace\HIS\his_api\target\classes\com\luojiawei\api\client\FlaskAiDoctorClient.class]
21:17:46:580 DEBUG 36348 --- [main] o.s.c.openfeign.FeignClientsRegistrar$1  : Identified candidate component class: file [A:\Desktop\workspace\HIS\his_api\target\classes\com\luojiawei\api\client\FlaskModelAnalyzeClient.class]
21:17:46:580 DEBUG 36348 --- [main] o.s.c.openfeign.FeignClientsRegistrar$1  : Identified candidate component class: file [A:\Desktop\workspace\HIS\his_api\target\classes\com\luojiawei\api\client\FlaskUploadClient.class]
21:17:46:939  INFO 36348 --- [main] .s.d.r.c.RepositoryConfigurationDelegate : Multiple Spring Data modules found, entering strict repository configuration mode
21:17:46:942  INFO 36348 --- [main] .s.d.r.c.RepositoryConfigurationDelegate : Bootstrapping Spring Data Redis repositories in DEFAULT mode.
21:17:46:979  INFO 36348 --- [main] .s.d.r.c.RepositoryConfigurationDelegate : Finished Spring Data repository scanning in 17 ms. Found 0 Redis repository interfaces.
21:17:47:337  INFO 36348 --- [main] o.s.cloud.context.scope.GenericScope     : BeanFactory id=93ec073a-d50a-3e20-8556-fa3097b20012
21:17:48:929  INFO 36348 --- [main] o.s.b.w.embedded.tomcat.TomcatWebServer  : Tomcat initialized with port(s): 8080 (http)
21:17:48:956  INFO 36348 --- [main] o.apache.catalina.core.StandardService   : Starting service [Tomcat]
21:17:48:956  INFO 36348 --- [main] org.apache.catalina.core.StandardEngine  : Starting Servlet engine: [Apache Tomcat/9.0.75]
21:17:49:190  INFO 36348 --- [main] o.a.c.c.C.[Tomcat].[localhost].[/]       : Initializing Spring embedded WebApplicationContext
21:17:49:191  INFO 36348 --- [main] w.s.c.ServletWebServerApplicationContext : Root WebApplicationContext: initialization completed in 3301 ms
21:17:49:645  INFO 36348 --- [main] org.redisson.Version                     : Redisson 3.17.7
21:17:50:149  INFO 36348 --- [redisson-netty-2-9] o.r.c.pool.MasterPubSubConnectionPool    : 1 connections initialized for 111.230.32.147/111.230.32.147:9631
21:17:50:840  INFO 36348 --- [redisson-netty-2-19] o.r.c.pool.MasterConnectionPool          : 24 connections initialized for 111.230.32.147/111.230.32.147:9631
21:17:51:189 DEBUG 36348 --- [main] c.l.h.filter.RefreshTokenFilter          : Filter 'refreshTokenFilter' configured for use
21:17:52:091  INFO 36348 --- [main] o.s.c.openfeign.FeignClientFactoryBean   : For 'flask-service' URL not provided. Will try picking an instance via load-balancing.
21:17:52:482  INFO 36348 --- [main] o.s.c.openfeign.FeignClientFactoryBean   : For 'ai-service' URL not provided. Will try picking an instance via load-balancing.
21:17:52:531  WARN 36348 --- [main] c.b.m.core.metadata.TableInfoHelper      : Can not find table primary key in Class: "java.lang.Object".
21:17:52:531  WARN 36348 --- [main] c.b.m.core.injector.DefaultSqlInjector   : class java.lang.Object ,Not found @TableId annotation, Cannot use Mybatis-Plus 'xxById' Method.
21:17:54:268  WARN 36348 --- [main] iguration$LoadBalancerCaffeineWarnLogger : Spring Cloud LoadBalancer is currently working with the default cache. While this cache implementation is useful for development and tests, it's recommended to use Caffeine cache in production.You can switch to using Caffeine cache, by adding it and org.springframework.cache.caffeine.CaffeineCacheManager to the classpath.
21:17:54:274  INFO 36348 --- [main] o.s.b.a.e.web.EndpointLinksResolver      : Exposing 1 endpoint(s) beneath base path '/actuator'
21:17:54:406  INFO 36348 --- [main] o.s.b.w.embedded.tomcat.TomcatWebServer  : Tomcat started on port(s): 8080 (http) with context path ''
21:17:54:543  INFO 36348 --- [main] c.a.n.p.a.s.c.ClientAuthPluginManager    : [ClientAuthPluginManager] Load ClientAuthService com.alibaba.nacos.client.auth.impl.NacosClientAuthServiceImpl success.
21:17:54:543  INFO 36348 --- [main] c.a.n.p.a.s.c.ClientAuthPluginManager    : [ClientAuthPluginManager] Load ClientAuthService com.alibaba.nacos.client.auth.ram.RamClientAuthServiceImpl success.
21:17:54:696  INFO 36348 --- [http-nio-8080-exec-2] o.a.c.c.C.[Tomcat].[localhost].[/]       : Initializing Spring DispatcherServlet 'dispatcherServlet'
21:17:54:697  INFO 36348 --- [http-nio-8080-exec-2] o.s.web.servlet.DispatcherServlet        : Initializing Servlet 'dispatcherServlet'
21:17:54:700  INFO 36348 --- [http-nio-8080-exec-2] o.s.web.servlet.DispatcherServlet        : Completed initialization in 3 ms
21:17:55:384  INFO 36348 --- [http-nio-8080-exec-2] com.zaxxer.hikari.HikariDataSource       : HikariPool-1 - Starting...
21:17:56:201  INFO 36348 --- [http-nio-8080-exec-2] com.zaxxer.hikari.HikariDataSource       : HikariPool-1 - Start completed.
21:17:56:214 DEBUG 36348 --- [http-nio-8080-exec-2] c.l.h.m.D.selectById                     : ==>  Preparing: SELECT id,patient_id,doctor_id,disease_name,disease_category,aimodel_id,result,create_time,status,id_card,name,score,remark FROM diagnosis_report WHERE id=?
21:17:56:269 DEBUG 36348 --- [http-nio-8080-exec-2] c.l.h.m.D.selectById                     : ==> Parameters: 1(Integer)
21:17:56:417 DEBUG 36348 --- [http-nio-8080-exec-2] c.l.h.m.D.selectById                     : <==      Total: 1
21:17:56:427 DEBUG 36348 --- [http-nio-8080-exec-2] c.l.h.mapper.PatientMapper.selectById    : ==>  Preparing: SELECT id,phone,id_card,name,verified,verified_by,verified_time,open_id,hospital_pid FROM patient WHERE id=?
21:17:56:428 DEBUG 36348 --- [http-nio-8080-exec-2] c.l.h.mapper.PatientMapper.selectById    : ==> Parameters: 1(Integer)
21:17:56:460 DEBUG 36348 --- [http-nio-8080-exec-2] c.l.h.mapper.PatientMapper.selectById    : <==      Total: 1
21:17:56:469 DEBUG 36348 --- [http-nio-8080-exec-2] c.l.h.mapper.DoctorMapper.selectById     : ==>  Preparing: SELECT id,phone,id_card,name,verified,verified_by,verified_time,license,department,hospital_pid FROM doctor WHERE id=?
21:17:56:470 DEBUG 36348 --- [http-nio-8080-exec-2] c.l.h.mapper.DoctorMapper.selectById     : ==> Parameters: 1(Integer)
21:17:56:503 DEBUG 36348 --- [http-nio-8080-exec-2] c.l.h.mapper.DoctorMapper.selectById     : <==      Total: 1
21:17:56:511 DEBUG 36348 --- [http-nio-8080-exec-2] c.l.h.m.E.selectListByDiagnosisId        : ==>  Preparing: select * from eye_images where dignosis_report_id = ?
21:17:56:512 DEBUG 36348 --- [http-nio-8080-exec-2] c.l.h.m.E.selectListByDiagnosisId        : ==> Parameters: 1(Integer)
21:17:56:544 DEBUG 36348 --- [http-nio-8080-exec-2] c.l.h.m.E.selectListByDiagnosisId        : <==      Total: 1
21:17:56:546 DEBUG 36348 --- [http-nio-8080-exec-2] c.l.h.m.T.selectByDiagnosisId            : ==>  Preparing: select * from treatment_plans where diagnosis_id = ?
21:17:56:546 DEBUG 36348 --- [http-nio-8080-exec-2] c.l.h.m.T.selectByDiagnosisId            : ==> Parameters: 1(Integer)
21:17:56:579 DEBUG 36348 --- [http-nio-8080-exec-2] c.l.h.m.T.selectByDiagnosisId            : <==      Total: 1
21:17:56:580 DEBUG 36348 --- [http-nio-8080-exec-2] c.l.h.m.M.selectByDiagnosisId            : ==>  Preparing: select * from medication_recommendations where diagnosis_id = ?
21:17:56:580 DEBUG 36348 --- [http-nio-8080-exec-2] c.l.h.m.M.selectByDiagnosisId            : ==> Parameters: 1(Integer)
21:17:56:613 DEBUG 36348 --- [http-nio-8080-exec-2] c.l.h.m.M.selectByDiagnosisId            : <==      Total: 1
21:17:56:614 DEBUG 36348 --- [http-nio-8080-exec-2] c.l.h.mapper.AiModelMapper.selectById    : ==>  Preparing: SELECT id,version,deploy_time,accuracy FROM ai_model WHERE id=?
21:17:56:614 DEBUG 36348 --- [http-nio-8080-exec-2] c.l.h.mapper.AiModelMapper.selectById    : ==> Parameters: 1(Integer)
21:17:56:646 DEBUG 36348 --- [http-nio-8080-exec-2] c.l.h.mapper.AiModelMapper.selectById    : <==      Total: 1
21:17:56:686 DEBUG 36348 --- [http-nio-8080-exec-2] o.s.c.openfeign.support.SpringEncoder    : Writing [ChatForm(diagnosisName=, diagnosisCategory=, result=A, remark=A, treatmentPlan=TreatmentPlans(id=1, diagnosisId=1, treatmentType=1, treatmentDetail=, startTime=2025-03-01T09:00, endDate=2025-03-10T09:00, doctorId=1, createdTime=2025-03-01T09:00, updatedTime=2025-03-01T09:00), medications=[MedicationRecommendations(id=1, diagnosisId=1, medicationName=A, dosage=10mg, frequency=, sideEffects=, startTime=2025-03-01T09:00, endTime=2025-03-10T09:00, doctorId=1, createdTime=2025-03-01T09:00, updatedTime=2025-03-01T09:00)], previousConversations=[DialogueInfo(role=pariatur tempor do, content=sit cupidatat commodo)], question=irure eu esse, stream=false)] using [org.springframework.http.converter.json.MappingJackson2HttpMessageConverter@137d04d8]
21:17:56:714 DEBUG 36348 --- [http-nio-8080-exec-2] c.l.api.client.FlaskAiDoctorClient       : [FlaskAiDoctorClient#eye_doctor_chat] ---> POST http://ai-service/api/eye-doctor/chat HTTP/1.1
21:17:56:715 DEBUG 36348 --- [http-nio-8080-exec-2] c.l.api.client.FlaskAiDoctorClient       : [FlaskAiDoctorClient#eye_doctor_chat] Content-Length: 753
21:17:56:715 DEBUG 36348 --- [http-nio-8080-exec-2] c.l.api.client.FlaskAiDoctorClient       : [FlaskAiDoctorClient#eye_doctor_chat] Content-Type: application/json
21:17:56:715 DEBUG 36348 --- [http-nio-8080-exec-2] c.l.api.client.FlaskAiDoctorClient       : [FlaskAiDoctorClient#eye_doctor_chat] 
21:17:56:715 DEBUG 36348 --- [http-nio-8080-exec-2] c.l.api.client.FlaskAiDoctorClient       : [FlaskAiDoctorClient#eye_doctor_chat] {"diagnosis_name":"","diagnosis_category":"","result":"A","remark":"A","treatment_plan":{"id":1,"treatmentType":1,"treatmentDetail":"","startTime":"2025-03-01 09:00:00","endDate":"2025-03-10 09:00:00","doctorId":1,"createdTime":"2025-03-01T09:00:00","updatedTime":"2025-03-01T09:00:00"},"medications":[{"id":1,"diagnosisId":1,"medicationName":"A","dosage":"10mg","frequency":"","sideEffects":"","startTime":"2025-03-01T09:00:00","endTime":"2025-03-10T09:00:00","doctorId":1,"createdTime":"2025-03-01 09:00:00","updatedTime":"2025-03-01 09:00:00"}],"previous_conversations":[{"role":"pariatur tempor do","content":"sit cupidatat commodo"}],"question":"irure eu esse","stream":false}
21:17:56:715 DEBUG 36348 --- [http-nio-8080-exec-2] c.l.api.client.FlaskAiDoctorClient       : [FlaskAiDoctorClient#eye_doctor_chat] ---> END HTTP (753-byte body)
21:17:57:053  INFO 36348 --- [main] c.a.n.c.a.AbstractAbilityControlManager  : Ready to get current node abilities...
21:17:57:055  INFO 36348 --- [main] c.a.n.c.a.AbstractAbilityControlManager  : Ready to initialize current node abilities, support modes: [SDK_CLIENT]
21:17:57:056  INFO 36348 --- [main] c.a.n.c.a.AbstractAbilityControlManager  : Initialize current abilities finish...
21:17:57:057  INFO 36348 --- [main] c.a.n.c.a.d.NacosAbilityManagerHolder    : [AbilityControlManager] Successfully initialize AbilityControlManager
21:17:57:270  INFO 36348 --- [main] c.a.c.n.registry.NacosServiceRegistry    : nacos registry, DEFAULT_GROUP his-service 10.21.93.70:8080 register finished
21:17:57:297 DEBUG 36348 --- [http-nio-8080-exec-2] c.l.api.client.FlaskAiDoctorClient       : [FlaskAiDoctorClient#eye_doctor_chat] <--- HTTP/1.1 422 Unprocessable Entity (581ms)
21:17:57:297 DEBUG 36348 --- [http-nio-8080-exec-2] c.l.api.client.FlaskAiDoctorClient       : [FlaskAiDoctorClient#eye_doctor_chat] content-length: 1784
21:17:57:297 DEBUG 36348 --- [http-nio-8080-exec-2] c.l.api.client.FlaskAiDoctorClient       : [FlaskAiDoctorClient#eye_doctor_chat] content-type: application/json
21:17:57:297 DEBUG 36348 --- [http-nio-8080-exec-2] c.l.api.client.FlaskAiDoctorClient       : [FlaskAiDoctorClient#eye_doctor_chat] date: Thu, 13 Mar 2025 13:17:56 GMT
21:17:57:297 DEBUG 36348 --- [http-nio-8080-exec-2] c.l.api.client.FlaskAiDoctorClient       : [FlaskAiDoctorClient#eye_doctor_chat] server: uvicorn
21:17:57:298 DEBUG 36348 --- [http-nio-8080-exec-2] c.l.api.client.FlaskAiDoctorClient       : [FlaskAiDoctorClient#eye_doctor_chat] 
21:17:57:299 DEBUG 36348 --- [http-nio-8080-exec-2] c.l.api.client.FlaskAiDoctorClient       : [FlaskAiDoctorClient#eye_doctor_chat] {"detail":[{"type":"missing","loc":["body","disease_name"],"msg":"Field required","input":{"diagnosis_name":"","diagnosis_category":"","result":"A","remark":"A","treatment_plan":{"id":1,"treatmentType":1,"treatmentDetail":"","startTime":"2025-03-01 09:00:00","endDate":"2025-03-10 09:00:00","doctorId":1,"createdTime":"2025-03-01T09:00:00","updatedTime":"2025-03-01T09:00:00"},"medications":[{"id":1,"diagnosisId":1,"medicationName":"A","dosage":"10mg","frequency":"","sideEffects":"","startTime":"2025-03-01T09:00:00","endTime":"2025-03-10T09:00:00","doctorId":1,"createdTime":"2025-03-01 09:00:00","updatedTime":"2025-03-01 09:00:00"}],"previous_conversations":[{"role":"pariatur tempor do","content":"sit cupidatat commodo"}],"question":"irure eu esse","stream":false},"url":"https://errors.pydantic.dev/2.4/v/missing"},{"type":"missing","loc":["body","disease_category"],"msg":"Field required","input":{"diagnosis_name":"","diagnosis_category":"","result":"A","remark":"A","treatment_plan":{"id":1,"treatmentType":1,"treatmentDetail":"","startTime":"2025-03-01 09:00:00","endDate":"2025-03-10 09:00:00","doctorId":1,"createdTime":"2025-03-01T09:00:00","updatedTime":"2025-03-01T09:00:00"},"medications":[{"id":1,"diagnosisId":1,"medicationName":"A","dosage":"10mg","frequency":"","sideEffects":"","startTime":"2025-03-01T09:00:00","endTime":"2025-03-10T09:00:00","doctorId":1,"createdTime":"2025-03-01 09:00:00","updatedTime":"2025-03-01 09:00:00"}],"previous_conversations":[{"role":"pariatur tempor do","content":"sit cupidatat commodo"}],"question":"irure eu esse","stream":false},"url":"https://errors.pydantic.dev/2.4/v/missing"}]}
21:17:57:299 DEBUG 36348 --- [http-nio-8080-exec-2] c.l.api.client.FlaskAiDoctorClient       : [FlaskAiDoctorClient#eye_doctor_chat] <--- END HTTP (1784-byte body)
21:17:57:321 ERROR 36348 --- [http-nio-8080-exec-2] o.a.c.c.C.[.[.[/].[dispatcherServlet]    : Servlet.service() for servlet [dispatcherServlet] in context with path [] threw exception [Request processing failed; nested exception is feign.FeignException$UnprocessableEntity: [422 Unprocessable Entity] during [POST] to [http://ai-service/api/eye-doctor/chat] [FlaskAiDoctorClient#eye_doctor_chat(ChatForm)]: [{"detail":[{"type":"missing","loc":["body","disease_name"],"msg":"Field required","input":{"diagnosis_name":"","diagnosis_category":"","result":"A","remark":"A","treatment_plan":{"id":1,"... (1784 bytes)]] with root cause

feign.FeignException$UnprocessableEntity: [422 Unprocessable Entity] during [POST] to [http://ai-service/api/eye-doctor/chat] [FlaskAiDoctorClient#eye_doctor_chat(ChatForm)]: [{"detail":[{"type":"missing","loc":["body","disease_name"],"msg":"Field required","input":{"diagnosis_name":"","diagnosis_category":"","result":"A","remark":"A","treatment_plan":{"id":1,"... (1784 bytes)]
	at feign.FeignException.clientErrorStatus(FeignException.java:233) ~[feign-core-11.10.jar:na]
	at feign.FeignException.errorStatus(FeignException.java:194) ~[feign-core-11.10.jar:na]
	at feign.FeignException.errorStatus(FeignException.java:185) ~[feign-core-11.10.jar:na]
	at feign.codec.ErrorDecoder$Default.decode(ErrorDecoder.java:92) ~[feign-core-11.10.jar:na]
	at feign.AsyncResponseHandler.handleResponse(AsyncResponseHandler.java:98) ~[feign-core-11.10.jar:na]
	at feign.SynchronousMethodHandler.executeAndDecode(SynchronousMethodHandler.java:141) ~[feign-core-11.10.jar:na]
	at feign.SynchronousMethodHandler.invoke(SynchronousMethodHandler.java:91) ~[feign-core-11.10.jar:na]
	at feign.ReflectiveFeign$FeignInvocationHandler.invoke(ReflectiveFeign.java:100) ~[feign-core-11.10.jar:na]
	at jdk.proxy2/jdk.proxy2.$Proxy138.eye_doctor_chat(Unknown Source) ~[na:na]
	at com.luojiawei.his_service.controller.ChatController.ask(ChatController.java:39) ~[classes/:na]
	at java.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke0(Native Method) ~[na:na]
	at java.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:77) ~[na:na]
	at java.base/jdk.internal.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43) ~[na:na]
	at java.base/java.lang.reflect.Method.invoke(Method.java:568) ~[na:na]
	at org.springframework.web.method.support.InvocableHandlerMethod.doInvoke(InvocableHandlerMethod.java:205) ~[spring-web-5.3.27.jar:5.3.27]
	at org.springframework.web.method.support.InvocableHandlerMethod.invokeForRequest(InvocableHandlerMethod.java:150) ~[spring-web-5.3.27.jar:5.3.27]
	at org.springframework.web.servlet.mvc.method.annotation.ServletInvocableHandlerMethod.invokeAndHandle(ServletInvocableHandlerMethod.java:117) ~[spring-webmvc-5.3.27.jar:5.3.27]
	at org.springframework.web.servlet.mvc.method.annotation.RequestMappingHandlerAdapter.invokeHandlerMethod(RequestMappingHandlerAdapter.java:895) ~[spring-webmvc-5.3.27.jar:5.3.27]
	at org.springframework.web.servlet.mvc.method.annotation.RequestMappingHandlerAdapter.handleInternal(RequestMappingHandlerAdapter.java:808) ~[spring-webmvc-5.3.27.jar:5.3.27]
	at org.springframework.web.servlet.mvc.method.AbstractHandlerMethodAdapter.handle(AbstractHandlerMethodAdapter.java:87) ~[spring-webmvc-5.3.27.jar:5.3.27]
	at org.springframework.web.servlet.DispatcherServlet.doDispatch(DispatcherServlet.java:1072) ~[spring-webmvc-5.3.27.jar:5.3.27]
	at org.springframework.web.servlet.DispatcherServlet.doService(DispatcherServlet.java:965) ~[spring-webmvc-5.3.27.jar:5.3.27]
	at org.springframework.web.servlet.FrameworkServlet.processRequest(FrameworkServlet.java:1006) ~[spring-webmvc-5.3.27.jar:5.3.27]
	at org.springframework.web.servlet.FrameworkServlet.doPost(FrameworkServlet.java:909) ~[spring-webmvc-5.3.27.jar:5.3.27]
	at javax.servlet.http.HttpServlet.service(HttpServlet.java:555) ~[tomcat-embed-core-9.0.75.jar:4.0.FR]
	at org.springframework.web.servlet.FrameworkServlet.service(FrameworkServlet.java:883) ~[spring-webmvc-5.3.27.jar:5.3.27]
	at javax.servlet.http.HttpServlet.service(HttpServlet.java:623) ~[tomcat-embed-core-9.0.75.jar:4.0.FR]
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:209) ~[tomcat-embed-core-9.0.75.jar:9.0.75]
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:153) ~[tomcat-embed-core-9.0.75.jar:9.0.75]
	at com.luojiawei.his_service.filter.RefreshTokenFilter.doFilterInternal(RefreshTokenFilter.java:58) ~[classes/:na]
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:117) ~[spring-web-5.3.27.jar:5.3.27]
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:178) ~[tomcat-embed-core-9.0.75.jar:9.0.75]
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:153) ~[tomcat-embed-core-9.0.75.jar:9.0.75]
	at org.springframework.web.filter.RequestContextFilter.doFilterInternal(RequestContextFilter.java:100) ~[spring-web-5.3.27.jar:5.3.27]
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:117) ~[spring-web-5.3.27.jar:5.3.27]
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:178) ~[tomcat-embed-core-9.0.75.jar:9.0.75]
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:153) ~[tomcat-embed-core-9.0.75.jar:9.0.75]
	at org.springframework.web.filter.FormContentFilter.doFilterInternal(FormContentFilter.java:93) ~[spring-web-5.3.27.jar:5.3.27]
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:117) ~[spring-web-5.3.27.jar:5.3.27]
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:178) ~[tomcat-embed-core-9.0.75.jar:9.0.75]
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:153) ~[tomcat-embed-core-9.0.75.jar:9.0.75]
	at org.springframework.boot.actuate.metrics.web.servlet.WebMvcMetricsFilter.doFilterInternal(WebMvcMetricsFilter.java:96) ~[spring-boot-actuator-2.7.12.jar:2.7.12]
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:117) ~[spring-web-5.3.27.jar:5.3.27]
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:178) ~[tomcat-embed-core-9.0.75.jar:9.0.75]
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:153) ~[tomcat-embed-core-9.0.75.jar:9.0.75]
	at org.springframework.web.filter.CharacterEncodingFilter.doFilterInternal(CharacterEncodingFilter.java:201) ~[spring-web-5.3.27.jar:5.3.27]
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:117) ~[spring-web-5.3.27.jar:5.3.27]
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:178) ~[tomcat-embed-core-9.0.75.jar:9.0.75]
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:153) ~[tomcat-embed-core-9.0.75.jar:9.0.75]
	at org.apache.catalina.core.StandardWrapperValve.invoke(StandardWrapperValve.java:167) ~[tomcat-embed-core-9.0.75.jar:9.0.75]
	at org.apache.catalina.core.StandardContextValve.invoke(StandardContextValve.java:90) ~[tomcat-embed-core-9.0.75.jar:9.0.75]
	at org.apache.catalina.authenticator.AuthenticatorBase.invoke(AuthenticatorBase.java:481) ~[tomcat-embed-core-9.0.75.jar:9.0.75]
	at org.apache.catalina.core.StandardHostValve.invoke(StandardHostValve.java:130) ~[tomcat-embed-core-9.0.75.jar:9.0.75]
	at org.apache.catalina.valves.ErrorReportValve.invoke(ErrorReportValve.java:93) ~[tomcat-embed-core-9.0.75.jar:9.0.75]
	at org.apache.catalina.core.StandardEngineValve.invoke(StandardEngineValve.java:74) ~[tomcat-embed-core-9.0.75.jar:9.0.75]
	at org.apache.catalina.connector.CoyoteAdapter.service(CoyoteAdapter.java:343) ~[tomcat-embed-core-9.0.75.jar:9.0.75]
	at org.apache.coyote.http11.Http11Processor.service(Http11Processor.java:390) ~[tomcat-embed-core-9.0.75.jar:9.0.75]
	at org.apache.coyote.AbstractProcessorLight.process(AbstractProcessorLight.java:63) ~[tomcat-embed-core-9.0.75.jar:9.0.75]
	at org.apache.coyote.AbstractProtocol$ConnectionHandler.process(AbstractProtocol.java:926) ~[tomcat-embed-core-9.0.75.jar:9.0.75]
	at org.apache.tomcat.util.net.NioEndpoint$SocketProcessor.doRun(NioEndpoint.java:1791) ~[tomcat-embed-core-9.0.75.jar:9.0.75]
	at org.apache.tomcat.util.net.SocketProcessorBase.run(SocketProcessorBase.java:52) ~[tomcat-embed-core-9.0.75.jar:9.0.75]
	at org.apache.tomcat.util.threads.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1191) ~[tomcat-embed-core-9.0.75.jar:9.0.75]
	at org.apache.tomcat.util.threads.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:659) ~[tomcat-embed-core-9.0.75.jar:9.0.75]
	at org.apache.tomcat.util.threads.TaskThread$WrappingRunnable.run(TaskThread.java:61) ~[tomcat-embed-core-9.0.75.jar:9.0.75]
	at java.base/java.lang.Thread.run(Thread.java:840) ~[na:na]

21:17:57:644  INFO 36348 --- [main] c.l.his_service.HisServiceApplication    : Started HisServiceApplication in 13.181 seconds (JVM running for 14.888)
21:20:40:869  WARN 36348 --- [Thread-15] c.a.nacos.common.notify.NotifyCenter     : [NotifyCenter] Start destroying Publisher
21:20:40:869  WARN 36348 --- [Thread-18] c.a.n.common.http.HttpClientBeanHolder   : [HttpClientBeanHolder] Start destroying common HttpClient
21:20:40:870  WARN 36348 --- [Thread-15] c.a.nacos.common.notify.NotifyCenter     : [NotifyCenter] Destruction of the end
21:20:40:873  WARN 36348 --- [Thread-18] c.a.n.common.http.HttpClientBeanHolder   : [HttpClientBeanHolder] Destruction of the end
21:20:40:944  INFO 36348 --- [SpringApplicationShutdownHook] c.a.c.n.registry.NacosServiceRegistry    : De-registering from Nacos Server now...
21:20:40:974  INFO 36348 --- [SpringApplicationShutdownHook] c.a.c.n.registry.NacosServiceRegistry    : De-registration finished.
21:20:41:019  INFO 36348 --- [SpringApplicationShutdownHook] com.zaxxer.hikari.HikariDataSource       : HikariPool-1 - Shutdown initiated...
21:20:41:329  INFO 36348 --- [SpringApplicationShutdownHook] com.zaxxer.hikari.HikariDataSource       : HikariPool-1 - Shutdown completed.
21:20:49:474  INFO 32476 --- [main] c.l.his_service.HisServiceApplication    : Starting HisServiceApplication using Java 17.0.11 on luo with PID 32476 (A:\Desktop\workspace\HIS\his_service\target\classes started by 22407 in A:\Desktop\workspace\HIS)
21:20:49:475 DEBUG 32476 --- [main] c.l.his_service.HisServiceApplication    : Running with Spring Boot v2.7.12, Spring v5.3.27
21:20:49:476  INFO 32476 --- [main] c.l.his_service.HisServiceApplication    : The following 1 profile is active: "dev"
21:20:50:348 DEBUG 32476 --- [main] o.s.c.openfeign.FeignClientsRegistrar$1  : Identified candidate component class: file [A:\Desktop\workspace\HIS\his_api\target\classes\com\luojiawei\api\client\FlaskAiDoctorClient.class]
21:20:50:349 DEBUG 32476 --- [main] o.s.c.openfeign.FeignClientsRegistrar$1  : Identified candidate component class: file [A:\Desktop\workspace\HIS\his_api\target\classes\com\luojiawei\api\client\FlaskModelAnalyzeClient.class]
21:20:50:350 DEBUG 32476 --- [main] o.s.c.openfeign.FeignClientsRegistrar$1  : Identified candidate component class: file [A:\Desktop\workspace\HIS\his_api\target\classes\com\luojiawei\api\client\FlaskUploadClient.class]
21:20:50:659  INFO 32476 --- [main] .s.d.r.c.RepositoryConfigurationDelegate : Multiple Spring Data modules found, entering strict repository configuration mode
21:20:50:661  INFO 32476 --- [main] .s.d.r.c.RepositoryConfigurationDelegate : Bootstrapping Spring Data Redis repositories in DEFAULT mode.
21:20:50:688  INFO 32476 --- [main] .s.d.r.c.RepositoryConfigurationDelegate : Finished Spring Data repository scanning in 15 ms. Found 0 Redis repository interfaces.
21:20:50:980  INFO 32476 --- [main] o.s.cloud.context.scope.GenericScope     : BeanFactory id=93ec073a-d50a-3e20-8556-fa3097b20012
21:20:52:643  INFO 32476 --- [main] o.s.b.w.embedded.tomcat.TomcatWebServer  : Tomcat initialized with port(s): 8080 (http)
21:20:52:670  INFO 32476 --- [main] o.apache.catalina.core.StandardService   : Starting service [Tomcat]
21:20:52:671  INFO 32476 --- [main] org.apache.catalina.core.StandardEngine  : Starting Servlet engine: [Apache Tomcat/9.0.75]
21:20:52:923  INFO 32476 --- [main] o.a.c.c.C.[Tomcat].[localhost].[/]       : Initializing Spring embedded WebApplicationContext
21:20:52:924  INFO 32476 --- [main] w.s.c.ServletWebServerApplicationContext : Root WebApplicationContext: initialization completed in 3391 ms
21:20:53:331  INFO 32476 --- [main] org.redisson.Version                     : Redisson 3.17.7
21:20:53:816  INFO 32476 --- [redisson-netty-2-9] o.r.c.pool.MasterPubSubConnectionPool    : 1 connections initialized for 111.230.32.147/111.230.32.147:9631
21:20:54:525  INFO 32476 --- [redisson-netty-2-19] o.r.c.pool.MasterConnectionPool          : 24 connections initialized for 111.230.32.147/111.230.32.147:9631
21:20:54:896 DEBUG 32476 --- [main] c.l.h.filter.RefreshTokenFilter          : Filter 'refreshTokenFilter' configured for use
21:20:55:790  INFO 32476 --- [main] o.s.c.openfeign.FeignClientFactoryBean   : For 'flask-service' URL not provided. Will try picking an instance via load-balancing.
21:20:56:151  INFO 32476 --- [main] o.s.c.openfeign.FeignClientFactoryBean   : For 'ai-service' URL not provided. Will try picking an instance via load-balancing.
21:20:56:192  WARN 32476 --- [main] c.b.m.core.metadata.TableInfoHelper      : Can not find table primary key in Class: "java.lang.Object".
21:20:56:192  WARN 32476 --- [main] c.b.m.core.injector.DefaultSqlInjector   : class java.lang.Object ,Not found @TableId annotation, Cannot use Mybatis-Plus 'xxById' Method.
21:20:57:903  WARN 32476 --- [main] iguration$LoadBalancerCaffeineWarnLogger : Spring Cloud LoadBalancer is currently working with the default cache. While this cache implementation is useful for development and tests, it's recommended to use Caffeine cache in production.You can switch to using Caffeine cache, by adding it and org.springframework.cache.caffeine.CaffeineCacheManager to the classpath.
21:20:57:908  INFO 32476 --- [main] o.s.b.a.e.web.EndpointLinksResolver      : Exposing 1 endpoint(s) beneath base path '/actuator'
21:20:58:040  INFO 32476 --- [main] o.s.b.w.embedded.tomcat.TomcatWebServer  : Tomcat started on port(s): 8080 (http) with context path ''
21:20:58:093  INFO 32476 --- [main] c.a.n.p.a.s.c.ClientAuthPluginManager    : [ClientAuthPluginManager] Load ClientAuthService com.alibaba.nacos.client.auth.impl.NacosClientAuthServiceImpl success.
21:20:58:093  INFO 32476 --- [main] c.a.n.p.a.s.c.ClientAuthPluginManager    : [ClientAuthPluginManager] Load ClientAuthService com.alibaba.nacos.client.auth.ram.RamClientAuthServiceImpl success.
21:21:00:264  INFO 32476 --- [http-nio-8080-exec-2] o.a.c.c.C.[Tomcat].[localhost].[/]       : Initializing Spring DispatcherServlet 'dispatcherServlet'
21:21:00:264  INFO 32476 --- [http-nio-8080-exec-2] o.s.web.servlet.DispatcherServlet        : Initializing Servlet 'dispatcherServlet'
21:21:00:266  INFO 32476 --- [http-nio-8080-exec-2] o.s.web.servlet.DispatcherServlet        : Completed initialization in 2 ms
21:21:00:398  INFO 32476 --- [main] c.a.n.c.a.AbstractAbilityControlManager  : Ready to get current node abilities...
21:21:00:401  INFO 32476 --- [main] c.a.n.c.a.AbstractAbilityControlManager  : Ready to initialize current node abilities, support modes: [SDK_CLIENT]
21:21:00:403  INFO 32476 --- [main] c.a.n.c.a.AbstractAbilityControlManager  : Initialize current abilities finish...
21:21:00:403  INFO 32476 --- [main] c.a.n.c.a.d.NacosAbilityManagerHolder    : [AbilityControlManager] Successfully initialize AbilityControlManager
21:21:00:476  INFO 32476 --- [main] c.a.c.n.registry.NacosServiceRegistry    : nacos registry, DEFAULT_GROUP his-service 10.21.93.70:8080 register finished
21:21:00:630  INFO 32476 --- [http-nio-8080-exec-2] com.zaxxer.hikari.HikariDataSource       : HikariPool-1 - Starting...
21:21:00:785  INFO 32476 --- [main] c.l.his_service.HisServiceApplication    : Started HisServiceApplication in 12.393 seconds (JVM running for 13.672)
21:21:01:278  INFO 32476 --- [http-nio-8080-exec-2] com.zaxxer.hikari.HikariDataSource       : HikariPool-1 - Start completed.
21:21:01:303 DEBUG 32476 --- [http-nio-8080-exec-2] c.l.h.m.D.selectById                     : ==>  Preparing: SELECT id,patient_id,doctor_id,disease_name,disease_category,aimodel_id,result,create_time,status,id_card,name,score,remark FROM diagnosis_report WHERE id=?
21:21:01:329 DEBUG 32476 --- [http-nio-8080-exec-2] c.l.h.m.D.selectById                     : ==> Parameters: 1(Integer)
21:21:01:402 DEBUG 32476 --- [http-nio-8080-exec-2] c.l.h.m.D.selectById                     : <==      Total: 1
21:21:01:434 DEBUG 32476 --- [http-nio-8080-exec-2] c.l.h.mapper.PatientMapper.selectById    : ==>  Preparing: SELECT id,phone,id_card,name,verified,verified_by,verified_time,open_id,hospital_pid FROM patient WHERE id=?
21:21:01:434 DEBUG 32476 --- [http-nio-8080-exec-2] c.l.h.mapper.PatientMapper.selectById    : ==> Parameters: 1(Integer)
21:21:01:466 DEBUG 32476 --- [http-nio-8080-exec-2] c.l.h.mapper.PatientMapper.selectById    : <==      Total: 1
21:21:01:468 DEBUG 32476 --- [http-nio-8080-exec-2] c.l.h.mapper.DoctorMapper.selectById     : ==>  Preparing: SELECT id,phone,id_card,name,verified,verified_by,verified_time,license,department,hospital_pid FROM doctor WHERE id=?
21:21:01:469 DEBUG 32476 --- [http-nio-8080-exec-2] c.l.h.mapper.DoctorMapper.selectById     : ==> Parameters: 1(Integer)
21:21:01:501 DEBUG 32476 --- [http-nio-8080-exec-2] c.l.h.mapper.DoctorMapper.selectById     : <==      Total: 1
21:21:01:507 DEBUG 32476 --- [http-nio-8080-exec-2] c.l.h.m.E.selectListByDiagnosisId        : ==>  Preparing: select * from eye_images where dignosis_report_id = ?
21:21:01:508 DEBUG 32476 --- [http-nio-8080-exec-2] c.l.h.m.E.selectListByDiagnosisId        : ==> Parameters: 1(Integer)
21:21:01:537 DEBUG 32476 --- [http-nio-8080-exec-2] c.l.h.m.E.selectListByDiagnosisId        : <==      Total: 1
21:21:01:539 DEBUG 32476 --- [http-nio-8080-exec-2] c.l.h.m.T.selectByDiagnosisId            : ==>  Preparing: select * from treatment_plans where diagnosis_id = ?
21:21:01:539 DEBUG 32476 --- [http-nio-8080-exec-2] c.l.h.m.T.selectByDiagnosisId            : ==> Parameters: 1(Integer)
21:21:01:572 DEBUG 32476 --- [http-nio-8080-exec-2] c.l.h.m.T.selectByDiagnosisId            : <==      Total: 1
21:21:01:573 DEBUG 32476 --- [http-nio-8080-exec-2] c.l.h.m.M.selectByDiagnosisId            : ==>  Preparing: select * from medication_recommendations where diagnosis_id = ?
21:21:01:574 DEBUG 32476 --- [http-nio-8080-exec-2] c.l.h.m.M.selectByDiagnosisId            : ==> Parameters: 1(Integer)
21:21:01:606 DEBUG 32476 --- [http-nio-8080-exec-2] c.l.h.m.M.selectByDiagnosisId            : <==      Total: 1
21:21:01:607 DEBUG 32476 --- [http-nio-8080-exec-2] c.l.h.mapper.AiModelMapper.selectById    : ==>  Preparing: SELECT id,version,deploy_time,accuracy FROM ai_model WHERE id=?
21:21:01:607 DEBUG 32476 --- [http-nio-8080-exec-2] c.l.h.mapper.AiModelMapper.selectById    : ==> Parameters: 1(Integer)
21:21:01:638 DEBUG 32476 --- [http-nio-8080-exec-2] c.l.h.mapper.AiModelMapper.selectById    : <==      Total: 1
21:21:01:676 DEBUG 32476 --- [http-nio-8080-exec-2] o.s.c.openfeign.support.SpringEncoder    : Writing [ChatForm(diagnosisName=, diagnosisCategory=, result=A, remark=A, treatmentPlan=TreatmentPlans(id=1, diagnosisId=1, treatmentType=1, treatmentDetail=, startTime=2025-03-01T09:00, endDate=2025-03-10T09:00, doctorId=1, createdTime=2025-03-01T09:00, updatedTime=2025-03-01T09:00), medications=[MedicationRecommendations(id=1, diagnosisId=1, medicationName=A, dosage=10mg, frequency=, sideEffects=, startTime=2025-03-01T09:00, endTime=2025-03-10T09:00, doctorId=1, createdTime=2025-03-01T09:00, updatedTime=2025-03-01T09:00)], previousConversations=[DialogueInfo(role=pariatur tempor do, content=sit cupidatat commodo)], question=irure eu esse, stream=false)] using [org.springframework.http.converter.json.MappingJackson2HttpMessageConverter@1e836aed]
21:21:01:689 DEBUG 32476 --- [http-nio-8080-exec-2] c.l.api.client.FlaskAiDoctorClient       : [FlaskAiDoctorClient#eye_doctor_chat] ---> POST http://ai-service/api/eye-doctor/chat HTTP/1.1
21:21:01:689 DEBUG 32476 --- [http-nio-8080-exec-2] c.l.api.client.FlaskAiDoctorClient       : [FlaskAiDoctorClient#eye_doctor_chat] Content-Length: 749
21:21:01:689 DEBUG 32476 --- [http-nio-8080-exec-2] c.l.api.client.FlaskAiDoctorClient       : [FlaskAiDoctorClient#eye_doctor_chat] Content-Type: application/json
21:21:01:690 DEBUG 32476 --- [http-nio-8080-exec-2] c.l.api.client.FlaskAiDoctorClient       : [FlaskAiDoctorClient#eye_doctor_chat] 
21:21:01:690 DEBUG 32476 --- [http-nio-8080-exec-2] c.l.api.client.FlaskAiDoctorClient       : [FlaskAiDoctorClient#eye_doctor_chat] {"disease_name":"","disease_category":"","result":"A","remark":"A","treatment_plan":{"id":1,"treatmentType":1,"treatmentDetail":"","startTime":"2025-03-01 09:00:00","endDate":"2025-03-10 09:00:00","doctorId":1,"createdTime":"2025-03-01T09:00:00","updatedTime":"2025-03-01T09:00:00"},"medications":[{"id":1,"diagnosisId":1,"medicationName":"A","dosage":"10mg","frequency":"","sideEffects":"","startTime":"2025-03-01T09:00:00","endTime":"2025-03-10T09:00:00","doctorId":1,"createdTime":"2025-03-01 09:00:00","updatedTime":"2025-03-01 09:00:00"}],"previous_conversations":[{"role":"pariatur tempor do","content":"sit cupidatat commodo"}],"question":"irure eu esse","stream":false}
21:21:01:690 DEBUG 32476 --- [http-nio-8080-exec-2] c.l.api.client.FlaskAiDoctorClient       : [FlaskAiDoctorClient#eye_doctor_chat] ---> END HTTP (749-byte body)
21:21:31:920 DEBUG 32476 --- [http-nio-8080-exec-2] c.l.api.client.FlaskAiDoctorClient       : [FlaskAiDoctorClient#eye_doctor_chat] <--- ERROR SocketTimeoutException: timeout (30230ms)
21:21:31:922 DEBUG 32476 --- [http-nio-8080-exec-2] c.l.api.client.FlaskAiDoctorClient       : [FlaskAiDoctorClient#eye_doctor_chat] java.net.SocketTimeoutException: timeout
	at okio.SocketAsyncTimeout.newTimeoutException(JvmOkio.kt:147)
	at okio.AsyncTimeout.access$newTimeoutException(AsyncTimeout.kt:158)
	at okio.AsyncTimeout$source$1.read(AsyncTimeout.kt:337)
	at okio.RealBufferedSource.indexOf(RealBufferedSource.kt:427)
	at okio.RealBufferedSource.readUtf8LineStrict(RealBufferedSource.kt:320)
	at okhttp3.internal.http1.HeadersReader.readLine(HeadersReader.kt:29)
	at okhttp3.internal.http1.Http1ExchangeCodec.readResponseHeaders(Http1ExchangeCodec.kt:178)
	at okhttp3.internal.connection.Exchange.readResponseHeaders(Exchange.kt:106)
	at okhttp3.internal.http.CallServerInterceptor.intercept(CallServerInterceptor.kt:79)
	at okhttp3.internal.http.RealInterceptorChain.proceed(RealInterceptorChain.kt:109)
	at okhttp3.internal.connection.ConnectInterceptor.intercept(ConnectInterceptor.kt:34)
	at okhttp3.internal.http.RealInterceptorChain.proceed(RealInterceptorChain.kt:109)
	at okhttp3.internal.cache.CacheInterceptor.intercept(CacheInterceptor.kt:95)
	at okhttp3.internal.http.RealInterceptorChain.proceed(RealInterceptorChain.kt:109)
	at okhttp3.internal.http.BridgeInterceptor.intercept(BridgeInterceptor.kt:83)
	at okhttp3.internal.http.RealInterceptorChain.proceed(RealInterceptorChain.kt:109)
	at okhttp3.internal.http.RetryAndFollowUpInterceptor.intercept(RetryAndFollowUpInterceptor.kt:76)
	at okhttp3.internal.http.RealInterceptorChain.proceed(RealInterceptorChain.kt:109)
	at okhttp3.internal.connection.RealCall.getResponseWithInterceptorChain$okhttp(RealCall.kt:201)
	at okhttp3.internal.connection.RealCall.execute(RealCall.kt:154)
	at feign.okhttp.OkHttpClient.execute(OkHttpClient.java:180)
	at org.springframework.cloud.openfeign.loadbalancer.LoadBalancerUtils.executeWithLoadBalancerLifecycleProcessing(LoadBalancerUtils.java:57)
	at org.springframework.cloud.openfeign.loadbalancer.LoadBalancerUtils.executeWithLoadBalancerLifecycleProcessing(LoadBalancerUtils.java:95)
	at org.springframework.cloud.openfeign.loadbalancer.FeignBlockingLoadBalancerClient.execute(FeignBlockingLoadBalancerClient.java:114)
	at feign.SynchronousMethodHandler.executeAndDecode(SynchronousMethodHandler.java:121)
	at feign.SynchronousMethodHandler.invoke(SynchronousMethodHandler.java:91)
	at feign.ReflectiveFeign$FeignInvocationHandler.invoke(ReflectiveFeign.java:100)
	at jdk.proxy2/jdk.proxy2.$Proxy138.eye_doctor_chat(Unknown Source)
	at com.luojiawei.his_service.controller.ChatController.ask(ChatController.java:39)
	at java.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at java.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:77)
	at java.base/jdk.internal.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.base/java.lang.reflect.Method.invoke(Method.java:568)
	at org.springframework.web.method.support.InvocableHandlerMethod.doInvoke(InvocableHandlerMethod.java:205)
	at org.springframework.web.method.support.InvocableHandlerMethod.invokeForRequest(InvocableHandlerMethod.java:150)
	at org.springframework.web.servlet.mvc.method.annotation.ServletInvocableHandlerMethod.invokeAndHandle(ServletInvocableHandlerMethod.java:117)
	at org.springframework.web.servlet.mvc.method.annotation.RequestMappingHandlerAdapter.invokeHandlerMethod(RequestMappingHandlerAdapter.java:895)
	at org.springframework.web.servlet.mvc.method.annotation.RequestMappingHandlerAdapter.handleInternal(RequestMappingHandlerAdapter.java:808)
	at org.springframework.web.servlet.mvc.method.AbstractHandlerMethodAdapter.handle(AbstractHandlerMethodAdapter.java:87)
	at org.springframework.web.servlet.DispatcherServlet.doDispatch(DispatcherServlet.java:1072)
	at org.springframework.web.servlet.DispatcherServlet.doService(DispatcherServlet.java:965)
	at org.springframework.web.servlet.FrameworkServlet.processRequest(FrameworkServlet.java:1006)
	at org.springframework.web.servlet.FrameworkServlet.doPost(FrameworkServlet.java:909)
	at javax.servlet.http.HttpServlet.service(HttpServlet.java:555)
	at org.springframework.web.servlet.FrameworkServlet.service(FrameworkServlet.java:883)
	at javax.servlet.http.HttpServlet.service(HttpServlet.java:623)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:209)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:153)
	at com.luojiawei.his_service.filter.RefreshTokenFilter.doFilterInternal(RefreshTokenFilter.java:58)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:117)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:178)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:153)
	at org.springframework.web.filter.RequestContextFilter.doFilterInternal(RequestContextFilter.java:100)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:117)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:178)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:153)
	at org.springframework.web.filter.FormContentFilter.doFilterInternal(FormContentFilter.java:93)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:117)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:178)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:153)
	at org.springframework.boot.actuate.metrics.web.servlet.WebMvcMetricsFilter.doFilterInternal(WebMvcMetricsFilter.java:96)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:117)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:178)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:153)
	at org.springframework.web.filter.CharacterEncodingFilter.doFilterInternal(CharacterEncodingFilter.java:201)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:117)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:178)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:153)
	at org.apache.catalina.core.StandardWrapperValve.invoke(StandardWrapperValve.java:167)
	at org.apache.catalina.core.StandardContextValve.invoke(StandardContextValve.java:90)
	at org.apache.catalina.authenticator.AuthenticatorBase.invoke(AuthenticatorBase.java:481)
	at org.apache.catalina.core.StandardHostValve.invoke(StandardHostValve.java:130)
	at org.apache.catalina.valves.ErrorReportValve.invoke(ErrorReportValve.java:93)
	at org.apache.catalina.core.StandardEngineValve.invoke(StandardEngineValve.java:74)
	at org.apache.catalina.connector.CoyoteAdapter.service(CoyoteAdapter.java:343)
	at org.apache.coyote.http11.Http11Processor.service(Http11Processor.java:390)
	at org.apache.coyote.AbstractProcessorLight.process(AbstractProcessorLight.java:63)
	at org.apache.coyote.AbstractProtocol$ConnectionHandler.process(AbstractProtocol.java:926)
	at org.apache.tomcat.util.net.NioEndpoint$SocketProcessor.doRun(NioEndpoint.java:1791)
	at org.apache.tomcat.util.net.SocketProcessorBase.run(SocketProcessorBase.java:52)
	at org.apache.tomcat.util.threads.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1191)
	at org.apache.tomcat.util.threads.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:659)
	at org.apache.tomcat.util.threads.TaskThread$WrappingRunnable.run(TaskThread.java:61)
	at java.base/java.lang.Thread.run(Thread.java:840)
Caused by: java.net.SocketException: Socket closed
	at java.base/sun.nio.ch.NioSocketImpl.endRead(NioSocketImpl.java:253)
	at java.base/sun.nio.ch.NioSocketImpl.implRead(NioSocketImpl.java:332)
	at java.base/sun.nio.ch.NioSocketImpl.read(NioSocketImpl.java:355)
	at java.base/sun.nio.ch.NioSocketImpl$1.read(NioSocketImpl.java:808)
	at java.base/java.net.Socket$SocketInputStream.read(Socket.java:966)
	at okio.InputStreamSource.read(JvmOkio.kt:94)
	at okio.AsyncTimeout$source$1.read(AsyncTimeout.kt:125)
	... 81 more

21:21:31:922 DEBUG 32476 --- [http-nio-8080-exec-2] c.l.api.client.FlaskAiDoctorClient       : [FlaskAiDoctorClient#eye_doctor_chat] <--- END ERROR
21:21:31:938 ERROR 32476 --- [http-nio-8080-exec-2] o.a.c.c.C.[.[.[/].[dispatcherServlet]    : Servlet.service() for servlet [dispatcherServlet] in context with path [] threw exception [Request processing failed; nested exception is feign.RetryableException: timeout executing POST http://ai-service/api/eye-doctor/chat] with root cause

java.net.SocketException: Socket closed
	at java.base/sun.nio.ch.NioSocketImpl.endRead(NioSocketImpl.java:253) ~[na:na]
	at java.base/sun.nio.ch.NioSocketImpl.implRead(NioSocketImpl.java:332) ~[na:na]
	at java.base/sun.nio.ch.NioSocketImpl.read(NioSocketImpl.java:355) ~[na:na]
	at java.base/sun.nio.ch.NioSocketImpl$1.read(NioSocketImpl.java:808) ~[na:na]
	at java.base/java.net.Socket$SocketInputStream.read(Socket.java:966) ~[na:na]
	at okio.InputStreamSource.read(JvmOkio.kt:94) ~[okio-jvm-3.2.0.jar:na]
	at okio.AsyncTimeout$source$1.read(AsyncTimeout.kt:125) ~[okio-jvm-3.2.0.jar:na]
	at okio.RealBufferedSource.indexOf(RealBufferedSource.kt:427) ~[okio-jvm-3.2.0.jar:na]
	at okio.RealBufferedSource.readUtf8LineStrict(RealBufferedSource.kt:320) ~[okio-jvm-3.2.0.jar:na]
	at okhttp3.internal.http1.HeadersReader.readLine(HeadersReader.kt:29) ~[okhttp-4.9.3.jar:na]
	at okhttp3.internal.http1.Http1ExchangeCodec.readResponseHeaders(Http1ExchangeCodec.kt:178) ~[okhttp-4.9.3.jar:na]
	at okhttp3.internal.connection.Exchange.readResponseHeaders(Exchange.kt:106) ~[okhttp-4.9.3.jar:na]
	at okhttp3.internal.http.CallServerInterceptor.intercept(CallServerInterceptor.kt:79) ~[okhttp-4.9.3.jar:na]
	at okhttp3.internal.http.RealInterceptorChain.proceed(RealInterceptorChain.kt:109) ~[okhttp-4.9.3.jar:na]
	at okhttp3.internal.connection.ConnectInterceptor.intercept(ConnectInterceptor.kt:34) ~[okhttp-4.9.3.jar:na]
	at okhttp3.internal.http.RealInterceptorChain.proceed(RealInterceptorChain.kt:109) ~[okhttp-4.9.3.jar:na]
	at okhttp3.internal.cache.CacheInterceptor.intercept(CacheInterceptor.kt:95) ~[okhttp-4.9.3.jar:na]
	at okhttp3.internal.http.RealInterceptorChain.proceed(RealInterceptorChain.kt:109) ~[okhttp-4.9.3.jar:na]
	at okhttp3.internal.http.BridgeInterceptor.intercept(BridgeInterceptor.kt:83) ~[okhttp-4.9.3.jar:na]
	at okhttp3.internal.http.RealInterceptorChain.proceed(RealInterceptorChain.kt:109) ~[okhttp-4.9.3.jar:na]
	at okhttp3.internal.http.RetryAndFollowUpInterceptor.intercept(RetryAndFollowUpInterceptor.kt:76) ~[okhttp-4.9.3.jar:na]
	at okhttp3.internal.http.RealInterceptorChain.proceed(RealInterceptorChain.kt:109) ~[okhttp-4.9.3.jar:na]
	at okhttp3.internal.connection.RealCall.getResponseWithInterceptorChain$okhttp(RealCall.kt:201) ~[okhttp-4.9.3.jar:na]
	at okhttp3.internal.connection.RealCall.execute(RealCall.kt:154) ~[okhttp-4.9.3.jar:na]
	at feign.okhttp.OkHttpClient.execute(OkHttpClient.java:180) ~[feign-okhttp-11.10.jar:na]
	at org.springframework.cloud.openfeign.loadbalancer.LoadBalancerUtils.executeWithLoadBalancerLifecycleProcessing(LoadBalancerUtils.java:57) ~[spring-cloud-openfeign-core-3.1.5.jar:3.1.5]
	at org.springframework.cloud.openfeign.loadbalancer.LoadBalancerUtils.executeWithLoadBalancerLifecycleProcessing(LoadBalancerUtils.java:95) ~[spring-cloud-openfeign-core-3.1.5.jar:3.1.5]
	at org.springframework.cloud.openfeign.loadbalancer.FeignBlockingLoadBalancerClient.execute(FeignBlockingLoadBalancerClient.java:114) ~[spring-cloud-openfeign-core-3.1.5.jar:3.1.5]
	at feign.SynchronousMethodHandler.executeAndDecode(SynchronousMethodHandler.java:121) ~[feign-core-11.10.jar:na]
	at feign.SynchronousMethodHandler.invoke(SynchronousMethodHandler.java:91) ~[feign-core-11.10.jar:na]
	at feign.ReflectiveFeign$FeignInvocationHandler.invoke(ReflectiveFeign.java:100) ~[feign-core-11.10.jar:na]
	at jdk.proxy2/jdk.proxy2.$Proxy138.eye_doctor_chat(Unknown Source) ~[na:na]
	at com.luojiawei.his_service.controller.ChatController.ask(ChatController.java:39) ~[classes/:na]
	at java.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke0(Native Method) ~[na:na]
	at java.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:77) ~[na:na]
	at java.base/jdk.internal.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43) ~[na:na]
	at java.base/java.lang.reflect.Method.invoke(Method.java:568) ~[na:na]
	at org.springframework.web.method.support.InvocableHandlerMethod.doInvoke(InvocableHandlerMethod.java:205) ~[spring-web-5.3.27.jar:5.3.27]
	at org.springframework.web.method.support.InvocableHandlerMethod.invokeForRequest(InvocableHandlerMethod.java:150) ~[spring-web-5.3.27.jar:5.3.27]
	at org.springframework.web.servlet.mvc.method.annotation.ServletInvocableHandlerMethod.invokeAndHandle(ServletInvocableHandlerMethod.java:117) ~[spring-webmvc-5.3.27.jar:5.3.27]
	at org.springframework.web.servlet.mvc.method.annotation.RequestMappingHandlerAdapter.invokeHandlerMethod(RequestMappingHandlerAdapter.java:895) ~[spring-webmvc-5.3.27.jar:5.3.27]
	at org.springframework.web.servlet.mvc.method.annotation.RequestMappingHandlerAdapter.handleInternal(RequestMappingHandlerAdapter.java:808) ~[spring-webmvc-5.3.27.jar:5.3.27]
	at org.springframework.web.servlet.mvc.method.AbstractHandlerMethodAdapter.handle(AbstractHandlerMethodAdapter.java:87) ~[spring-webmvc-5.3.27.jar:5.3.27]
	at org.springframework.web.servlet.DispatcherServlet.doDispatch(DispatcherServlet.java:1072) ~[spring-webmvc-5.3.27.jar:5.3.27]
	at org.springframework.web.servlet.DispatcherServlet.doService(DispatcherServlet.java:965) ~[spring-webmvc-5.3.27.jar:5.3.27]
	at org.springframework.web.servlet.FrameworkServlet.processRequest(FrameworkServlet.java:1006) ~[spring-webmvc-5.3.27.jar:5.3.27]
	at org.springframework.web.servlet.FrameworkServlet.doPost(FrameworkServlet.java:909) ~[spring-webmvc-5.3.27.jar:5.3.27]
	at javax.servlet.http.HttpServlet.service(HttpServlet.java:555) ~[tomcat-embed-core-9.0.75.jar:4.0.FR]
	at org.springframework.web.servlet.FrameworkServlet.service(FrameworkServlet.java:883) ~[spring-webmvc-5.3.27.jar:5.3.27]
	at javax.servlet.http.HttpServlet.service(HttpServlet.java:623) ~[tomcat-embed-core-9.0.75.jar:4.0.FR]
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:209) ~[tomcat-embed-core-9.0.75.jar:9.0.75]
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:153) ~[tomcat-embed-core-9.0.75.jar:9.0.75]
	at com.luojiawei.his_service.filter.RefreshTokenFilter.doFilterInternal(RefreshTokenFilter.java:58) ~[classes/:na]
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:117) ~[spring-web-5.3.27.jar:5.3.27]
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:178) ~[tomcat-embed-core-9.0.75.jar:9.0.75]
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:153) ~[tomcat-embed-core-9.0.75.jar:9.0.75]
	at org.springframework.web.filter.RequestContextFilter.doFilterInternal(RequestContextFilter.java:100) ~[spring-web-5.3.27.jar:5.3.27]
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:117) ~[spring-web-5.3.27.jar:5.3.27]
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:178) ~[tomcat-embed-core-9.0.75.jar:9.0.75]
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:153) ~[tomcat-embed-core-9.0.75.jar:9.0.75]
	at org.springframework.web.filter.FormContentFilter.doFilterInternal(FormContentFilter.java:93) ~[spring-web-5.3.27.jar:5.3.27]
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:117) ~[spring-web-5.3.27.jar:5.3.27]
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:178) ~[tomcat-embed-core-9.0.75.jar:9.0.75]
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:153) ~[tomcat-embed-core-9.0.75.jar:9.0.75]
	at org.springframework.boot.actuate.metrics.web.servlet.WebMvcMetricsFilter.doFilterInternal(WebMvcMetricsFilter.java:96) ~[spring-boot-actuator-2.7.12.jar:2.7.12]
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:117) ~[spring-web-5.3.27.jar:5.3.27]
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:178) ~[tomcat-embed-core-9.0.75.jar:9.0.75]
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:153) ~[tomcat-embed-core-9.0.75.jar:9.0.75]
	at org.springframework.web.filter.CharacterEncodingFilter.doFilterInternal(CharacterEncodingFilter.java:201) ~[spring-web-5.3.27.jar:5.3.27]
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:117) ~[spring-web-5.3.27.jar:5.3.27]
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:178) ~[tomcat-embed-core-9.0.75.jar:9.0.75]
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:153) ~[tomcat-embed-core-9.0.75.jar:9.0.75]
	at org.apache.catalina.core.StandardWrapperValve.invoke(StandardWrapperValve.java:167) ~[tomcat-embed-core-9.0.75.jar:9.0.75]
	at org.apache.catalina.core.StandardContextValve.invoke(StandardContextValve.java:90) ~[tomcat-embed-core-9.0.75.jar:9.0.75]
	at org.apache.catalina.authenticator.AuthenticatorBase.invoke(AuthenticatorBase.java:481) ~[tomcat-embed-core-9.0.75.jar:9.0.75]
	at org.apache.catalina.core.StandardHostValve.invoke(StandardHostValve.java:130) ~[tomcat-embed-core-9.0.75.jar:9.0.75]
	at org.apache.catalina.valves.ErrorReportValve.invoke(ErrorReportValve.java:93) ~[tomcat-embed-core-9.0.75.jar:9.0.75]
	at org.apache.catalina.core.StandardEngineValve.invoke(StandardEngineValve.java:74) ~[tomcat-embed-core-9.0.75.jar:9.0.75]
	at org.apache.catalina.connector.CoyoteAdapter.service(CoyoteAdapter.java:343) ~[tomcat-embed-core-9.0.75.jar:9.0.75]
	at org.apache.coyote.http11.Http11Processor.service(Http11Processor.java:390) ~[tomcat-embed-core-9.0.75.jar:9.0.75]
	at org.apache.coyote.AbstractProcessorLight.process(AbstractProcessorLight.java:63) ~[tomcat-embed-core-9.0.75.jar:9.0.75]
	at org.apache.coyote.AbstractProtocol$ConnectionHandler.process(AbstractProtocol.java:926) ~[tomcat-embed-core-9.0.75.jar:9.0.75]
	at org.apache.tomcat.util.net.NioEndpoint$SocketProcessor.doRun(NioEndpoint.java:1791) ~[tomcat-embed-core-9.0.75.jar:9.0.75]
	at org.apache.tomcat.util.net.SocketProcessorBase.run(SocketProcessorBase.java:52) ~[tomcat-embed-core-9.0.75.jar:9.0.75]
	at org.apache.tomcat.util.threads.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1191) ~[tomcat-embed-core-9.0.75.jar:9.0.75]
	at org.apache.tomcat.util.threads.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:659) ~[tomcat-embed-core-9.0.75.jar:9.0.75]
	at org.apache.tomcat.util.threads.TaskThread$WrappingRunnable.run(TaskThread.java:61) ~[tomcat-embed-core-9.0.75.jar:9.0.75]
	at java.base/java.lang.Thread.run(Thread.java:840) ~[na:na]

21:22:48:240  WARN 32476 --- [Thread-15] c.a.nacos.common.notify.NotifyCenter     : [NotifyCenter] Start destroying Publisher
21:22:48:241  WARN 32476 --- [Thread-15] c.a.nacos.common.notify.NotifyCenter     : [NotifyCenter] Destruction of the end
21:22:48:241  WARN 32476 --- [Thread-18] c.a.n.common.http.HttpClientBeanHolder   : [HttpClientBeanHolder] Start destroying common HttpClient
21:22:48:242  WARN 32476 --- [Thread-18] c.a.n.common.http.HttpClientBeanHolder   : [HttpClientBeanHolder] Destruction of the end
21:22:48:303  INFO 32476 --- [SpringApplicationShutdownHook] c.a.c.n.registry.NacosServiceRegistry    : De-registering from Nacos Server now...
21:22:48:325  INFO 32476 --- [SpringApplicationShutdownHook] c.a.c.n.registry.NacosServiceRegistry    : De-registration finished.
21:22:48:343  INFO 32476 --- [SpringApplicationShutdownHook] com.zaxxer.hikari.HikariDataSource       : HikariPool-1 - Shutdown initiated...
21:22:48:706  INFO 32476 --- [SpringApplicationShutdownHook] com.zaxxer.hikari.HikariDataSource       : HikariPool-1 - Shutdown completed.
21:22:53:310  INFO 38360 --- [main] c.l.his_service.HisServiceApplication    : Starting HisServiceApplication using Java 17.0.11 on luo with PID 38360 (A:\Desktop\workspace\HIS\his_service\target\classes started by 22407 in A:\Desktop\workspace\HIS)
21:22:53:311 DEBUG 38360 --- [main] c.l.his_service.HisServiceApplication    : Running with Spring Boot v2.7.12, Spring v5.3.27
21:22:53:312  INFO 38360 --- [main] c.l.his_service.HisServiceApplication    : The following 1 profile is active: "dev"
21:22:54:135 DEBUG 38360 --- [main] o.s.c.openfeign.FeignClientsRegistrar$1  : Identified candidate component class: file [A:\Desktop\workspace\HIS\his_api\target\classes\com\luojiawei\api\client\FlaskAiDoctorClient.class]
21:22:54:136 DEBUG 38360 --- [main] o.s.c.openfeign.FeignClientsRegistrar$1  : Identified candidate component class: file [A:\Desktop\workspace\HIS\his_api\target\classes\com\luojiawei\api\client\FlaskModelAnalyzeClient.class]
21:22:54:136 DEBUG 38360 --- [main] o.s.c.openfeign.FeignClientsRegistrar$1  : Identified candidate component class: file [A:\Desktop\workspace\HIS\his_api\target\classes\com\luojiawei\api\client\FlaskUploadClient.class]
21:22:54:503  INFO 38360 --- [main] .s.d.r.c.RepositoryConfigurationDelegate : Multiple Spring Data modules found, entering strict repository configuration mode
21:22:54:506  INFO 38360 --- [main] .s.d.r.c.RepositoryConfigurationDelegate : Bootstrapping Spring Data Redis repositories in DEFAULT mode.
21:22:54:534  INFO 38360 --- [main] .s.d.r.c.RepositoryConfigurationDelegate : Finished Spring Data repository scanning in 16 ms. Found 0 Redis repository interfaces.
21:22:54:821  INFO 38360 --- [main] o.s.cloud.context.scope.GenericScope     : BeanFactory id=93ec073a-d50a-3e20-8556-fa3097b20012
21:22:55:463  INFO 38360 --- [main] o.s.b.w.embedded.tomcat.TomcatWebServer  : Tomcat initialized with port(s): 8080 (http)
21:22:55:473  INFO 38360 --- [main] o.apache.catalina.core.StandardService   : Starting service [Tomcat]
21:22:55:474  INFO 38360 --- [main] org.apache.catalina.core.StandardEngine  : Starting Servlet engine: [Apache Tomcat/9.0.75]
21:22:55:657  INFO 38360 --- [main] o.a.c.c.C.[Tomcat].[localhost].[/]       : Initializing Spring embedded WebApplicationContext
21:22:55:657  INFO 38360 --- [main] w.s.c.ServletWebServerApplicationContext : Root WebApplicationContext: initialization completed in 2283 ms
21:22:56:074  INFO 38360 --- [main] org.redisson.Version                     : Redisson 3.17.7
21:22:56:499  INFO 38360 --- [redisson-netty-2-9] o.r.c.pool.MasterPubSubConnectionPool    : 1 connections initialized for 111.230.32.147/111.230.32.147:9631
21:22:57:185  INFO 38360 --- [redisson-netty-2-19] o.r.c.pool.MasterConnectionPool          : 24 connections initialized for 111.230.32.147/111.230.32.147:9631
21:22:57:504 DEBUG 38360 --- [main] c.l.h.filter.RefreshTokenFilter          : Filter 'refreshTokenFilter' configured for use
21:22:58:292  INFO 38360 --- [main] o.s.c.openfeign.FeignClientFactoryBean   : For 'flask-service' URL not provided. Will try picking an instance via load-balancing.
21:22:58:567  INFO 38360 --- [main] o.s.c.openfeign.FeignClientFactoryBean   : For 'ai-service' URL not provided. Will try picking an instance via load-balancing.
21:22:58:615  WARN 38360 --- [main] c.b.m.core.metadata.TableInfoHelper      : Can not find table primary key in Class: "java.lang.Object".
21:22:58:615  WARN 38360 --- [main] c.b.m.core.injector.DefaultSqlInjector   : class java.lang.Object ,Not found @TableId annotation, Cannot use Mybatis-Plus 'xxById' Method.
21:23:00:268  WARN 38360 --- [main] iguration$LoadBalancerCaffeineWarnLogger : Spring Cloud LoadBalancer is currently working with the default cache. While this cache implementation is useful for development and tests, it's recommended to use Caffeine cache in production.You can switch to using Caffeine cache, by adding it and org.springframework.cache.caffeine.CaffeineCacheManager to the classpath.
21:23:00:273  INFO 38360 --- [main] o.s.b.a.e.web.EndpointLinksResolver      : Exposing 1 endpoint(s) beneath base path '/actuator'
21:23:00:360  INFO 38360 --- [main] o.s.b.w.embedded.tomcat.TomcatWebServer  : Tomcat started on port(s): 8080 (http) with context path ''
21:23:00:406  INFO 38360 --- [main] c.a.n.p.a.s.c.ClientAuthPluginManager    : [ClientAuthPluginManager] Load ClientAuthService com.alibaba.nacos.client.auth.impl.NacosClientAuthServiceImpl success.
21:23:00:406  INFO 38360 --- [main] c.a.n.p.a.s.c.ClientAuthPluginManager    : [ClientAuthPluginManager] Load ClientAuthService com.alibaba.nacos.client.auth.ram.RamClientAuthServiceImpl success.
21:23:01:413  INFO 38360 --- [main] c.a.n.c.a.AbstractAbilityControlManager  : Ready to get current node abilities...
21:23:01:415  INFO 38360 --- [main] c.a.n.c.a.AbstractAbilityControlManager  : Ready to initialize current node abilities, support modes: [SDK_CLIENT]
21:23:01:416  INFO 38360 --- [main] c.a.n.c.a.AbstractAbilityControlManager  : Initialize current abilities finish...
21:23:01:416  INFO 38360 --- [main] c.a.n.c.a.d.NacosAbilityManagerHolder    : [AbilityControlManager] Successfully initialize AbilityControlManager
21:23:01:478  INFO 38360 --- [main] c.a.c.n.registry.NacosServiceRegistry    : nacos registry, DEFAULT_GROUP his-service 10.21.93.70:8080 register finished
21:23:01:770  INFO 38360 --- [main] c.l.his_service.HisServiceApplication    : Started HisServiceApplication in 9.422 seconds (JVM running for 10.467)
21:23:02:248  INFO 38360 --- [RMI TCP Connection(1)-10.21.93.70] o.a.c.c.C.[Tomcat].[localhost].[/]       : Initializing Spring DispatcherServlet 'dispatcherServlet'
21:23:02:249  INFO 38360 --- [RMI TCP Connection(1)-10.21.93.70] o.s.web.servlet.DispatcherServlet        : Initializing Servlet 'dispatcherServlet'
21:23:02:249  INFO 38360 --- [RMI TCP Connection(3)-10.21.93.70] com.zaxxer.hikari.HikariDataSource       : HikariPool-1 - Starting...
21:23:02:252  INFO 38360 --- [RMI TCP Connection(1)-10.21.93.70] o.s.web.servlet.DispatcherServlet        : Completed initialization in 3 ms
21:23:02:907  INFO 38360 --- [RMI TCP Connection(3)-10.21.93.70] com.zaxxer.hikari.HikariDataSource       : HikariPool-1 - Start completed.
21:23:03:232 DEBUG 38360 --- [http-nio-8080-exec-2] c.l.h.m.D.selectById                     : ==>  Preparing: SELECT id,patient_id,doctor_id,disease_name,disease_category,aimodel_id,result,create_time,status,id_card,name,score,remark FROM diagnosis_report WHERE id=?
21:23:03:270 DEBUG 38360 --- [http-nio-8080-exec-2] c.l.h.m.D.selectById                     : ==> Parameters: 1(Integer)
21:23:03:344 DEBUG 38360 --- [http-nio-8080-exec-2] c.l.h.m.D.selectById                     : <==      Total: 1
21:23:03:346 DEBUG 38360 --- [http-nio-8080-exec-2] c.l.h.mapper.PatientMapper.selectById    : ==>  Preparing: SELECT id,phone,id_card,name,verified,verified_by,verified_time,open_id,hospital_pid FROM patient WHERE id=?
21:23:03:347 DEBUG 38360 --- [http-nio-8080-exec-2] c.l.h.mapper.PatientMapper.selectById    : ==> Parameters: 1(Integer)
21:23:03:381 DEBUG 38360 --- [http-nio-8080-exec-2] c.l.h.mapper.PatientMapper.selectById    : <==      Total: 1
21:23:03:383 DEBUG 38360 --- [http-nio-8080-exec-2] c.l.h.mapper.DoctorMapper.selectById     : ==>  Preparing: SELECT id,phone,id_card,name,verified,verified_by,verified_time,license,department,hospital_pid FROM doctor WHERE id=?
21:23:03:383 DEBUG 38360 --- [http-nio-8080-exec-2] c.l.h.mapper.DoctorMapper.selectById     : ==> Parameters: 1(Integer)
21:23:03:419 DEBUG 38360 --- [http-nio-8080-exec-2] c.l.h.mapper.DoctorMapper.selectById     : <==      Total: 1
21:23:03:422 DEBUG 38360 --- [http-nio-8080-exec-2] c.l.h.m.E.selectListByDiagnosisId        : ==>  Preparing: select * from eye_images where dignosis_report_id = ?
21:23:03:423 DEBUG 38360 --- [http-nio-8080-exec-2] c.l.h.m.E.selectListByDiagnosisId        : ==> Parameters: 1(Integer)
21:23:03:455 DEBUG 38360 --- [http-nio-8080-exec-2] c.l.h.m.E.selectListByDiagnosisId        : <==      Total: 1
21:23:03:456 DEBUG 38360 --- [http-nio-8080-exec-2] c.l.h.m.T.selectByDiagnosisId            : ==>  Preparing: select * from treatment_plans where diagnosis_id = ?
21:23:03:456 DEBUG 38360 --- [http-nio-8080-exec-2] c.l.h.m.T.selectByDiagnosisId            : ==> Parameters: 1(Integer)
21:23:03:489 DEBUG 38360 --- [http-nio-8080-exec-2] c.l.h.m.T.selectByDiagnosisId            : <==      Total: 1
21:23:03:490 DEBUG 38360 --- [http-nio-8080-exec-2] c.l.h.m.M.selectByDiagnosisId            : ==>  Preparing: select * from medication_recommendations where diagnosis_id = ?
21:23:03:490 DEBUG 38360 --- [http-nio-8080-exec-2] c.l.h.m.M.selectByDiagnosisId            : ==> Parameters: 1(Integer)
21:23:03:524 DEBUG 38360 --- [http-nio-8080-exec-2] c.l.h.m.M.selectByDiagnosisId            : <==      Total: 1
21:23:03:524 DEBUG 38360 --- [http-nio-8080-exec-2] c.l.h.mapper.AiModelMapper.selectById    : ==>  Preparing: SELECT id,version,deploy_time,accuracy FROM ai_model WHERE id=?
21:23:03:524 DEBUG 38360 --- [http-nio-8080-exec-2] c.l.h.mapper.AiModelMapper.selectById    : ==> Parameters: 1(Integer)
21:23:03:557 DEBUG 38360 --- [http-nio-8080-exec-2] c.l.h.mapper.AiModelMapper.selectById    : <==      Total: 1
21:23:03:587 DEBUG 38360 --- [http-nio-8080-exec-2] o.s.c.openfeign.support.SpringEncoder    : Writing [ChatForm(diagnosisName=, diagnosisCategory=, result=A, remark=A, treatmentPlan=TreatmentPlans(id=1, diagnosisId=1, treatmentType=1, treatmentDetail=, startTime=2025-03-01T09:00, endDate=2025-03-10T09:00, doctorId=1, createdTime=2025-03-01T09:00, updatedTime=2025-03-01T09:00), medications=[MedicationRecommendations(id=1, diagnosisId=1, medicationName=A, dosage=10mg, frequency=, sideEffects=, startTime=2025-03-01T09:00, endTime=2025-03-10T09:00, doctorId=1, createdTime=2025-03-01T09:00, updatedTime=2025-03-01T09:00)], previousConversations=[DialogueInfo(role=pariatur tempor do, content=sit cupidatat commodo)], question=irure eu esse, stream=false)] using [org.springframework.http.converter.json.MappingJackson2HttpMessageConverter@4cbb11e4]
21:23:03:606 DEBUG 38360 --- [http-nio-8080-exec-2] c.l.api.client.FlaskAiDoctorClient       : [FlaskAiDoctorClient#eye_doctor_chat] ---> POST http://ai-service/api/eye-doctor/chat HTTP/1.1
21:23:03:606 DEBUG 38360 --- [http-nio-8080-exec-2] c.l.api.client.FlaskAiDoctorClient       : [FlaskAiDoctorClient#eye_doctor_chat] Content-Length: 749
21:23:03:606 DEBUG 38360 --- [http-nio-8080-exec-2] c.l.api.client.FlaskAiDoctorClient       : [FlaskAiDoctorClient#eye_doctor_chat] Content-Type: application/json
21:23:03:606 DEBUG 38360 --- [http-nio-8080-exec-2] c.l.api.client.FlaskAiDoctorClient       : [FlaskAiDoctorClient#eye_doctor_chat] 
21:23:03:607 DEBUG 38360 --- [http-nio-8080-exec-2] c.l.api.client.FlaskAiDoctorClient       : [FlaskAiDoctorClient#eye_doctor_chat] {"disease_name":"","disease_category":"","result":"A","remark":"A","treatment_plan":{"id":1,"treatmentType":1,"treatmentDetail":"","startTime":"2025-03-01 09:00:00","endDate":"2025-03-10 09:00:00","doctorId":1,"createdTime":"2025-03-01T09:00:00","updatedTime":"2025-03-01T09:00:00"},"medications":[{"id":1,"diagnosisId":1,"medicationName":"A","dosage":"10mg","frequency":"","sideEffects":"","startTime":"2025-03-01T09:00:00","endTime":"2025-03-10T09:00:00","doctorId":1,"createdTime":"2025-03-01 09:00:00","updatedTime":"2025-03-01 09:00:00"}],"previous_conversations":[{"role":"pariatur tempor do","content":"sit cupidatat commodo"}],"question":"irure eu esse","stream":false}
21:23:03:607 DEBUG 38360 --- [http-nio-8080-exec-2] c.l.api.client.FlaskAiDoctorClient       : [FlaskAiDoctorClient#eye_doctor_chat] ---> END HTTP (749-byte body)
21:23:17:474 DEBUG 38360 --- [http-nio-8080-exec-2] c.l.api.client.FlaskAiDoctorClient       : [FlaskAiDoctorClient#eye_doctor_chat] <--- HTTP/1.1 200 OK (13866ms)
21:23:17:475 DEBUG 38360 --- [http-nio-8080-exec-2] c.l.api.client.FlaskAiDoctorClient       : [FlaskAiDoctorClient#eye_doctor_chat] content-length: 1128
21:23:17:475 DEBUG 38360 --- [http-nio-8080-exec-2] c.l.api.client.FlaskAiDoctorClient       : [FlaskAiDoctorClient#eye_doctor_chat] content-type: application/json
21:23:17:475 DEBUG 38360 --- [http-nio-8080-exec-2] c.l.api.client.FlaskAiDoctorClient       : [FlaskAiDoctorClient#eye_doctor_chat] date: Thu, 13 Mar 2025 13:23:02 GMT
21:23:17:475 DEBUG 38360 --- [http-nio-8080-exec-2] c.l.api.client.FlaskAiDoctorClient       : [FlaskAiDoctorClient#eye_doctor_chat] server: uvicorn
21:23:17:475 DEBUG 38360 --- [http-nio-8080-exec-2] c.l.api.client.FlaskAiDoctorClient       : [FlaskAiDoctorClient#eye_doctor_chat] 
21:23:17:476 DEBUG 38360 --- [http-nio-8080-exec-2] c.l.api.client.FlaskAiDoctorClient       : [FlaskAiDoctorClient#eye_doctor_chat] {"response_id":"c1e6910d-e354-4747-8b24-86e087be59dd","content":"\n\n\n1. \n2. \n3. \n\n\n1. \n2. \n3. \n4. \n\n","references":[],"created_at":"2025-03-13T13:23:17.462059+00:00"}
21:23:17:476 DEBUG 38360 --- [http-nio-8080-exec-2] c.l.api.client.FlaskAiDoctorClient       : [FlaskAiDoctorClient#eye_doctor_chat] <--- END HTTP (1128-byte body)
21:24:38:233  WARN 38360 --- [Thread-15] c.a.nacos.common.notify.NotifyCenter     : [NotifyCenter] Start destroying Publisher
21:24:38:234  WARN 38360 --- [Thread-18] c.a.n.common.http.HttpClientBeanHolder   : [HttpClientBeanHolder] Start destroying common HttpClient
21:24:38:235  WARN 38360 --- [Thread-15] c.a.nacos.common.notify.NotifyCenter     : [NotifyCenter] Destruction of the end
21:24:38:235  WARN 38360 --- [Thread-18] c.a.n.common.http.HttpClientBeanHolder   : [HttpClientBeanHolder] Destruction of the end
21:24:38:288  INFO 38360 --- [SpringApplicationShutdownHook] c.a.c.n.registry.NacosServiceRegistry    : De-registering from Nacos Server now...
21:24:38:316  INFO 38360 --- [SpringApplicationShutdownHook] c.a.c.n.registry.NacosServiceRegistry    : De-registration finished.
21:24:38:329  INFO 38360 --- [SpringApplicationShutdownHook] com.zaxxer.hikari.HikariDataSource       : HikariPool-1 - Shutdown initiated...
21:24:38:640  INFO 38360 --- [SpringApplicationShutdownHook] com.zaxxer.hikari.HikariDataSource       : HikariPool-1 - Shutdown completed.
21:24:42:929  INFO 39620 --- [main] c.l.his_service.HisServiceApplication    : Starting HisServiceApplication using Java 17.0.11 on luo with PID 39620 (A:\Desktop\workspace\HIS\his_service\target\classes started by 22407 in A:\Desktop\workspace\HIS)
21:24:42:930 DEBUG 39620 --- [main] c.l.his_service.HisServiceApplication    : Running with Spring Boot v2.7.12, Spring v5.3.27
21:24:42:931  INFO 39620 --- [main] c.l.his_service.HisServiceApplication    : The following 1 profile is active: "dev"
21:24:43:666 DEBUG 39620 --- [main] o.s.c.openfeign.FeignClientsRegistrar$1  : Identified candidate component class: file [A:\Desktop\workspace\HIS\his_api\target\classes\com\luojiawei\api\client\FlaskAiDoctorClient.class]
21:24:43:666 DEBUG 39620 --- [main] o.s.c.openfeign.FeignClientsRegistrar$1  : Identified candidate component class: file [A:\Desktop\workspace\HIS\his_api\target\classes\com\luojiawei\api\client\FlaskModelAnalyzeClient.class]
21:24:43:667 DEBUG 39620 --- [main] o.s.c.openfeign.FeignClientsRegistrar$1  : Identified candidate component class: file [A:\Desktop\workspace\HIS\his_api\target\classes\com\luojiawei\api\client\FlaskUploadClient.class]
21:24:44:008  INFO 39620 --- [main] .s.d.r.c.RepositoryConfigurationDelegate : Multiple Spring Data modules found, entering strict repository configuration mode
21:24:44:011  INFO 39620 --- [main] .s.d.r.c.RepositoryConfigurationDelegate : Bootstrapping Spring Data Redis repositories in DEFAULT mode.
21:24:44:042  INFO 39620 --- [main] .s.d.r.c.RepositoryConfigurationDelegate : Finished Spring Data repository scanning in 16 ms. Found 0 Redis repository interfaces.
21:24:44:357  INFO 39620 --- [main] o.s.cloud.context.scope.GenericScope     : BeanFactory id=93ec073a-d50a-3e20-8556-fa3097b20012
21:24:44:982  INFO 39620 --- [main] o.s.b.w.embedded.tomcat.TomcatWebServer  : Tomcat initialized with port(s): 8080 (http)
21:24:44:994  INFO 39620 --- [main] o.apache.catalina.core.StandardService   : Starting service [Tomcat]
21:24:44:994  INFO 39620 --- [main] org.apache.catalina.core.StandardEngine  : Starting Servlet engine: [Apache Tomcat/9.0.75]
21:24:45:166  INFO 39620 --- [main] o.a.c.c.C.[Tomcat].[localhost].[/]       : Initializing Spring embedded WebApplicationContext
21:24:45:166  INFO 39620 --- [main] w.s.c.ServletWebServerApplicationContext : Root WebApplicationContext: initialization completed in 2188 ms
21:24:45:600  INFO 39620 --- [main] org.redisson.Version                     : Redisson 3.17.7
21:24:46:007  INFO 39620 --- [redisson-netty-2-9] o.r.c.pool.MasterPubSubConnectionPool    : 1 connections initialized for 111.230.32.147/111.230.32.147:9631
21:24:46:693  INFO 39620 --- [redisson-netty-2-19] o.r.c.pool.MasterConnectionPool          : 24 connections initialized for 111.230.32.147/111.230.32.147:9631
21:24:46:989 DEBUG 39620 --- [main] c.l.h.filter.RefreshTokenFilter          : Filter 'refreshTokenFilter' configured for use
21:24:47:801  INFO 39620 --- [main] o.s.c.openfeign.FeignClientFactoryBean   : For 'flask-service' URL not provided. Will try picking an instance via load-balancing.
21:24:48:069  INFO 39620 --- [main] o.s.c.openfeign.FeignClientFactoryBean   : For 'ai-service' URL not provided. Will try picking an instance via load-balancing.
21:24:48:118  WARN 39620 --- [main] c.b.m.core.metadata.TableInfoHelper      : Can not find table primary key in Class: "java.lang.Object".
21:24:48:118  WARN 39620 --- [main] c.b.m.core.injector.DefaultSqlInjector   : class java.lang.Object ,Not found @TableId annotation, Cannot use Mybatis-Plus 'xxById' Method.
21:24:49:829  WARN 39620 --- [main] iguration$LoadBalancerCaffeineWarnLogger : Spring Cloud LoadBalancer is currently working with the default cache. While this cache implementation is useful for development and tests, it's recommended to use Caffeine cache in production.You can switch to using Caffeine cache, by adding it and org.springframework.cache.caffeine.CaffeineCacheManager to the classpath.
21:24:49:833  INFO 39620 --- [main] o.s.b.a.e.web.EndpointLinksResolver      : Exposing 1 endpoint(s) beneath base path '/actuator'
21:24:49:946  INFO 39620 --- [main] o.s.b.w.embedded.tomcat.TomcatWebServer  : Tomcat started on port(s): 8080 (http) with context path ''
21:24:49:989  INFO 39620 --- [main] c.a.n.p.a.s.c.ClientAuthPluginManager    : [ClientAuthPluginManager] Load ClientAuthService com.alibaba.nacos.client.auth.impl.NacosClientAuthServiceImpl success.
21:24:49:990  INFO 39620 --- [main] c.a.n.p.a.s.c.ClientAuthPluginManager    : [ClientAuthPluginManager] Load ClientAuthService com.alibaba.nacos.client.auth.ram.RamClientAuthServiceImpl success.
21:24:50:925  INFO 39620 --- [main] c.a.n.c.a.AbstractAbilityControlManager  : Ready to get current node abilities...
21:24:50:927  INFO 39620 --- [main] c.a.n.c.a.AbstractAbilityControlManager  : Ready to initialize current node abilities, support modes: [SDK_CLIENT]
21:24:50:928  INFO 39620 --- [main] c.a.n.c.a.AbstractAbilityControlManager  : Initialize current abilities finish...
21:24:50:928  INFO 39620 --- [main] c.a.n.c.a.d.NacosAbilityManagerHolder    : [AbilityControlManager] Successfully initialize AbilityControlManager
21:24:50:994  INFO 39620 --- [main] c.a.c.n.registry.NacosServiceRegistry    : nacos registry, DEFAULT_GROUP his-service 10.21.93.70:8080 register finished
21:24:51:273  INFO 39620 --- [main] c.l.his_service.HisServiceApplication    : Started HisServiceApplication in 9.336 seconds (JVM running for 10.384)
21:24:51:434  INFO 39620 --- [RMI TCP Connection(3)-10.21.93.70] o.a.c.c.C.[Tomcat].[localhost].[/]       : Initializing Spring DispatcherServlet 'dispatcherServlet'
21:24:51:434  INFO 39620 --- [RMI TCP Connection(3)-10.21.93.70] o.s.web.servlet.DispatcherServlet        : Initializing Servlet 'dispatcherServlet'
21:24:51:438  INFO 39620 --- [RMI TCP Connection(3)-10.21.93.70] o.s.web.servlet.DispatcherServlet        : Completed initialization in 3 ms
21:24:51:441  INFO 39620 --- [RMI TCP Connection(2)-10.21.93.70] com.zaxxer.hikari.HikariDataSource       : HikariPool-1 - Starting...
21:24:52:024  INFO 39620 --- [RMI TCP Connection(2)-10.21.93.70] com.zaxxer.hikari.HikariDataSource       : HikariPool-1 - Start completed.
21:25:00:124 DEBUG 39620 --- [http-nio-8080-exec-2] c.l.h.m.D.selectById                     : ==>  Preparing: SELECT id,patient_id,doctor_id,disease_name,disease_category,aimodel_id,result,create_time,status,id_card,name,score,remark FROM diagnosis_report WHERE id=?
21:25:00:155 DEBUG 39620 --- [http-nio-8080-exec-2] c.l.h.m.D.selectById                     : ==> Parameters: 1(Integer)
21:25:00:218 DEBUG 39620 --- [http-nio-8080-exec-2] c.l.h.m.D.selectById                     : <==      Total: 1
21:25:00:220 DEBUG 39620 --- [http-nio-8080-exec-2] c.l.h.mapper.PatientMapper.selectById    : ==>  Preparing: SELECT id,phone,id_card,name,verified,verified_by,verified_time,open_id,hospital_pid FROM patient WHERE id=?
21:25:00:221 DEBUG 39620 --- [http-nio-8080-exec-2] c.l.h.mapper.PatientMapper.selectById    : ==> Parameters: 1(Integer)
21:25:00:250 DEBUG 39620 --- [http-nio-8080-exec-2] c.l.h.mapper.PatientMapper.selectById    : <==      Total: 1
21:25:00:252 DEBUG 39620 --- [http-nio-8080-exec-2] c.l.h.mapper.DoctorMapper.selectById     : ==>  Preparing: SELECT id,phone,id_card,name,verified,verified_by,verified_time,license,department,hospital_pid FROM doctor WHERE id=?
21:25:00:252 DEBUG 39620 --- [http-nio-8080-exec-2] c.l.h.mapper.DoctorMapper.selectById     : ==> Parameters: 1(Integer)
21:25:00:282 DEBUG 39620 --- [http-nio-8080-exec-2] c.l.h.mapper.DoctorMapper.selectById     : <==      Total: 1
21:25:00:284 DEBUG 39620 --- [http-nio-8080-exec-2] c.l.h.m.E.selectListByDiagnosisId        : ==>  Preparing: select * from eye_images where dignosis_report_id = ?
21:25:00:284 DEBUG 39620 --- [http-nio-8080-exec-2] c.l.h.m.E.selectListByDiagnosisId        : ==> Parameters: 1(Integer)
21:25:00:314 DEBUG 39620 --- [http-nio-8080-exec-2] c.l.h.m.E.selectListByDiagnosisId        : <==      Total: 1
21:25:00:315 DEBUG 39620 --- [http-nio-8080-exec-2] c.l.h.m.T.selectByDiagnosisId            : ==>  Preparing: select * from treatment_plans where diagnosis_id = ?
21:25:00:315 DEBUG 39620 --- [http-nio-8080-exec-2] c.l.h.m.T.selectByDiagnosisId            : ==> Parameters: 1(Integer)
21:25:00:344 DEBUG 39620 --- [http-nio-8080-exec-2] c.l.h.m.T.selectByDiagnosisId            : <==      Total: 1
21:25:00:345 DEBUG 39620 --- [http-nio-8080-exec-2] c.l.h.m.M.selectByDiagnosisId            : ==>  Preparing: select * from medication_recommendations where diagnosis_id = ?
21:25:00:345 DEBUG 39620 --- [http-nio-8080-exec-2] c.l.h.m.M.selectByDiagnosisId            : ==> Parameters: 1(Integer)
21:25:00:375 DEBUG 39620 --- [http-nio-8080-exec-2] c.l.h.m.M.selectByDiagnosisId            : <==      Total: 1
21:25:00:376 DEBUG 39620 --- [http-nio-8080-exec-2] c.l.h.mapper.AiModelMapper.selectById    : ==>  Preparing: SELECT id,version,deploy_time,accuracy FROM ai_model WHERE id=?
21:25:00:377 DEBUG 39620 --- [http-nio-8080-exec-2] c.l.h.mapper.AiModelMapper.selectById    : ==> Parameters: 1(Integer)
21:25:00:407 DEBUG 39620 --- [http-nio-8080-exec-2] c.l.h.mapper.AiModelMapper.selectById    : <==      Total: 1
21:25:00:439 DEBUG 39620 --- [http-nio-8080-exec-2] o.s.c.openfeign.support.SpringEncoder    : Writing [ChatForm(diagnosisName=, diagnosisCategory=, result=A, remark=A, treatmentPlan=TreatmentPlans(id=1, diagnosisId=1, treatmentType=1, treatmentDetail=, startTime=2025-03-01T09:00, endDate=2025-03-10T09:00, doctorId=1, createdTime=2025-03-01T09:00, updatedTime=2025-03-01T09:00), medications=[MedicationRecommendations(id=1, diagnosisId=1, medicationName=A, dosage=10mg, frequency=, sideEffects=, startTime=2025-03-01T09:00, endTime=2025-03-10T09:00, doctorId=1, createdTime=2025-03-01T09:00, updatedTime=2025-03-01T09:00)], previousConversations=[DialogueInfo(role=pariatur tempor do, content=sit cupidatat commodo)], question=irure eu esse, stream=false)] using [org.springframework.http.converter.json.MappingJackson2HttpMessageConverter@72c1bf75]
21:25:00:455 DEBUG 39620 --- [http-nio-8080-exec-2] c.l.api.client.FlaskAiDoctorClient       : [FlaskAiDoctorClient#eye_doctor_chat] ---> POST http://ai-service/api/eye-doctor/chat HTTP/1.1
21:25:00:455 DEBUG 39620 --- [http-nio-8080-exec-2] c.l.api.client.FlaskAiDoctorClient       : [FlaskAiDoctorClient#eye_doctor_chat] Content-Length: 749
21:25:00:455 DEBUG 39620 --- [http-nio-8080-exec-2] c.l.api.client.FlaskAiDoctorClient       : [FlaskAiDoctorClient#eye_doctor_chat] Content-Type: application/json
21:25:00:456 DEBUG 39620 --- [http-nio-8080-exec-2] c.l.api.client.FlaskAiDoctorClient       : [FlaskAiDoctorClient#eye_doctor_chat] 
21:25:00:456 DEBUG 39620 --- [http-nio-8080-exec-2] c.l.api.client.FlaskAiDoctorClient       : [FlaskAiDoctorClient#eye_doctor_chat] {"disease_name":"","disease_category":"","result":"A","remark":"A","treatment_plan":{"id":1,"treatmentType":1,"treatmentDetail":"","startTime":"2025-03-01 09:00:00","endDate":"2025-03-10 09:00:00","doctorId":1,"createdTime":"2025-03-01T09:00:00","updatedTime":"2025-03-01T09:00:00"},"medications":[{"id":1,"diagnosisId":1,"medicationName":"A","dosage":"10mg","frequency":"","sideEffects":"","startTime":"2025-03-01T09:00:00","endTime":"2025-03-10T09:00:00","doctorId":1,"createdTime":"2025-03-01 09:00:00","updatedTime":"2025-03-01 09:00:00"}],"previous_conversations":[{"role":"pariatur tempor do","content":"sit cupidatat commodo"}],"question":"irure eu esse","stream":false}
21:25:00:456 DEBUG 39620 --- [http-nio-8080-exec-2] c.l.api.client.FlaskAiDoctorClient       : [FlaskAiDoctorClient#eye_doctor_chat] ---> END HTTP (749-byte body)
21:25:03:102  WARN 39620 --- [Thread-15] c.a.nacos.common.notify.NotifyCenter     : [NotifyCenter] Start destroying Publisher
21:25:03:102  WARN 39620 --- [Thread-18] c.a.n.common.http.HttpClientBeanHolder   : [HttpClientBeanHolder] Start destroying common HttpClient
21:25:03:102  WARN 39620 --- [Thread-15] c.a.nacos.common.notify.NotifyCenter     : [NotifyCenter] Destruction of the end
21:25:03:103  WARN 39620 --- [Thread-18] c.a.n.common.http.HttpClientBeanHolder   : [HttpClientBeanHolder] Destruction of the end
21:25:10:463  INFO 39620 --- [SpringApplicationShutdownHook] c.a.c.n.registry.NacosServiceRegistry    : De-registering from Nacos Server now...
21:25:10:493  INFO 39620 --- [SpringApplicationShutdownHook] c.a.c.n.registry.NacosServiceRegistry    : De-registration finished.
21:25:10:514  INFO 39620 --- [SpringApplicationShutdownHook] com.zaxxer.hikari.HikariDataSource       : HikariPool-1 - Shutdown initiated...
21:25:10:820  INFO 39620 --- [SpringApplicationShutdownHook] com.zaxxer.hikari.HikariDataSource       : HikariPool-1 - Shutdown completed.
21:25:15:483  INFO 39624 --- [main] c.l.his_service.HisServiceApplication    : Starting HisServiceApplication using Java 17.0.11 on luo with PID 39624 (A:\Desktop\workspace\HIS\his_service\target\classes started by 22407 in A:\Desktop\workspace\HIS)
21:25:15:484 DEBUG 39624 --- [main] c.l.his_service.HisServiceApplication    : Running with Spring Boot v2.7.12, Spring v5.3.27
21:25:15:485  INFO 39624 --- [main] c.l.his_service.HisServiceApplication    : The following 1 profile is active: "dev"
21:25:16:226 DEBUG 39624 --- [main] o.s.c.openfeign.FeignClientsRegistrar$1  : Identified candidate component class: file [A:\Desktop\workspace\HIS\his_api\target\classes\com\luojiawei\api\client\FlaskAiDoctorClient.class]
21:25:16:226 DEBUG 39624 --- [main] o.s.c.openfeign.FeignClientsRegistrar$1  : Identified candidate component class: file [A:\Desktop\workspace\HIS\his_api\target\classes\com\luojiawei\api\client\FlaskModelAnalyzeClient.class]
21:25:16:227 DEBUG 39624 --- [main] o.s.c.openfeign.FeignClientsRegistrar$1  : Identified candidate component class: file [A:\Desktop\workspace\HIS\his_api\target\classes\com\luojiawei\api\client\FlaskUploadClient.class]
21:25:16:549  INFO 39624 --- [main] .s.d.r.c.RepositoryConfigurationDelegate : Multiple Spring Data modules found, entering strict repository configuration mode
21:25:16:552  INFO 39624 --- [main] .s.d.r.c.RepositoryConfigurationDelegate : Bootstrapping Spring Data Redis repositories in DEFAULT mode.
21:25:16:584  INFO 39624 --- [main] .s.d.r.c.RepositoryConfigurationDelegate : Finished Spring Data repository scanning in 16 ms. Found 0 Redis repository interfaces.
21:25:16:885  INFO 39624 --- [main] o.s.cloud.context.scope.GenericScope     : BeanFactory id=93ec073a-d50a-3e20-8556-fa3097b20012
21:25:17:546  INFO 39624 --- [main] o.s.b.w.embedded.tomcat.TomcatWebServer  : Tomcat initialized with port(s): 8080 (http)
21:25:17:559  INFO 39624 --- [main] o.apache.catalina.core.StandardService   : Starting service [Tomcat]
21:25:17:559  INFO 39624 --- [main] org.apache.catalina.core.StandardEngine  : Starting Servlet engine: [Apache Tomcat/9.0.75]
21:25:17:722  INFO 39624 --- [main] o.a.c.c.C.[Tomcat].[localhost].[/]       : Initializing Spring embedded WebApplicationContext
21:25:17:722  INFO 39624 --- [main] w.s.c.ServletWebServerApplicationContext : Root WebApplicationContext: initialization completed in 2183 ms
21:25:18:136  INFO 39624 --- [main] org.redisson.Version                     : Redisson 3.17.7
21:25:18:537  INFO 39624 --- [redisson-netty-2-9] o.r.c.pool.MasterPubSubConnectionPool    : 1 connections initialized for 111.230.32.147/111.230.32.147:9631
21:25:19:229  INFO 39624 --- [redisson-netty-2-19] o.r.c.pool.MasterConnectionPool          : 24 connections initialized for 111.230.32.147/111.230.32.147:9631
21:25:19:536 DEBUG 39624 --- [main] c.l.h.filter.RefreshTokenFilter          : Filter 'refreshTokenFilter' configured for use
21:25:20:336  INFO 39624 --- [main] o.s.c.openfeign.FeignClientFactoryBean   : For 'flask-service' URL not provided. Will try picking an instance via load-balancing.
21:25:20:650  INFO 39624 --- [main] o.s.c.openfeign.FeignClientFactoryBean   : For 'ai-service' URL not provided. Will try picking an instance via load-balancing.
21:25:20:701  WARN 39624 --- [main] c.b.m.core.metadata.TableInfoHelper      : Can not find table primary key in Class: "java.lang.Object".
21:25:20:704  WARN 39624 --- [main] c.b.m.core.injector.DefaultSqlInjector   : class java.lang.Object ,Not found @TableId annotation, Cannot use Mybatis-Plus 'xxById' Method.
21:25:22:447  WARN 39624 --- [main] iguration$LoadBalancerCaffeineWarnLogger : Spring Cloud LoadBalancer is currently working with the default cache. While this cache implementation is useful for development and tests, it's recommended to use Caffeine cache in production.You can switch to using Caffeine cache, by adding it and org.springframework.cache.caffeine.CaffeineCacheManager to the classpath.
21:25:22:452  INFO 39624 --- [main] o.s.b.a.e.web.EndpointLinksResolver      : Exposing 1 endpoint(s) beneath base path '/actuator'
21:25:22:544  INFO 39624 --- [main] o.s.b.w.embedded.tomcat.TomcatWebServer  : Tomcat started on port(s): 8080 (http) with context path ''
21:25:22:590  INFO 39624 --- [main] c.a.n.p.a.s.c.ClientAuthPluginManager    : [ClientAuthPluginManager] Load ClientAuthService com.alibaba.nacos.client.auth.impl.NacosClientAuthServiceImpl success.
21:25:22:590  INFO 39624 --- [main] c.a.n.p.a.s.c.ClientAuthPluginManager    : [ClientAuthPluginManager] Load ClientAuthService com.alibaba.nacos.client.auth.ram.RamClientAuthServiceImpl success.
21:25:23:570  INFO 39624 --- [main] c.a.n.c.a.AbstractAbilityControlManager  : Ready to get current node abilities...
21:25:23:571  INFO 39624 --- [main] c.a.n.c.a.AbstractAbilityControlManager  : Ready to initialize current node abilities, support modes: [SDK_CLIENT]
21:25:23:572  INFO 39624 --- [main] c.a.n.c.a.AbstractAbilityControlManager  : Initialize current abilities finish...
21:25:23:572  INFO 39624 --- [main] c.a.n.c.a.d.NacosAbilityManagerHolder    : [AbilityControlManager] Successfully initialize AbilityControlManager
21:25:23:616  INFO 39624 --- [main] c.a.c.n.registry.NacosServiceRegistry    : nacos registry, DEFAULT_GROUP his-service 10.21.93.70:8080 register finished
21:25:23:925  INFO 39624 --- [main] c.l.his_service.HisServiceApplication    : Started HisServiceApplication in 9.584 seconds (JVM running for 10.654)
21:25:24:267  INFO 39624 --- [RMI TCP Connection(2)-10.21.93.70] o.a.c.c.C.[Tomcat].[localhost].[/]       : Initializing Spring DispatcherServlet 'dispatcherServlet'
21:25:24:267  INFO 39624 --- [RMI TCP Connection(2)-10.21.93.70] o.s.web.servlet.DispatcherServlet        : Initializing Servlet 'dispatcherServlet'
21:25:24:269  INFO 39624 --- [RMI TCP Connection(2)-10.21.93.70] o.s.web.servlet.DispatcherServlet        : Completed initialization in 1 ms
21:25:24:273  INFO 39624 --- [RMI TCP Connection(3)-10.21.93.70] com.zaxxer.hikari.HikariDataSource       : HikariPool-1 - Starting...
21:25:24:851  INFO 39624 --- [RMI TCP Connection(3)-10.21.93.70] com.zaxxer.hikari.HikariDataSource       : HikariPool-1 - Start completed.
21:29:16:281  WARN 39624 --- [Thread-18] c.a.n.common.http.HttpClientBeanHolder   : [HttpClientBeanHolder] Start destroying common HttpClient
21:29:16:282  WARN 39624 --- [Thread-15] c.a.nacos.common.notify.NotifyCenter     : [NotifyCenter] Start destroying Publisher
21:29:16:282  WARN 39624 --- [Thread-15] c.a.nacos.common.notify.NotifyCenter     : [NotifyCenter] Destruction of the end
21:29:16:289  WARN 39624 --- [Thread-18] c.a.n.common.http.HttpClientBeanHolder   : [HttpClientBeanHolder] Destruction of the end
21:29:16:370  INFO 39624 --- [SpringApplicationShutdownHook] c.a.c.n.registry.NacosServiceRegistry    : De-registering from Nacos Server now...
21:29:16:402  INFO 39624 --- [SpringApplicationShutdownHook] c.a.c.n.registry.NacosServiceRegistry    : De-registration finished.
21:29:16:451  INFO 39624 --- [SpringApplicationShutdownHook] com.zaxxer.hikari.HikariDataSource       : HikariPool-1 - Shutdown initiated...
21:29:16:758  INFO 39624 --- [SpringApplicationShutdownHook] com.zaxxer.hikari.HikariDataSource       : HikariPool-1 - Shutdown completed.
21:32:40:179  INFO 38752 --- [main] c.l.his_service.HisServiceApplication    : Starting HisServiceApplication using Java 17.0.11 on luo with PID 38752 (A:\Desktop\workspace\HIS\his_service\target\classes started by 22407 in A:\Desktop\workspace\HIS)
21:32:40:184 DEBUG 38752 --- [main] c.l.his_service.HisServiceApplication    : Running with Spring Boot v2.7.12, Spring v5.3.27
21:32:40:185  INFO 38752 --- [main] c.l.his_service.HisServiceApplication    : The following 1 profile is active: "dev"
21:32:42:637 DEBUG 38752 --- [main] o.s.c.openfeign.FeignClientsRegistrar$1  : Identified candidate component class: file [A:\Desktop\workspace\HIS\his_api\target\classes\com\luojiawei\api\client\FlaskAiDoctorClient.class]
21:32:42:637 DEBUG 38752 --- [main] o.s.c.openfeign.FeignClientsRegistrar$1  : Identified candidate component class: file [A:\Desktop\workspace\HIS\his_api\target\classes\com\luojiawei\api\client\FlaskModelAnalyzeClient.class]
21:32:42:639 DEBUG 38752 --- [main] o.s.c.openfeign.FeignClientsRegistrar$1  : Identified candidate component class: file [A:\Desktop\workspace\HIS\his_api\target\classes\com\luojiawei\api\client\FlaskUploadClient.class]
21:32:43:573  INFO 38752 --- [main] .s.d.r.c.RepositoryConfigurationDelegate : Multiple Spring Data modules found, entering strict repository configuration mode
21:32:43:585  INFO 38752 --- [main] .s.d.r.c.RepositoryConfigurationDelegate : Bootstrapping Spring Data Redis repositories in DEFAULT mode.
21:32:43:705  INFO 38752 --- [main] .s.d.r.c.RepositoryConfigurationDelegate : Finished Spring Data repository scanning in 23 ms. Found 0 Redis repository interfaces.
21:32:44:359  INFO 38752 --- [main] o.s.cloud.context.scope.GenericScope     : BeanFactory id=15115e6d-eb61-304d-ae7c-b74e3e436bbc
21:32:46:933  INFO 38752 --- [main] o.s.b.w.embedded.tomcat.TomcatWebServer  : Tomcat initialized with port(s): 8080 (http)
21:32:46:964  INFO 38752 --- [main] o.apache.catalina.core.StandardService   : Starting service [Tomcat]
21:32:46:964  INFO 38752 --- [main] org.apache.catalina.core.StandardEngine  : Starting Servlet engine: [Apache Tomcat/9.0.75]
21:32:47:212  INFO 38752 --- [main] o.a.c.c.C.[Tomcat].[localhost].[/]       : Initializing Spring embedded WebApplicationContext
21:32:47:212  INFO 38752 --- [main] w.s.c.ServletWebServerApplicationContext : Root WebApplicationContext: initialization completed in 6854 ms
21:32:48:334  INFO 38752 --- [main] org.redisson.Version                     : Redisson 3.17.7
21:32:49:273  INFO 38752 --- [redisson-netty-2-9] o.r.c.pool.MasterPubSubConnectionPool    : 1 connections initialized for 111.230.32.147/111.230.32.147:9631
21:32:49:988  INFO 38752 --- [redisson-netty-2-19] o.r.c.pool.MasterConnectionPool          : 24 connections initialized for 111.230.32.147/111.230.32.147:9631
21:32:50:674 DEBUG 38752 --- [main] c.l.h.filter.RefreshTokenFilter          : Filter 'refreshTokenFilter' configured for use
21:32:52:265  INFO 38752 --- [main] o.s.c.openfeign.FeignClientFactoryBean   : For 'flask-service' URL not provided. Will try picking an instance via load-balancing.
21:32:52:913  INFO 38752 --- [main] o.s.c.openfeign.FeignClientFactoryBean   : For 'ai-doctor-service' URL not provided. Will try picking an instance via load-balancing.
21:32:57:006  WARN 38752 --- [main] iguration$LoadBalancerCaffeineWarnLogger : Spring Cloud LoadBalancer is currently working with the default cache. While this cache implementation is useful for development and tests, it's recommended to use Caffeine cache in production.You can switch to using Caffeine cache, by adding it and org.springframework.cache.caffeine.CaffeineCacheManager to the classpath.
21:32:57:014  INFO 38752 --- [main] o.s.b.a.e.web.EndpointLinksResolver      : Exposing 1 endpoint(s) beneath base path '/actuator'
21:32:57:176  INFO 38752 --- [main] o.s.b.w.embedded.tomcat.TomcatWebServer  : Tomcat started on port(s): 8080 (http) with context path ''
21:32:57:249  INFO 38752 --- [main] c.a.n.p.a.s.c.ClientAuthPluginManager    : [ClientAuthPluginManager] Load ClientAuthService com.alibaba.nacos.client.auth.impl.NacosClientAuthServiceImpl success.
21:32:57:250  INFO 38752 --- [main] c.a.n.p.a.s.c.ClientAuthPluginManager    : [ClientAuthPluginManager] Load ClientAuthService com.alibaba.nacos.client.auth.ram.RamClientAuthServiceImpl success.
21:32:58:698  INFO 38752 --- [main] c.a.n.c.a.AbstractAbilityControlManager  : Ready to get current node abilities...
21:32:58:700  INFO 38752 --- [main] c.a.n.c.a.AbstractAbilityControlManager  : Ready to initialize current node abilities, support modes: [SDK_CLIENT]
21:32:58:701  INFO 38752 --- [main] c.a.n.c.a.AbstractAbilityControlManager  : Initialize current abilities finish...
21:32:58:701  INFO 38752 --- [main] c.a.n.c.a.d.NacosAbilityManagerHolder    : [AbilityControlManager] Successfully initialize AbilityControlManager
21:32:58:798  INFO 38752 --- [main] c.a.c.n.registry.NacosServiceRegistry    : nacos registry, DEFAULT_GROUP his-service 10.21.93.70:8848 register finished
21:32:59:086  INFO 38752 --- [main] c.l.his_service.HisServiceApplication    : Started HisServiceApplication in 21.164 seconds (JVM running for 23.075)
21:33:02:814  INFO 38752 --- [http-nio-8080-exec-2] o.a.c.c.C.[Tomcat].[localhost].[/]       : Initializing Spring DispatcherServlet 'dispatcherServlet'
21:33:02:814  INFO 38752 --- [http-nio-8080-exec-2] o.s.web.servlet.DispatcherServlet        : Initializing Servlet 'dispatcherServlet'
21:33:02:817  INFO 38752 --- [http-nio-8080-exec-2] o.s.web.servlet.DispatcherServlet        : Completed initialization in 3 ms
21:33:03:372  INFO 38752 --- [http-nio-8080-exec-2] com.zaxxer.hikari.HikariDataSource       : HikariPool-1 - Starting...
21:33:04:104  INFO 38752 --- [http-nio-8080-exec-2] com.zaxxer.hikari.HikariDataSource       : HikariPool-1 - Start completed.
21:33:04:116 DEBUG 38752 --- [http-nio-8080-exec-2] c.l.h.m.D.selectById                     : ==>  Preparing: SELECT id,patient_id,doctor_id,disease_name,disease_category,aimodel_id,result,create_time,status,id_card,name,score,remark FROM diagnosis_report WHERE id=?
21:33:04:148 DEBUG 38752 --- [http-nio-8080-exec-2] c.l.h.m.D.selectById                     : ==> Parameters: 1(Integer)
21:33:04:239 DEBUG 38752 --- [http-nio-8080-exec-2] c.l.h.m.D.selectById                     : <==      Total: 1
21:33:04:248 DEBUG 38752 --- [http-nio-8080-exec-2] c.l.h.mapper.PatientMapper.selectById    : ==>  Preparing: SELECT id,phone,id_card,name,verified,verified_by,verified_time,open_id,hospital_pid FROM patient WHERE id=?
21:33:04:249 DEBUG 38752 --- [http-nio-8080-exec-2] c.l.h.mapper.PatientMapper.selectById    : ==> Parameters: 1(Integer)
21:33:04:280 DEBUG 38752 --- [http-nio-8080-exec-2] c.l.h.mapper.PatientMapper.selectById    : <==      Total: 1
21:33:04:285 DEBUG 38752 --- [http-nio-8080-exec-2] c.l.h.mapper.DoctorMapper.selectById     : ==>  Preparing: SELECT id,phone,id_card,name,verified,verified_by,verified_time,license,department,hospital_pid FROM doctor WHERE id=?
21:33:04:286 DEBUG 38752 --- [http-nio-8080-exec-2] c.l.h.mapper.DoctorMapper.selectById     : ==> Parameters: 1(Integer)
21:33:04:317 DEBUG 38752 --- [http-nio-8080-exec-2] c.l.h.mapper.DoctorMapper.selectById     : <==      Total: 1
21:33:04:323 DEBUG 38752 --- [http-nio-8080-exec-2] c.l.h.m.E.selectListByDiagnosisId        : ==>  Preparing: select * from eye_images where dignosis_report_id = ?
21:33:04:324 DEBUG 38752 --- [http-nio-8080-exec-2] c.l.h.m.E.selectListByDiagnosisId        : ==> Parameters: 1(Integer)
21:33:04:353 DEBUG 38752 --- [http-nio-8080-exec-2] c.l.h.m.E.selectListByDiagnosisId        : <==      Total: 1
21:33:04:354 DEBUG 38752 --- [http-nio-8080-exec-2] c.l.h.m.T.selectByDiagnosisId            : ==>  Preparing: select * from treatment_plans where diagnosis_id = ?
21:33:04:355 DEBUG 38752 --- [http-nio-8080-exec-2] c.l.h.m.T.selectByDiagnosisId            : ==> Parameters: 1(Integer)
21:33:04:385 DEBUG 38752 --- [http-nio-8080-exec-2] c.l.h.m.T.selectByDiagnosisId            : <==      Total: 1
21:33:04:385 DEBUG 38752 --- [http-nio-8080-exec-2] c.l.h.m.M.selectByDiagnosisId            : ==>  Preparing: select * from medication_recommendations where diagnosis_id = ?
21:33:04:386 DEBUG 38752 --- [http-nio-8080-exec-2] c.l.h.m.M.selectByDiagnosisId            : ==> Parameters: 1(Integer)
21:33:04:418 DEBUG 38752 --- [http-nio-8080-exec-2] c.l.h.m.M.selectByDiagnosisId            : <==      Total: 1
21:33:04:419 DEBUG 38752 --- [http-nio-8080-exec-2] c.l.h.mapper.AiModelMapper.selectById    : ==>  Preparing: SELECT id,version,deploy_time,accuracy FROM ai_model WHERE id=?
21:33:04:419 DEBUG 38752 --- [http-nio-8080-exec-2] c.l.h.mapper.AiModelMapper.selectById    : ==> Parameters: 1(Integer)
21:33:04:449 DEBUG 38752 --- [http-nio-8080-exec-2] c.l.h.mapper.AiModelMapper.selectById    : <==      Total: 1
21:33:04:483 DEBUG 38752 --- [http-nio-8080-exec-2] o.s.c.openfeign.support.SpringEncoder    : Writing [ChatForm(diagnosisName=, diagnosisCategory=, result=A, remark=A, treatmentPlan=TreatmentPlans(id=1, diagnosisId=1, treatmentType=1, treatmentDetail=, startTime=2025-03-01T09:00, endDate=2025-03-10T09:00, doctorId=1, createdTime=2025-03-01T09:00, updatedTime=2025-03-01T09:00), medications=[MedicationRecommendations(id=1, diagnosisId=1, medicationName=A, dosage=10mg, frequency=, sideEffects=, startTime=2025-03-01T09:00, endTime=2025-03-10T09:00, doctorId=1, createdTime=2025-03-01T09:00, updatedTime=2025-03-01T09:00)], previousConversations=[DialogueInfo(role=pariatur tempor do, content=sit cupidatat commodo)], question=irure eu esse, stream=false)] using [org.springframework.http.converter.json.MappingJackson2HttpMessageConverter@4a094f90]
21:33:04:497 DEBUG 38752 --- [http-nio-8080-exec-2] c.l.api.client.FlaskAiDoctorClient       : [FlaskAiDoctorClient#eye_doctor_chat] ---> POST http://ai-doctor-service/api/eye-doctor/chat HTTP/1.1
21:33:04:498 DEBUG 38752 --- [http-nio-8080-exec-2] c.l.api.client.FlaskAiDoctorClient       : [FlaskAiDoctorClient#eye_doctor_chat] Content-Length: 749
21:33:04:498 DEBUG 38752 --- [http-nio-8080-exec-2] c.l.api.client.FlaskAiDoctorClient       : [FlaskAiDoctorClient#eye_doctor_chat] Content-Type: application/json
21:33:04:498 DEBUG 38752 --- [http-nio-8080-exec-2] c.l.api.client.FlaskAiDoctorClient       : [FlaskAiDoctorClient#eye_doctor_chat] 
21:33:04:498 DEBUG 38752 --- [http-nio-8080-exec-2] c.l.api.client.FlaskAiDoctorClient       : [FlaskAiDoctorClient#eye_doctor_chat] {"disease_name":"","disease_category":"","result":"A","remark":"A","treatment_plan":{"id":1,"treatmentType":1,"treatmentDetail":"","startTime":"2025-03-01 09:00:00","endDate":"2025-03-10 09:00:00","doctorId":1,"createdTime":"2025-03-01T09:00:00","updatedTime":"2025-03-01T09:00:00"},"medications":[{"id":1,"diagnosisId":1,"medicationName":"A","dosage":"10mg","frequency":"","sideEffects":"","startTime":"2025-03-01T09:00:00","endTime":"2025-03-10T09:00:00","doctorId":1,"createdTime":"2025-03-01 09:00:00","updatedTime":"2025-03-01 09:00:00"}],"previous_conversations":[{"role":"pariatur tempor do","content":"sit cupidatat commodo"}],"question":"irure eu esse","stream":false}
21:33:04:498 DEBUG 38752 --- [http-nio-8080-exec-2] c.l.api.client.FlaskAiDoctorClient       : [FlaskAiDoctorClient#eye_doctor_chat] ---> END HTTP (749-byte body)
21:33:04:756  WARN 38752 --- [http-nio-8080-exec-2] o.s.c.l.core.RoundRobinLoadBalancer      : No servers available for service: ai-doctor-service
21:33:04:757  WARN 38752 --- [http-nio-8080-exec-2] .s.c.o.l.FeignBlockingLoadBalancerClient : Load balancer does not contain an instance for the service ai-doctor-service
21:33:04:767 DEBUG 38752 --- [http-nio-8080-exec-2] c.l.api.client.FlaskAiDoctorClient       : [FlaskAiDoctorClient#eye_doctor_chat] <--- HTTP/1.1 503 (267ms)
21:33:04:767 DEBUG 38752 --- [http-nio-8080-exec-2] c.l.api.client.FlaskAiDoctorClient       : [FlaskAiDoctorClient#eye_doctor_chat] 
21:33:04:767 DEBUG 38752 --- [http-nio-8080-exec-2] c.l.api.client.FlaskAiDoctorClient       : [FlaskAiDoctorClient#eye_doctor_chat] Load balancer does not contain an instance for the service ai-doctor-service
21:33:04:767 DEBUG 38752 --- [http-nio-8080-exec-2] c.l.api.client.FlaskAiDoctorClient       : [FlaskAiDoctorClient#eye_doctor_chat] <--- END HTTP (76-byte body)
21:33:04:800 ERROR 38752 --- [http-nio-8080-exec-2] o.a.c.c.C.[.[.[/].[dispatcherServlet]    : Servlet.service() for servlet [dispatcherServlet] in context with path [] threw exception [Request processing failed; nested exception is feign.FeignException$ServiceUnavailable: [503] during [POST] to [http://ai-doctor-service/api/eye-doctor/chat] [FlaskAiDoctorClient#eye_doctor_chat(ChatForm)]: [Load balancer does not contain an instance for the service ai-doctor-service]] with root cause

feign.FeignException$ServiceUnavailable: [503] during [POST] to [http://ai-doctor-service/api/eye-doctor/chat] [FlaskAiDoctorClient#eye_doctor_chat(ChatForm)]: [Load balancer does not contain an instance for the service ai-doctor-service]
	at feign.FeignException.serverErrorStatus(FeignException.java:256) ~[feign-core-11.10.jar:na]
	at feign.FeignException.errorStatus(FeignException.java:197) ~[feign-core-11.10.jar:na]
	at feign.FeignException.errorStatus(FeignException.java:185) ~[feign-core-11.10.jar:na]
	at feign.codec.ErrorDecoder$Default.decode(ErrorDecoder.java:92) ~[feign-core-11.10.jar:na]
	at feign.AsyncResponseHandler.handleResponse(AsyncResponseHandler.java:98) ~[feign-core-11.10.jar:na]
	at feign.SynchronousMethodHandler.executeAndDecode(SynchronousMethodHandler.java:141) ~[feign-core-11.10.jar:na]
	at feign.SynchronousMethodHandler.invoke(SynchronousMethodHandler.java:91) ~[feign-core-11.10.jar:na]
	at feign.ReflectiveFeign$FeignInvocationHandler.invoke(ReflectiveFeign.java:100) ~[feign-core-11.10.jar:na]
	at jdk.proxy2/jdk.proxy2.$Proxy138.eye_doctor_chat(Unknown Source) ~[na:na]
	at com.luojiawei.his_service.controller.ChatController.ask(ChatController.java:39) ~[classes/:na]
	at java.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke0(Native Method) ~[na:na]
	at java.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:77) ~[na:na]
	at java.base/jdk.internal.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43) ~[na:na]
	at java.base/java.lang.reflect.Method.invoke(Method.java:568) ~[na:na]
	at org.springframework.web.method.support.InvocableHandlerMethod.doInvoke(InvocableHandlerMethod.java:205) ~[spring-web-5.3.27.jar:5.3.27]
	at org.springframework.web.method.support.InvocableHandlerMethod.invokeForRequest(InvocableHandlerMethod.java:150) ~[spring-web-5.3.27.jar:5.3.27]
	at org.springframework.web.servlet.mvc.method.annotation.ServletInvocableHandlerMethod.invokeAndHandle(ServletInvocableHandlerMethod.java:117) ~[spring-webmvc-5.3.27.jar:5.3.27]
	at org.springframework.web.servlet.mvc.method.annotation.RequestMappingHandlerAdapter.invokeHandlerMethod(RequestMappingHandlerAdapter.java:895) ~[spring-webmvc-5.3.27.jar:5.3.27]
	at org.springframework.web.servlet.mvc.method.annotation.RequestMappingHandlerAdapter.handleInternal(RequestMappingHandlerAdapter.java:808) ~[spring-webmvc-5.3.27.jar:5.3.27]
	at org.springframework.web.servlet.mvc.method.AbstractHandlerMethodAdapter.handle(AbstractHandlerMethodAdapter.java:87) ~[spring-webmvc-5.3.27.jar:5.3.27]
	at org.springframework.web.servlet.DispatcherServlet.doDispatch(DispatcherServlet.java:1072) ~[spring-webmvc-5.3.27.jar:5.3.27]
	at org.springframework.web.servlet.DispatcherServlet.doService(DispatcherServlet.java:965) ~[spring-webmvc-5.3.27.jar:5.3.27]
	at org.springframework.web.servlet.FrameworkServlet.processRequest(FrameworkServlet.java:1006) ~[spring-webmvc-5.3.27.jar:5.3.27]
	at org.springframework.web.servlet.FrameworkServlet.doPost(FrameworkServlet.java:909) ~[spring-webmvc-5.3.27.jar:5.3.27]
	at javax.servlet.http.HttpServlet.service(HttpServlet.java:555) ~[tomcat-embed-core-9.0.75.jar:4.0.FR]
	at org.springframework.web.servlet.FrameworkServlet.service(FrameworkServlet.java:883) ~[spring-webmvc-5.3.27.jar:5.3.27]
	at javax.servlet.http.HttpServlet.service(HttpServlet.java:623) ~[tomcat-embed-core-9.0.75.jar:4.0.FR]
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:209) ~[tomcat-embed-core-9.0.75.jar:9.0.75]
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:153) ~[tomcat-embed-core-9.0.75.jar:9.0.75]
	at com.luojiawei.his_service.filter.RefreshTokenFilter.doFilterInternal(RefreshTokenFilter.java:58) ~[classes/:na]
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:117) ~[spring-web-5.3.27.jar:5.3.27]
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:178) ~[tomcat-embed-core-9.0.75.jar:9.0.75]
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:153) ~[tomcat-embed-core-9.0.75.jar:9.0.75]
	at org.springframework.web.filter.RequestContextFilter.doFilterInternal(RequestContextFilter.java:100) ~[spring-web-5.3.27.jar:5.3.27]
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:117) ~[spring-web-5.3.27.jar:5.3.27]
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:178) ~[tomcat-embed-core-9.0.75.jar:9.0.75]
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:153) ~[tomcat-embed-core-9.0.75.jar:9.0.75]
	at org.springframework.web.filter.FormContentFilter.doFilterInternal(FormContentFilter.java:93) ~[spring-web-5.3.27.jar:5.3.27]
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:117) ~[spring-web-5.3.27.jar:5.3.27]
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:178) ~[tomcat-embed-core-9.0.75.jar:9.0.75]
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:153) ~[tomcat-embed-core-9.0.75.jar:9.0.75]
	at org.springframework.boot.actuate.metrics.web.servlet.WebMvcMetricsFilter.doFilterInternal(WebMvcMetricsFilter.java:96) ~[spring-boot-actuator-2.7.12.jar:2.7.12]
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:117) ~[spring-web-5.3.27.jar:5.3.27]
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:178) ~[tomcat-embed-core-9.0.75.jar:9.0.75]
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:153) ~[tomcat-embed-core-9.0.75.jar:9.0.75]
	at org.springframework.web.filter.CharacterEncodingFilter.doFilterInternal(CharacterEncodingFilter.java:201) ~[spring-web-5.3.27.jar:5.3.27]
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:117) ~[spring-web-5.3.27.jar:5.3.27]
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:178) ~[tomcat-embed-core-9.0.75.jar:9.0.75]
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:153) ~[tomcat-embed-core-9.0.75.jar:9.0.75]
	at org.apache.catalina.core.StandardWrapperValve.invoke(StandardWrapperValve.java:167) ~[tomcat-embed-core-9.0.75.jar:9.0.75]
	at org.apache.catalina.core.StandardContextValve.invoke(StandardContextValve.java:90) ~[tomcat-embed-core-9.0.75.jar:9.0.75]
	at org.apache.catalina.authenticator.AuthenticatorBase.invoke(AuthenticatorBase.java:481) ~[tomcat-embed-core-9.0.75.jar:9.0.75]
	at org.apache.catalina.core.StandardHostValve.invoke(StandardHostValve.java:130) ~[tomcat-embed-core-9.0.75.jar:9.0.75]
	at org.apache.catalina.valves.ErrorReportValve.invoke(ErrorReportValve.java:93) ~[tomcat-embed-core-9.0.75.jar:9.0.75]
	at org.apache.catalina.core.StandardEngineValve.invoke(StandardEngineValve.java:74) ~[tomcat-embed-core-9.0.75.jar:9.0.75]
	at org.apache.catalina.connector.CoyoteAdapter.service(CoyoteAdapter.java:343) ~[tomcat-embed-core-9.0.75.jar:9.0.75]
	at org.apache.coyote.http11.Http11Processor.service(Http11Processor.java:390) ~[tomcat-embed-core-9.0.75.jar:9.0.75]
	at org.apache.coyote.AbstractProcessorLight.process(AbstractProcessorLight.java:63) ~[tomcat-embed-core-9.0.75.jar:9.0.75]
	at org.apache.coyote.AbstractProtocol$ConnectionHandler.process(AbstractProtocol.java:926) ~[tomcat-embed-core-9.0.75.jar:9.0.75]
	at org.apache.tomcat.util.net.NioEndpoint$SocketProcessor.doRun(NioEndpoint.java:1791) ~[tomcat-embed-core-9.0.75.jar:9.0.75]
	at org.apache.tomcat.util.net.SocketProcessorBase.run(SocketProcessorBase.java:52) ~[tomcat-embed-core-9.0.75.jar:9.0.75]
	at org.apache.tomcat.util.threads.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1191) ~[tomcat-embed-core-9.0.75.jar:9.0.75]
	at org.apache.tomcat.util.threads.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:659) ~[tomcat-embed-core-9.0.75.jar:9.0.75]
	at org.apache.tomcat.util.threads.TaskThread$WrappingRunnable.run(TaskThread.java:61) ~[tomcat-embed-core-9.0.75.jar:9.0.75]
	at java.base/java.lang.Thread.run(Thread.java:840) ~[na:na]

21:33:21:478 DEBUG 38752 --- [http-nio-8080-exec-3] c.l.h.m.D.selectById                     : ==>  Preparing: SELECT id,patient_id,doctor_id,disease_name,disease_category,aimodel_id,result,create_time,status,id_card,name,score,remark FROM diagnosis_report WHERE id=?
21:33:21:480 DEBUG 38752 --- [http-nio-8080-exec-3] c.l.h.m.D.selectById                     : ==> Parameters: 1(Integer)
21:33:21:512 DEBUG 38752 --- [http-nio-8080-exec-3] c.l.h.m.D.selectById                     : <==      Total: 1
21:33:21:512 DEBUG 38752 --- [http-nio-8080-exec-3] c.l.h.mapper.PatientMapper.selectById    : ==>  Preparing: SELECT id,phone,id_card,name,verified,verified_by,verified_time,open_id,hospital_pid FROM patient WHERE id=?
21:33:21:513 DEBUG 38752 --- [http-nio-8080-exec-3] c.l.h.mapper.PatientMapper.selectById    : ==> Parameters: 1(Integer)
21:33:21:544 DEBUG 38752 --- [http-nio-8080-exec-3] c.l.h.mapper.PatientMapper.selectById    : <==      Total: 1
21:33:21:545 DEBUG 38752 --- [http-nio-8080-exec-3] c.l.h.mapper.DoctorMapper.selectById     : ==>  Preparing: SELECT id,phone,id_card,name,verified,verified_by,verified_time,license,department,hospital_pid FROM doctor WHERE id=?
21:33:21:546 DEBUG 38752 --- [http-nio-8080-exec-3] c.l.h.mapper.DoctorMapper.selectById     : ==> Parameters: 1(Integer)
21:33:21:577 DEBUG 38752 --- [http-nio-8080-exec-3] c.l.h.mapper.DoctorMapper.selectById     : <==      Total: 1
21:33:21:578 DEBUG 38752 --- [http-nio-8080-exec-3] c.l.h.m.E.selectListByDiagnosisId        : ==>  Preparing: select * from eye_images where dignosis_report_id = ?
21:33:21:578 DEBUG 38752 --- [http-nio-8080-exec-3] c.l.h.m.E.selectListByDiagnosisId        : ==> Parameters: 1(Integer)
21:33:21:608 DEBUG 38752 --- [http-nio-8080-exec-3] c.l.h.m.E.selectListByDiagnosisId        : <==      Total: 1
21:33:21:609 DEBUG 38752 --- [http-nio-8080-exec-3] c.l.h.m.T.selectByDiagnosisId            : ==>  Preparing: select * from treatment_plans where diagnosis_id = ?
21:33:21:609 DEBUG 38752 --- [http-nio-8080-exec-3] c.l.h.m.T.selectByDiagnosisId            : ==> Parameters: 1(Integer)
21:33:21:639 DEBUG 38752 --- [http-nio-8080-exec-3] c.l.h.m.T.selectByDiagnosisId            : <==      Total: 1
21:33:21:640 DEBUG 38752 --- [http-nio-8080-exec-3] c.l.h.m.M.selectByDiagnosisId            : ==>  Preparing: select * from medication_recommendations where diagnosis_id = ?
21:33:21:640 DEBUG 38752 --- [http-nio-8080-exec-3] c.l.h.m.M.selectByDiagnosisId            : ==> Parameters: 1(Integer)
21:33:21:671 DEBUG 38752 --- [http-nio-8080-exec-3] c.l.h.m.M.selectByDiagnosisId            : <==      Total: 1
21:33:21:672 DEBUG 38752 --- [http-nio-8080-exec-3] c.l.h.mapper.AiModelMapper.selectById    : ==>  Preparing: SELECT id,version,deploy_time,accuracy FROM ai_model WHERE id=?
21:33:21:672 DEBUG 38752 --- [http-nio-8080-exec-3] c.l.h.mapper.AiModelMapper.selectById    : ==> Parameters: 1(Integer)
21:33:21:703 DEBUG 38752 --- [http-nio-8080-exec-3] c.l.h.mapper.AiModelMapper.selectById    : <==      Total: 1
21:33:21:705 DEBUG 38752 --- [http-nio-8080-exec-3] o.s.c.openfeign.support.SpringEncoder    : Writing [ChatForm(diagnosisName=, diagnosisCategory=, result=A, remark=A, treatmentPlan=TreatmentPlans(id=1, diagnosisId=1, treatmentType=1, treatmentDetail=, startTime=2025-03-01T09:00, endDate=2025-03-10T09:00, doctorId=1, createdTime=2025-03-01T09:00, updatedTime=2025-03-01T09:00), medications=[MedicationRecommendations(id=1, diagnosisId=1, medicationName=A, dosage=10mg, frequency=, sideEffects=, startTime=2025-03-01T09:00, endTime=2025-03-10T09:00, doctorId=1, createdTime=2025-03-01T09:00, updatedTime=2025-03-01T09:00)], previousConversations=[DialogueInfo(role=pariatur tempor do, content=sit cupidatat commodo)], question=irure eu esse, stream=false)] using [org.springframework.http.converter.json.MappingJackson2HttpMessageConverter@4a094f90]
21:33:21:707 DEBUG 38752 --- [http-nio-8080-exec-3] c.l.api.client.FlaskAiDoctorClient       : [FlaskAiDoctorClient#eye_doctor_chat] ---> POST http://ai-doctor-service/api/eye-doctor/chat HTTP/1.1
21:33:21:707 DEBUG 38752 --- [http-nio-8080-exec-3] c.l.api.client.FlaskAiDoctorClient       : [FlaskAiDoctorClient#eye_doctor_chat] Content-Length: 749
21:33:21:708 DEBUG 38752 --- [http-nio-8080-exec-3] c.l.api.client.FlaskAiDoctorClient       : [FlaskAiDoctorClient#eye_doctor_chat] Content-Type: application/json
21:33:21:708 DEBUG 38752 --- [http-nio-8080-exec-3] c.l.api.client.FlaskAiDoctorClient       : [FlaskAiDoctorClient#eye_doctor_chat] 
21:33:21:708 DEBUG 38752 --- [http-nio-8080-exec-3] c.l.api.client.FlaskAiDoctorClient       : [FlaskAiDoctorClient#eye_doctor_chat] {"disease_name":"","disease_category":"","result":"A","remark":"A","treatment_plan":{"id":1,"treatmentType":1,"treatmentDetail":"","startTime":"2025-03-01 09:00:00","endDate":"2025-03-10 09:00:00","doctorId":1,"createdTime":"2025-03-01T09:00:00","updatedTime":"2025-03-01T09:00:00"},"medications":[{"id":1,"diagnosisId":1,"medicationName":"A","dosage":"10mg","frequency":"","sideEffects":"","startTime":"2025-03-01T09:00:00","endTime":"2025-03-10T09:00:00","doctorId":1,"createdTime":"2025-03-01 09:00:00","updatedTime":"2025-03-01 09:00:00"}],"previous_conversations":[{"role":"pariatur tempor do","content":"sit cupidatat commodo"}],"question":"irure eu esse","stream":false}
21:33:21:708 DEBUG 38752 --- [http-nio-8080-exec-3] c.l.api.client.FlaskAiDoctorClient       : [FlaskAiDoctorClient#eye_doctor_chat] ---> END HTTP (749-byte body)
21:33:21:710  WARN 38752 --- [http-nio-8080-exec-3] o.s.c.l.core.RoundRobinLoadBalancer      : No servers available for service: ai-doctor-service
21:33:21:710  WARN 38752 --- [http-nio-8080-exec-3] .s.c.o.l.FeignBlockingLoadBalancerClient : Load balancer does not contain an instance for the service ai-doctor-service
21:33:21:711 DEBUG 38752 --- [http-nio-8080-exec-3] c.l.api.client.FlaskAiDoctorClient       : [FlaskAiDoctorClient#eye_doctor_chat] <--- HTTP/1.1 503 (2ms)
21:33:21:711 DEBUG 38752 --- [http-nio-8080-exec-3] c.l.api.client.FlaskAiDoctorClient       : [FlaskAiDoctorClient#eye_doctor_chat] 
21:33:21:711 DEBUG 38752 --- [http-nio-8080-exec-3] c.l.api.client.FlaskAiDoctorClient       : [FlaskAiDoctorClient#eye_doctor_chat] Load balancer does not contain an instance for the service ai-doctor-service
21:33:21:711 DEBUG 38752 --- [http-nio-8080-exec-3] c.l.api.client.FlaskAiDoctorClient       : [FlaskAiDoctorClient#eye_doctor_chat] <--- END HTTP (76-byte body)
21:33:21:712 ERROR 38752 --- [http-nio-8080-exec-3] o.a.c.c.C.[.[.[/].[dispatcherServlet]    : Servlet.service() for servlet [dispatcherServlet] in context with path [] threw exception [Request processing failed; nested exception is feign.FeignException$ServiceUnavailable: [503] during [POST] to [http://ai-doctor-service/api/eye-doctor/chat] [FlaskAiDoctorClient#eye_doctor_chat(ChatForm)]: [Load balancer does not contain an instance for the service ai-doctor-service]] with root cause

feign.FeignException$ServiceUnavailable: [503] during [POST] to [http://ai-doctor-service/api/eye-doctor/chat] [FlaskAiDoctorClient#eye_doctor_chat(ChatForm)]: [Load balancer does not contain an instance for the service ai-doctor-service]
	at feign.FeignException.serverErrorStatus(FeignException.java:256) ~[feign-core-11.10.jar:na]
	at feign.FeignException.errorStatus(FeignException.java:197) ~[feign-core-11.10.jar:na]
	at feign.FeignException.errorStatus(FeignException.java:185) ~[feign-core-11.10.jar:na]
	at feign.codec.ErrorDecoder$Default.decode(ErrorDecoder.java:92) ~[feign-core-11.10.jar:na]
	at feign.AsyncResponseHandler.handleResponse(AsyncResponseHandler.java:98) ~[feign-core-11.10.jar:na]
	at feign.SynchronousMethodHandler.executeAndDecode(SynchronousMethodHandler.java:141) ~[feign-core-11.10.jar:na]
	at feign.SynchronousMethodHandler.invoke(SynchronousMethodHandler.java:91) ~[feign-core-11.10.jar:na]
	at feign.ReflectiveFeign$FeignInvocationHandler.invoke(ReflectiveFeign.java:100) ~[feign-core-11.10.jar:na]
	at jdk.proxy2/jdk.proxy2.$Proxy138.eye_doctor_chat(Unknown Source) ~[na:na]
	at com.luojiawei.his_service.controller.ChatController.ask(ChatController.java:39) ~[classes/:na]
	at java.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke0(Native Method) ~[na:na]
	at java.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:77) ~[na:na]
	at java.base/jdk.internal.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43) ~[na:na]
	at java.base/java.lang.reflect.Method.invoke(Method.java:568) ~[na:na]
	at org.springframework.web.method.support.InvocableHandlerMethod.doInvoke(InvocableHandlerMethod.java:205) ~[spring-web-5.3.27.jar:5.3.27]
	at org.springframework.web.method.support.InvocableHandlerMethod.invokeForRequest(InvocableHandlerMethod.java:150) ~[spring-web-5.3.27.jar:5.3.27]
	at org.springframework.web.servlet.mvc.method.annotation.ServletInvocableHandlerMethod.invokeAndHandle(ServletInvocableHandlerMethod.java:117) ~[spring-webmvc-5.3.27.jar:5.3.27]
	at org.springframework.web.servlet.mvc.method.annotation.RequestMappingHandlerAdapter.invokeHandlerMethod(RequestMappingHandlerAdapter.java:895) ~[spring-webmvc-5.3.27.jar:5.3.27]
	at org.springframework.web.servlet.mvc.method.annotation.RequestMappingHandlerAdapter.handleInternal(RequestMappingHandlerAdapter.java:808) ~[spring-webmvc-5.3.27.jar:5.3.27]
	at org.springframework.web.servlet.mvc.method.AbstractHandlerMethodAdapter.handle(AbstractHandlerMethodAdapter.java:87) ~[spring-webmvc-5.3.27.jar:5.3.27]
	at org.springframework.web.servlet.DispatcherServlet.doDispatch(DispatcherServlet.java:1072) ~[spring-webmvc-5.3.27.jar:5.3.27]
	at org.springframework.web.servlet.DispatcherServlet.doService(DispatcherServlet.java:965) ~[spring-webmvc-5.3.27.jar:5.3.27]
	at org.springframework.web.servlet.FrameworkServlet.processRequest(FrameworkServlet.java:1006) ~[spring-webmvc-5.3.27.jar:5.3.27]
	at org.springframework.web.servlet.FrameworkServlet.doPost(FrameworkServlet.java:909) ~[spring-webmvc-5.3.27.jar:5.3.27]
	at javax.servlet.http.HttpServlet.service(HttpServlet.java:555) ~[tomcat-embed-core-9.0.75.jar:4.0.FR]
	at org.springframework.web.servlet.FrameworkServlet.service(FrameworkServlet.java:883) ~[spring-webmvc-5.3.27.jar:5.3.27]
	at javax.servlet.http.HttpServlet.service(HttpServlet.java:623) ~[tomcat-embed-core-9.0.75.jar:4.0.FR]
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:209) ~[tomcat-embed-core-9.0.75.jar:9.0.75]
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:153) ~[tomcat-embed-core-9.0.75.jar:9.0.75]
	at com.luojiawei.his_service.filter.RefreshTokenFilter.doFilterInternal(RefreshTokenFilter.java:58) ~[classes/:na]
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:117) ~[spring-web-5.3.27.jar:5.3.27]
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:178) ~[tomcat-embed-core-9.0.75.jar:9.0.75]
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:153) ~[tomcat-embed-core-9.0.75.jar:9.0.75]
	at org.springframework.web.filter.RequestContextFilter.doFilterInternal(RequestContextFilter.java:100) ~[spring-web-5.3.27.jar:5.3.27]
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:117) ~[spring-web-5.3.27.jar:5.3.27]
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:178) ~[tomcat-embed-core-9.0.75.jar:9.0.75]
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:153) ~[tomcat-embed-core-9.0.75.jar:9.0.75]
	at org.springframework.web.filter.FormContentFilter.doFilterInternal(FormContentFilter.java:93) ~[spring-web-5.3.27.jar:5.3.27]
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:117) ~[spring-web-5.3.27.jar:5.3.27]
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:178) ~[tomcat-embed-core-9.0.75.jar:9.0.75]
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:153) ~[tomcat-embed-core-9.0.75.jar:9.0.75]
	at org.springframework.boot.actuate.metrics.web.servlet.WebMvcMetricsFilter.doFilterInternal(WebMvcMetricsFilter.java:96) ~[spring-boot-actuator-2.7.12.jar:2.7.12]
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:117) ~[spring-web-5.3.27.jar:5.3.27]
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:178) ~[tomcat-embed-core-9.0.75.jar:9.0.75]
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:153) ~[tomcat-embed-core-9.0.75.jar:9.0.75]
	at org.springframework.web.filter.CharacterEncodingFilter.doFilterInternal(CharacterEncodingFilter.java:201) ~[spring-web-5.3.27.jar:5.3.27]
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:117) ~[spring-web-5.3.27.jar:5.3.27]
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:178) ~[tomcat-embed-core-9.0.75.jar:9.0.75]
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:153) ~[tomcat-embed-core-9.0.75.jar:9.0.75]
	at org.apache.catalina.core.StandardWrapperValve.invoke(StandardWrapperValve.java:167) ~[tomcat-embed-core-9.0.75.jar:9.0.75]
	at org.apache.catalina.core.StandardContextValve.invoke(StandardContextValve.java:90) ~[tomcat-embed-core-9.0.75.jar:9.0.75]
	at org.apache.catalina.authenticator.AuthenticatorBase.invoke(AuthenticatorBase.java:481) ~[tomcat-embed-core-9.0.75.jar:9.0.75]
	at org.apache.catalina.core.StandardHostValve.invoke(StandardHostValve.java:130) ~[tomcat-embed-core-9.0.75.jar:9.0.75]
	at org.apache.catalina.valves.ErrorReportValve.invoke(ErrorReportValve.java:93) ~[tomcat-embed-core-9.0.75.jar:9.0.75]
	at org.apache.catalina.core.StandardEngineValve.invoke(StandardEngineValve.java:74) ~[tomcat-embed-core-9.0.75.jar:9.0.75]
	at org.apache.catalina.connector.CoyoteAdapter.service(CoyoteAdapter.java:343) ~[tomcat-embed-core-9.0.75.jar:9.0.75]
	at org.apache.coyote.http11.Http11Processor.service(Http11Processor.java:390) ~[tomcat-embed-core-9.0.75.jar:9.0.75]
	at org.apache.coyote.AbstractProcessorLight.process(AbstractProcessorLight.java:63) ~[tomcat-embed-core-9.0.75.jar:9.0.75]
	at org.apache.coyote.AbstractProtocol$ConnectionHandler.process(AbstractProtocol.java:926) ~[tomcat-embed-core-9.0.75.jar:9.0.75]
	at org.apache.tomcat.util.net.NioEndpoint$SocketProcessor.doRun(NioEndpoint.java:1791) ~[tomcat-embed-core-9.0.75.jar:9.0.75]
	at org.apache.tomcat.util.net.SocketProcessorBase.run(SocketProcessorBase.java:52) ~[tomcat-embed-core-9.0.75.jar:9.0.75]
	at org.apache.tomcat.util.threads.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1191) ~[tomcat-embed-core-9.0.75.jar:9.0.75]
	at org.apache.tomcat.util.threads.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:659) ~[tomcat-embed-core-9.0.75.jar:9.0.75]
	at org.apache.tomcat.util.threads.TaskThread$WrappingRunnable.run(TaskThread.java:61) ~[tomcat-embed-core-9.0.75.jar:9.0.75]
	at java.base/java.lang.Thread.run(Thread.java:840) ~[na:na]

21:34:37:821 DEBUG 38752 --- [http-nio-8080-exec-6] c.l.h.m.D.selectById                     : ==>  Preparing: SELECT id,patient_id,doctor_id,disease_name,disease_category,aimodel_id,result,create_time,status,id_card,name,score,remark FROM diagnosis_report WHERE id=?
21:34:37:821 DEBUG 38752 --- [http-nio-8080-exec-6] c.l.h.m.D.selectById                     : ==> Parameters: 1(Integer)
21:34:37:851 DEBUG 38752 --- [http-nio-8080-exec-6] c.l.h.m.D.selectById                     : <==      Total: 1
21:34:37:853 DEBUG 38752 --- [http-nio-8080-exec-6] c.l.h.mapper.PatientMapper.selectById    : ==>  Preparing: SELECT id,phone,id_card,name,verified,verified_by,verified_time,open_id,hospital_pid FROM patient WHERE id=?
21:34:37:854 DEBUG 38752 --- [http-nio-8080-exec-6] c.l.h.mapper.PatientMapper.selectById    : ==> Parameters: 1(Integer)
21:34:37:887 DEBUG 38752 --- [http-nio-8080-exec-6] c.l.h.mapper.PatientMapper.selectById    : <==      Total: 1
21:34:37:889 DEBUG 38752 --- [http-nio-8080-exec-6] c.l.h.mapper.DoctorMapper.selectById     : ==>  Preparing: SELECT id,phone,id_card,name,verified,verified_by,verified_time,license,department,hospital_pid FROM doctor WHERE id=?
21:34:37:889 DEBUG 38752 --- [http-nio-8080-exec-6] c.l.h.mapper.DoctorMapper.selectById     : ==> Parameters: 1(Integer)
21:34:37:920 DEBUG 38752 --- [http-nio-8080-exec-6] c.l.h.mapper.DoctorMapper.selectById     : <==      Total: 1
21:34:37:921 DEBUG 38752 --- [http-nio-8080-exec-6] c.l.h.m.E.selectListByDiagnosisId        : ==>  Preparing: select * from eye_images where dignosis_report_id = ?
21:34:37:921 DEBUG 38752 --- [http-nio-8080-exec-6] c.l.h.m.E.selectListByDiagnosisId        : ==> Parameters: 1(Integer)
21:34:37:952 DEBUG 38752 --- [http-nio-8080-exec-6] c.l.h.m.E.selectListByDiagnosisId        : <==      Total: 1
21:34:37:952 DEBUG 38752 --- [http-nio-8080-exec-6] c.l.h.m.T.selectByDiagnosisId            : ==>  Preparing: select * from treatment_plans where diagnosis_id = ?
21:34:37:952 DEBUG 38752 --- [http-nio-8080-exec-6] c.l.h.m.T.selectByDiagnosisId            : ==> Parameters: 1(Integer)
21:34:37:983 DEBUG 38752 --- [http-nio-8080-exec-6] c.l.h.m.T.selectByDiagnosisId            : <==      Total: 1
21:34:37:983 DEBUG 38752 --- [http-nio-8080-exec-6] c.l.h.m.M.selectByDiagnosisId            : ==>  Preparing: select * from medication_recommendations where diagnosis_id = ?
21:34:37:984 DEBUG 38752 --- [http-nio-8080-exec-6] c.l.h.m.M.selectByDiagnosisId            : ==> Parameters: 1(Integer)
21:34:38:014 DEBUG 38752 --- [http-nio-8080-exec-6] c.l.h.m.M.selectByDiagnosisId            : <==      Total: 1
21:34:38:014 DEBUG 38752 --- [http-nio-8080-exec-6] c.l.h.mapper.AiModelMapper.selectById    : ==>  Preparing: SELECT id,version,deploy_time,accuracy FROM ai_model WHERE id=?
21:34:38:014 DEBUG 38752 --- [http-nio-8080-exec-6] c.l.h.mapper.AiModelMapper.selectById    : ==> Parameters: 1(Integer)
21:34:38:044 DEBUG 38752 --- [http-nio-8080-exec-6] c.l.h.mapper.AiModelMapper.selectById    : <==      Total: 1
21:34:38:045 DEBUG 38752 --- [http-nio-8080-exec-6] o.s.c.openfeign.support.SpringEncoder    : Writing [ChatForm(diagnosisName=, diagnosisCategory=, result=A, remark=A, treatmentPlan=TreatmentPlans(id=1, diagnosisId=1, treatmentType=1, treatmentDetail=, startTime=2025-03-01T09:00, endDate=2025-03-10T09:00, doctorId=1, createdTime=2025-03-01T09:00, updatedTime=2025-03-01T09:00), medications=[MedicationRecommendations(id=1, diagnosisId=1, medicationName=A, dosage=10mg, frequency=, sideEffects=, startTime=2025-03-01T09:00, endTime=2025-03-10T09:00, doctorId=1, createdTime=2025-03-01T09:00, updatedTime=2025-03-01T09:00)], previousConversations=[DialogueInfo(role=pariatur tempor do, content=sit cupidatat commodo)], question=irure eu esse, stream=false)] using [org.springframework.http.converter.json.MappingJackson2HttpMessageConverter@4a094f90]
21:34:38:046 DEBUG 38752 --- [http-nio-8080-exec-6] c.l.api.client.FlaskAiDoctorClient       : [FlaskAiDoctorClient#eye_doctor_chat] ---> POST http://ai-doctor-service/api/eye-doctor/chat HTTP/1.1
21:34:38:046 DEBUG 38752 --- [http-nio-8080-exec-6] c.l.api.client.FlaskAiDoctorClient       : [FlaskAiDoctorClient#eye_doctor_chat] Content-Length: 749
21:34:38:046 DEBUG 38752 --- [http-nio-8080-exec-6] c.l.api.client.FlaskAiDoctorClient       : [FlaskAiDoctorClient#eye_doctor_chat] Content-Type: application/json
21:34:38:046 DEBUG 38752 --- [http-nio-8080-exec-6] c.l.api.client.FlaskAiDoctorClient       : [FlaskAiDoctorClient#eye_doctor_chat] 
21:34:38:046 DEBUG 38752 --- [http-nio-8080-exec-6] c.l.api.client.FlaskAiDoctorClient       : [FlaskAiDoctorClient#eye_doctor_chat] {"disease_name":"","disease_category":"","result":"A","remark":"A","treatment_plan":{"id":1,"treatmentType":1,"treatmentDetail":"","startTime":"2025-03-01 09:00:00","endDate":"2025-03-10 09:00:00","doctorId":1,"createdTime":"2025-03-01T09:00:00","updatedTime":"2025-03-01T09:00:00"},"medications":[{"id":1,"diagnosisId":1,"medicationName":"A","dosage":"10mg","frequency":"","sideEffects":"","startTime":"2025-03-01T09:00:00","endTime":"2025-03-10T09:00:00","doctorId":1,"createdTime":"2025-03-01 09:00:00","updatedTime":"2025-03-01 09:00:00"}],"previous_conversations":[{"role":"pariatur tempor do","content":"sit cupidatat commodo"}],"question":"irure eu esse","stream":false}
21:34:38:046 DEBUG 38752 --- [http-nio-8080-exec-6] c.l.api.client.FlaskAiDoctorClient       : [FlaskAiDoctorClient#eye_doctor_chat] ---> END HTTP (749-byte body)
21:34:53:240 DEBUG 38752 --- [http-nio-8080-exec-6] c.l.api.client.FlaskAiDoctorClient       : [FlaskAiDoctorClient#eye_doctor_chat] <--- ERROR SocketTimeoutException: timeout (15193ms)
21:34:53:241 DEBUG 38752 --- [http-nio-8080-exec-6] c.l.api.client.FlaskAiDoctorClient       : [FlaskAiDoctorClient#eye_doctor_chat] java.net.SocketTimeoutException: timeout
	at okio.SocketAsyncTimeout.newTimeoutException(JvmOkio.kt:147)
	at okio.AsyncTimeout.access$newTimeoutException(AsyncTimeout.kt:158)
	at okio.AsyncTimeout$source$1.read(AsyncTimeout.kt:337)
	at okio.RealBufferedSource.indexOf(RealBufferedSource.kt:427)
	at okio.RealBufferedSource.readUtf8LineStrict(RealBufferedSource.kt:320)
	at okhttp3.internal.http1.HeadersReader.readLine(HeadersReader.kt:29)
	at okhttp3.internal.http1.Http1ExchangeCodec.readResponseHeaders(Http1ExchangeCodec.kt:178)
	at okhttp3.internal.connection.Exchange.readResponseHeaders(Exchange.kt:106)
	at okhttp3.internal.http.CallServerInterceptor.intercept(CallServerInterceptor.kt:79)
	at okhttp3.internal.http.RealInterceptorChain.proceed(RealInterceptorChain.kt:109)
	at okhttp3.internal.connection.ConnectInterceptor.intercept(ConnectInterceptor.kt:34)
	at okhttp3.internal.http.RealInterceptorChain.proceed(RealInterceptorChain.kt:109)
	at okhttp3.internal.cache.CacheInterceptor.intercept(CacheInterceptor.kt:95)
	at okhttp3.internal.http.RealInterceptorChain.proceed(RealInterceptorChain.kt:109)
	at okhttp3.internal.http.BridgeInterceptor.intercept(BridgeInterceptor.kt:83)
	at okhttp3.internal.http.RealInterceptorChain.proceed(RealInterceptorChain.kt:109)
	at okhttp3.internal.http.RetryAndFollowUpInterceptor.intercept(RetryAndFollowUpInterceptor.kt:76)
	at okhttp3.internal.http.RealInterceptorChain.proceed(RealInterceptorChain.kt:109)
	at okhttp3.internal.connection.RealCall.getResponseWithInterceptorChain$okhttp(RealCall.kt:201)
	at okhttp3.internal.connection.RealCall.execute(RealCall.kt:154)
	at feign.okhttp.OkHttpClient.execute(OkHttpClient.java:180)
	at org.springframework.cloud.openfeign.loadbalancer.LoadBalancerUtils.executeWithLoadBalancerLifecycleProcessing(LoadBalancerUtils.java:57)
	at org.springframework.cloud.openfeign.loadbalancer.LoadBalancerUtils.executeWithLoadBalancerLifecycleProcessing(LoadBalancerUtils.java:95)
	at org.springframework.cloud.openfeign.loadbalancer.FeignBlockingLoadBalancerClient.execute(FeignBlockingLoadBalancerClient.java:114)
	at feign.SynchronousMethodHandler.executeAndDecode(SynchronousMethodHandler.java:121)
	at feign.SynchronousMethodHandler.invoke(SynchronousMethodHandler.java:91)
	at feign.ReflectiveFeign$FeignInvocationHandler.invoke(ReflectiveFeign.java:100)
	at jdk.proxy2/jdk.proxy2.$Proxy138.eye_doctor_chat(Unknown Source)
	at com.luojiawei.his_service.controller.ChatController.ask(ChatController.java:39)
	at java.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at java.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:77)
	at java.base/jdk.internal.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.base/java.lang.reflect.Method.invoke(Method.java:568)
	at org.springframework.web.method.support.InvocableHandlerMethod.doInvoke(InvocableHandlerMethod.java:205)
	at org.springframework.web.method.support.InvocableHandlerMethod.invokeForRequest(InvocableHandlerMethod.java:150)
	at org.springframework.web.servlet.mvc.method.annotation.ServletInvocableHandlerMethod.invokeAndHandle(ServletInvocableHandlerMethod.java:117)
	at org.springframework.web.servlet.mvc.method.annotation.RequestMappingHandlerAdapter.invokeHandlerMethod(RequestMappingHandlerAdapter.java:895)
	at org.springframework.web.servlet.mvc.method.annotation.RequestMappingHandlerAdapter.handleInternal(RequestMappingHandlerAdapter.java:808)
	at org.springframework.web.servlet.mvc.method.AbstractHandlerMethodAdapter.handle(AbstractHandlerMethodAdapter.java:87)
	at org.springframework.web.servlet.DispatcherServlet.doDispatch(DispatcherServlet.java:1072)
	at org.springframework.web.servlet.DispatcherServlet.doService(DispatcherServlet.java:965)
	at org.springframework.web.servlet.FrameworkServlet.processRequest(FrameworkServlet.java:1006)
	at org.springframework.web.servlet.FrameworkServlet.doPost(FrameworkServlet.java:909)
	at javax.servlet.http.HttpServlet.service(HttpServlet.java:555)
	at org.springframework.web.servlet.FrameworkServlet.service(FrameworkServlet.java:883)
	at javax.servlet.http.HttpServlet.service(HttpServlet.java:623)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:209)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:153)
	at com.luojiawei.his_service.filter.RefreshTokenFilter.doFilterInternal(RefreshTokenFilter.java:58)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:117)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:178)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:153)
	at org.springframework.web.filter.RequestContextFilter.doFilterInternal(RequestContextFilter.java:100)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:117)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:178)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:153)
	at org.springframework.web.filter.FormContentFilter.doFilterInternal(FormContentFilter.java:93)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:117)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:178)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:153)
	at org.springframework.boot.actuate.metrics.web.servlet.WebMvcMetricsFilter.doFilterInternal(WebMvcMetricsFilter.java:96)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:117)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:178)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:153)
	at org.springframework.web.filter.CharacterEncodingFilter.doFilterInternal(CharacterEncodingFilter.java:201)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:117)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:178)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:153)
	at org.apache.catalina.core.StandardWrapperValve.invoke(StandardWrapperValve.java:167)
	at org.apache.catalina.core.StandardContextValve.invoke(StandardContextValve.java:90)
	at org.apache.catalina.authenticator.AuthenticatorBase.invoke(AuthenticatorBase.java:481)
	at org.apache.catalina.core.StandardHostValve.invoke(StandardHostValve.java:130)
	at org.apache.catalina.valves.ErrorReportValve.invoke(ErrorReportValve.java:93)
	at org.apache.catalina.core.StandardEngineValve.invoke(StandardEngineValve.java:74)
	at org.apache.catalina.connector.CoyoteAdapter.service(CoyoteAdapter.java:343)
	at org.apache.coyote.http11.Http11Processor.service(Http11Processor.java:390)
	at org.apache.coyote.AbstractProcessorLight.process(AbstractProcessorLight.java:63)
	at org.apache.coyote.AbstractProtocol$ConnectionHandler.process(AbstractProtocol.java:926)
	at org.apache.tomcat.util.net.NioEndpoint$SocketProcessor.doRun(NioEndpoint.java:1791)
	at org.apache.tomcat.util.net.SocketProcessorBase.run(SocketProcessorBase.java:52)
	at org.apache.tomcat.util.threads.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1191)
	at org.apache.tomcat.util.threads.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:659)
	at org.apache.tomcat.util.threads.TaskThread$WrappingRunnable.run(TaskThread.java:61)
	at java.base/java.lang.Thread.run(Thread.java:840)
Caused by: java.net.SocketException: Socket closed
	at java.base/sun.nio.ch.NioSocketImpl.endRead(NioSocketImpl.java:253)
	at java.base/sun.nio.ch.NioSocketImpl.implRead(NioSocketImpl.java:332)
	at java.base/sun.nio.ch.NioSocketImpl.read(NioSocketImpl.java:355)
	at java.base/sun.nio.ch.NioSocketImpl$1.read(NioSocketImpl.java:808)
	at java.base/java.net.Socket$SocketInputStream.read(Socket.java:966)
	at okio.InputStreamSource.read(JvmOkio.kt:94)
	at okio.AsyncTimeout$source$1.read(AsyncTimeout.kt:125)
	... 81 more

21:34:53:242 DEBUG 38752 --- [http-nio-8080-exec-6] c.l.api.client.FlaskAiDoctorClient       : [FlaskAiDoctorClient#eye_doctor_chat] <--- END ERROR
21:34:53:244 ERROR 38752 --- [http-nio-8080-exec-6] o.a.c.c.C.[.[.[/].[dispatcherServlet]    : Servlet.service() for servlet [dispatcherServlet] in context with path [] threw exception [Request processing failed; nested exception is feign.RetryableException: timeout executing POST http://ai-doctor-service/api/eye-doctor/chat] with root cause

java.net.SocketException: Socket closed
	at java.base/sun.nio.ch.NioSocketImpl.endRead(NioSocketImpl.java:253) ~[na:na]
	at java.base/sun.nio.ch.NioSocketImpl.implRead(NioSocketImpl.java:332) ~[na:na]
	at java.base/sun.nio.ch.NioSocketImpl.read(NioSocketImpl.java:355) ~[na:na]
	at java.base/sun.nio.ch.NioSocketImpl$1.read(NioSocketImpl.java:808) ~[na:na]
	at java.base/java.net.Socket$SocketInputStream.read(Socket.java:966) ~[na:na]
	at okio.InputStreamSource.read(JvmOkio.kt:94) ~[okio-jvm-3.2.0.jar:na]
	at okio.AsyncTimeout$source$1.read(AsyncTimeout.kt:125) ~[okio-jvm-3.2.0.jar:na]
	at okio.RealBufferedSource.indexOf(RealBufferedSource.kt:427) ~[okio-jvm-3.2.0.jar:na]
	at okio.RealBufferedSource.readUtf8LineStrict(RealBufferedSource.kt:320) ~[okio-jvm-3.2.0.jar:na]
	at okhttp3.internal.http1.HeadersReader.readLine(HeadersReader.kt:29) ~[okhttp-4.9.3.jar:na]
	at okhttp3.internal.http1.Http1ExchangeCodec.readResponseHeaders(Http1ExchangeCodec.kt:178) ~[okhttp-4.9.3.jar:na]
	at okhttp3.internal.connection.Exchange.readResponseHeaders(Exchange.kt:106) ~[okhttp-4.9.3.jar:na]
	at okhttp3.internal.http.CallServerInterceptor.intercept(CallServerInterceptor.kt:79) ~[okhttp-4.9.3.jar:na]
	at okhttp3.internal.http.RealInterceptorChain.proceed(RealInterceptorChain.kt:109) ~[okhttp-4.9.3.jar:na]
	at okhttp3.internal.connection.ConnectInterceptor.intercept(ConnectInterceptor.kt:34) ~[okhttp-4.9.3.jar:na]
	at okhttp3.internal.http.RealInterceptorChain.proceed(RealInterceptorChain.kt:109) ~[okhttp-4.9.3.jar:na]
	at okhttp3.internal.cache.CacheInterceptor.intercept(CacheInterceptor.kt:95) ~[okhttp-4.9.3.jar:na]
	at okhttp3.internal.http.RealInterceptorChain.proceed(RealInterceptorChain.kt:109) ~[okhttp-4.9.3.jar:na]
	at okhttp3.internal.http.BridgeInterceptor.intercept(BridgeInterceptor.kt:83) ~[okhttp-4.9.3.jar:na]
	at okhttp3.internal.http.RealInterceptorChain.proceed(RealInterceptorChain.kt:109) ~[okhttp-4.9.3.jar:na]
	at okhttp3.internal.http.RetryAndFollowUpInterceptor.intercept(RetryAndFollowUpInterceptor.kt:76) ~[okhttp-4.9.3.jar:na]
	at okhttp3.internal.http.RealInterceptorChain.proceed(RealInterceptorChain.kt:109) ~[okhttp-4.9.3.jar:na]
	at okhttp3.internal.connection.RealCall.getResponseWithInterceptorChain$okhttp(RealCall.kt:201) ~[okhttp-4.9.3.jar:na]
	at okhttp3.internal.connection.RealCall.execute(RealCall.kt:154) ~[okhttp-4.9.3.jar:na]
	at feign.okhttp.OkHttpClient.execute(OkHttpClient.java:180) ~[feign-okhttp-11.10.jar:na]
	at org.springframework.cloud.openfeign.loadbalancer.LoadBalancerUtils.executeWithLoadBalancerLifecycleProcessing(LoadBalancerUtils.java:57) ~[spring-cloud-openfeign-core-3.1.5.jar:3.1.5]
	at org.springframework.cloud.openfeign.loadbalancer.LoadBalancerUtils.executeWithLoadBalancerLifecycleProcessing(LoadBalancerUtils.java:95) ~[spring-cloud-openfeign-core-3.1.5.jar:3.1.5]
	at org.springframework.cloud.openfeign.loadbalancer.FeignBlockingLoadBalancerClient.execute(FeignBlockingLoadBalancerClient.java:114) ~[spring-cloud-openfeign-core-3.1.5.jar:3.1.5]
	at feign.SynchronousMethodHandler.executeAndDecode(SynchronousMethodHandler.java:121) ~[feign-core-11.10.jar:na]
	at feign.SynchronousMethodHandler.invoke(SynchronousMethodHandler.java:91) ~[feign-core-11.10.jar:na]
	at feign.ReflectiveFeign$FeignInvocationHandler.invoke(ReflectiveFeign.java:100) ~[feign-core-11.10.jar:na]
	at jdk.proxy2/jdk.proxy2.$Proxy138.eye_doctor_chat(Unknown Source) ~[na:na]
	at com.luojiawei.his_service.controller.ChatController.ask(ChatController.java:39) ~[classes/:na]
	at java.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke0(Native Method) ~[na:na]
	at java.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:77) ~[na:na]
	at java.base/jdk.internal.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43) ~[na:na]
	at java.base/java.lang.reflect.Method.invoke(Method.java:568) ~[na:na]
	at org.springframework.web.method.support.InvocableHandlerMethod.doInvoke(InvocableHandlerMethod.java:205) ~[spring-web-5.3.27.jar:5.3.27]
	at org.springframework.web.method.support.InvocableHandlerMethod.invokeForRequest(InvocableHandlerMethod.java:150) ~[spring-web-5.3.27.jar:5.3.27]
	at org.springframework.web.servlet.mvc.method.annotation.ServletInvocableHandlerMethod.invokeAndHandle(ServletInvocableHandlerMethod.java:117) ~[spring-webmvc-5.3.27.jar:5.3.27]
	at org.springframework.web.servlet.mvc.method.annotation.RequestMappingHandlerAdapter.invokeHandlerMethod(RequestMappingHandlerAdapter.java:895) ~[spring-webmvc-5.3.27.jar:5.3.27]
	at org.springframework.web.servlet.mvc.method.annotation.RequestMappingHandlerAdapter.handleInternal(RequestMappingHandlerAdapter.java:808) ~[spring-webmvc-5.3.27.jar:5.3.27]
	at org.springframework.web.servlet.mvc.method.AbstractHandlerMethodAdapter.handle(AbstractHandlerMethodAdapter.java:87) ~[spring-webmvc-5.3.27.jar:5.3.27]
	at org.springframework.web.servlet.DispatcherServlet.doDispatch(DispatcherServlet.java:1072) ~[spring-webmvc-5.3.27.jar:5.3.27]
	at org.springframework.web.servlet.DispatcherServlet.doService(DispatcherServlet.java:965) ~[spring-webmvc-5.3.27.jar:5.3.27]
	at org.springframework.web.servlet.FrameworkServlet.processRequest(FrameworkServlet.java:1006) ~[spring-webmvc-5.3.27.jar:5.3.27]
	at org.springframework.web.servlet.FrameworkServlet.doPost(FrameworkServlet.java:909) ~[spring-webmvc-5.3.27.jar:5.3.27]
	at javax.servlet.http.HttpServlet.service(HttpServlet.java:555) ~[tomcat-embed-core-9.0.75.jar:4.0.FR]
	at org.springframework.web.servlet.FrameworkServlet.service(FrameworkServlet.java:883) ~[spring-webmvc-5.3.27.jar:5.3.27]
	at javax.servlet.http.HttpServlet.service(HttpServlet.java:623) ~[tomcat-embed-core-9.0.75.jar:4.0.FR]
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:209) ~[tomcat-embed-core-9.0.75.jar:9.0.75]
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:153) ~[tomcat-embed-core-9.0.75.jar:9.0.75]
	at com.luojiawei.his_service.filter.RefreshTokenFilter.doFilterInternal(RefreshTokenFilter.java:58) ~[classes/:na]
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:117) ~[spring-web-5.3.27.jar:5.3.27]
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:178) ~[tomcat-embed-core-9.0.75.jar:9.0.75]
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:153) ~[tomcat-embed-core-9.0.75.jar:9.0.75]
	at org.springframework.web.filter.RequestContextFilter.doFilterInternal(RequestContextFilter.java:100) ~[spring-web-5.3.27.jar:5.3.27]
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:117) ~[spring-web-5.3.27.jar:5.3.27]
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:178) ~[tomcat-embed-core-9.0.75.jar:9.0.75]
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:153) ~[tomcat-embed-core-9.0.75.jar:9.0.75]
	at org.springframework.web.filter.FormContentFilter.doFilterInternal(FormContentFilter.java:93) ~[spring-web-5.3.27.jar:5.3.27]
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:117) ~[spring-web-5.3.27.jar:5.3.27]
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:178) ~[tomcat-embed-core-9.0.75.jar:9.0.75]
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:153) ~[tomcat-embed-core-9.0.75.jar:9.0.75]
	at org.springframework.boot.actuate.metrics.web.servlet.WebMvcMetricsFilter.doFilterInternal(WebMvcMetricsFilter.java:96) ~[spring-boot-actuator-2.7.12.jar:2.7.12]
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:117) ~[spring-web-5.3.27.jar:5.3.27]
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:178) ~[tomcat-embed-core-9.0.75.jar:9.0.75]
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:153) ~[tomcat-embed-core-9.0.75.jar:9.0.75]
	at org.springframework.web.filter.CharacterEncodingFilter.doFilterInternal(CharacterEncodingFilter.java:201) ~[spring-web-5.3.27.jar:5.3.27]
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:117) ~[spring-web-5.3.27.jar:5.3.27]
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:178) ~[tomcat-embed-core-9.0.75.jar:9.0.75]
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:153) ~[tomcat-embed-core-9.0.75.jar:9.0.75]
	at org.apache.catalina.core.StandardWrapperValve.invoke(StandardWrapperValve.java:167) ~[tomcat-embed-core-9.0.75.jar:9.0.75]
	at org.apache.catalina.core.StandardContextValve.invoke(StandardContextValve.java:90) ~[tomcat-embed-core-9.0.75.jar:9.0.75]
	at org.apache.catalina.authenticator.AuthenticatorBase.invoke(AuthenticatorBase.java:481) ~[tomcat-embed-core-9.0.75.jar:9.0.75]
	at org.apache.catalina.core.StandardHostValve.invoke(StandardHostValve.java:130) ~[tomcat-embed-core-9.0.75.jar:9.0.75]
	at org.apache.catalina.valves.ErrorReportValve.invoke(ErrorReportValve.java:93) ~[tomcat-embed-core-9.0.75.jar:9.0.75]
	at org.apache.catalina.core.StandardEngineValve.invoke(StandardEngineValve.java:74) ~[tomcat-embed-core-9.0.75.jar:9.0.75]
	at org.apache.catalina.connector.CoyoteAdapter.service(CoyoteAdapter.java:343) ~[tomcat-embed-core-9.0.75.jar:9.0.75]
	at org.apache.coyote.http11.Http11Processor.service(Http11Processor.java:390) ~[tomcat-embed-core-9.0.75.jar:9.0.75]
	at org.apache.coyote.AbstractProcessorLight.process(AbstractProcessorLight.java:63) ~[tomcat-embed-core-9.0.75.jar:9.0.75]
	at org.apache.coyote.AbstractProtocol$ConnectionHandler.process(AbstractProtocol.java:926) ~[tomcat-embed-core-9.0.75.jar:9.0.75]
	at org.apache.tomcat.util.net.NioEndpoint$SocketProcessor.doRun(NioEndpoint.java:1791) ~[tomcat-embed-core-9.0.75.jar:9.0.75]
	at org.apache.tomcat.util.net.SocketProcessorBase.run(SocketProcessorBase.java:52) ~[tomcat-embed-core-9.0.75.jar:9.0.75]
	at org.apache.tomcat.util.threads.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1191) ~[tomcat-embed-core-9.0.75.jar:9.0.75]
	at org.apache.tomcat.util.threads.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:659) ~[tomcat-embed-core-9.0.75.jar:9.0.75]
	at org.apache.tomcat.util.threads.TaskThread$WrappingRunnable.run(TaskThread.java:61) ~[tomcat-embed-core-9.0.75.jar:9.0.75]
	at java.base/java.lang.Thread.run(Thread.java:840) ~[na:na]

21:35:03:147 DEBUG 38752 --- [http-nio-8080-exec-7] c.l.h.m.D.selectById                     : ==>  Preparing: SELECT id,patient_id,doctor_id,disease_name,disease_category,aimodel_id,result,create_time,status,id_card,name,score,remark FROM diagnosis_report WHERE id=?
21:35:03:147 DEBUG 38752 --- [http-nio-8080-exec-7] c.l.h.m.D.selectById                     : ==> Parameters: 1(Integer)
21:35:03:177 DEBUG 38752 --- [http-nio-8080-exec-7] c.l.h.m.D.selectById                     : <==      Total: 1
21:35:03:178 DEBUG 38752 --- [http-nio-8080-exec-7] c.l.h.mapper.PatientMapper.selectById    : ==>  Preparing: SELECT id,phone,id_card,name,verified,verified_by,verified_time,open_id,hospital_pid FROM patient WHERE id=?
21:35:03:178 DEBUG 38752 --- [http-nio-8080-exec-7] c.l.h.mapper.PatientMapper.selectById    : ==> Parameters: 1(Integer)
21:35:03:208 DEBUG 38752 --- [http-nio-8080-exec-7] c.l.h.mapper.PatientMapper.selectById    : <==      Total: 1
21:35:03:209 DEBUG 38752 --- [http-nio-8080-exec-7] c.l.h.mapper.DoctorMapper.selectById     : ==>  Preparing: SELECT id,phone,id_card,name,verified,verified_by,verified_time,license,department,hospital_pid FROM doctor WHERE id=?
21:35:03:209 DEBUG 38752 --- [http-nio-8080-exec-7] c.l.h.mapper.DoctorMapper.selectById     : ==> Parameters: 1(Integer)
21:35:03:240 DEBUG 38752 --- [http-nio-8080-exec-7] c.l.h.mapper.DoctorMapper.selectById     : <==      Total: 1
21:35:03:240 DEBUG 38752 --- [http-nio-8080-exec-7] c.l.h.m.E.selectListByDiagnosisId        : ==>  Preparing: select * from eye_images where dignosis_report_id = ?
21:35:03:240 DEBUG 38752 --- [http-nio-8080-exec-7] c.l.h.m.E.selectListByDiagnosisId        : ==> Parameters: 1(Integer)
21:35:03:270 DEBUG 38752 --- [http-nio-8080-exec-7] c.l.h.m.E.selectListByDiagnosisId        : <==      Total: 1
21:35:03:271 DEBUG 38752 --- [http-nio-8080-exec-7] c.l.h.m.T.selectByDiagnosisId            : ==>  Preparing: select * from treatment_plans where diagnosis_id = ?
21:35:03:272 DEBUG 38752 --- [http-nio-8080-exec-7] c.l.h.m.T.selectByDiagnosisId            : ==> Parameters: 1(Integer)
21:35:03:302 DEBUG 38752 --- [http-nio-8080-exec-7] c.l.h.m.T.selectByDiagnosisId            : <==      Total: 1
21:35:03:302 DEBUG 38752 --- [http-nio-8080-exec-7] c.l.h.m.M.selectByDiagnosisId            : ==>  Preparing: select * from medication_recommendations where diagnosis_id = ?
21:35:03:302 DEBUG 38752 --- [http-nio-8080-exec-7] c.l.h.m.M.selectByDiagnosisId            : ==> Parameters: 1(Integer)
21:35:03:333 DEBUG 38752 --- [http-nio-8080-exec-7] c.l.h.m.M.selectByDiagnosisId            : <==      Total: 1
21:35:03:333 DEBUG 38752 --- [http-nio-8080-exec-7] c.l.h.mapper.AiModelMapper.selectById    : ==>  Preparing: SELECT id,version,deploy_time,accuracy FROM ai_model WHERE id=?
21:35:03:333 DEBUG 38752 --- [http-nio-8080-exec-7] c.l.h.mapper.AiModelMapper.selectById    : ==> Parameters: 1(Integer)
21:35:03:363 DEBUG 38752 --- [http-nio-8080-exec-7] c.l.h.mapper.AiModelMapper.selectById    : <==      Total: 1
21:35:03:363 DEBUG 38752 --- [http-nio-8080-exec-7] o.s.c.openfeign.support.SpringEncoder    : Writing [ChatForm(diagnosisName=, diagnosisCategory=, result=A, remark=A, treatmentPlan=TreatmentPlans(id=1, diagnosisId=1, treatmentType=1, treatmentDetail=, startTime=2025-03-01T09:00, endDate=2025-03-10T09:00, doctorId=1, createdTime=2025-03-01T09:00, updatedTime=2025-03-01T09:00), medications=[MedicationRecommendations(id=1, diagnosisId=1, medicationName=A, dosage=10mg, frequency=, sideEffects=, startTime=2025-03-01T09:00, endTime=2025-03-10T09:00, doctorId=1, createdTime=2025-03-01T09:00, updatedTime=2025-03-01T09:00)], previousConversations=[DialogueInfo(role=pariatur tempor do, content=sit cupidatat commodo)], question=irure eu esse, stream=false)] using [org.springframework.http.converter.json.MappingJackson2HttpMessageConverter@4a094f90]
21:35:03:364 DEBUG 38752 --- [http-nio-8080-exec-7] c.l.api.client.FlaskAiDoctorClient       : [FlaskAiDoctorClient#eye_doctor_chat] ---> POST http://ai-doctor-service/api/eye-doctor/chat HTTP/1.1
21:35:03:364 DEBUG 38752 --- [http-nio-8080-exec-7] c.l.api.client.FlaskAiDoctorClient       : [FlaskAiDoctorClient#eye_doctor_chat] Content-Length: 749
21:35:03:364 DEBUG 38752 --- [http-nio-8080-exec-7] c.l.api.client.FlaskAiDoctorClient       : [FlaskAiDoctorClient#eye_doctor_chat] Content-Type: application/json
21:35:03:364 DEBUG 38752 --- [http-nio-8080-exec-7] c.l.api.client.FlaskAiDoctorClient       : [FlaskAiDoctorClient#eye_doctor_chat] 
21:35:03:364 DEBUG 38752 --- [http-nio-8080-exec-7] c.l.api.client.FlaskAiDoctorClient       : [FlaskAiDoctorClient#eye_doctor_chat] {"disease_name":"","disease_category":"","result":"A","remark":"A","treatment_plan":{"id":1,"treatmentType":1,"treatmentDetail":"","startTime":"2025-03-01 09:00:00","endDate":"2025-03-10 09:00:00","doctorId":1,"createdTime":"2025-03-01T09:00:00","updatedTime":"2025-03-01T09:00:00"},"medications":[{"id":1,"diagnosisId":1,"medicationName":"A","dosage":"10mg","frequency":"","sideEffects":"","startTime":"2025-03-01T09:00:00","endTime":"2025-03-10T09:00:00","doctorId":1,"createdTime":"2025-03-01 09:00:00","updatedTime":"2025-03-01 09:00:00"}],"previous_conversations":[{"role":"pariatur tempor do","content":"sit cupidatat commodo"}],"question":"irure eu esse","stream":false}
21:35:03:364 DEBUG 38752 --- [http-nio-8080-exec-7] c.l.api.client.FlaskAiDoctorClient       : [FlaskAiDoctorClient#eye_doctor_chat] ---> END HTTP (749-byte body)
21:35:18:370 DEBUG 38752 --- [http-nio-8080-exec-7] c.l.api.client.FlaskAiDoctorClient       : [FlaskAiDoctorClient#eye_doctor_chat] <--- ERROR SocketTimeoutException: timeout (15005ms)
21:35:18:371 DEBUG 38752 --- [http-nio-8080-exec-7] c.l.api.client.FlaskAiDoctorClient       : [FlaskAiDoctorClient#eye_doctor_chat] java.net.SocketTimeoutException: timeout
	at okio.SocketAsyncTimeout.newTimeoutException(JvmOkio.kt:147)
	at okio.AsyncTimeout.access$newTimeoutException(AsyncTimeout.kt:158)
	at okio.AsyncTimeout$source$1.read(AsyncTimeout.kt:337)
	at okio.RealBufferedSource.indexOf(RealBufferedSource.kt:427)
	at okio.RealBufferedSource.readUtf8LineStrict(RealBufferedSource.kt:320)
	at okhttp3.internal.http1.HeadersReader.readLine(HeadersReader.kt:29)
	at okhttp3.internal.http1.Http1ExchangeCodec.readResponseHeaders(Http1ExchangeCodec.kt:178)
	at okhttp3.internal.connection.Exchange.readResponseHeaders(Exchange.kt:106)
	at okhttp3.internal.http.CallServerInterceptor.intercept(CallServerInterceptor.kt:79)
	at okhttp3.internal.http.RealInterceptorChain.proceed(RealInterceptorChain.kt:109)
	at okhttp3.internal.connection.ConnectInterceptor.intercept(ConnectInterceptor.kt:34)
	at okhttp3.internal.http.RealInterceptorChain.proceed(RealInterceptorChain.kt:109)
	at okhttp3.internal.cache.CacheInterceptor.intercept(CacheInterceptor.kt:95)
	at okhttp3.internal.http.RealInterceptorChain.proceed(RealInterceptorChain.kt:109)
	at okhttp3.internal.http.BridgeInterceptor.intercept(BridgeInterceptor.kt:83)
	at okhttp3.internal.http.RealInterceptorChain.proceed(RealInterceptorChain.kt:109)
	at okhttp3.internal.http.RetryAndFollowUpInterceptor.intercept(RetryAndFollowUpInterceptor.kt:76)
	at okhttp3.internal.http.RealInterceptorChain.proceed(RealInterceptorChain.kt:109)
	at okhttp3.internal.connection.RealCall.getResponseWithInterceptorChain$okhttp(RealCall.kt:201)
	at okhttp3.internal.connection.RealCall.execute(RealCall.kt:154)
	at feign.okhttp.OkHttpClient.execute(OkHttpClient.java:180)
	at org.springframework.cloud.openfeign.loadbalancer.LoadBalancerUtils.executeWithLoadBalancerLifecycleProcessing(LoadBalancerUtils.java:57)
	at org.springframework.cloud.openfeign.loadbalancer.LoadBalancerUtils.executeWithLoadBalancerLifecycleProcessing(LoadBalancerUtils.java:95)
	at org.springframework.cloud.openfeign.loadbalancer.FeignBlockingLoadBalancerClient.execute(FeignBlockingLoadBalancerClient.java:114)
	at feign.SynchronousMethodHandler.executeAndDecode(SynchronousMethodHandler.java:121)
	at feign.SynchronousMethodHandler.invoke(SynchronousMethodHandler.java:91)
	at feign.ReflectiveFeign$FeignInvocationHandler.invoke(ReflectiveFeign.java:100)
	at jdk.proxy2/jdk.proxy2.$Proxy138.eye_doctor_chat(Unknown Source)
	at com.luojiawei.his_service.controller.ChatController.ask(ChatController.java:39)
	at java.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at java.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:77)
	at java.base/jdk.internal.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.base/java.lang.reflect.Method.invoke(Method.java:568)
	at org.springframework.web.method.support.InvocableHandlerMethod.doInvoke(InvocableHandlerMethod.java:205)
	at org.springframework.web.method.support.InvocableHandlerMethod.invokeForRequest(InvocableHandlerMethod.java:150)
	at org.springframework.web.servlet.mvc.method.annotation.ServletInvocableHandlerMethod.invokeAndHandle(ServletInvocableHandlerMethod.java:117)
	at org.springframework.web.servlet.mvc.method.annotation.RequestMappingHandlerAdapter.invokeHandlerMethod(RequestMappingHandlerAdapter.java:895)
	at org.springframework.web.servlet.mvc.method.annotation.RequestMappingHandlerAdapter.handleInternal(RequestMappingHandlerAdapter.java:808)
	at org.springframework.web.servlet.mvc.method.AbstractHandlerMethodAdapter.handle(AbstractHandlerMethodAdapter.java:87)
	at org.springframework.web.servlet.DispatcherServlet.doDispatch(DispatcherServlet.java:1072)
	at org.springframework.web.servlet.DispatcherServlet.doService(DispatcherServlet.java:965)
	at org.springframework.web.servlet.FrameworkServlet.processRequest(FrameworkServlet.java:1006)
	at org.springframework.web.servlet.FrameworkServlet.doPost(FrameworkServlet.java:909)
	at javax.servlet.http.HttpServlet.service(HttpServlet.java:555)
	at org.springframework.web.servlet.FrameworkServlet.service(FrameworkServlet.java:883)
	at javax.servlet.http.HttpServlet.service(HttpServlet.java:623)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:209)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:153)
	at com.luojiawei.his_service.filter.RefreshTokenFilter.doFilterInternal(RefreshTokenFilter.java:58)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:117)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:178)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:153)
	at org.springframework.web.filter.RequestContextFilter.doFilterInternal(RequestContextFilter.java:100)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:117)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:178)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:153)
	at org.springframework.web.filter.FormContentFilter.doFilterInternal(FormContentFilter.java:93)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:117)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:178)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:153)
	at org.springframework.boot.actuate.metrics.web.servlet.WebMvcMetricsFilter.doFilterInternal(WebMvcMetricsFilter.java:96)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:117)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:178)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:153)
	at org.springframework.web.filter.CharacterEncodingFilter.doFilterInternal(CharacterEncodingFilter.java:201)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:117)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:178)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:153)
	at org.apache.catalina.core.StandardWrapperValve.invoke(StandardWrapperValve.java:167)
	at org.apache.catalina.core.StandardContextValve.invoke(StandardContextValve.java:90)
	at org.apache.catalina.authenticator.AuthenticatorBase.invoke(AuthenticatorBase.java:481)
	at org.apache.catalina.core.StandardHostValve.invoke(StandardHostValve.java:130)
	at org.apache.catalina.valves.ErrorReportValve.invoke(ErrorReportValve.java:93)
	at org.apache.catalina.core.StandardEngineValve.invoke(StandardEngineValve.java:74)
	at org.apache.catalina.connector.CoyoteAdapter.service(CoyoteAdapter.java:343)
	at org.apache.coyote.http11.Http11Processor.service(Http11Processor.java:390)
	at org.apache.coyote.AbstractProcessorLight.process(AbstractProcessorLight.java:63)
	at org.apache.coyote.AbstractProtocol$ConnectionHandler.process(AbstractProtocol.java:926)
	at org.apache.tomcat.util.net.NioEndpoint$SocketProcessor.doRun(NioEndpoint.java:1791)
	at org.apache.tomcat.util.net.SocketProcessorBase.run(SocketProcessorBase.java:52)
	at org.apache.tomcat.util.threads.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1191)
	at org.apache.tomcat.util.threads.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:659)
	at org.apache.tomcat.util.threads.TaskThread$WrappingRunnable.run(TaskThread.java:61)
	at java.base/java.lang.Thread.run(Thread.java:840)
Caused by: java.net.SocketException: Socket closed
	at java.base/sun.nio.ch.NioSocketImpl.endRead(NioSocketImpl.java:253)
	at java.base/sun.nio.ch.NioSocketImpl.implRead(NioSocketImpl.java:332)
	at java.base/sun.nio.ch.NioSocketImpl.read(NioSocketImpl.java:355)
	at java.base/sun.nio.ch.NioSocketImpl$1.read(NioSocketImpl.java:808)
	at java.base/java.net.Socket$SocketInputStream.read(Socket.java:966)
	at okio.InputStreamSource.read(JvmOkio.kt:94)
	at okio.AsyncTimeout$source$1.read(AsyncTimeout.kt:125)
	... 81 more

21:35:18:371 DEBUG 38752 --- [http-nio-8080-exec-7] c.l.api.client.FlaskAiDoctorClient       : [FlaskAiDoctorClient#eye_doctor_chat] <--- END ERROR
21:35:18:373 ERROR 38752 --- [http-nio-8080-exec-7] o.a.c.c.C.[.[.[/].[dispatcherServlet]    : Servlet.service() for servlet [dispatcherServlet] in context with path [] threw exception [Request processing failed; nested exception is feign.RetryableException: timeout executing POST http://ai-doctor-service/api/eye-doctor/chat] with root cause

java.net.SocketException: Socket closed
	at java.base/sun.nio.ch.NioSocketImpl.endRead(NioSocketImpl.java:253) ~[na:na]
	at java.base/sun.nio.ch.NioSocketImpl.implRead(NioSocketImpl.java:332) ~[na:na]
	at java.base/sun.nio.ch.NioSocketImpl.read(NioSocketImpl.java:355) ~[na:na]
	at java.base/sun.nio.ch.NioSocketImpl$1.read(NioSocketImpl.java:808) ~[na:na]
	at java.base/java.net.Socket$SocketInputStream.read(Socket.java:966) ~[na:na]
	at okio.InputStreamSource.read(JvmOkio.kt:94) ~[okio-jvm-3.2.0.jar:na]
	at okio.AsyncTimeout$source$1.read(AsyncTimeout.kt:125) ~[okio-jvm-3.2.0.jar:na]
	at okio.RealBufferedSource.indexOf(RealBufferedSource.kt:427) ~[okio-jvm-3.2.0.jar:na]
	at okio.RealBufferedSource.readUtf8LineStrict(RealBufferedSource.kt:320) ~[okio-jvm-3.2.0.jar:na]
	at okhttp3.internal.http1.HeadersReader.readLine(HeadersReader.kt:29) ~[okhttp-4.9.3.jar:na]
	at okhttp3.internal.http1.Http1ExchangeCodec.readResponseHeaders(Http1ExchangeCodec.kt:178) ~[okhttp-4.9.3.jar:na]
	at okhttp3.internal.connection.Exchange.readResponseHeaders(Exchange.kt:106) ~[okhttp-4.9.3.jar:na]
	at okhttp3.internal.http.CallServerInterceptor.intercept(CallServerInterceptor.kt:79) ~[okhttp-4.9.3.jar:na]
	at okhttp3.internal.http.RealInterceptorChain.proceed(RealInterceptorChain.kt:109) ~[okhttp-4.9.3.jar:na]
	at okhttp3.internal.connection.ConnectInterceptor.intercept(ConnectInterceptor.kt:34) ~[okhttp-4.9.3.jar:na]
	at okhttp3.internal.http.RealInterceptorChain.proceed(RealInterceptorChain.kt:109) ~[okhttp-4.9.3.jar:na]
	at okhttp3.internal.cache.CacheInterceptor.intercept(CacheInterceptor.kt:95) ~[okhttp-4.9.3.jar:na]
	at okhttp3.internal.http.RealInterceptorChain.proceed(RealInterceptorChain.kt:109) ~[okhttp-4.9.3.jar:na]
	at okhttp3.internal.http.BridgeInterceptor.intercept(BridgeInterceptor.kt:83) ~[okhttp-4.9.3.jar:na]
	at okhttp3.internal.http.RealInterceptorChain.proceed(RealInterceptorChain.kt:109) ~[okhttp-4.9.3.jar:na]
	at okhttp3.internal.http.RetryAndFollowUpInterceptor.intercept(RetryAndFollowUpInterceptor.kt:76) ~[okhttp-4.9.3.jar:na]
	at okhttp3.internal.http.RealInterceptorChain.proceed(RealInterceptorChain.kt:109) ~[okhttp-4.9.3.jar:na]
	at okhttp3.internal.connection.RealCall.getResponseWithInterceptorChain$okhttp(RealCall.kt:201) ~[okhttp-4.9.3.jar:na]
	at okhttp3.internal.connection.RealCall.execute(RealCall.kt:154) ~[okhttp-4.9.3.jar:na]
	at feign.okhttp.OkHttpClient.execute(OkHttpClient.java:180) ~[feign-okhttp-11.10.jar:na]
	at org.springframework.cloud.openfeign.loadbalancer.LoadBalancerUtils.executeWithLoadBalancerLifecycleProcessing(LoadBalancerUtils.java:57) ~[spring-cloud-openfeign-core-3.1.5.jar:3.1.5]
	at org.springframework.cloud.openfeign.loadbalancer.LoadBalancerUtils.executeWithLoadBalancerLifecycleProcessing(LoadBalancerUtils.java:95) ~[spring-cloud-openfeign-core-3.1.5.jar:3.1.5]
	at org.springframework.cloud.openfeign.loadbalancer.FeignBlockingLoadBalancerClient.execute(FeignBlockingLoadBalancerClient.java:114) ~[spring-cloud-openfeign-core-3.1.5.jar:3.1.5]
	at feign.SynchronousMethodHandler.executeAndDecode(SynchronousMethodHandler.java:121) ~[feign-core-11.10.jar:na]
	at feign.SynchronousMethodHandler.invoke(SynchronousMethodHandler.java:91) ~[feign-core-11.10.jar:na]
	at feign.ReflectiveFeign$FeignInvocationHandler.invoke(ReflectiveFeign.java:100) ~[feign-core-11.10.jar:na]
	at jdk.proxy2/jdk.proxy2.$Proxy138.eye_doctor_chat(Unknown Source) ~[na:na]
	at com.luojiawei.his_service.controller.ChatController.ask(ChatController.java:39) ~[classes/:na]
	at java.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke0(Native Method) ~[na:na]
	at java.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:77) ~[na:na]
	at java.base/jdk.internal.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43) ~[na:na]
	at java.base/java.lang.reflect.Method.invoke(Method.java:568) ~[na:na]
	at org.springframework.web.method.support.InvocableHandlerMethod.doInvoke(InvocableHandlerMethod.java:205) ~[spring-web-5.3.27.jar:5.3.27]
	at org.springframework.web.method.support.InvocableHandlerMethod.invokeForRequest(InvocableHandlerMethod.java:150) ~[spring-web-5.3.27.jar:5.3.27]
	at org.springframework.web.servlet.mvc.method.annotation.ServletInvocableHandlerMethod.invokeAndHandle(ServletInvocableHandlerMethod.java:117) ~[spring-webmvc-5.3.27.jar:5.3.27]
	at org.springframework.web.servlet.mvc.method.annotation.RequestMappingHandlerAdapter.invokeHandlerMethod(RequestMappingHandlerAdapter.java:895) ~[spring-webmvc-5.3.27.jar:5.3.27]
	at org.springframework.web.servlet.mvc.method.annotation.RequestMappingHandlerAdapter.handleInternal(RequestMappingHandlerAdapter.java:808) ~[spring-webmvc-5.3.27.jar:5.3.27]
	at org.springframework.web.servlet.mvc.method.AbstractHandlerMethodAdapter.handle(AbstractHandlerMethodAdapter.java:87) ~[spring-webmvc-5.3.27.jar:5.3.27]
	at org.springframework.web.servlet.DispatcherServlet.doDispatch(DispatcherServlet.java:1072) ~[spring-webmvc-5.3.27.jar:5.3.27]
	at org.springframework.web.servlet.DispatcherServlet.doService(DispatcherServlet.java:965) ~[spring-webmvc-5.3.27.jar:5.3.27]
	at org.springframework.web.servlet.FrameworkServlet.processRequest(FrameworkServlet.java:1006) ~[spring-webmvc-5.3.27.jar:5.3.27]
	at org.springframework.web.servlet.FrameworkServlet.doPost(FrameworkServlet.java:909) ~[spring-webmvc-5.3.27.jar:5.3.27]
	at javax.servlet.http.HttpServlet.service(HttpServlet.java:555) ~[tomcat-embed-core-9.0.75.jar:4.0.FR]
	at org.springframework.web.servlet.FrameworkServlet.service(FrameworkServlet.java:883) ~[spring-webmvc-5.3.27.jar:5.3.27]
	at javax.servlet.http.HttpServlet.service(HttpServlet.java:623) ~[tomcat-embed-core-9.0.75.jar:4.0.FR]
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:209) ~[tomcat-embed-core-9.0.75.jar:9.0.75]
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:153) ~[tomcat-embed-core-9.0.75.jar:9.0.75]
	at com.luojiawei.his_service.filter.RefreshTokenFilter.doFilterInternal(RefreshTokenFilter.java:58) ~[classes/:na]
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:117) ~[spring-web-5.3.27.jar:5.3.27]
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:178) ~[tomcat-embed-core-9.0.75.jar:9.0.75]
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:153) ~[tomcat-embed-core-9.0.75.jar:9.0.75]
	at org.springframework.web.filter.RequestContextFilter.doFilterInternal(RequestContextFilter.java:100) ~[spring-web-5.3.27.jar:5.3.27]
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:117) ~[spring-web-5.3.27.jar:5.3.27]
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:178) ~[tomcat-embed-core-9.0.75.jar:9.0.75]
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:153) ~[tomcat-embed-core-9.0.75.jar:9.0.75]
	at org.springframework.web.filter.FormContentFilter.doFilterInternal(FormContentFilter.java:93) ~[spring-web-5.3.27.jar:5.3.27]
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:117) ~[spring-web-5.3.27.jar:5.3.27]
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:178) ~[tomcat-embed-core-9.0.75.jar:9.0.75]
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:153) ~[tomcat-embed-core-9.0.75.jar:9.0.75]
	at org.springframework.boot.actuate.metrics.web.servlet.WebMvcMetricsFilter.doFilterInternal(WebMvcMetricsFilter.java:96) ~[spring-boot-actuator-2.7.12.jar:2.7.12]
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:117) ~[spring-web-5.3.27.jar:5.3.27]
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:178) ~[tomcat-embed-core-9.0.75.jar:9.0.75]
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:153) ~[tomcat-embed-core-9.0.75.jar:9.0.75]
	at org.springframework.web.filter.CharacterEncodingFilter.doFilterInternal(CharacterEncodingFilter.java:201) ~[spring-web-5.3.27.jar:5.3.27]
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:117) ~[spring-web-5.3.27.jar:5.3.27]
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:178) ~[tomcat-embed-core-9.0.75.jar:9.0.75]
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:153) ~[tomcat-embed-core-9.0.75.jar:9.0.75]
	at org.apache.catalina.core.StandardWrapperValve.invoke(StandardWrapperValve.java:167) ~[tomcat-embed-core-9.0.75.jar:9.0.75]
	at org.apache.catalina.core.StandardContextValve.invoke(StandardContextValve.java:90) ~[tomcat-embed-core-9.0.75.jar:9.0.75]
	at org.apache.catalina.authenticator.AuthenticatorBase.invoke(AuthenticatorBase.java:481) ~[tomcat-embed-core-9.0.75.jar:9.0.75]
	at org.apache.catalina.core.StandardHostValve.invoke(StandardHostValve.java:130) ~[tomcat-embed-core-9.0.75.jar:9.0.75]
	at org.apache.catalina.valves.ErrorReportValve.invoke(ErrorReportValve.java:93) ~[tomcat-embed-core-9.0.75.jar:9.0.75]
	at org.apache.catalina.core.StandardEngineValve.invoke(StandardEngineValve.java:74) ~[tomcat-embed-core-9.0.75.jar:9.0.75]
	at org.apache.catalina.connector.CoyoteAdapter.service(CoyoteAdapter.java:343) ~[tomcat-embed-core-9.0.75.jar:9.0.75]
	at org.apache.coyote.http11.Http11Processor.service(Http11Processor.java:390) ~[tomcat-embed-core-9.0.75.jar:9.0.75]
	at org.apache.coyote.AbstractProcessorLight.process(AbstractProcessorLight.java:63) ~[tomcat-embed-core-9.0.75.jar:9.0.75]
	at org.apache.coyote.AbstractProtocol$ConnectionHandler.process(AbstractProtocol.java:926) ~[tomcat-embed-core-9.0.75.jar:9.0.75]
	at org.apache.tomcat.util.net.NioEndpoint$SocketProcessor.doRun(NioEndpoint.java:1791) ~[tomcat-embed-core-9.0.75.jar:9.0.75]
	at org.apache.tomcat.util.net.SocketProcessorBase.run(SocketProcessorBase.java:52) ~[tomcat-embed-core-9.0.75.jar:9.0.75]
	at org.apache.tomcat.util.threads.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1191) ~[tomcat-embed-core-9.0.75.jar:9.0.75]
	at org.apache.tomcat.util.threads.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:659) ~[tomcat-embed-core-9.0.75.jar:9.0.75]
	at org.apache.tomcat.util.threads.TaskThread$WrappingRunnable.run(TaskThread.java:61) ~[tomcat-embed-core-9.0.75.jar:9.0.75]
	at java.base/java.lang.Thread.run(Thread.java:840) ~[na:na]

21:35:36:110 DEBUG 38752 --- [http-nio-8080-exec-8] c.l.h.m.D.selectById                     : ==>  Preparing: SELECT id,patient_id,doctor_id,disease_name,disease_category,aimodel_id,result,create_time,status,id_card,name,score,remark FROM diagnosis_report WHERE id=?
21:35:36:111 DEBUG 38752 --- [http-nio-8080-exec-8] c.l.h.m.D.selectById                     : ==> Parameters: 1(Integer)
21:35:36:141 DEBUG 38752 --- [http-nio-8080-exec-8] c.l.h.m.D.selectById                     : <==      Total: 1
21:35:36:142 DEBUG 38752 --- [http-nio-8080-exec-8] c.l.h.mapper.PatientMapper.selectById    : ==>  Preparing: SELECT id,phone,id_card,name,verified,verified_by,verified_time,open_id,hospital_pid FROM patient WHERE id=?
21:35:36:142 DEBUG 38752 --- [http-nio-8080-exec-8] c.l.h.mapper.PatientMapper.selectById    : ==> Parameters: 1(Integer)
21:35:36:173 DEBUG 38752 --- [http-nio-8080-exec-8] c.l.h.mapper.PatientMapper.selectById    : <==      Total: 1
21:35:36:173 DEBUG 38752 --- [http-nio-8080-exec-8] c.l.h.mapper.DoctorMapper.selectById     : ==>  Preparing: SELECT id,phone,id_card,name,verified,verified_by,verified_time,license,department,hospital_pid FROM doctor WHERE id=?
21:35:36:174 DEBUG 38752 --- [http-nio-8080-exec-8] c.l.h.mapper.DoctorMapper.selectById     : ==> Parameters: 1(Integer)
21:35:36:204 DEBUG 38752 --- [http-nio-8080-exec-8] c.l.h.mapper.DoctorMapper.selectById     : <==      Total: 1
21:35:36:204 DEBUG 38752 --- [http-nio-8080-exec-8] c.l.h.m.E.selectListByDiagnosisId        : ==>  Preparing: select * from eye_images where dignosis_report_id = ?
21:35:36:205 DEBUG 38752 --- [http-nio-8080-exec-8] c.l.h.m.E.selectListByDiagnosisId        : ==> Parameters: 1(Integer)
21:35:36:234 DEBUG 38752 --- [http-nio-8080-exec-8] c.l.h.m.E.selectListByDiagnosisId        : <==      Total: 1
21:35:36:235 DEBUG 38752 --- [http-nio-8080-exec-8] c.l.h.m.T.selectByDiagnosisId            : ==>  Preparing: select * from treatment_plans where diagnosis_id = ?
21:35:36:235 DEBUG 38752 --- [http-nio-8080-exec-8] c.l.h.m.T.selectByDiagnosisId            : ==> Parameters: 1(Integer)
21:35:36:265 DEBUG 38752 --- [http-nio-8080-exec-8] c.l.h.m.T.selectByDiagnosisId            : <==      Total: 1
21:35:36:265 DEBUG 38752 --- [http-nio-8080-exec-8] c.l.h.m.M.selectByDiagnosisId            : ==>  Preparing: select * from medication_recommendations where diagnosis_id = ?
21:35:36:265 DEBUG 38752 --- [http-nio-8080-exec-8] c.l.h.m.M.selectByDiagnosisId            : ==> Parameters: 1(Integer)
21:35:36:295 DEBUG 38752 --- [http-nio-8080-exec-8] c.l.h.m.M.selectByDiagnosisId            : <==      Total: 1
21:35:36:295 DEBUG 38752 --- [http-nio-8080-exec-8] c.l.h.mapper.AiModelMapper.selectById    : ==>  Preparing: SELECT id,version,deploy_time,accuracy FROM ai_model WHERE id=?
21:35:36:296 DEBUG 38752 --- [http-nio-8080-exec-8] c.l.h.mapper.AiModelMapper.selectById    : ==> Parameters: 1(Integer)
21:35:36:326 DEBUG 38752 --- [http-nio-8080-exec-8] c.l.h.mapper.AiModelMapper.selectById    : <==      Total: 1
21:35:36:327 DEBUG 38752 --- [http-nio-8080-exec-8] o.s.c.openfeign.support.SpringEncoder    : Writing [ChatForm(diagnosisName=, diagnosisCategory=, result=A, remark=A, treatmentPlan=TreatmentPlans(id=1, diagnosisId=1, treatmentType=1, treatmentDetail=, startTime=2025-03-01T09:00, endDate=2025-03-10T09:00, doctorId=1, createdTime=2025-03-01T09:00, updatedTime=2025-03-01T09:00), medications=[MedicationRecommendations(id=1, diagnosisId=1, medicationName=A, dosage=10mg, frequency=, sideEffects=, startTime=2025-03-01T09:00, endTime=2025-03-10T09:00, doctorId=1, createdTime=2025-03-01T09:00, updatedTime=2025-03-01T09:00)], previousConversations=[DialogueInfo(role=pariatur tempor do, content=sit cupidatat commodo)], question=irure eu esse, stream=false)] using [org.springframework.http.converter.json.MappingJackson2HttpMessageConverter@4a094f90]
21:35:36:328 DEBUG 38752 --- [http-nio-8080-exec-8] c.l.api.client.FlaskAiDoctorClient       : [FlaskAiDoctorClient#eye_doctor_chat] ---> POST http://ai-doctor-service/api/eye-doctor/chat HTTP/1.1
21:35:36:328 DEBUG 38752 --- [http-nio-8080-exec-8] c.l.api.client.FlaskAiDoctorClient       : [FlaskAiDoctorClient#eye_doctor_chat] Content-Length: 749
21:35:36:328 DEBUG 38752 --- [http-nio-8080-exec-8] c.l.api.client.FlaskAiDoctorClient       : [FlaskAiDoctorClient#eye_doctor_chat] Content-Type: application/json
21:35:36:328 DEBUG 38752 --- [http-nio-8080-exec-8] c.l.api.client.FlaskAiDoctorClient       : [FlaskAiDoctorClient#eye_doctor_chat] 
21:35:36:328 DEBUG 38752 --- [http-nio-8080-exec-8] c.l.api.client.FlaskAiDoctorClient       : [FlaskAiDoctorClient#eye_doctor_chat] {"disease_name":"","disease_category":"","result":"A","remark":"A","treatment_plan":{"id":1,"treatmentType":1,"treatmentDetail":"","startTime":"2025-03-01 09:00:00","endDate":"2025-03-10 09:00:00","doctorId":1,"createdTime":"2025-03-01T09:00:00","updatedTime":"2025-03-01T09:00:00"},"medications":[{"id":1,"diagnosisId":1,"medicationName":"A","dosage":"10mg","frequency":"","sideEffects":"","startTime":"2025-03-01T09:00:00","endTime":"2025-03-10T09:00:00","doctorId":1,"createdTime":"2025-03-01 09:00:00","updatedTime":"2025-03-01 09:00:00"}],"previous_conversations":[{"role":"pariatur tempor do","content":"sit cupidatat commodo"}],"question":"irure eu esse","stream":false}
21:35:36:329 DEBUG 38752 --- [http-nio-8080-exec-8] c.l.api.client.FlaskAiDoctorClient       : [FlaskAiDoctorClient#eye_doctor_chat] ---> END HTTP (749-byte body)
21:35:51:345 DEBUG 38752 --- [http-nio-8080-exec-8] c.l.api.client.FlaskAiDoctorClient       : [FlaskAiDoctorClient#eye_doctor_chat] <--- ERROR SocketTimeoutException: timeout (15015ms)
21:35:51:346 DEBUG 38752 --- [http-nio-8080-exec-8] c.l.api.client.FlaskAiDoctorClient       : [FlaskAiDoctorClient#eye_doctor_chat] java.net.SocketTimeoutException: timeout
	at okio.SocketAsyncTimeout.newTimeoutException(JvmOkio.kt:147)
	at okio.AsyncTimeout.access$newTimeoutException(AsyncTimeout.kt:158)
	at okio.AsyncTimeout$source$1.read(AsyncTimeout.kt:337)
	at okio.RealBufferedSource.indexOf(RealBufferedSource.kt:427)
	at okio.RealBufferedSource.readUtf8LineStrict(RealBufferedSource.kt:320)
	at okhttp3.internal.http1.HeadersReader.readLine(HeadersReader.kt:29)
	at okhttp3.internal.http1.Http1ExchangeCodec.readResponseHeaders(Http1ExchangeCodec.kt:178)
	at okhttp3.internal.connection.Exchange.readResponseHeaders(Exchange.kt:106)
	at okhttp3.internal.http.CallServerInterceptor.intercept(CallServerInterceptor.kt:79)
	at okhttp3.internal.http.RealInterceptorChain.proceed(RealInterceptorChain.kt:109)
	at okhttp3.internal.connection.ConnectInterceptor.intercept(ConnectInterceptor.kt:34)
	at okhttp3.internal.http.RealInterceptorChain.proceed(RealInterceptorChain.kt:109)
	at okhttp3.internal.cache.CacheInterceptor.intercept(CacheInterceptor.kt:95)
	at okhttp3.internal.http.RealInterceptorChain.proceed(RealInterceptorChain.kt:109)
	at okhttp3.internal.http.BridgeInterceptor.intercept(BridgeInterceptor.kt:83)
	at okhttp3.internal.http.RealInterceptorChain.proceed(RealInterceptorChain.kt:109)
	at okhttp3.internal.http.RetryAndFollowUpInterceptor.intercept(RetryAndFollowUpInterceptor.kt:76)
	at okhttp3.internal.http.RealInterceptorChain.proceed(RealInterceptorChain.kt:109)
	at okhttp3.internal.connection.RealCall.getResponseWithInterceptorChain$okhttp(RealCall.kt:201)
	at okhttp3.internal.connection.RealCall.execute(RealCall.kt:154)
	at feign.okhttp.OkHttpClient.execute(OkHttpClient.java:180)
	at org.springframework.cloud.openfeign.loadbalancer.LoadBalancerUtils.executeWithLoadBalancerLifecycleProcessing(LoadBalancerUtils.java:57)
	at org.springframework.cloud.openfeign.loadbalancer.LoadBalancerUtils.executeWithLoadBalancerLifecycleProcessing(LoadBalancerUtils.java:95)
	at org.springframework.cloud.openfeign.loadbalancer.FeignBlockingLoadBalancerClient.execute(FeignBlockingLoadBalancerClient.java:114)
	at feign.SynchronousMethodHandler.executeAndDecode(SynchronousMethodHandler.java:121)
	at feign.SynchronousMethodHandler.invoke(SynchronousMethodHandler.java:91)
	at feign.ReflectiveFeign$FeignInvocationHandler.invoke(ReflectiveFeign.java:100)
	at jdk.proxy2/jdk.proxy2.$Proxy138.eye_doctor_chat(Unknown Source)
	at com.luojiawei.his_service.controller.ChatController.ask(ChatController.java:39)
	at java.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at java.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:77)
	at java.base/jdk.internal.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.base/java.lang.reflect.Method.invoke(Method.java:568)
	at org.springframework.web.method.support.InvocableHandlerMethod.doInvoke(InvocableHandlerMethod.java:205)
	at org.springframework.web.method.support.InvocableHandlerMethod.invokeForRequest(InvocableHandlerMethod.java:150)
	at org.springframework.web.servlet.mvc.method.annotation.ServletInvocableHandlerMethod.invokeAndHandle(ServletInvocableHandlerMethod.java:117)
	at org.springframework.web.servlet.mvc.method.annotation.RequestMappingHandlerAdapter.invokeHandlerMethod(RequestMappingHandlerAdapter.java:895)
	at org.springframework.web.servlet.mvc.method.annotation.RequestMappingHandlerAdapter.handleInternal(RequestMappingHandlerAdapter.java:808)
	at org.springframework.web.servlet.mvc.method.AbstractHandlerMethodAdapter.handle(AbstractHandlerMethodAdapter.java:87)
	at org.springframework.web.servlet.DispatcherServlet.doDispatch(DispatcherServlet.java:1072)
	at org.springframework.web.servlet.DispatcherServlet.doService(DispatcherServlet.java:965)
	at org.springframework.web.servlet.FrameworkServlet.processRequest(FrameworkServlet.java:1006)
	at org.springframework.web.servlet.FrameworkServlet.doPost(FrameworkServlet.java:909)
	at javax.servlet.http.HttpServlet.service(HttpServlet.java:555)
	at org.springframework.web.servlet.FrameworkServlet.service(FrameworkServlet.java:883)
	at javax.servlet.http.HttpServlet.service(HttpServlet.java:623)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:209)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:153)
	at com.luojiawei.his_service.filter.RefreshTokenFilter.doFilterInternal(RefreshTokenFilter.java:58)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:117)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:178)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:153)
	at org.springframework.web.filter.RequestContextFilter.doFilterInternal(RequestContextFilter.java:100)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:117)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:178)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:153)
	at org.springframework.web.filter.FormContentFilter.doFilterInternal(FormContentFilter.java:93)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:117)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:178)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:153)
	at org.springframework.boot.actuate.metrics.web.servlet.WebMvcMetricsFilter.doFilterInternal(WebMvcMetricsFilter.java:96)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:117)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:178)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:153)
	at org.springframework.web.filter.CharacterEncodingFilter.doFilterInternal(CharacterEncodingFilter.java:201)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:117)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:178)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:153)
	at org.apache.catalina.core.StandardWrapperValve.invoke(StandardWrapperValve.java:167)
	at org.apache.catalina.core.StandardContextValve.invoke(StandardContextValve.java:90)
	at org.apache.catalina.authenticator.AuthenticatorBase.invoke(AuthenticatorBase.java:481)
	at org.apache.catalina.core.StandardHostValve.invoke(StandardHostValve.java:130)
	at org.apache.catalina.valves.ErrorReportValve.invoke(ErrorReportValve.java:93)
	at org.apache.catalina.core.StandardEngineValve.invoke(StandardEngineValve.java:74)
	at org.apache.catalina.connector.CoyoteAdapter.service(CoyoteAdapter.java:343)
	at org.apache.coyote.http11.Http11Processor.service(Http11Processor.java:390)
	at org.apache.coyote.AbstractProcessorLight.process(AbstractProcessorLight.java:63)
	at org.apache.coyote.AbstractProtocol$ConnectionHandler.process(AbstractProtocol.java:926)
	at org.apache.tomcat.util.net.NioEndpoint$SocketProcessor.doRun(NioEndpoint.java:1791)
	at org.apache.tomcat.util.net.SocketProcessorBase.run(SocketProcessorBase.java:52)
	at org.apache.tomcat.util.threads.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1191)
	at org.apache.tomcat.util.threads.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:659)
	at org.apache.tomcat.util.threads.TaskThread$WrappingRunnable.run(TaskThread.java:61)
	at java.base/java.lang.Thread.run(Thread.java:840)
Caused by: java.net.SocketException: Socket closed
	at java.base/sun.nio.ch.NioSocketImpl.endRead(NioSocketImpl.java:253)
	at java.base/sun.nio.ch.NioSocketImpl.implRead(NioSocketImpl.java:332)
	at java.base/sun.nio.ch.NioSocketImpl.read(NioSocketImpl.java:355)
	at java.base/sun.nio.ch.NioSocketImpl$1.read(NioSocketImpl.java:808)
	at java.base/java.net.Socket$SocketInputStream.read(Socket.java:966)
	at okio.InputStreamSource.read(JvmOkio.kt:94)
	at okio.AsyncTimeout$source$1.read(AsyncTimeout.kt:125)
	... 81 more

21:35:51:346 DEBUG 38752 --- [http-nio-8080-exec-8] c.l.api.client.FlaskAiDoctorClient       : [FlaskAiDoctorClient#eye_doctor_chat] <--- END ERROR
21:35:51:348 ERROR 38752 --- [http-nio-8080-exec-8] o.a.c.c.C.[.[.[/].[dispatcherServlet]    : Servlet.service() for servlet [dispatcherServlet] in context with path [] threw exception [Request processing failed; nested exception is feign.RetryableException: timeout executing POST http://ai-doctor-service/api/eye-doctor/chat] with root cause

java.net.SocketException: Socket closed
	at java.base/sun.nio.ch.NioSocketImpl.endRead(NioSocketImpl.java:253) ~[na:na]
	at java.base/sun.nio.ch.NioSocketImpl.implRead(NioSocketImpl.java:332) ~[na:na]
	at java.base/sun.nio.ch.NioSocketImpl.read(NioSocketImpl.java:355) ~[na:na]
	at java.base/sun.nio.ch.NioSocketImpl$1.read(NioSocketImpl.java:808) ~[na:na]
	at java.base/java.net.Socket$SocketInputStream.read(Socket.java:966) ~[na:na]
	at okio.InputStreamSource.read(JvmOkio.kt:94) ~[okio-jvm-3.2.0.jar:na]
	at okio.AsyncTimeout$source$1.read(AsyncTimeout.kt:125) ~[okio-jvm-3.2.0.jar:na]
	at okio.RealBufferedSource.indexOf(RealBufferedSource.kt:427) ~[okio-jvm-3.2.0.jar:na]
	at okio.RealBufferedSource.readUtf8LineStrict(RealBufferedSource.kt:320) ~[okio-jvm-3.2.0.jar:na]
	at okhttp3.internal.http1.HeadersReader.readLine(HeadersReader.kt:29) ~[okhttp-4.9.3.jar:na]
	at okhttp3.internal.http1.Http1ExchangeCodec.readResponseHeaders(Http1ExchangeCodec.kt:178) ~[okhttp-4.9.3.jar:na]
	at okhttp3.internal.connection.Exchange.readResponseHeaders(Exchange.kt:106) ~[okhttp-4.9.3.jar:na]
	at okhttp3.internal.http.CallServerInterceptor.intercept(CallServerInterceptor.kt:79) ~[okhttp-4.9.3.jar:na]
	at okhttp3.internal.http.RealInterceptorChain.proceed(RealInterceptorChain.kt:109) ~[okhttp-4.9.3.jar:na]
	at okhttp3.internal.connection.ConnectInterceptor.intercept(ConnectInterceptor.kt:34) ~[okhttp-4.9.3.jar:na]
	at okhttp3.internal.http.RealInterceptorChain.proceed(RealInterceptorChain.kt:109) ~[okhttp-4.9.3.jar:na]
	at okhttp3.internal.cache.CacheInterceptor.intercept(CacheInterceptor.kt:95) ~[okhttp-4.9.3.jar:na]
	at okhttp3.internal.http.RealInterceptorChain.proceed(RealInterceptorChain.kt:109) ~[okhttp-4.9.3.jar:na]
	at okhttp3.internal.http.BridgeInterceptor.intercept(BridgeInterceptor.kt:83) ~[okhttp-4.9.3.jar:na]
	at okhttp3.internal.http.RealInterceptorChain.proceed(RealInterceptorChain.kt:109) ~[okhttp-4.9.3.jar:na]
	at okhttp3.internal.http.RetryAndFollowUpInterceptor.intercept(RetryAndFollowUpInterceptor.kt:76) ~[okhttp-4.9.3.jar:na]
	at okhttp3.internal.http.RealInterceptorChain.proceed(RealInterceptorChain.kt:109) ~[okhttp-4.9.3.jar:na]
	at okhttp3.internal.connection.RealCall.getResponseWithInterceptorChain$okhttp(RealCall.kt:201) ~[okhttp-4.9.3.jar:na]
	at okhttp3.internal.connection.RealCall.execute(RealCall.kt:154) ~[okhttp-4.9.3.jar:na]
	at feign.okhttp.OkHttpClient.execute(OkHttpClient.java:180) ~[feign-okhttp-11.10.jar:na]
	at org.springframework.cloud.openfeign.loadbalancer.LoadBalancerUtils.executeWithLoadBalancerLifecycleProcessing(LoadBalancerUtils.java:57) ~[spring-cloud-openfeign-core-3.1.5.jar:3.1.5]
	at org.springframework.cloud.openfeign.loadbalancer.LoadBalancerUtils.executeWithLoadBalancerLifecycleProcessing(LoadBalancerUtils.java:95) ~[spring-cloud-openfeign-core-3.1.5.jar:3.1.5]
	at org.springframework.cloud.openfeign.loadbalancer.FeignBlockingLoadBalancerClient.execute(FeignBlockingLoadBalancerClient.java:114) ~[spring-cloud-openfeign-core-3.1.5.jar:3.1.5]
	at feign.SynchronousMethodHandler.executeAndDecode(SynchronousMethodHandler.java:121) ~[feign-core-11.10.jar:na]
	at feign.SynchronousMethodHandler.invoke(SynchronousMethodHandler.java:91) ~[feign-core-11.10.jar:na]
	at feign.ReflectiveFeign$FeignInvocationHandler.invoke(ReflectiveFeign.java:100) ~[feign-core-11.10.jar:na]
	at jdk.proxy2/jdk.proxy2.$Proxy138.eye_doctor_chat(Unknown Source) ~[na:na]
	at com.luojiawei.his_service.controller.ChatController.ask(ChatController.java:39) ~[classes/:na]
	at java.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke0(Native Method) ~[na:na]
	at java.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:77) ~[na:na]
	at java.base/jdk.internal.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43) ~[na:na]
	at java.base/java.lang.reflect.Method.invoke(Method.java:568) ~[na:na]
	at org.springframework.web.method.support.InvocableHandlerMethod.doInvoke(InvocableHandlerMethod.java:205) ~[spring-web-5.3.27.jar:5.3.27]
	at org.springframework.web.method.support.InvocableHandlerMethod.invokeForRequest(InvocableHandlerMethod.java:150) ~[spring-web-5.3.27.jar:5.3.27]
	at org.springframework.web.servlet.mvc.method.annotation.ServletInvocableHandlerMethod.invokeAndHandle(ServletInvocableHandlerMethod.java:117) ~[spring-webmvc-5.3.27.jar:5.3.27]
	at org.springframework.web.servlet.mvc.method.annotation.RequestMappingHandlerAdapter.invokeHandlerMethod(RequestMappingHandlerAdapter.java:895) ~[spring-webmvc-5.3.27.jar:5.3.27]
	at org.springframework.web.servlet.mvc.method.annotation.RequestMappingHandlerAdapter.handleInternal(RequestMappingHandlerAdapter.java:808) ~[spring-webmvc-5.3.27.jar:5.3.27]
	at org.springframework.web.servlet.mvc.method.AbstractHandlerMethodAdapter.handle(AbstractHandlerMethodAdapter.java:87) ~[spring-webmvc-5.3.27.jar:5.3.27]
	at org.springframework.web.servlet.DispatcherServlet.doDispatch(DispatcherServlet.java:1072) ~[spring-webmvc-5.3.27.jar:5.3.27]
	at org.springframework.web.servlet.DispatcherServlet.doService(DispatcherServlet.java:965) ~[spring-webmvc-5.3.27.jar:5.3.27]
	at org.springframework.web.servlet.FrameworkServlet.processRequest(FrameworkServlet.java:1006) ~[spring-webmvc-5.3.27.jar:5.3.27]
	at org.springframework.web.servlet.FrameworkServlet.doPost(FrameworkServlet.java:909) ~[spring-webmvc-5.3.27.jar:5.3.27]
	at javax.servlet.http.HttpServlet.service(HttpServlet.java:555) ~[tomcat-embed-core-9.0.75.jar:4.0.FR]
	at org.springframework.web.servlet.FrameworkServlet.service(FrameworkServlet.java:883) ~[spring-webmvc-5.3.27.jar:5.3.27]
	at javax.servlet.http.HttpServlet.service(HttpServlet.java:623) ~[tomcat-embed-core-9.0.75.jar:4.0.FR]
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:209) ~[tomcat-embed-core-9.0.75.jar:9.0.75]
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:153) ~[tomcat-embed-core-9.0.75.jar:9.0.75]
	at com.luojiawei.his_service.filter.RefreshTokenFilter.doFilterInternal(RefreshTokenFilter.java:58) ~[classes/:na]
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:117) ~[spring-web-5.3.27.jar:5.3.27]
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:178) ~[tomcat-embed-core-9.0.75.jar:9.0.75]
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:153) ~[tomcat-embed-core-9.0.75.jar:9.0.75]
	at org.springframework.web.filter.RequestContextFilter.doFilterInternal(RequestContextFilter.java:100) ~[spring-web-5.3.27.jar:5.3.27]
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:117) ~[spring-web-5.3.27.jar:5.3.27]
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:178) ~[tomcat-embed-core-9.0.75.jar:9.0.75]
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:153) ~[tomcat-embed-core-9.0.75.jar:9.0.75]
	at org.springframework.web.filter.FormContentFilter.doFilterInternal(FormContentFilter.java:93) ~[spring-web-5.3.27.jar:5.3.27]
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:117) ~[spring-web-5.3.27.jar:5.3.27]
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:178) ~[tomcat-embed-core-9.0.75.jar:9.0.75]
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:153) ~[tomcat-embed-core-9.0.75.jar:9.0.75]
	at org.springframework.boot.actuate.metrics.web.servlet.WebMvcMetricsFilter.doFilterInternal(WebMvcMetricsFilter.java:96) ~[spring-boot-actuator-2.7.12.jar:2.7.12]
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:117) ~[spring-web-5.3.27.jar:5.3.27]
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:178) ~[tomcat-embed-core-9.0.75.jar:9.0.75]
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:153) ~[tomcat-embed-core-9.0.75.jar:9.0.75]
	at org.springframework.web.filter.CharacterEncodingFilter.doFilterInternal(CharacterEncodingFilter.java:201) ~[spring-web-5.3.27.jar:5.3.27]
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:117) ~[spring-web-5.3.27.jar:5.3.27]
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:178) ~[tomcat-embed-core-9.0.75.jar:9.0.75]
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:153) ~[tomcat-embed-core-9.0.75.jar:9.0.75]
	at org.apache.catalina.core.StandardWrapperValve.invoke(StandardWrapperValve.java:167) ~[tomcat-embed-core-9.0.75.jar:9.0.75]
	at org.apache.catalina.core.StandardContextValve.invoke(StandardContextValve.java:90) ~[tomcat-embed-core-9.0.75.jar:9.0.75]
	at org.apache.catalina.authenticator.AuthenticatorBase.invoke(AuthenticatorBase.java:481) ~[tomcat-embed-core-9.0.75.jar:9.0.75]
	at org.apache.catalina.core.StandardHostValve.invoke(StandardHostValve.java:130) ~[tomcat-embed-core-9.0.75.jar:9.0.75]
	at org.apache.catalina.valves.ErrorReportValve.invoke(ErrorReportValve.java:93) ~[tomcat-embed-core-9.0.75.jar:9.0.75]
	at org.apache.catalina.core.StandardEngineValve.invoke(StandardEngineValve.java:74) ~[tomcat-embed-core-9.0.75.jar:9.0.75]
	at org.apache.catalina.connector.CoyoteAdapter.service(CoyoteAdapter.java:343) ~[tomcat-embed-core-9.0.75.jar:9.0.75]
	at org.apache.coyote.http11.Http11Processor.service(Http11Processor.java:390) ~[tomcat-embed-core-9.0.75.jar:9.0.75]
	at org.apache.coyote.AbstractProcessorLight.process(AbstractProcessorLight.java:63) ~[tomcat-embed-core-9.0.75.jar:9.0.75]
	at org.apache.coyote.AbstractProtocol$ConnectionHandler.process(AbstractProtocol.java:926) ~[tomcat-embed-core-9.0.75.jar:9.0.75]
	at org.apache.tomcat.util.net.NioEndpoint$SocketProcessor.doRun(NioEndpoint.java:1791) ~[tomcat-embed-core-9.0.75.jar:9.0.75]
	at org.apache.tomcat.util.net.SocketProcessorBase.run(SocketProcessorBase.java:52) ~[tomcat-embed-core-9.0.75.jar:9.0.75]
	at org.apache.tomcat.util.threads.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1191) ~[tomcat-embed-core-9.0.75.jar:9.0.75]
	at org.apache.tomcat.util.threads.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:659) ~[tomcat-embed-core-9.0.75.jar:9.0.75]
	at org.apache.tomcat.util.threads.TaskThread$WrappingRunnable.run(TaskThread.java:61) ~[tomcat-embed-core-9.0.75.jar:9.0.75]
	at java.base/java.lang.Thread.run(Thread.java:840) ~[na:na]

21:36:28:518  WARN 38752 --- [Thread-18] c.a.n.common.http.HttpClientBeanHolder   : [HttpClientBeanHolder] Start destroying common HttpClient
21:36:28:518  WARN 38752 --- [Thread-15] c.a.nacos.common.notify.NotifyCenter     : [NotifyCenter] Start destroying Publisher
21:36:28:518  WARN 38752 --- [Thread-15] c.a.nacos.common.notify.NotifyCenter     : [NotifyCenter] Destruction of the end
21:36:28:526  WARN 38752 --- [Thread-18] c.a.n.common.http.HttpClientBeanHolder   : [HttpClientBeanHolder] Destruction of the end
21:36:28:595  INFO 38752 --- [SpringApplicationShutdownHook] c.a.c.n.registry.NacosServiceRegistry    : De-registering from Nacos Server now...
21:36:28:630  INFO 38752 --- [SpringApplicationShutdownHook] c.a.c.n.registry.NacosServiceRegistry    : De-registration finished.
21:36:28:674  INFO 38752 --- [SpringApplicationShutdownHook] com.zaxxer.hikari.HikariDataSource       : HikariPool-1 - Shutdown initiated...
21:36:28:982  INFO 38752 --- [SpringApplicationShutdownHook] com.zaxxer.hikari.HikariDataSource       : HikariPool-1 - Shutdown completed.
21:36:33:856  INFO 40944 --- [main] c.l.his_service.HisServiceApplication    : Starting HisServiceApplication using Java 17.0.11 on luo with PID 40944 (A:\Desktop\workspace\HIS\his_service\target\classes started by 22407 in A:\Desktop\workspace\HIS)
21:36:33:857 DEBUG 40944 --- [main] c.l.his_service.HisServiceApplication    : Running with Spring Boot v2.7.12, Spring v5.3.27
21:36:33:857  INFO 40944 --- [main] c.l.his_service.HisServiceApplication    : The following 1 profile is active: "dev"
21:36:34:727 DEBUG 40944 --- [main] o.s.c.openfeign.FeignClientsRegistrar$1  : Identified candidate component class: file [A:\Desktop\workspace\HIS\his_api\target\classes\com\luojiawei\api\client\FlaskAiDoctorClient.class]
21:36:34:729 DEBUG 40944 --- [main] o.s.c.openfeign.FeignClientsRegistrar$1  : Identified candidate component class: file [A:\Desktop\workspace\HIS\his_api\target\classes\com\luojiawei\api\client\FlaskModelAnalyzeClient.class]
21:36:34:729 DEBUG 40944 --- [main] o.s.c.openfeign.FeignClientsRegistrar$1  : Identified candidate component class: file [A:\Desktop\workspace\HIS\his_api\target\classes\com\luojiawei\api\client\FlaskUploadClient.class]
21:36:35:097  INFO 40944 --- [main] .s.d.r.c.RepositoryConfigurationDelegate : Multiple Spring Data modules found, entering strict repository configuration mode
21:36:35:101  INFO 40944 --- [main] .s.d.r.c.RepositoryConfigurationDelegate : Bootstrapping Spring Data Redis repositories in DEFAULT mode.
21:36:35:136  INFO 40944 --- [main] .s.d.r.c.RepositoryConfigurationDelegate : Finished Spring Data repository scanning in 17 ms. Found 0 Redis repository interfaces.
21:36:35:499  INFO 40944 --- [main] o.s.cloud.context.scope.GenericScope     : BeanFactory id=15115e6d-eb61-304d-ae7c-b74e3e436bbc
21:36:37:163  INFO 40944 --- [main] o.s.b.w.embedded.tomcat.TomcatWebServer  : Tomcat initialized with port(s): 8080 (http)
21:36:37:195  INFO 40944 --- [main] o.apache.catalina.core.StandardService   : Starting service [Tomcat]
21:36:37:196  INFO 40944 --- [main] org.apache.catalina.core.StandardEngine  : Starting Servlet engine: [Apache Tomcat/9.0.75]
21:36:37:440  INFO 40944 --- [main] o.a.c.c.C.[Tomcat].[localhost].[/]       : Initializing Spring embedded WebApplicationContext
21:36:37:440  INFO 40944 --- [main] w.s.c.ServletWebServerApplicationContext : Root WebApplicationContext: initialization completed in 3529 ms
21:36:37:994  INFO 40944 --- [main] org.redisson.Version                     : Redisson 3.17.7
21:36:38:493  INFO 40944 --- [redisson-netty-2-9] o.r.c.pool.MasterPubSubConnectionPool    : 1 connections initialized for 111.230.32.147/111.230.32.147:9631
21:36:39:197  INFO 40944 --- [redisson-netty-2-19] o.r.c.pool.MasterConnectionPool          : 24 connections initialized for 111.230.32.147/111.230.32.147:9631
21:36:39:559 DEBUG 40944 --- [main] c.l.h.filter.RefreshTokenFilter          : Filter 'refreshTokenFilter' configured for use
21:36:40:592  INFO 40944 --- [main] o.s.c.openfeign.FeignClientFactoryBean   : For 'flask-service' URL not provided. Will try picking an instance via load-balancing.
21:36:41:017  INFO 40944 --- [main] o.s.c.openfeign.FeignClientFactoryBean   : For 'ai-doctor-service' URL not provided. Will try picking an instance via load-balancing.
21:36:43:202  WARN 40944 --- [main] iguration$LoadBalancerCaffeineWarnLogger : Spring Cloud LoadBalancer is currently working with the default cache. While this cache implementation is useful for development and tests, it's recommended to use Caffeine cache in production.You can switch to using Caffeine cache, by adding it and org.springframework.cache.caffeine.CaffeineCacheManager to the classpath.
21:36:43:210  INFO 40944 --- [main] o.s.b.a.e.web.EndpointLinksResolver      : Exposing 1 endpoint(s) beneath base path '/actuator'
21:36:43:382  INFO 40944 --- [main] o.s.b.w.embedded.tomcat.TomcatWebServer  : Tomcat started on port(s): 8080 (http) with context path ''
21:36:43:457  INFO 40944 --- [main] c.a.n.p.a.s.c.ClientAuthPluginManager    : [ClientAuthPluginManager] Load ClientAuthService com.alibaba.nacos.client.auth.impl.NacosClientAuthServiceImpl success.
21:36:43:457  INFO 40944 --- [main] c.a.n.p.a.s.c.ClientAuthPluginManager    : [ClientAuthPluginManager] Load ClientAuthService com.alibaba.nacos.client.auth.ram.RamClientAuthServiceImpl success.
21:36:45:794  INFO 40944 --- [main] c.a.n.c.a.AbstractAbilityControlManager  : Ready to get current node abilities...
21:36:45:796  INFO 40944 --- [main] c.a.n.c.a.AbstractAbilityControlManager  : Ready to initialize current node abilities, support modes: [SDK_CLIENT]
21:36:45:796  INFO 40944 --- [main] c.a.n.c.a.AbstractAbilityControlManager  : Initialize current abilities finish...
21:36:45:797  INFO 40944 --- [main] c.a.n.c.a.d.NacosAbilityManagerHolder    : [AbilityControlManager] Successfully initialize AbilityControlManager
21:36:45:888  INFO 40944 --- [main] c.a.c.n.registry.NacosServiceRegistry    : nacos registry, DEFAULT_GROUP his-service 10.21.93.70:8848 register finished
21:36:46:168  INFO 40944 --- [main] c.l.his_service.HisServiceApplication    : Started HisServiceApplication in 13.29 seconds (JVM running for 14.508)
21:36:46:723  INFO 40944 --- [RMI TCP Connection(3)-10.21.93.70] o.a.c.c.C.[Tomcat].[localhost].[/]       : Initializing Spring DispatcherServlet 'dispatcherServlet'
21:36:46:724  INFO 40944 --- [RMI TCP Connection(3)-10.21.93.70] o.s.web.servlet.DispatcherServlet        : Initializing Servlet 'dispatcherServlet'
21:36:46:724  INFO 40944 --- [RMI TCP Connection(2)-10.21.93.70] com.zaxxer.hikari.HikariDataSource       : HikariPool-1 - Starting...
21:36:46:726  INFO 40944 --- [RMI TCP Connection(3)-10.21.93.70] o.s.web.servlet.DispatcherServlet        : Completed initialization in 2 ms
21:36:47:510  INFO 40944 --- [RMI TCP Connection(2)-10.21.93.70] com.zaxxer.hikari.HikariDataSource       : HikariPool-1 - Start completed.
21:36:53:850 DEBUG 40944 --- [http-nio-8080-exec-2] c.l.h.m.D.selectById                     : ==>  Preparing: SELECT id,patient_id,doctor_id,disease_name,disease_category,aimodel_id,result,create_time,status,id_card,name,score,remark FROM diagnosis_report WHERE id=?
21:36:53:879 DEBUG 40944 --- [http-nio-8080-exec-2] c.l.h.m.D.selectById                     : ==> Parameters: 1(Integer)
21:36:53:949 DEBUG 40944 --- [http-nio-8080-exec-2] c.l.h.m.D.selectById                     : <==      Total: 1
21:36:53:952 DEBUG 40944 --- [http-nio-8080-exec-2] c.l.h.mapper.PatientMapper.selectById    : ==>  Preparing: SELECT id,phone,id_card,name,verified,verified_by,verified_time,open_id,hospital_pid FROM patient WHERE id=?
21:36:53:953 DEBUG 40944 --- [http-nio-8080-exec-2] c.l.h.mapper.PatientMapper.selectById    : ==> Parameters: 1(Integer)
21:36:53:984 DEBUG 40944 --- [http-nio-8080-exec-2] c.l.h.mapper.PatientMapper.selectById    : <==      Total: 1
21:36:53:987 DEBUG 40944 --- [http-nio-8080-exec-2] c.l.h.mapper.DoctorMapper.selectById     : ==>  Preparing: SELECT id,phone,id_card,name,verified,verified_by,verified_time,license,department,hospital_pid FROM doctor WHERE id=?
21:36:53:989 DEBUG 40944 --- [http-nio-8080-exec-2] c.l.h.mapper.DoctorMapper.selectById     : ==> Parameters: 1(Integer)
21:36:54:019 DEBUG 40944 --- [http-nio-8080-exec-2] c.l.h.mapper.DoctorMapper.selectById     : <==      Total: 1
21:36:54:021 DEBUG 40944 --- [http-nio-8080-exec-2] c.l.h.m.E.selectListByDiagnosisId        : ==>  Preparing: select * from eye_images where dignosis_report_id = ?
21:36:54:022 DEBUG 40944 --- [http-nio-8080-exec-2] c.l.h.m.E.selectListByDiagnosisId        : ==> Parameters: 1(Integer)
21:36:54:050 DEBUG 40944 --- [http-nio-8080-exec-2] c.l.h.m.E.selectListByDiagnosisId        : <==      Total: 1
21:36:54:051 DEBUG 40944 --- [http-nio-8080-exec-2] c.l.h.m.T.selectByDiagnosisId            : ==>  Preparing: select * from treatment_plans where diagnosis_id = ?
21:36:54:052 DEBUG 40944 --- [http-nio-8080-exec-2] c.l.h.m.T.selectByDiagnosisId            : ==> Parameters: 1(Integer)
21:36:54:081 DEBUG 40944 --- [http-nio-8080-exec-2] c.l.h.m.T.selectByDiagnosisId            : <==      Total: 1
21:36:54:082 DEBUG 40944 --- [http-nio-8080-exec-2] c.l.h.m.M.selectByDiagnosisId            : ==>  Preparing: select * from medication_recommendations where diagnosis_id = ?
21:36:54:082 DEBUG 40944 --- [http-nio-8080-exec-2] c.l.h.m.M.selectByDiagnosisId            : ==> Parameters: 1(Integer)
21:36:54:111 DEBUG 40944 --- [http-nio-8080-exec-2] c.l.h.m.M.selectByDiagnosisId            : <==      Total: 1
21:36:54:112 DEBUG 40944 --- [http-nio-8080-exec-2] c.l.h.mapper.AiModelMapper.selectById    : ==>  Preparing: SELECT id,version,deploy_time,accuracy FROM ai_model WHERE id=?
21:36:54:112 DEBUG 40944 --- [http-nio-8080-exec-2] c.l.h.mapper.AiModelMapper.selectById    : ==> Parameters: 1(Integer)
21:36:54:140 DEBUG 40944 --- [http-nio-8080-exec-2] c.l.h.mapper.AiModelMapper.selectById    : <==      Total: 1
21:36:54:167 DEBUG 40944 --- [http-nio-8080-exec-2] o.s.c.openfeign.support.SpringEncoder    : Writing [ChatForm(diagnosisName=, diagnosisCategory=, result=A, remark=A, treatmentPlan=TreatmentPlans(id=1, diagnosisId=1, treatmentType=1, treatmentDetail=, startTime=2025-03-01T09:00, endDate=2025-03-10T09:00, doctorId=1, createdTime=2025-03-01T09:00, updatedTime=2025-03-01T09:00), medications=[MedicationRecommendations(id=1, diagnosisId=1, medicationName=A, dosage=10mg, frequency=, sideEffects=, startTime=2025-03-01T09:00, endTime=2025-03-10T09:00, doctorId=1, createdTime=2025-03-01T09:00, updatedTime=2025-03-01T09:00)], previousConversations=[DialogueInfo(role=pariatur tempor do, content=sit cupidatat commodo)], question=irure eu esse, stream=false)] using [org.springframework.http.converter.json.MappingJackson2HttpMessageConverter@3294102e]
21:36:54:180 DEBUG 40944 --- [http-nio-8080-exec-2] c.l.api.client.FlaskAiDoctorClient       : [FlaskAiDoctorClient#eye_doctor_chat] ---> POST http://ai-doctor-service/api/eye-doctor/chat HTTP/1.1
21:36:54:181 DEBUG 40944 --- [http-nio-8080-exec-2] c.l.api.client.FlaskAiDoctorClient       : [FlaskAiDoctorClient#eye_doctor_chat] Content-Length: 749
21:36:54:181 DEBUG 40944 --- [http-nio-8080-exec-2] c.l.api.client.FlaskAiDoctorClient       : [FlaskAiDoctorClient#eye_doctor_chat] Content-Type: application/json
21:36:54:181 DEBUG 40944 --- [http-nio-8080-exec-2] c.l.api.client.FlaskAiDoctorClient       : [FlaskAiDoctorClient#eye_doctor_chat] 
21:36:54:181 DEBUG 40944 --- [http-nio-8080-exec-2] c.l.api.client.FlaskAiDoctorClient       : [FlaskAiDoctorClient#eye_doctor_chat] {"disease_name":"","disease_category":"","result":"A","remark":"A","treatment_plan":{"id":1,"treatmentType":1,"treatmentDetail":"","startTime":"2025-03-01 09:00:00","endDate":"2025-03-10 09:00:00","doctorId":1,"createdTime":"2025-03-01T09:00:00","updatedTime":"2025-03-01T09:00:00"},"medications":[{"id":1,"diagnosisId":1,"medicationName":"A","dosage":"10mg","frequency":"","sideEffects":"","startTime":"2025-03-01T09:00:00","endTime":"2025-03-10T09:00:00","doctorId":1,"createdTime":"2025-03-01 09:00:00","updatedTime":"2025-03-01 09:00:00"}],"previous_conversations":[{"role":"pariatur tempor do","content":"sit cupidatat commodo"}],"question":"irure eu esse","stream":false}
21:36:54:181 DEBUG 40944 --- [http-nio-8080-exec-2] c.l.api.client.FlaskAiDoctorClient       : [FlaskAiDoctorClient#eye_doctor_chat] ---> END HTTP (749-byte body)
21:37:09:415 DEBUG 40944 --- [http-nio-8080-exec-2] c.l.api.client.FlaskAiDoctorClient       : [FlaskAiDoctorClient#eye_doctor_chat] <--- ERROR SocketTimeoutException: timeout (15234ms)
21:37:09:417 DEBUG 40944 --- [http-nio-8080-exec-2] c.l.api.client.FlaskAiDoctorClient       : [FlaskAiDoctorClient#eye_doctor_chat] java.net.SocketTimeoutException: timeout
	at okio.SocketAsyncTimeout.newTimeoutException(JvmOkio.kt:147)
	at okio.AsyncTimeout.access$newTimeoutException(AsyncTimeout.kt:158)
	at okio.AsyncTimeout$source$1.read(AsyncTimeout.kt:337)
	at okio.RealBufferedSource.indexOf(RealBufferedSource.kt:427)
	at okio.RealBufferedSource.readUtf8LineStrict(RealBufferedSource.kt:320)
	at okhttp3.internal.http1.HeadersReader.readLine(HeadersReader.kt:29)
	at okhttp3.internal.http1.Http1ExchangeCodec.readResponseHeaders(Http1ExchangeCodec.kt:178)
	at okhttp3.internal.connection.Exchange.readResponseHeaders(Exchange.kt:106)
	at okhttp3.internal.http.CallServerInterceptor.intercept(CallServerInterceptor.kt:79)
	at okhttp3.internal.http.RealInterceptorChain.proceed(RealInterceptorChain.kt:109)
	at okhttp3.internal.connection.ConnectInterceptor.intercept(ConnectInterceptor.kt:34)
	at okhttp3.internal.http.RealInterceptorChain.proceed(RealInterceptorChain.kt:109)
	at okhttp3.internal.cache.CacheInterceptor.intercept(CacheInterceptor.kt:95)
	at okhttp3.internal.http.RealInterceptorChain.proceed(RealInterceptorChain.kt:109)
	at okhttp3.internal.http.BridgeInterceptor.intercept(BridgeInterceptor.kt:83)
	at okhttp3.internal.http.RealInterceptorChain.proceed(RealInterceptorChain.kt:109)
	at okhttp3.internal.http.RetryAndFollowUpInterceptor.intercept(RetryAndFollowUpInterceptor.kt:76)
	at okhttp3.internal.http.RealInterceptorChain.proceed(RealInterceptorChain.kt:109)
	at okhttp3.internal.connection.RealCall.getResponseWithInterceptorChain$okhttp(RealCall.kt:201)
	at okhttp3.internal.connection.RealCall.execute(RealCall.kt:154)
	at feign.okhttp.OkHttpClient.execute(OkHttpClient.java:180)
	at org.springframework.cloud.openfeign.loadbalancer.LoadBalancerUtils.executeWithLoadBalancerLifecycleProcessing(LoadBalancerUtils.java:57)
	at org.springframework.cloud.openfeign.loadbalancer.LoadBalancerUtils.executeWithLoadBalancerLifecycleProcessing(LoadBalancerUtils.java:95)
	at org.springframework.cloud.openfeign.loadbalancer.FeignBlockingLoadBalancerClient.execute(FeignBlockingLoadBalancerClient.java:114)
	at feign.SynchronousMethodHandler.executeAndDecode(SynchronousMethodHandler.java:121)
	at feign.SynchronousMethodHandler.invoke(SynchronousMethodHandler.java:91)
	at feign.ReflectiveFeign$FeignInvocationHandler.invoke(ReflectiveFeign.java:100)
	at jdk.proxy2/jdk.proxy2.$Proxy138.eye_doctor_chat(Unknown Source)
	at com.luojiawei.his_service.controller.ChatController.ask(ChatController.java:39)
	at java.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at java.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:77)
	at java.base/jdk.internal.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.base/java.lang.reflect.Method.invoke(Method.java:568)
	at org.springframework.web.method.support.InvocableHandlerMethod.doInvoke(InvocableHandlerMethod.java:205)
	at org.springframework.web.method.support.InvocableHandlerMethod.invokeForRequest(InvocableHandlerMethod.java:150)
	at org.springframework.web.servlet.mvc.method.annotation.ServletInvocableHandlerMethod.invokeAndHandle(ServletInvocableHandlerMethod.java:117)
	at org.springframework.web.servlet.mvc.method.annotation.RequestMappingHandlerAdapter.invokeHandlerMethod(RequestMappingHandlerAdapter.java:895)
	at org.springframework.web.servlet.mvc.method.annotation.RequestMappingHandlerAdapter.handleInternal(RequestMappingHandlerAdapter.java:808)
	at org.springframework.web.servlet.mvc.method.AbstractHandlerMethodAdapter.handle(AbstractHandlerMethodAdapter.java:87)
	at org.springframework.web.servlet.DispatcherServlet.doDispatch(DispatcherServlet.java:1072)
	at org.springframework.web.servlet.DispatcherServlet.doService(DispatcherServlet.java:965)
	at org.springframework.web.servlet.FrameworkServlet.processRequest(FrameworkServlet.java:1006)
	at org.springframework.web.servlet.FrameworkServlet.doPost(FrameworkServlet.java:909)
	at javax.servlet.http.HttpServlet.service(HttpServlet.java:555)
	at org.springframework.web.servlet.FrameworkServlet.service(FrameworkServlet.java:883)
	at javax.servlet.http.HttpServlet.service(HttpServlet.java:623)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:209)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:153)
	at com.luojiawei.his_service.filter.RefreshTokenFilter.doFilterInternal(RefreshTokenFilter.java:58)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:117)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:178)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:153)
	at org.springframework.web.filter.RequestContextFilter.doFilterInternal(RequestContextFilter.java:100)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:117)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:178)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:153)
	at org.springframework.web.filter.FormContentFilter.doFilterInternal(FormContentFilter.java:93)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:117)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:178)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:153)
	at org.springframework.boot.actuate.metrics.web.servlet.WebMvcMetricsFilter.doFilterInternal(WebMvcMetricsFilter.java:96)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:117)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:178)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:153)
	at org.springframework.web.filter.CharacterEncodingFilter.doFilterInternal(CharacterEncodingFilter.java:201)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:117)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:178)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:153)
	at org.apache.catalina.core.StandardWrapperValve.invoke(StandardWrapperValve.java:167)
	at org.apache.catalina.core.StandardContextValve.invoke(StandardContextValve.java:90)
	at org.apache.catalina.authenticator.AuthenticatorBase.invoke(AuthenticatorBase.java:481)
	at org.apache.catalina.core.StandardHostValve.invoke(StandardHostValve.java:130)
	at org.apache.catalina.valves.ErrorReportValve.invoke(ErrorReportValve.java:93)
	at org.apache.catalina.core.StandardEngineValve.invoke(StandardEngineValve.java:74)
	at org.apache.catalina.connector.CoyoteAdapter.service(CoyoteAdapter.java:343)
	at org.apache.coyote.http11.Http11Processor.service(Http11Processor.java:390)
	at org.apache.coyote.AbstractProcessorLight.process(AbstractProcessorLight.java:63)
	at org.apache.coyote.AbstractProtocol$ConnectionHandler.process(AbstractProtocol.java:926)
	at org.apache.tomcat.util.net.NioEndpoint$SocketProcessor.doRun(NioEndpoint.java:1791)
	at org.apache.tomcat.util.net.SocketProcessorBase.run(SocketProcessorBase.java:52)
	at org.apache.tomcat.util.threads.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1191)
	at org.apache.tomcat.util.threads.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:659)
	at org.apache.tomcat.util.threads.TaskThread$WrappingRunnable.run(TaskThread.java:61)
	at java.base/java.lang.Thread.run(Thread.java:840)
Caused by: java.net.SocketException: Socket closed
	at java.base/sun.nio.ch.NioSocketImpl.endRead(NioSocketImpl.java:253)
	at java.base/sun.nio.ch.NioSocketImpl.implRead(NioSocketImpl.java:332)
	at java.base/sun.nio.ch.NioSocketImpl.read(NioSocketImpl.java:355)
	at java.base/sun.nio.ch.NioSocketImpl$1.read(NioSocketImpl.java:808)
	at java.base/java.net.Socket$SocketInputStream.read(Socket.java:966)
	at okio.InputStreamSource.read(JvmOkio.kt:94)
	at okio.AsyncTimeout$source$1.read(AsyncTimeout.kt:125)
	... 81 more

21:37:09:417 DEBUG 40944 --- [http-nio-8080-exec-2] c.l.api.client.FlaskAiDoctorClient       : [FlaskAiDoctorClient#eye_doctor_chat] <--- END ERROR
21:37:09:440 ERROR 40944 --- [http-nio-8080-exec-2] o.a.c.c.C.[.[.[/].[dispatcherServlet]    : Servlet.service() for servlet [dispatcherServlet] in context with path [] threw exception [Request processing failed; nested exception is feign.RetryableException: timeout executing POST http://ai-doctor-service/api/eye-doctor/chat] with root cause

java.net.SocketException: Socket closed
	at java.base/sun.nio.ch.NioSocketImpl.endRead(NioSocketImpl.java:253) ~[na:na]
	at java.base/sun.nio.ch.NioSocketImpl.implRead(NioSocketImpl.java:332) ~[na:na]
	at java.base/sun.nio.ch.NioSocketImpl.read(NioSocketImpl.java:355) ~[na:na]
	at java.base/sun.nio.ch.NioSocketImpl$1.read(NioSocketImpl.java:808) ~[na:na]
	at java.base/java.net.Socket$SocketInputStream.read(Socket.java:966) ~[na:na]
	at okio.InputStreamSource.read(JvmOkio.kt:94) ~[okio-jvm-3.2.0.jar:na]
	at okio.AsyncTimeout$source$1.read(AsyncTimeout.kt:125) ~[okio-jvm-3.2.0.jar:na]
	at okio.RealBufferedSource.indexOf(RealBufferedSource.kt:427) ~[okio-jvm-3.2.0.jar:na]
	at okio.RealBufferedSource.readUtf8LineStrict(RealBufferedSource.kt:320) ~[okio-jvm-3.2.0.jar:na]
	at okhttp3.internal.http1.HeadersReader.readLine(HeadersReader.kt:29) ~[okhttp-4.9.3.jar:na]
	at okhttp3.internal.http1.Http1ExchangeCodec.readResponseHeaders(Http1ExchangeCodec.kt:178) ~[okhttp-4.9.3.jar:na]
	at okhttp3.internal.connection.Exchange.readResponseHeaders(Exchange.kt:106) ~[okhttp-4.9.3.jar:na]
	at okhttp3.internal.http.CallServerInterceptor.intercept(CallServerInterceptor.kt:79) ~[okhttp-4.9.3.jar:na]
	at okhttp3.internal.http.RealInterceptorChain.proceed(RealInterceptorChain.kt:109) ~[okhttp-4.9.3.jar:na]
	at okhttp3.internal.connection.ConnectInterceptor.intercept(ConnectInterceptor.kt:34) ~[okhttp-4.9.3.jar:na]
	at okhttp3.internal.http.RealInterceptorChain.proceed(RealInterceptorChain.kt:109) ~[okhttp-4.9.3.jar:na]
	at okhttp3.internal.cache.CacheInterceptor.intercept(CacheInterceptor.kt:95) ~[okhttp-4.9.3.jar:na]
	at okhttp3.internal.http.RealInterceptorChain.proceed(RealInterceptorChain.kt:109) ~[okhttp-4.9.3.jar:na]
	at okhttp3.internal.http.BridgeInterceptor.intercept(BridgeInterceptor.kt:83) ~[okhttp-4.9.3.jar:na]
	at okhttp3.internal.http.RealInterceptorChain.proceed(RealInterceptorChain.kt:109) ~[okhttp-4.9.3.jar:na]
	at okhttp3.internal.http.RetryAndFollowUpInterceptor.intercept(RetryAndFollowUpInterceptor.kt:76) ~[okhttp-4.9.3.jar:na]
	at okhttp3.internal.http.RealInterceptorChain.proceed(RealInterceptorChain.kt:109) ~[okhttp-4.9.3.jar:na]
	at okhttp3.internal.connection.RealCall.getResponseWithInterceptorChain$okhttp(RealCall.kt:201) ~[okhttp-4.9.3.jar:na]
	at okhttp3.internal.connection.RealCall.execute(RealCall.kt:154) ~[okhttp-4.9.3.jar:na]
	at feign.okhttp.OkHttpClient.execute(OkHttpClient.java:180) ~[feign-okhttp-11.10.jar:na]
	at org.springframework.cloud.openfeign.loadbalancer.LoadBalancerUtils.executeWithLoadBalancerLifecycleProcessing(LoadBalancerUtils.java:57) ~[spring-cloud-openfeign-core-3.1.5.jar:3.1.5]
	at org.springframework.cloud.openfeign.loadbalancer.LoadBalancerUtils.executeWithLoadBalancerLifecycleProcessing(LoadBalancerUtils.java:95) ~[spring-cloud-openfeign-core-3.1.5.jar:3.1.5]
	at org.springframework.cloud.openfeign.loadbalancer.FeignBlockingLoadBalancerClient.execute(FeignBlockingLoadBalancerClient.java:114) ~[spring-cloud-openfeign-core-3.1.5.jar:3.1.5]
	at feign.SynchronousMethodHandler.executeAndDecode(SynchronousMethodHandler.java:121) ~[feign-core-11.10.jar:na]
	at feign.SynchronousMethodHandler.invoke(SynchronousMethodHandler.java:91) ~[feign-core-11.10.jar:na]
	at feign.ReflectiveFeign$FeignInvocationHandler.invoke(ReflectiveFeign.java:100) ~[feign-core-11.10.jar:na]
	at jdk.proxy2/jdk.proxy2.$Proxy138.eye_doctor_chat(Unknown Source) ~[na:na]
	at com.luojiawei.his_service.controller.ChatController.ask(ChatController.java:39) ~[classes/:na]
	at java.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke0(Native Method) ~[na:na]
	at java.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:77) ~[na:na]
	at java.base/jdk.internal.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43) ~[na:na]
	at java.base/java.lang.reflect.Method.invoke(Method.java:568) ~[na:na]
	at org.springframework.web.method.support.InvocableHandlerMethod.doInvoke(InvocableHandlerMethod.java:205) ~[spring-web-5.3.27.jar:5.3.27]
	at org.springframework.web.method.support.InvocableHandlerMethod.invokeForRequest(InvocableHandlerMethod.java:150) ~[spring-web-5.3.27.jar:5.3.27]
	at org.springframework.web.servlet.mvc.method.annotation.ServletInvocableHandlerMethod.invokeAndHandle(ServletInvocableHandlerMethod.java:117) ~[spring-webmvc-5.3.27.jar:5.3.27]
	at org.springframework.web.servlet.mvc.method.annotation.RequestMappingHandlerAdapter.invokeHandlerMethod(RequestMappingHandlerAdapter.java:895) ~[spring-webmvc-5.3.27.jar:5.3.27]
	at org.springframework.web.servlet.mvc.method.annotation.RequestMappingHandlerAdapter.handleInternal(RequestMappingHandlerAdapter.java:808) ~[spring-webmvc-5.3.27.jar:5.3.27]
	at org.springframework.web.servlet.mvc.method.AbstractHandlerMethodAdapter.handle(AbstractHandlerMethodAdapter.java:87) ~[spring-webmvc-5.3.27.jar:5.3.27]
	at org.springframework.web.servlet.DispatcherServlet.doDispatch(DispatcherServlet.java:1072) ~[spring-webmvc-5.3.27.jar:5.3.27]
	at org.springframework.web.servlet.DispatcherServlet.doService(DispatcherServlet.java:965) ~[spring-webmvc-5.3.27.jar:5.3.27]
	at org.springframework.web.servlet.FrameworkServlet.processRequest(FrameworkServlet.java:1006) ~[spring-webmvc-5.3.27.jar:5.3.27]
	at org.springframework.web.servlet.FrameworkServlet.doPost(FrameworkServlet.java:909) ~[spring-webmvc-5.3.27.jar:5.3.27]
	at javax.servlet.http.HttpServlet.service(HttpServlet.java:555) ~[tomcat-embed-core-9.0.75.jar:4.0.FR]
	at org.springframework.web.servlet.FrameworkServlet.service(FrameworkServlet.java:883) ~[spring-webmvc-5.3.27.jar:5.3.27]
	at javax.servlet.http.HttpServlet.service(HttpServlet.java:623) ~[tomcat-embed-core-9.0.75.jar:4.0.FR]
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:209) ~[tomcat-embed-core-9.0.75.jar:9.0.75]
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:153) ~[tomcat-embed-core-9.0.75.jar:9.0.75]
	at com.luojiawei.his_service.filter.RefreshTokenFilter.doFilterInternal(RefreshTokenFilter.java:58) ~[classes/:na]
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:117) ~[spring-web-5.3.27.jar:5.3.27]
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:178) ~[tomcat-embed-core-9.0.75.jar:9.0.75]
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:153) ~[tomcat-embed-core-9.0.75.jar:9.0.75]
	at org.springframework.web.filter.RequestContextFilter.doFilterInternal(RequestContextFilter.java:100) ~[spring-web-5.3.27.jar:5.3.27]
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:117) ~[spring-web-5.3.27.jar:5.3.27]
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:178) ~[tomcat-embed-core-9.0.75.jar:9.0.75]
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:153) ~[tomcat-embed-core-9.0.75.jar:9.0.75]
	at org.springframework.web.filter.FormContentFilter.doFilterInternal(FormContentFilter.java:93) ~[spring-web-5.3.27.jar:5.3.27]
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:117) ~[spring-web-5.3.27.jar:5.3.27]
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:178) ~[tomcat-embed-core-9.0.75.jar:9.0.75]
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:153) ~[tomcat-embed-core-9.0.75.jar:9.0.75]
	at org.springframework.boot.actuate.metrics.web.servlet.WebMvcMetricsFilter.doFilterInternal(WebMvcMetricsFilter.java:96) ~[spring-boot-actuator-2.7.12.jar:2.7.12]
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:117) ~[spring-web-5.3.27.jar:5.3.27]
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:178) ~[tomcat-embed-core-9.0.75.jar:9.0.75]
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:153) ~[tomcat-embed-core-9.0.75.jar:9.0.75]
	at org.springframework.web.filter.CharacterEncodingFilter.doFilterInternal(CharacterEncodingFilter.java:201) ~[spring-web-5.3.27.jar:5.3.27]
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:117) ~[spring-web-5.3.27.jar:5.3.27]
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:178) ~[tomcat-embed-core-9.0.75.jar:9.0.75]
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:153) ~[tomcat-embed-core-9.0.75.jar:9.0.75]
	at org.apache.catalina.core.StandardWrapperValve.invoke(StandardWrapperValve.java:167) ~[tomcat-embed-core-9.0.75.jar:9.0.75]
	at org.apache.catalina.core.StandardContextValve.invoke(StandardContextValve.java:90) ~[tomcat-embed-core-9.0.75.jar:9.0.75]
	at org.apache.catalina.authenticator.AuthenticatorBase.invoke(AuthenticatorBase.java:481) ~[tomcat-embed-core-9.0.75.jar:9.0.75]
	at org.apache.catalina.core.StandardHostValve.invoke(StandardHostValve.java:130) ~[tomcat-embed-core-9.0.75.jar:9.0.75]
	at org.apache.catalina.valves.ErrorReportValve.invoke(ErrorReportValve.java:93) ~[tomcat-embed-core-9.0.75.jar:9.0.75]
	at org.apache.catalina.core.StandardEngineValve.invoke(StandardEngineValve.java:74) ~[tomcat-embed-core-9.0.75.jar:9.0.75]
	at org.apache.catalina.connector.CoyoteAdapter.service(CoyoteAdapter.java:343) ~[tomcat-embed-core-9.0.75.jar:9.0.75]
	at org.apache.coyote.http11.Http11Processor.service(Http11Processor.java:390) ~[tomcat-embed-core-9.0.75.jar:9.0.75]
	at org.apache.coyote.AbstractProcessorLight.process(AbstractProcessorLight.java:63) ~[tomcat-embed-core-9.0.75.jar:9.0.75]
	at org.apache.coyote.AbstractProtocol$ConnectionHandler.process(AbstractProtocol.java:926) ~[tomcat-embed-core-9.0.75.jar:9.0.75]
	at org.apache.tomcat.util.net.NioEndpoint$SocketProcessor.doRun(NioEndpoint.java:1791) ~[tomcat-embed-core-9.0.75.jar:9.0.75]
	at org.apache.tomcat.util.net.SocketProcessorBase.run(SocketProcessorBase.java:52) ~[tomcat-embed-core-9.0.75.jar:9.0.75]
	at org.apache.tomcat.util.threads.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1191) ~[tomcat-embed-core-9.0.75.jar:9.0.75]
	at org.apache.tomcat.util.threads.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:659) ~[tomcat-embed-core-9.0.75.jar:9.0.75]
	at org.apache.tomcat.util.threads.TaskThread$WrappingRunnable.run(TaskThread.java:61) ~[tomcat-embed-core-9.0.75.jar:9.0.75]
	at java.base/java.lang.Thread.run(Thread.java:840) ~[na:na]

21:37:13:349  WARN 40944 --- [Thread-18] c.a.n.common.http.HttpClientBeanHolder   : [HttpClientBeanHolder] Start destroying common HttpClient
21:37:13:349  WARN 40944 --- [Thread-15] c.a.nacos.common.notify.NotifyCenter     : [NotifyCenter] Start destroying Publisher
21:37:13:349  WARN 40944 --- [Thread-15] c.a.nacos.common.notify.NotifyCenter     : [NotifyCenter] Destruction of the end
21:37:13:350  WARN 40944 --- [Thread-18] c.a.n.common.http.HttpClientBeanHolder   : [HttpClientBeanHolder] Destruction of the end
21:37:13:403  INFO 40944 --- [SpringApplicationShutdownHook] c.a.c.n.registry.NacosServiceRegistry    : De-registering from Nacos Server now...
21:37:13:438  INFO 40944 --- [SpringApplicationShutdownHook] c.a.c.n.registry.NacosServiceRegistry    : De-registration finished.
21:37:13:452  INFO 40944 --- [SpringApplicationShutdownHook] com.zaxxer.hikari.HikariDataSource       : HikariPool-1 - Shutdown initiated...
21:37:13:748  INFO 40944 --- [SpringApplicationShutdownHook] com.zaxxer.hikari.HikariDataSource       : HikariPool-1 - Shutdown completed.
21:37:18:172  INFO 15704 --- [main] c.l.his_service.HisServiceApplication    : Starting HisServiceApplication using Java 17.0.11 on luo with PID 15704 (A:\Desktop\workspace\HIS\his_service\target\classes started by 22407 in A:\Desktop\workspace\HIS)
21:37:18:173 DEBUG 15704 --- [main] c.l.his_service.HisServiceApplication    : Running with Spring Boot v2.7.12, Spring v5.3.27
21:37:18:174  INFO 15704 --- [main] c.l.his_service.HisServiceApplication    : The following 1 profile is active: "dev"
21:37:19:074 DEBUG 15704 --- [main] o.s.c.openfeign.FeignClientsRegistrar$1  : Identified candidate component class: file [A:\Desktop\workspace\HIS\his_api\target\classes\com\luojiawei\api\client\FlaskAiDoctorClient.class]
21:37:19:075 DEBUG 15704 --- [main] o.s.c.openfeign.FeignClientsRegistrar$1  : Identified candidate component class: file [A:\Desktop\workspace\HIS\his_api\target\classes\com\luojiawei\api\client\FlaskModelAnalyzeClient.class]
21:37:19:076 DEBUG 15704 --- [main] o.s.c.openfeign.FeignClientsRegistrar$1  : Identified candidate component class: file [A:\Desktop\workspace\HIS\his_api\target\classes\com\luojiawei\api\client\FlaskUploadClient.class]
21:37:19:475  INFO 15704 --- [main] .s.d.r.c.RepositoryConfigurationDelegate : Multiple Spring Data modules found, entering strict repository configuration mode
21:37:19:477  INFO 15704 --- [main] .s.d.r.c.RepositoryConfigurationDelegate : Bootstrapping Spring Data Redis repositories in DEFAULT mode.
21:37:19:505  INFO 15704 --- [main] .s.d.r.c.RepositoryConfigurationDelegate : Finished Spring Data repository scanning in 14 ms. Found 0 Redis repository interfaces.
21:37:19:804  INFO 15704 --- [main] o.s.cloud.context.scope.GenericScope     : BeanFactory id=15115e6d-eb61-304d-ae7c-b74e3e436bbc
21:37:20:466  INFO 15704 --- [main] o.s.b.w.embedded.tomcat.TomcatWebServer  : Tomcat initialized with port(s): 8080 (http)
21:37:20:481  INFO 15704 --- [main] o.apache.catalina.core.StandardService   : Starting service [Tomcat]
21:37:20:481  INFO 15704 --- [main] org.apache.catalina.core.StandardEngine  : Starting Servlet engine: [Apache Tomcat/9.0.75]
21:37:20:661  INFO 15704 --- [main] o.a.c.c.C.[Tomcat].[localhost].[/]       : Initializing Spring embedded WebApplicationContext
21:37:20:662  INFO 15704 --- [main] w.s.c.ServletWebServerApplicationContext : Root WebApplicationContext: initialization completed in 2413 ms
21:37:21:094  INFO 15704 --- [main] org.redisson.Version                     : Redisson 3.17.7
21:37:21:546  INFO 15704 --- [redisson-netty-2-9] o.r.c.pool.MasterPubSubConnectionPool    : 1 connections initialized for 111.230.32.147/111.230.32.147:9631
21:37:22:225  INFO 15704 --- [redisson-netty-2-19] o.r.c.pool.MasterConnectionPool          : 24 connections initialized for 111.230.32.147/111.230.32.147:9631
21:37:22:600 DEBUG 15704 --- [main] c.l.h.filter.RefreshTokenFilter          : Filter 'refreshTokenFilter' configured for use
21:37:23:628  INFO 15704 --- [main] o.s.c.openfeign.FeignClientFactoryBean   : For 'flask-service' URL not provided. Will try picking an instance via load-balancing.
21:37:23:988  INFO 15704 --- [main] o.s.c.openfeign.FeignClientFactoryBean   : For 'ai-doctor-service' URL not provided. Will try picking an instance via load-balancing.
21:37:25:784  WARN 15704 --- [main] iguration$LoadBalancerCaffeineWarnLogger : Spring Cloud LoadBalancer is currently working with the default cache. While this cache implementation is useful for development and tests, it's recommended to use Caffeine cache in production.You can switch to using Caffeine cache, by adding it and org.springframework.cache.caffeine.CaffeineCacheManager to the classpath.
21:37:25:789  INFO 15704 --- [main] o.s.b.a.e.web.EndpointLinksResolver      : Exposing 1 endpoint(s) beneath base path '/actuator'
21:37:25:881  INFO 15704 --- [main] o.s.b.w.embedded.tomcat.TomcatWebServer  : Tomcat started on port(s): 8080 (http) with context path ''
21:37:25:918  INFO 15704 --- [main] c.a.n.p.a.s.c.ClientAuthPluginManager    : [ClientAuthPluginManager] Load ClientAuthService com.alibaba.nacos.client.auth.impl.NacosClientAuthServiceImpl success.
21:37:25:919  INFO 15704 --- [main] c.a.n.p.a.s.c.ClientAuthPluginManager    : [ClientAuthPluginManager] Load ClientAuthService com.alibaba.nacos.client.auth.ram.RamClientAuthServiceImpl success.
21:37:26:970  INFO 15704 --- [main] c.a.n.c.a.AbstractAbilityControlManager  : Ready to get current node abilities...
21:37:26:972  INFO 15704 --- [main] c.a.n.c.a.AbstractAbilityControlManager  : Ready to initialize current node abilities, support modes: [SDK_CLIENT]
21:37:26:973  INFO 15704 --- [main] c.a.n.c.a.AbstractAbilityControlManager  : Initialize current abilities finish...
21:37:26:973  INFO 15704 --- [main] c.a.n.c.a.d.NacosAbilityManagerHolder    : [AbilityControlManager] Successfully initialize AbilityControlManager
21:37:27:070  INFO 15704 --- [main] c.a.c.n.registry.NacosServiceRegistry    : nacos registry, DEFAULT_GROUP his-service 10.21.93.70:8848 register finished
21:37:27:385  INFO 15704 --- [main] c.l.his_service.HisServiceApplication    : Started HisServiceApplication in 10.195 seconds (JVM running for 11.31)
21:37:27:565  INFO 15704 --- [RMI TCP Connection(3)-10.21.93.70] o.a.c.c.C.[Tomcat].[localhost].[/]       : Initializing Spring DispatcherServlet 'dispatcherServlet'
21:37:27:565  INFO 15704 --- [RMI TCP Connection(3)-10.21.93.70] o.s.web.servlet.DispatcherServlet        : Initializing Servlet 'dispatcherServlet'
21:37:27:567  INFO 15704 --- [RMI TCP Connection(3)-10.21.93.70] o.s.web.servlet.DispatcherServlet        : Completed initialization in 1 ms
21:37:27:570  INFO 15704 --- [RMI TCP Connection(2)-10.21.93.70] com.zaxxer.hikari.HikariDataSource       : HikariPool-1 - Starting...
21:37:28:174  INFO 15704 --- [RMI TCP Connection(2)-10.21.93.70] com.zaxxer.hikari.HikariDataSource       : HikariPool-1 - Start completed.
21:37:38:512 DEBUG 15704 --- [http-nio-8080-exec-2] c.l.h.m.D.selectById                     : ==>  Preparing: SELECT id,patient_id,doctor_id,disease_name,disease_category,aimodel_id,result,create_time,status,id_card,name,score,remark FROM diagnosis_report WHERE id=?
21:37:38:544 DEBUG 15704 --- [http-nio-8080-exec-2] c.l.h.m.D.selectById                     : ==> Parameters: 1(Integer)
21:37:38:614 DEBUG 15704 --- [http-nio-8080-exec-2] c.l.h.m.D.selectById                     : <==      Total: 1
21:37:38:616 DEBUG 15704 --- [http-nio-8080-exec-2] c.l.h.mapper.PatientMapper.selectById    : ==>  Preparing: SELECT id,phone,id_card,name,verified,verified_by,verified_time,open_id,hospital_pid FROM patient WHERE id=?
21:37:38:617 DEBUG 15704 --- [http-nio-8080-exec-2] c.l.h.mapper.PatientMapper.selectById    : ==> Parameters: 1(Integer)
21:37:38:652 DEBUG 15704 --- [http-nio-8080-exec-2] c.l.h.mapper.PatientMapper.selectById    : <==      Total: 1
21:37:38:654 DEBUG 15704 --- [http-nio-8080-exec-2] c.l.h.mapper.DoctorMapper.selectById     : ==>  Preparing: SELECT id,phone,id_card,name,verified,verified_by,verified_time,license,department,hospital_pid FROM doctor WHERE id=?
21:37:38:654 DEBUG 15704 --- [http-nio-8080-exec-2] c.l.h.mapper.DoctorMapper.selectById     : ==> Parameters: 1(Integer)
21:37:38:688 DEBUG 15704 --- [http-nio-8080-exec-2] c.l.h.mapper.DoctorMapper.selectById     : <==      Total: 1
21:37:38:691 DEBUG 15704 --- [http-nio-8080-exec-2] c.l.h.m.E.selectListByDiagnosisId        : ==>  Preparing: select * from eye_images where dignosis_report_id = ?
21:37:38:691 DEBUG 15704 --- [http-nio-8080-exec-2] c.l.h.m.E.selectListByDiagnosisId        : ==> Parameters: 1(Integer)
21:37:38:727 DEBUG 15704 --- [http-nio-8080-exec-2] c.l.h.m.E.selectListByDiagnosisId        : <==      Total: 1
21:37:38:727 DEBUG 15704 --- [http-nio-8080-exec-2] c.l.h.m.T.selectByDiagnosisId            : ==>  Preparing: select * from treatment_plans where diagnosis_id = ?
21:37:38:728 DEBUG 15704 --- [http-nio-8080-exec-2] c.l.h.m.T.selectByDiagnosisId            : ==> Parameters: 1(Integer)
21:37:38:762 DEBUG 15704 --- [http-nio-8080-exec-2] c.l.h.m.T.selectByDiagnosisId            : <==      Total: 1
21:37:38:762 DEBUG 15704 --- [http-nio-8080-exec-2] c.l.h.m.M.selectByDiagnosisId            : ==>  Preparing: select * from medication_recommendations where diagnosis_id = ?
21:37:38:763 DEBUG 15704 --- [http-nio-8080-exec-2] c.l.h.m.M.selectByDiagnosisId            : ==> Parameters: 1(Integer)
21:37:38:800 DEBUG 15704 --- [http-nio-8080-exec-2] c.l.h.m.M.selectByDiagnosisId            : <==      Total: 1
21:37:38:801 DEBUG 15704 --- [http-nio-8080-exec-2] c.l.h.mapper.AiModelMapper.selectById    : ==>  Preparing: SELECT id,version,deploy_time,accuracy FROM ai_model WHERE id=?
21:37:38:802 DEBUG 15704 --- [http-nio-8080-exec-2] c.l.h.mapper.AiModelMapper.selectById    : ==> Parameters: 1(Integer)
21:37:38:836 DEBUG 15704 --- [http-nio-8080-exec-2] c.l.h.mapper.AiModelMapper.selectById    : <==      Total: 1
21:37:38:874 DEBUG 15704 --- [http-nio-8080-exec-2] o.s.c.openfeign.support.SpringEncoder    : Writing [ChatForm(diagnosisName=, diagnosisCategory=, result=A, remark=A, treatmentPlan=TreatmentPlans(id=1, diagnosisId=1, treatmentType=1, treatmentDetail=, startTime=2025-03-01T09:00, endDate=2025-03-10T09:00, doctorId=1, createdTime=2025-03-01T09:00, updatedTime=2025-03-01T09:00), medications=[MedicationRecommendations(id=1, diagnosisId=1, medicationName=A, dosage=10mg, frequency=, sideEffects=, startTime=2025-03-01T09:00, endTime=2025-03-10T09:00, doctorId=1, createdTime=2025-03-01T09:00, updatedTime=2025-03-01T09:00)], previousConversations=[DialogueInfo(role=pariatur tempor do, content=sit cupidatat commodo)], question= , stream=false)] using [org.springframework.http.converter.json.MappingJackson2HttpMessageConverter@4bc41565]
21:37:38:893 DEBUG 15704 --- [http-nio-8080-exec-2] c.l.api.client.FlaskAiDoctorClient       : [FlaskAiDoctorClient#eye_doctor_chat] ---> POST http://ai-doctor-service/api/eye-doctor/chat HTTP/1.1
21:37:38:894 DEBUG 15704 --- [http-nio-8080-exec-2] c.l.api.client.FlaskAiDoctorClient       : [FlaskAiDoctorClient#eye_doctor_chat] Content-Length: 752
21:37:38:894 DEBUG 15704 --- [http-nio-8080-exec-2] c.l.api.client.FlaskAiDoctorClient       : [FlaskAiDoctorClient#eye_doctor_chat] Content-Type: application/json
21:37:38:894 DEBUG 15704 --- [http-nio-8080-exec-2] c.l.api.client.FlaskAiDoctorClient       : [FlaskAiDoctorClient#eye_doctor_chat] 
21:37:38:894 DEBUG 15704 --- [http-nio-8080-exec-2] c.l.api.client.FlaskAiDoctorClient       : [FlaskAiDoctorClient#eye_doctor_chat] {"disease_name":"","disease_category":"","result":"A","remark":"A","treatment_plan":{"id":1,"treatmentType":1,"treatmentDetail":"","startTime":"2025-03-01 09:00:00","endDate":"2025-03-10 09:00:00","doctorId":1,"createdTime":"2025-03-01T09:00:00","updatedTime":"2025-03-01T09:00:00"},"medications":[{"id":1,"diagnosisId":1,"medicationName":"A","dosage":"10mg","frequency":"","sideEffects":"","startTime":"2025-03-01T09:00:00","endTime":"2025-03-10T09:00:00","doctorId":1,"createdTime":"2025-03-01 09:00:00","updatedTime":"2025-03-01 09:00:00"}],"previous_conversations":[{"role":"pariatur tempor do","content":"sit cupidatat commodo"}],"question":" ","stream":false}
21:37:38:894 DEBUG 15704 --- [http-nio-8080-exec-2] c.l.api.client.FlaskAiDoctorClient       : [FlaskAiDoctorClient#eye_doctor_chat] ---> END HTTP (752-byte body)
21:38:21:187 DEBUG 15704 --- [http-nio-8080-exec-2] c.l.api.client.FlaskAiDoctorClient       : [FlaskAiDoctorClient#eye_doctor_chat] <--- HTTP/1.1 200 OK (42292ms)
21:38:21:188 DEBUG 15704 --- [http-nio-8080-exec-2] c.l.api.client.FlaskAiDoctorClient       : [FlaskAiDoctorClient#eye_doctor_chat] content-length: 888
21:38:21:188 DEBUG 15704 --- [http-nio-8080-exec-2] c.l.api.client.FlaskAiDoctorClient       : [FlaskAiDoctorClient#eye_doctor_chat] content-type: application/json
21:38:21:188 DEBUG 15704 --- [http-nio-8080-exec-2] c.l.api.client.FlaskAiDoctorClient       : [FlaskAiDoctorClient#eye_doctor_chat] date: Thu, 13 Mar 2025 13:37:38 GMT
21:38:21:188 DEBUG 15704 --- [http-nio-8080-exec-2] c.l.api.client.FlaskAiDoctorClient       : [FlaskAiDoctorClient#eye_doctor_chat] server: uvicorn
21:38:21:188 DEBUG 15704 --- [http-nio-8080-exec-2] c.l.api.client.FlaskAiDoctorClient       : [FlaskAiDoctorClient#eye_doctor_chat] 
21:38:21:189 DEBUG 15704 --- [http-nio-8080-exec-2] c.l.api.client.FlaskAiDoctorClient       : [FlaskAiDoctorClient#eye_doctor_chat] {"response_id":"dd8356d8-44a5-4197-9d31-2cbc4994ccf1","content":"  \n1?? ****  \n2?? **A**  \n3?? **A**  \n4?? ** 10mg bid**  \n\n  \n\n??   \n-   \n- \"\"  \n-   \n\n ???","references":[],"created_at":"2025-03-13T13:38:21.163998+00:00"}
21:38:21:190 DEBUG 15704 --- [http-nio-8080-exec-2] c.l.api.client.FlaskAiDoctorClient       : [FlaskAiDoctorClient#eye_doctor_chat] <--- END HTTP (888-byte body)
21:55:19:004  WARN 15704 --- [Thread-18] c.a.n.common.http.HttpClientBeanHolder   : [HttpClientBeanHolder] Start destroying common HttpClient
21:55:19:004  WARN 15704 --- [Thread-15] c.a.nacos.common.notify.NotifyCenter     : [NotifyCenter] Start destroying Publisher
21:55:19:043  WARN 15704 --- [Thread-15] c.a.nacos.common.notify.NotifyCenter     : [NotifyCenter] Destruction of the end
21:55:19:064  WARN 15704 --- [Thread-18] c.a.n.common.http.HttpClientBeanHolder   : [HttpClientBeanHolder] Destruction of the end
21:55:19:318  INFO 15704 --- [SpringApplicationShutdownHook] c.a.c.n.registry.NacosServiceRegistry    : De-registering from Nacos Server now...
21:55:19:381  INFO 15704 --- [SpringApplicationShutdownHook] c.a.c.n.registry.NacosServiceRegistry    : De-registration finished.
21:55:19:444  INFO 15704 --- [SpringApplicationShutdownHook] com.zaxxer.hikari.HikariDataSource       : HikariPool-1 - Shutdown initiated...
21:55:19:769  INFO 15704 --- [SpringApplicationShutdownHook] com.zaxxer.hikari.HikariDataSource       : HikariPool-1 - Shutdown completed.
21:55:29:005  INFO 26208 --- [main] c.l.his_service.HisServiceApplication    : Starting HisServiceApplication using Java 17.0.11 on luo with PID 26208 (A:\Desktop\workspace\HIS\his_service\target\classes started by 22407 in A:\Desktop\workspace\HIS)
21:55:29:006 DEBUG 26208 --- [main] c.l.his_service.HisServiceApplication    : Running with Spring Boot v2.7.12, Spring v5.3.27
21:55:29:007  INFO 26208 --- [main] c.l.his_service.HisServiceApplication    : The following 1 profile is active: "dev"
21:55:30:357 DEBUG 26208 --- [main] o.s.c.openfeign.FeignClientsRegistrar$1  : Identified candidate component class: file [A:\Desktop\workspace\HIS\his_api\target\classes\com\luojiawei\api\client\FlaskAiDoctorClient.class]
21:55:30:360 DEBUG 26208 --- [main] o.s.c.openfeign.FeignClientsRegistrar$1  : Identified candidate component class: file [A:\Desktop\workspace\HIS\his_api\target\classes\com\luojiawei\api\client\FlaskModelAnalyzeClient.class]
21:55:30:362 DEBUG 26208 --- [main] o.s.c.openfeign.FeignClientsRegistrar$1  : Identified candidate component class: file [A:\Desktop\workspace\HIS\his_api\target\classes\com\luojiawei\api\client\FlaskUploadClient.class]
21:55:30:902  INFO 26208 --- [main] .s.d.r.c.RepositoryConfigurationDelegate : Multiple Spring Data modules found, entering strict repository configuration mode
21:55:30:905  INFO 26208 --- [main] .s.d.r.c.RepositoryConfigurationDelegate : Bootstrapping Spring Data Redis repositories in DEFAULT mode.
21:55:30:940  INFO 26208 --- [main] .s.d.r.c.RepositoryConfigurationDelegate : Finished Spring Data repository scanning in 18 ms. Found 0 Redis repository interfaces.
21:55:31:368  INFO 26208 --- [main] o.s.cloud.context.scope.GenericScope     : BeanFactory id=15115e6d-eb61-304d-ae7c-b74e3e436bbc
21:55:32:163  INFO 26208 --- [main] o.s.b.w.embedded.tomcat.TomcatWebServer  : Tomcat initialized with port(s): 8080 (http)
21:55:32:176  INFO 26208 --- [main] o.apache.catalina.core.StandardService   : Starting service [Tomcat]
21:55:32:177  INFO 26208 --- [main] org.apache.catalina.core.StandardEngine  : Starting Servlet engine: [Apache Tomcat/9.0.75]
21:55:32:363  INFO 26208 --- [main] o.a.c.c.C.[Tomcat].[localhost].[/]       : Initializing Spring embedded WebApplicationContext
21:55:32:364  INFO 26208 --- [main] w.s.c.ServletWebServerApplicationContext : Root WebApplicationContext: initialization completed in 3284 ms
21:55:32:823  INFO 26208 --- [main] org.redisson.Version                     : Redisson 3.17.7
21:55:33:278  INFO 26208 --- [redisson-netty-2-9] o.r.c.pool.MasterPubSubConnectionPool    : 1 connections initialized for 111.230.32.147/111.230.32.147:9631
21:55:33:983  INFO 26208 --- [redisson-netty-2-19] o.r.c.pool.MasterConnectionPool          : 24 connections initialized for 111.230.32.147/111.230.32.147:9631
21:55:34:380 DEBUG 26208 --- [main] c.l.h.filter.RefreshTokenFilter          : Filter 'refreshTokenFilter' configured for use
21:55:35:369  INFO 26208 --- [main] o.s.c.openfeign.FeignClientFactoryBean   : For 'flask-service' URL not provided. Will try picking an instance via load-balancing.
21:55:35:765  INFO 26208 --- [main] o.s.c.openfeign.FeignClientFactoryBean   : For 'ai-doctor-service' URL not provided. Will try picking an instance via load-balancing.
21:55:37:574  WARN 26208 --- [main] iguration$LoadBalancerCaffeineWarnLogger : Spring Cloud LoadBalancer is currently working with the default cache. While this cache implementation is useful for development and tests, it's recommended to use Caffeine cache in production.You can switch to using Caffeine cache, by adding it and org.springframework.cache.caffeine.CaffeineCacheManager to the classpath.
21:55:37:583  INFO 26208 --- [main] o.s.b.a.e.web.EndpointLinksResolver      : Exposing 1 endpoint(s) beneath base path '/actuator'
21:55:37:712  INFO 26208 --- [main] o.s.b.w.embedded.tomcat.TomcatWebServer  : Tomcat started on port(s): 8080 (http) with context path ''
21:55:37:778  INFO 26208 --- [main] c.a.n.p.a.s.c.ClientAuthPluginManager    : [ClientAuthPluginManager] Load ClientAuthService com.alibaba.nacos.client.auth.impl.NacosClientAuthServiceImpl success.
21:55:37:780  INFO 26208 --- [main] c.a.n.p.a.s.c.ClientAuthPluginManager    : [ClientAuthPluginManager] Load ClientAuthService com.alibaba.nacos.client.auth.ram.RamClientAuthServiceImpl success.
21:55:40:145  INFO 26208 --- [main] c.a.n.c.a.AbstractAbilityControlManager  : Ready to get current node abilities...
21:55:40:146  INFO 26208 --- [main] c.a.n.c.a.AbstractAbilityControlManager  : Ready to initialize current node abilities, support modes: [SDK_CLIENT]
21:55:40:147  INFO 26208 --- [main] c.a.n.c.a.AbstractAbilityControlManager  : Initialize current abilities finish...
21:55:40:148  INFO 26208 --- [main] c.a.n.c.a.d.NacosAbilityManagerHolder    : [AbilityControlManager] Successfully initialize AbilityControlManager
21:55:40:278  INFO 26208 --- [main] c.a.c.n.registry.NacosServiceRegistry    : nacos registry, DEFAULT_GROUP his-service 10.21.93.70:8848 register finished
21:55:40:662  INFO 26208 --- [main] c.l.his_service.HisServiceApplication    : Started HisServiceApplication in 12.853 seconds (JVM running for 14.397)
21:55:40:938  INFO 26208 --- [RMI TCP Connection(3)-10.21.93.70] o.a.c.c.C.[Tomcat].[localhost].[/]       : Initializing Spring DispatcherServlet 'dispatcherServlet'
21:55:40:938  INFO 26208 --- [RMI TCP Connection(3)-10.21.93.70] o.s.web.servlet.DispatcherServlet        : Initializing Servlet 'dispatcherServlet'
21:55:40:940  INFO 26208 --- [RMI TCP Connection(3)-10.21.93.70] o.s.web.servlet.DispatcherServlet        : Completed initialization in 2 ms
21:55:40:944  INFO 26208 --- [RMI TCP Connection(1)-10.21.93.70] com.zaxxer.hikari.HikariDataSource       : HikariPool-1 - Starting...
21:55:41:694  INFO 26208 --- [RMI TCP Connection(1)-10.21.93.70] com.zaxxer.hikari.HikariDataSource       : HikariPool-1 - Start completed.
22:04:35:826  WARN 26208 --- [Thread-18] c.a.n.common.http.HttpClientBeanHolder   : [HttpClientBeanHolder] Start destroying common HttpClient
22:04:35:826  WARN 26208 --- [Thread-15] c.a.nacos.common.notify.NotifyCenter     : [NotifyCenter] Start destroying Publisher
22:04:35:826  WARN 26208 --- [Thread-15] c.a.nacos.common.notify.NotifyCenter     : [NotifyCenter] Destruction of the end
22:04:35:830  WARN 26208 --- [Thread-18] c.a.n.common.http.HttpClientBeanHolder   : [HttpClientBeanHolder] Destruction of the end
22:04:35:920  INFO 26208 --- [SpringApplicationShutdownHook] c.a.c.n.registry.NacosServiceRegistry    : De-registering from Nacos Server now...
22:04:35:955  INFO 26208 --- [SpringApplicationShutdownHook] c.a.c.n.registry.NacosServiceRegistry    : De-registration finished.
22:04:36:013  INFO 26208 --- [SpringApplicationShutdownHook] com.zaxxer.hikari.HikariDataSource       : HikariPool-1 - Shutdown initiated...
22:04:36:325  INFO 26208 --- [SpringApplicationShutdownHook] com.zaxxer.hikari.HikariDataSource       : HikariPool-1 - Shutdown completed.
22:04:46:350  INFO 35372 --- [main] c.l.his_service.HisServiceApplication    : Starting HisServiceApplication using Java 17.0.11 on luo with PID 35372 (A:\Desktop\workspace\HIS\his_service\target\classes started by 22407 in A:\Desktop\workspace\HIS)
22:04:46:351 DEBUG 35372 --- [main] c.l.his_service.HisServiceApplication    : Running with Spring Boot v2.7.12, Spring v5.3.27
22:04:46:352  INFO 35372 --- [main] c.l.his_service.HisServiceApplication    : The following 1 profile is active: "dev"
22:04:47:278 DEBUG 35372 --- [main] o.s.c.openfeign.FeignClientsRegistrar$1  : Identified candidate component class: file [A:\Desktop\workspace\HIS\his_api\target\classes\com\luojiawei\api\client\FlaskAiDoctorClient.class]
22:04:47:279 DEBUG 35372 --- [main] o.s.c.openfeign.FeignClientsRegistrar$1  : Identified candidate component class: file [A:\Desktop\workspace\HIS\his_api\target\classes\com\luojiawei\api\client\FlaskModelAnalyzeClient.class]
22:04:47:280 DEBUG 35372 --- [main] o.s.c.openfeign.FeignClientsRegistrar$1  : Identified candidate component class: file [A:\Desktop\workspace\HIS\his_api\target\classes\com\luojiawei\api\client\FlaskUploadClient.class]
22:04:47:600  INFO 35372 --- [main] .s.d.r.c.RepositoryConfigurationDelegate : Multiple Spring Data modules found, entering strict repository configuration mode
22:04:47:603  INFO 35372 --- [main] .s.d.r.c.RepositoryConfigurationDelegate : Bootstrapping Spring Data Redis repositories in DEFAULT mode.
22:04:47:637  INFO 35372 --- [main] .s.d.r.c.RepositoryConfigurationDelegate : Finished Spring Data repository scanning in 19 ms. Found 0 Redis repository interfaces.
22:04:48:005  INFO 35372 --- [main] o.s.cloud.context.scope.GenericScope     : BeanFactory id=15115e6d-eb61-304d-ae7c-b74e3e436bbc
22:04:49:878  INFO 35372 --- [main] o.s.b.w.embedded.tomcat.TomcatWebServer  : Tomcat initialized with port(s): 8080 (http)
22:04:49:920  INFO 35372 --- [main] o.apache.catalina.core.StandardService   : Starting service [Tomcat]
22:04:49:920  INFO 35372 --- [main] org.apache.catalina.core.StandardEngine  : Starting Servlet engine: [Apache Tomcat/9.0.75]
22:04:50:279  INFO 35372 --- [main] o.a.c.c.C.[Tomcat].[localhost].[/]       : Initializing Spring embedded WebApplicationContext
22:04:50:280  INFO 35372 --- [main] w.s.c.ServletWebServerApplicationContext : Root WebApplicationContext: initialization completed in 3866 ms
22:04:51:001  INFO 35372 --- [main] org.redisson.Version                     : Redisson 3.17.7
22:04:51:558  INFO 35372 --- [redisson-netty-2-9] o.r.c.pool.MasterPubSubConnectionPool    : 1 connections initialized for 111.230.32.147/111.230.32.147:9631
22:04:52:255  INFO 35372 --- [redisson-netty-2-19] o.r.c.pool.MasterConnectionPool          : 24 connections initialized for 111.230.32.147/111.230.32.147:9631
22:04:52:595 DEBUG 35372 --- [main] c.l.h.filter.RefreshTokenFilter          : Filter 'refreshTokenFilter' configured for use
22:04:53:719  INFO 35372 --- [main] o.s.c.openfeign.FeignClientFactoryBean   : For 'flask-service' URL not provided. Will try picking an instance via load-balancing.
22:04:54:086  INFO 35372 --- [main] o.s.c.openfeign.FeignClientFactoryBean   : For 'ai-doctor-service' URL not provided. Will try picking an instance via load-balancing.
22:04:55:910  WARN 35372 --- [main] iguration$LoadBalancerCaffeineWarnLogger : Spring Cloud LoadBalancer is currently working with the default cache. While this cache implementation is useful for development and tests, it's recommended to use Caffeine cache in production.You can switch to using Caffeine cache, by adding it and org.springframework.cache.caffeine.CaffeineCacheManager to the classpath.
22:04:55:914  INFO 35372 --- [main] o.s.b.a.e.web.EndpointLinksResolver      : Exposing 1 endpoint(s) beneath base path '/actuator'
22:04:56:023  INFO 35372 --- [main] o.s.b.w.embedded.tomcat.TomcatWebServer  : Tomcat started on port(s): 8080 (http) with context path ''
22:04:56:085  INFO 35372 --- [main] c.a.n.p.a.s.c.ClientAuthPluginManager    : [ClientAuthPluginManager] Load ClientAuthService com.alibaba.nacos.client.auth.impl.NacosClientAuthServiceImpl success.
22:04:56:085  INFO 35372 --- [main] c.a.n.p.a.s.c.ClientAuthPluginManager    : [ClientAuthPluginManager] Load ClientAuthService com.alibaba.nacos.client.auth.ram.RamClientAuthServiceImpl success.
22:04:57:076  INFO 35372 --- [http-nio-8080-exec-2] o.a.c.c.C.[Tomcat].[localhost].[/]       : Initializing Spring DispatcherServlet 'dispatcherServlet'
22:04:57:076  INFO 35372 --- [http-nio-8080-exec-2] o.s.web.servlet.DispatcherServlet        : Initializing Servlet 'dispatcherServlet'
22:04:57:079  INFO 35372 --- [http-nio-8080-exec-2] o.s.web.servlet.DispatcherServlet        : Completed initialization in 3 ms
22:04:57:455 ERROR 35372 --- [http-nio-8080-exec-2] o.a.c.c.C.[.[.[/].[dispatcherServlet]    : Servlet.service() for servlet [dispatcherServlet] in context with path [] threw exception [Request processing failed; nested exception is java.lang.NullPointerException: Cannot invoke "java.util.ArrayList.add(Object)" because the return value of "com.luojiawei.common.domain.vo.RecommendedQuestions.getQuestions()" is null] with root cause

java.lang.NullPointerException: Cannot invoke "java.util.ArrayList.add(Object)" because the return value of "com.luojiawei.common.domain.vo.RecommendedQuestions.getQuestions()" is null
	at com.luojiawei.his_service.controller.DiagnosisReportController.getQuestions(DiagnosisReportController.java:59) ~[classes/:na]
	at java.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke0(Native Method) ~[na:na]
	at java.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:77) ~[na:na]
	at java.base/jdk.internal.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43) ~[na:na]
	at java.base/java.lang.reflect.Method.invoke(Method.java:568) ~[na:na]
	at org.springframework.web.method.support.InvocableHandlerMethod.doInvoke(InvocableHandlerMethod.java:205) ~[spring-web-5.3.27.jar:5.3.27]
	at org.springframework.web.method.support.InvocableHandlerMethod.invokeForRequest(InvocableHandlerMethod.java:150) ~[spring-web-5.3.27.jar:5.3.27]
	at org.springframework.web.servlet.mvc.method.annotation.ServletInvocableHandlerMethod.invokeAndHandle(ServletInvocableHandlerMethod.java:117) ~[spring-webmvc-5.3.27.jar:5.3.27]
	at org.springframework.web.servlet.mvc.method.annotation.RequestMappingHandlerAdapter.invokeHandlerMethod(RequestMappingHandlerAdapter.java:895) ~[spring-webmvc-5.3.27.jar:5.3.27]
	at org.springframework.web.servlet.mvc.method.annotation.RequestMappingHandlerAdapter.handleInternal(RequestMappingHandlerAdapter.java:808) ~[spring-webmvc-5.3.27.jar:5.3.27]
	at org.springframework.web.servlet.mvc.method.AbstractHandlerMethodAdapter.handle(AbstractHandlerMethodAdapter.java:87) ~[spring-webmvc-5.3.27.jar:5.3.27]
	at org.springframework.web.servlet.DispatcherServlet.doDispatch(DispatcherServlet.java:1072) ~[spring-webmvc-5.3.27.jar:5.3.27]
	at org.springframework.web.servlet.DispatcherServlet.doService(DispatcherServlet.java:965) ~[spring-webmvc-5.3.27.jar:5.3.27]
	at org.springframework.web.servlet.FrameworkServlet.processRequest(FrameworkServlet.java:1006) ~[spring-webmvc-5.3.27.jar:5.3.27]
	at org.springframework.web.servlet.FrameworkServlet.doGet(FrameworkServlet.java:898) ~[spring-webmvc-5.3.27.jar:5.3.27]
	at javax.servlet.http.HttpServlet.service(HttpServlet.java:529) ~[tomcat-embed-core-9.0.75.jar:4.0.FR]
	at org.springframework.web.servlet.FrameworkServlet.service(FrameworkServlet.java:883) ~[spring-webmvc-5.3.27.jar:5.3.27]
	at javax.servlet.http.HttpServlet.service(HttpServlet.java:623) ~[tomcat-embed-core-9.0.75.jar:4.0.FR]
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:209) ~[tomcat-embed-core-9.0.75.jar:9.0.75]
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:153) ~[tomcat-embed-core-9.0.75.jar:9.0.75]
	at com.luojiawei.his_service.filter.RefreshTokenFilter.doFilterInternal(RefreshTokenFilter.java:58) ~[classes/:na]
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:117) ~[spring-web-5.3.27.jar:5.3.27]
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:178) ~[tomcat-embed-core-9.0.75.jar:9.0.75]
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:153) ~[tomcat-embed-core-9.0.75.jar:9.0.75]
	at org.springframework.web.filter.RequestContextFilter.doFilterInternal(RequestContextFilter.java:100) ~[spring-web-5.3.27.jar:5.3.27]
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:117) ~[spring-web-5.3.27.jar:5.3.27]
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:178) ~[tomcat-embed-core-9.0.75.jar:9.0.75]
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:153) ~[tomcat-embed-core-9.0.75.jar:9.0.75]
	at org.springframework.web.filter.FormContentFilter.doFilterInternal(FormContentFilter.java:93) ~[spring-web-5.3.27.jar:5.3.27]
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:117) ~[spring-web-5.3.27.jar:5.3.27]
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:178) ~[tomcat-embed-core-9.0.75.jar:9.0.75]
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:153) ~[tomcat-embed-core-9.0.75.jar:9.0.75]
	at org.springframework.boot.actuate.metrics.web.servlet.WebMvcMetricsFilter.doFilterInternal(WebMvcMetricsFilter.java:96) ~[spring-boot-actuator-2.7.12.jar:2.7.12]
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:117) ~[spring-web-5.3.27.jar:5.3.27]
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:178) ~[tomcat-embed-core-9.0.75.jar:9.0.75]
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:153) ~[tomcat-embed-core-9.0.75.jar:9.0.75]
	at org.springframework.web.filter.CharacterEncodingFilter.doFilterInternal(CharacterEncodingFilter.java:201) ~[spring-web-5.3.27.jar:5.3.27]
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:117) ~[spring-web-5.3.27.jar:5.3.27]
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:178) ~[tomcat-embed-core-9.0.75.jar:9.0.75]
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:153) ~[tomcat-embed-core-9.0.75.jar:9.0.75]
	at org.apache.catalina.core.StandardWrapperValve.invoke(StandardWrapperValve.java:167) ~[tomcat-embed-core-9.0.75.jar:9.0.75]
	at org.apache.catalina.core.StandardContextValve.invoke(StandardContextValve.java:90) ~[tomcat-embed-core-9.0.75.jar:9.0.75]
	at org.apache.catalina.authenticator.AuthenticatorBase.invoke(AuthenticatorBase.java:481) ~[tomcat-embed-core-9.0.75.jar:9.0.75]
	at org.apache.catalina.core.StandardHostValve.invoke(StandardHostValve.java:130) ~[tomcat-embed-core-9.0.75.jar:9.0.75]
	at org.apache.catalina.valves.ErrorReportValve.invoke(ErrorReportValve.java:93) ~[tomcat-embed-core-9.0.75.jar:9.0.75]
	at org.apache.catalina.core.StandardEngineValve.invoke(StandardEngineValve.java:74) ~[tomcat-embed-core-9.0.75.jar:9.0.75]
	at org.apache.catalina.connector.CoyoteAdapter.service(CoyoteAdapter.java:343) ~[tomcat-embed-core-9.0.75.jar:9.0.75]
	at org.apache.coyote.http11.Http11Processor.service(Http11Processor.java:390) ~[tomcat-embed-core-9.0.75.jar:9.0.75]
	at org.apache.coyote.AbstractProcessorLight.process(AbstractProcessorLight.java:63) ~[tomcat-embed-core-9.0.75.jar:9.0.75]
	at org.apache.coyote.AbstractProtocol$ConnectionHandler.process(AbstractProtocol.java:926) ~[tomcat-embed-core-9.0.75.jar:9.0.75]
	at org.apache.tomcat.util.net.NioEndpoint$SocketProcessor.doRun(NioEndpoint.java:1791) ~[tomcat-embed-core-9.0.75.jar:9.0.75]
	at org.apache.tomcat.util.net.SocketProcessorBase.run(SocketProcessorBase.java:52) ~[tomcat-embed-core-9.0.75.jar:9.0.75]
	at org.apache.tomcat.util.threads.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1191) ~[tomcat-embed-core-9.0.75.jar:9.0.75]
	at org.apache.tomcat.util.threads.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:659) ~[tomcat-embed-core-9.0.75.jar:9.0.75]
	at org.apache.tomcat.util.threads.TaskThread$WrappingRunnable.run(TaskThread.java:61) ~[tomcat-embed-core-9.0.75.jar:9.0.75]
	at java.base/java.lang.Thread.run(Thread.java:840) ~[na:na]

22:04:58:537  INFO 35372 --- [main] c.a.n.c.a.AbstractAbilityControlManager  : Ready to get current node abilities...
22:04:58:538  INFO 35372 --- [main] c.a.n.c.a.AbstractAbilityControlManager  : Ready to initialize current node abilities, support modes: [SDK_CLIENT]
22:04:58:539  INFO 35372 --- [main] c.a.n.c.a.AbstractAbilityControlManager  : Initialize current abilities finish...
22:04:58:540  INFO 35372 --- [main] c.a.n.c.a.d.NacosAbilityManagerHolder    : [AbilityControlManager] Successfully initialize AbilityControlManager
22:04:58:638  INFO 35372 --- [main] c.a.c.n.registry.NacosServiceRegistry    : nacos registry, DEFAULT_GROUP his-service 10.21.93.70:8848 register finished
22:04:58:941  INFO 35372 --- [main] c.l.his_service.HisServiceApplication    : Started HisServiceApplication in 13.767 seconds (JVM running for 15.151)
22:04:59:440  INFO 35372 --- [RMI TCP Connection(4)-10.21.93.70] com.zaxxer.hikari.HikariDataSource       : HikariPool-1 - Starting...
22:05:00:078  INFO 35372 --- [RMI TCP Connection(4)-10.21.93.70] com.zaxxer.hikari.HikariDataSource       : HikariPool-1 - Start completed.
22:07:37:509  WARN 35372 --- [HikariPool-1 housekeeper] com.zaxxer.hikari.pool.HikariPool        : HikariPool-1 - Thread starvation or clock leap detected (housekeeper delta=2m7s318ms251?s600ns).
22:07:37:519 ERROR 35372 --- [http-nio-8080-exec-3] o.a.c.c.C.[.[.[/].[dispatcherServlet]    : Servlet.service() for servlet [dispatcherServlet] in context with path [] threw exception [Request processing failed; nested exception is java.lang.NullPointerException: Cannot invoke "java.util.ArrayList.add(Object)" because the return value of "com.luojiawei.common.domain.vo.RecommendedQuestions.getQuestions()" is null] with root cause

java.lang.NullPointerException: Cannot invoke "java.util.ArrayList.add(Object)" because the return value of "com.luojiawei.common.domain.vo.RecommendedQuestions.getQuestions()" is null
	at com.luojiawei.his_service.controller.DiagnosisReportController.getQuestions(DiagnosisReportController.java:59) ~[classes/:na]
	at java.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke0(Native Method) ~[na:na]
	at java.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:77) ~[na:na]
	at java.base/jdk.internal.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43) ~[na:na]
	at java.base/java.lang.reflect.Method.invoke(Method.java:568) ~[na:na]
	at org.springframework.web.method.support.InvocableHandlerMethod.doInvoke(InvocableHandlerMethod.java:205) ~[spring-web-5.3.27.jar:5.3.27]
	at org.springframework.web.method.support.InvocableHandlerMethod.invokeForRequest(InvocableHandlerMethod.java:150) ~[spring-web-5.3.27.jar:5.3.27]
	at org.springframework.web.servlet.mvc.method.annotation.ServletInvocableHandlerMethod.invokeAndHandle(ServletInvocableHandlerMethod.java:117) ~[spring-webmvc-5.3.27.jar:5.3.27]
	at org.springframework.web.servlet.mvc.method.annotation.RequestMappingHandlerAdapter.invokeHandlerMethod(RequestMappingHandlerAdapter.java:895) ~[spring-webmvc-5.3.27.jar:5.3.27]
	at org.springframework.web.servlet.mvc.method.annotation.RequestMappingHandlerAdapter.handleInternal(RequestMappingHandlerAdapter.java:808) ~[spring-webmvc-5.3.27.jar:5.3.27]
	at org.springframework.web.servlet.mvc.method.AbstractHandlerMethodAdapter.handle(AbstractHandlerMethodAdapter.java:87) ~[spring-webmvc-5.3.27.jar:5.3.27]
	at org.springframework.web.servlet.DispatcherServlet.doDispatch(DispatcherServlet.java:1072) ~[spring-webmvc-5.3.27.jar:5.3.27]
	at org.springframework.web.servlet.DispatcherServlet.doService(DispatcherServlet.java:965) ~[spring-webmvc-5.3.27.jar:5.3.27]
	at org.springframework.web.servlet.FrameworkServlet.processRequest(FrameworkServlet.java:1006) ~[spring-webmvc-5.3.27.jar:5.3.27]
	at org.springframework.web.servlet.FrameworkServlet.doGet(FrameworkServlet.java:898) ~[spring-webmvc-5.3.27.jar:5.3.27]
	at javax.servlet.http.HttpServlet.service(HttpServlet.java:529) ~[tomcat-embed-core-9.0.75.jar:4.0.FR]
	at org.springframework.web.servlet.FrameworkServlet.service(FrameworkServlet.java:883) ~[spring-webmvc-5.3.27.jar:5.3.27]
	at javax.servlet.http.HttpServlet.service(HttpServlet.java:623) ~[tomcat-embed-core-9.0.75.jar:4.0.FR]
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:209) ~[tomcat-embed-core-9.0.75.jar:9.0.75]
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:153) ~[tomcat-embed-core-9.0.75.jar:9.0.75]
	at com.luojiawei.his_service.filter.RefreshTokenFilter.doFilterInternal(RefreshTokenFilter.java:58) ~[classes/:na]
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:117) ~[spring-web-5.3.27.jar:5.3.27]
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:178) ~[tomcat-embed-core-9.0.75.jar:9.0.75]
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:153) ~[tomcat-embed-core-9.0.75.jar:9.0.75]
	at org.springframework.web.filter.RequestContextFilter.doFilterInternal(RequestContextFilter.java:100) ~[spring-web-5.3.27.jar:5.3.27]
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:117) ~[spring-web-5.3.27.jar:5.3.27]
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:178) ~[tomcat-embed-core-9.0.75.jar:9.0.75]
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:153) ~[tomcat-embed-core-9.0.75.jar:9.0.75]
	at org.springframework.web.filter.FormContentFilter.doFilterInternal(FormContentFilter.java:93) ~[spring-web-5.3.27.jar:5.3.27]
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:117) ~[spring-web-5.3.27.jar:5.3.27]
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:178) ~[tomcat-embed-core-9.0.75.jar:9.0.75]
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:153) ~[tomcat-embed-core-9.0.75.jar:9.0.75]
	at org.springframework.boot.actuate.metrics.web.servlet.WebMvcMetricsFilter.doFilterInternal(WebMvcMetricsFilter.java:96) ~[spring-boot-actuator-2.7.12.jar:2.7.12]
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:117) ~[spring-web-5.3.27.jar:5.3.27]
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:178) ~[tomcat-embed-core-9.0.75.jar:9.0.75]
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:153) ~[tomcat-embed-core-9.0.75.jar:9.0.75]
	at org.springframework.web.filter.CharacterEncodingFilter.doFilterInternal(CharacterEncodingFilter.java:201) ~[spring-web-5.3.27.jar:5.3.27]
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:117) ~[spring-web-5.3.27.jar:5.3.27]
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:178) ~[tomcat-embed-core-9.0.75.jar:9.0.75]
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:153) ~[tomcat-embed-core-9.0.75.jar:9.0.75]
	at org.apache.catalina.core.StandardWrapperValve.invoke(StandardWrapperValve.java:167) ~[tomcat-embed-core-9.0.75.jar:9.0.75]
	at org.apache.catalina.core.StandardContextValve.invoke(StandardContextValve.java:90) ~[tomcat-embed-core-9.0.75.jar:9.0.75]
	at org.apache.catalina.authenticator.AuthenticatorBase.invoke(AuthenticatorBase.java:481) ~[tomcat-embed-core-9.0.75.jar:9.0.75]
	at org.apache.catalina.core.StandardHostValve.invoke(StandardHostValve.java:130) ~[tomcat-embed-core-9.0.75.jar:9.0.75]
	at org.apache.catalina.valves.ErrorReportValve.invoke(ErrorReportValve.java:93) ~[tomcat-embed-core-9.0.75.jar:9.0.75]
	at org.apache.catalina.core.StandardEngineValve.invoke(StandardEngineValve.java:74) ~[tomcat-embed-core-9.0.75.jar:9.0.75]
	at org.apache.catalina.connector.CoyoteAdapter.service(CoyoteAdapter.java:343) ~[tomcat-embed-core-9.0.75.jar:9.0.75]
	at org.apache.coyote.http11.Http11Processor.service(Http11Processor.java:390) ~[tomcat-embed-core-9.0.75.jar:9.0.75]
	at org.apache.coyote.AbstractProcessorLight.process(AbstractProcessorLight.java:63) ~[tomcat-embed-core-9.0.75.jar:9.0.75]
	at org.apache.coyote.AbstractProtocol$ConnectionHandler.process(AbstractProtocol.java:926) ~[tomcat-embed-core-9.0.75.jar:9.0.75]
	at org.apache.tomcat.util.net.NioEndpoint$SocketProcessor.doRun(NioEndpoint.java:1791) ~[tomcat-embed-core-9.0.75.jar:9.0.75]
	at org.apache.tomcat.util.net.SocketProcessorBase.run(SocketProcessorBase.java:52) ~[tomcat-embed-core-9.0.75.jar:9.0.75]
	at org.apache.tomcat.util.threads.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1191) ~[tomcat-embed-core-9.0.75.jar:9.0.75]
	at org.apache.tomcat.util.threads.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:659) ~[tomcat-embed-core-9.0.75.jar:9.0.75]
	at org.apache.tomcat.util.threads.TaskThread$WrappingRunnable.run(TaskThread.java:61) ~[tomcat-embed-core-9.0.75.jar:9.0.75]
	at java.base/java.lang.Thread.run(Thread.java:840) ~[na:na]

22:07:37:611  WARN 35372 --- [Thread-18] c.a.n.common.http.HttpClientBeanHolder   : [HttpClientBeanHolder] Start destroying common HttpClient
22:07:37:612  WARN 35372 --- [Thread-15] c.a.nacos.common.notify.NotifyCenter     : [NotifyCenter] Start destroying Publisher
22:07:37:612  WARN 35372 --- [Thread-15] c.a.nacos.common.notify.NotifyCenter     : [NotifyCenter] Destruction of the end
22:07:37:613  WARN 35372 --- [Thread-18] c.a.n.common.http.HttpClientBeanHolder   : [HttpClientBeanHolder] Destruction of the end
22:07:37:698  INFO 35372 --- [SpringApplicationShutdownHook] c.a.c.n.registry.NacosServiceRegistry    : De-registering from Nacos Server now...
22:07:38:165 ERROR 35372 --- [SpringApplicationShutdownHook] c.a.c.n.registry.NacosServiceRegistry    : ERR_NACOS_DEREGISTER, de-register failed...NacosRegistration{nacosDiscoveryProperties=NacosDiscoveryProperties{serverAddr='81.71.3.20', username='', password='', endpoint='', namespace='', watchDelay=30000, logName='', service='his-service', weight=1.0, clusterName='DEFAULT', group='DEFAULT_GROUP', namingLoadCacheAtStart='false', metadata={IPv6=null, preserved.register.source=SPRING_CLOUD}, registerEnabled=true, ip='10.21.93.70', networkInterface='', port=8848, secure=false, accessKey='', secretKey='', heartBeatInterval=null, heartBeatTimeout=null, ipDeleteTimeout=null, instanceEnabled=true, ephemeral=true, failureToleranceEnabled=false}, ipDeleteTimeout=null, failFast=true}},

com.alibaba.nacos.api.exception.NacosException: Client not connected, current status:UNHEALTHY
	at com.alibaba.nacos.common.remote.client.RpcClient.request(RpcClient.java:647) ~[nacos-client-2.3.0.jar:na]
	at com.alibaba.nacos.common.remote.client.RpcClient.request(RpcClient.java:626) ~[nacos-client-2.3.0.jar:na]
	at com.alibaba.nacos.client.naming.remote.gprc.NamingGrpcClientProxy.requestToServer(NamingGrpcClientProxy.java:450) ~[nacos-client-2.3.0.jar:na]
	at com.alibaba.nacos.client.naming.remote.gprc.NamingGrpcClientProxy.doDeregisterService(NamingGrpcClientProxy.java:304) ~[nacos-client-2.3.0.jar:na]
	at com.alibaba.nacos.client.naming.remote.gprc.NamingGrpcClientProxy.deregisterServiceForEphemeral(NamingGrpcClientProxy.java:289) ~[nacos-client-2.3.0.jar:na]
	at com.alibaba.nacos.client.naming.remote.gprc.NamingGrpcClientProxy.deregisterService(NamingGrpcClientProxy.java:272) ~[nacos-client-2.3.0.jar:na]
	at com.alibaba.nacos.client.naming.remote.NamingClientProxyDelegate.deregisterService(NamingClientProxyDelegate.java:125) ~[nacos-client-2.3.0.jar:na]
	at com.alibaba.nacos.client.naming.NacosNamingService.deregisterInstance(NacosNamingService.java:199) ~[nacos-client-2.3.0.jar:na]
	at com.alibaba.nacos.client.naming.NacosNamingService.deregisterInstance(NacosNamingService.java:187) ~[nacos-client-2.3.0.jar:na]
	at com.alibaba.cloud.nacos.registry.NacosServiceRegistry.deregister(NacosServiceRegistry.java:107) ~[spring-cloud-starter-alibaba-nacos-discovery-2021.0.5.0.jar:2021.0.5.0]
	at org.springframework.cloud.client.serviceregistry.AbstractAutoServiceRegistration.deregister(AbstractAutoServiceRegistration.java:249) ~[spring-cloud-commons-3.1.5.jar:3.1.5]
	at org.springframework.cloud.client.serviceregistry.AbstractAutoServiceRegistration.stop(AbstractAutoServiceRegistration.java:264) ~[spring-cloud-commons-3.1.5.jar:3.1.5]
	at org.springframework.cloud.client.serviceregistry.AbstractAutoServiceRegistration.destroy(AbstractAutoServiceRegistration.java:201) ~[spring-cloud-commons-3.1.5.jar:3.1.5]
	at java.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke0(Native Method) ~[na:na]
	at java.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:77) ~[na:na]
	at java.base/jdk.internal.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43) ~[na:na]
	at java.base/java.lang.reflect.Method.invoke(Method.java:568) ~[na:na]
	at org.springframework.beans.factory.annotation.InitDestroyAnnotationBeanPostProcessor$LifecycleElement.invoke(InitDestroyAnnotationBeanPostProcessor.java:389) ~[spring-beans-5.3.27.jar:5.3.27]
	at org.springframework.beans.factory.annotation.InitDestroyAnnotationBeanPostProcessor$LifecycleMetadata.invokeDestroyMethods(InitDestroyAnnotationBeanPostProcessor.java:347) ~[spring-beans-5.3.27.jar:5.3.27]
	at org.springframework.beans.factory.annotation.InitDestroyAnnotationBeanPostProcessor.postProcessBeforeDestruction(InitDestroyAnnotationBeanPostProcessor.java:177) ~[spring-beans-5.3.27.jar:5.3.27]
	at org.springframework.beans.factory.support.DisposableBeanAdapter.destroy(DisposableBeanAdapter.java:197) ~[spring-beans-5.3.27.jar:5.3.27]
	at org.springframework.beans.factory.support.DefaultSingletonBeanRegistry.destroyBean(DefaultSingletonBeanRegistry.java:587) ~[spring-beans-5.3.27.jar:5.3.27]
	at org.springframework.beans.factory.support.DefaultSingletonBeanRegistry.destroySingleton(DefaultSingletonBeanRegistry.java:559) ~[spring-beans-5.3.27.jar:5.3.27]
	at org.springframework.beans.factory.support.DefaultListableBeanFactory.destroySingleton(DefaultListableBeanFactory.java:1163) ~[spring-beans-5.3.27.jar:5.3.27]
	at org.springframework.beans.factory.support.DefaultSingletonBeanRegistry.destroySingletons(DefaultSingletonBeanRegistry.java:520) ~[spring-beans-5.3.27.jar:5.3.27]
	at org.springframework.beans.factory.support.DefaultListableBeanFactory.destroySingletons(DefaultListableBeanFactory.java:1156) ~[spring-beans-5.3.27.jar:5.3.27]
	at org.springframework.context.support.AbstractApplicationContext.destroyBeans(AbstractApplicationContext.java:1108) ~[spring-context-5.3.27.jar:5.3.27]
	at org.springframework.context.support.AbstractApplicationContext.doClose(AbstractApplicationContext.java:1077) ~[spring-context-5.3.27.jar:5.3.27]
	at org.springframework.boot.web.servlet.context.ServletWebServerApplicationContext.doClose(ServletWebServerApplicationContext.java:174) ~[spring-boot-2.7.12.jar:2.7.12]
	at org.springframework.context.support.AbstractApplicationContext.close(AbstractApplicationContext.java:1023) ~[spring-context-5.3.27.jar:5.3.27]
	at org.springframework.boot.SpringApplicationShutdownHook.closeAndWait(SpringApplicationShutdownHook.java:145) ~[spring-boot-2.7.12.jar:2.7.12]
	at java.base/java.lang.Iterable.forEach(Iterable.java:75) ~[na:na]
	at org.springframework.boot.SpringApplicationShutdownHook.run(SpringApplicationShutdownHook.java:114) ~[spring-boot-2.7.12.jar:2.7.12]
	at java.base/java.lang.Thread.run(Thread.java:840) ~[na:na]

22:07:38:165  INFO 35372 --- [SpringApplicationShutdownHook] c.a.c.n.registry.NacosServiceRegistry    : De-registration finished.
22:07:38:178  INFO 35372 --- [SpringApplicationShutdownHook] com.zaxxer.hikari.HikariDataSource       : HikariPool-1 - Shutdown initiated...
22:07:38:487  INFO 35372 --- [SpringApplicationShutdownHook] com.zaxxer.hikari.HikariDataSource       : HikariPool-1 - Shutdown completed.
22:07:45:902  INFO 37856 --- [main] c.l.his_service.HisServiceApplication    : Starting HisServiceApplication using Java 17.0.11 on luo with PID 37856 (A:\Desktop\workspace\HIS\his_service\target\classes started by 22407 in A:\Desktop\workspace\HIS)
22:07:45:903 DEBUG 37856 --- [main] c.l.his_service.HisServiceApplication    : Running with Spring Boot v2.7.12, Spring v5.3.27
22:07:45:904  INFO 37856 --- [main] c.l.his_service.HisServiceApplication    : The following 1 profile is active: "dev"
22:07:46:635 DEBUG 37856 --- [main] o.s.c.openfeign.FeignClientsRegistrar$1  : Identified candidate component class: file [A:\Desktop\workspace\HIS\his_api\target\classes\com\luojiawei\api\client\FlaskAiDoctorClient.class]
22:07:46:636 DEBUG 37856 --- [main] o.s.c.openfeign.FeignClientsRegistrar$1  : Identified candidate component class: file [A:\Desktop\workspace\HIS\his_api\target\classes\com\luojiawei\api\client\FlaskModelAnalyzeClient.class]
22:07:46:637 DEBUG 37856 --- [main] o.s.c.openfeign.FeignClientsRegistrar$1  : Identified candidate component class: file [A:\Desktop\workspace\HIS\his_api\target\classes\com\luojiawei\api\client\FlaskUploadClient.class]
22:07:47:005  INFO 37856 --- [main] .s.d.r.c.RepositoryConfigurationDelegate : Multiple Spring Data modules found, entering strict repository configuration mode
22:07:47:007  INFO 37856 --- [main] .s.d.r.c.RepositoryConfigurationDelegate : Bootstrapping Spring Data Redis repositories in DEFAULT mode.
22:07:47:036  INFO 37856 --- [main] .s.d.r.c.RepositoryConfigurationDelegate : Finished Spring Data repository scanning in 15 ms. Found 0 Redis repository interfaces.
22:07:47:318  INFO 37856 --- [main] o.s.cloud.context.scope.GenericScope     : BeanFactory id=15115e6d-eb61-304d-ae7c-b74e3e436bbc
22:07:47:949  INFO 37856 --- [main] o.s.b.w.embedded.tomcat.TomcatWebServer  : Tomcat initialized with port(s): 8080 (http)
22:07:47:959  INFO 37856 --- [main] o.apache.catalina.core.StandardService   : Starting service [Tomcat]
22:07:47:960  INFO 37856 --- [main] org.apache.catalina.core.StandardEngine  : Starting Servlet engine: [Apache Tomcat/9.0.75]
22:07:48:106  INFO 37856 --- [main] o.a.c.c.C.[Tomcat].[localhost].[/]       : Initializing Spring embedded WebApplicationContext
22:07:48:107  INFO 37856 --- [main] w.s.c.ServletWebServerApplicationContext : Root WebApplicationContext: initialization completed in 2155 ms
22:07:48:524  INFO 37856 --- [main] org.redisson.Version                     : Redisson 3.17.7
22:07:48:936  INFO 37856 --- [redisson-netty-2-9] o.r.c.pool.MasterPubSubConnectionPool    : 1 connections initialized for 111.230.32.147/111.230.32.147:9631
22:07:49:648  INFO 37856 --- [redisson-netty-2-19] o.r.c.pool.MasterConnectionPool          : 24 connections initialized for 111.230.32.147/111.230.32.147:9631
22:07:50:023 DEBUG 37856 --- [main] c.l.h.filter.RefreshTokenFilter          : Filter 'refreshTokenFilter' configured for use
22:07:50:933  INFO 37856 --- [main] o.s.c.openfeign.FeignClientFactoryBean   : For 'flask-service' URL not provided. Will try picking an instance via load-balancing.
22:07:51:259  INFO 37856 --- [main] o.s.c.openfeign.FeignClientFactoryBean   : For 'ai-doctor-service' URL not provided. Will try picking an instance via load-balancing.
22:07:52:992  WARN 37856 --- [main] iguration$LoadBalancerCaffeineWarnLogger : Spring Cloud LoadBalancer is currently working with the default cache. While this cache implementation is useful for development and tests, it's recommended to use Caffeine cache in production.You can switch to using Caffeine cache, by adding it and org.springframework.cache.caffeine.CaffeineCacheManager to the classpath.
22:07:52:997  INFO 37856 --- [main] o.s.b.a.e.web.EndpointLinksResolver      : Exposing 1 endpoint(s) beneath base path '/actuator'
22:07:53:100  INFO 37856 --- [main] o.s.b.w.embedded.tomcat.TomcatWebServer  : Tomcat started on port(s): 8080 (http) with context path ''
22:07:53:155  INFO 37856 --- [main] c.a.n.p.a.s.c.ClientAuthPluginManager    : [ClientAuthPluginManager] Load ClientAuthService com.alibaba.nacos.client.auth.impl.NacosClientAuthServiceImpl success.
22:07:53:155  INFO 37856 --- [main] c.a.n.p.a.s.c.ClientAuthPluginManager    : [ClientAuthPluginManager] Load ClientAuthService com.alibaba.nacos.client.auth.ram.RamClientAuthServiceImpl success.
22:07:54:256  INFO 37856 --- [main] c.a.n.c.a.AbstractAbilityControlManager  : Ready to get current node abilities...
22:07:54:257  INFO 37856 --- [main] c.a.n.c.a.AbstractAbilityControlManager  : Ready to initialize current node abilities, support modes: [SDK_CLIENT]
22:07:54:258  INFO 37856 --- [main] c.a.n.c.a.AbstractAbilityControlManager  : Initialize current abilities finish...
22:07:54:259  INFO 37856 --- [main] c.a.n.c.a.d.NacosAbilityManagerHolder    : [AbilityControlManager] Successfully initialize AbilityControlManager
22:07:54:352  INFO 37856 --- [main] c.a.c.n.registry.NacosServiceRegistry    : nacos registry, DEFAULT_GROUP his-service 10.21.93.70:8848 register finished
22:07:54:666  INFO 37856 --- [main] c.l.his_service.HisServiceApplication    : Started HisServiceApplication in 9.769 seconds (JVM running for 10.838)
22:07:54:784  INFO 37856 --- [RMI TCP Connection(3)-10.21.93.70] o.a.c.c.C.[Tomcat].[localhost].[/]       : Initializing Spring DispatcherServlet 'dispatcherServlet'
22:07:54:785  INFO 37856 --- [RMI TCP Connection(3)-10.21.93.70] o.s.web.servlet.DispatcherServlet        : Initializing Servlet 'dispatcherServlet'
22:07:54:786  INFO 37856 --- [RMI TCP Connection(3)-10.21.93.70] o.s.web.servlet.DispatcherServlet        : Completed initialization in 1 ms
22:07:54:789  INFO 37856 --- [RMI TCP Connection(2)-10.21.93.70] com.zaxxer.hikari.HikariDataSource       : HikariPool-1 - Starting...
22:07:55:368  INFO 37856 --- [RMI TCP Connection(2)-10.21.93.70] com.zaxxer.hikari.HikariDataSource       : HikariPool-1 - Start completed.
22:08:06:849 ERROR 37856 --- [http-nio-8080-exec-2] o.a.c.c.C.[.[.[/].[dispatcherServlet]    : Servlet.service() for servlet [dispatcherServlet] in context with path [] threw exception [Request processing failed; nested exception is java.lang.NullPointerException: Cannot invoke "java.util.ArrayList.add(Object)" because the return value of "com.luojiawei.common.domain.vo.RecommendedQuestions.getQuestions()" is null] with root cause

java.lang.NullPointerException: Cannot invoke "java.util.ArrayList.add(Object)" because the return value of "com.luojiawei.common.domain.vo.RecommendedQuestions.getQuestions()" is null
	at com.luojiawei.his_service.controller.DiagnosisReportController.getQuestions(DiagnosisReportController.java:60) ~[classes/:na]
	at java.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke0(Native Method) ~[na:na]
	at java.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:77) ~[na:na]
	at java.base/jdk.internal.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43) ~[na:na]
	at java.base/java.lang.reflect.Method.invoke(Method.java:568) ~[na:na]
	at org.springframework.web.method.support.InvocableHandlerMethod.doInvoke(InvocableHandlerMethod.java:205) ~[spring-web-5.3.27.jar:5.3.27]
	at org.springframework.web.method.support.InvocableHandlerMethod.invokeForRequest(InvocableHandlerMethod.java:150) ~[spring-web-5.3.27.jar:5.3.27]
	at org.springframework.web.servlet.mvc.method.annotation.ServletInvocableHandlerMethod.invokeAndHandle(ServletInvocableHandlerMethod.java:117) ~[spring-webmvc-5.3.27.jar:5.3.27]
	at org.springframework.web.servlet.mvc.method.annotation.RequestMappingHandlerAdapter.invokeHandlerMethod(RequestMappingHandlerAdapter.java:895) ~[spring-webmvc-5.3.27.jar:5.3.27]
	at org.springframework.web.servlet.mvc.method.annotation.RequestMappingHandlerAdapter.handleInternal(RequestMappingHandlerAdapter.java:808) ~[spring-webmvc-5.3.27.jar:5.3.27]
	at org.springframework.web.servlet.mvc.method.AbstractHandlerMethodAdapter.handle(AbstractHandlerMethodAdapter.java:87) ~[spring-webmvc-5.3.27.jar:5.3.27]
	at org.springframework.web.servlet.DispatcherServlet.doDispatch(DispatcherServlet.java:1072) ~[spring-webmvc-5.3.27.jar:5.3.27]
	at org.springframework.web.servlet.DispatcherServlet.doService(DispatcherServlet.java:965) ~[spring-webmvc-5.3.27.jar:5.3.27]
	at org.springframework.web.servlet.FrameworkServlet.processRequest(FrameworkServlet.java:1006) ~[spring-webmvc-5.3.27.jar:5.3.27]
	at org.springframework.web.servlet.FrameworkServlet.doGet(FrameworkServlet.java:898) ~[spring-webmvc-5.3.27.jar:5.3.27]
	at javax.servlet.http.HttpServlet.service(HttpServlet.java:529) ~[tomcat-embed-core-9.0.75.jar:4.0.FR]
	at org.springframework.web.servlet.FrameworkServlet.service(FrameworkServlet.java:883) ~[spring-webmvc-5.3.27.jar:5.3.27]
	at javax.servlet.http.HttpServlet.service(HttpServlet.java:623) ~[tomcat-embed-core-9.0.75.jar:4.0.FR]
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:209) ~[tomcat-embed-core-9.0.75.jar:9.0.75]
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:153) ~[tomcat-embed-core-9.0.75.jar:9.0.75]
	at com.luojiawei.his_service.filter.RefreshTokenFilter.doFilterInternal(RefreshTokenFilter.java:58) ~[classes/:na]
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:117) ~[spring-web-5.3.27.jar:5.3.27]
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:178) ~[tomcat-embed-core-9.0.75.jar:9.0.75]
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:153) ~[tomcat-embed-core-9.0.75.jar:9.0.75]
	at org.springframework.web.filter.RequestContextFilter.doFilterInternal(RequestContextFilter.java:100) ~[spring-web-5.3.27.jar:5.3.27]
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:117) ~[spring-web-5.3.27.jar:5.3.27]
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:178) ~[tomcat-embed-core-9.0.75.jar:9.0.75]
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:153) ~[tomcat-embed-core-9.0.75.jar:9.0.75]
	at org.springframework.web.filter.FormContentFilter.doFilterInternal(FormContentFilter.java:93) ~[spring-web-5.3.27.jar:5.3.27]
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:117) ~[spring-web-5.3.27.jar:5.3.27]
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:178) ~[tomcat-embed-core-9.0.75.jar:9.0.75]
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:153) ~[tomcat-embed-core-9.0.75.jar:9.0.75]
	at org.springframework.boot.actuate.metrics.web.servlet.WebMvcMetricsFilter.doFilterInternal(WebMvcMetricsFilter.java:96) ~[spring-boot-actuator-2.7.12.jar:2.7.12]
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:117) ~[spring-web-5.3.27.jar:5.3.27]
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:178) ~[tomcat-embed-core-9.0.75.jar:9.0.75]
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:153) ~[tomcat-embed-core-9.0.75.jar:9.0.75]
	at org.springframework.web.filter.CharacterEncodingFilter.doFilterInternal(CharacterEncodingFilter.java:201) ~[spring-web-5.3.27.jar:5.3.27]
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:117) ~[spring-web-5.3.27.jar:5.3.27]
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:178) ~[tomcat-embed-core-9.0.75.jar:9.0.75]
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:153) ~[tomcat-embed-core-9.0.75.jar:9.0.75]
	at org.apache.catalina.core.StandardWrapperValve.invoke(StandardWrapperValve.java:167) ~[tomcat-embed-core-9.0.75.jar:9.0.75]
	at org.apache.catalina.core.StandardContextValve.invoke(StandardContextValve.java:90) ~[tomcat-embed-core-9.0.75.jar:9.0.75]
	at org.apache.catalina.authenticator.AuthenticatorBase.invoke(AuthenticatorBase.java:481) ~[tomcat-embed-core-9.0.75.jar:9.0.75]
	at org.apache.catalina.core.StandardHostValve.invoke(StandardHostValve.java:130) ~[tomcat-embed-core-9.0.75.jar:9.0.75]
	at org.apache.catalina.valves.ErrorReportValve.invoke(ErrorReportValve.java:93) ~[tomcat-embed-core-9.0.75.jar:9.0.75]
	at org.apache.catalina.core.StandardEngineValve.invoke(StandardEngineValve.java:74) ~[tomcat-embed-core-9.0.75.jar:9.0.75]
	at org.apache.catalina.connector.CoyoteAdapter.service(CoyoteAdapter.java:343) ~[tomcat-embed-core-9.0.75.jar:9.0.75]
	at org.apache.coyote.http11.Http11Processor.service(Http11Processor.java:390) ~[tomcat-embed-core-9.0.75.jar:9.0.75]
	at org.apache.coyote.AbstractProcessorLight.process(AbstractProcessorLight.java:63) ~[tomcat-embed-core-9.0.75.jar:9.0.75]
	at org.apache.coyote.AbstractProtocol$ConnectionHandler.process(AbstractProtocol.java:926) ~[tomcat-embed-core-9.0.75.jar:9.0.75]
	at org.apache.tomcat.util.net.NioEndpoint$SocketProcessor.doRun(NioEndpoint.java:1791) ~[tomcat-embed-core-9.0.75.jar:9.0.75]
	at org.apache.tomcat.util.net.SocketProcessorBase.run(SocketProcessorBase.java:52) ~[tomcat-embed-core-9.0.75.jar:9.0.75]
	at org.apache.tomcat.util.threads.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1191) ~[tomcat-embed-core-9.0.75.jar:9.0.75]
	at org.apache.tomcat.util.threads.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:659) ~[tomcat-embed-core-9.0.75.jar:9.0.75]
	at org.apache.tomcat.util.threads.TaskThread$WrappingRunnable.run(TaskThread.java:61) ~[tomcat-embed-core-9.0.75.jar:9.0.75]
	at java.base/java.lang.Thread.run(Thread.java:840) ~[na:na]

22:09:00:650  WARN 37856 --- [Thread-15] c.a.nacos.common.notify.NotifyCenter     : [NotifyCenter] Start destroying Publisher
22:09:00:651  WARN 37856 --- [Thread-18] c.a.n.common.http.HttpClientBeanHolder   : [HttpClientBeanHolder] Start destroying common HttpClient
22:09:00:652  WARN 37856 --- [Thread-15] c.a.nacos.common.notify.NotifyCenter     : [NotifyCenter] Destruction of the end
22:09:00:652  WARN 37856 --- [Thread-18] c.a.n.common.http.HttpClientBeanHolder   : [HttpClientBeanHolder] Destruction of the end
22:09:00:725  INFO 37856 --- [SpringApplicationShutdownHook] c.a.c.n.registry.NacosServiceRegistry    : De-registering from Nacos Server now...
22:09:00:761  INFO 37856 --- [SpringApplicationShutdownHook] c.a.c.n.registry.NacosServiceRegistry    : De-registration finished.
22:09:00:775  INFO 37856 --- [SpringApplicationShutdownHook] com.zaxxer.hikari.HikariDataSource       : HikariPool-1 - Shutdown initiated...
22:09:01:080  INFO 37856 --- [SpringApplicationShutdownHook] com.zaxxer.hikari.HikariDataSource       : HikariPool-1 - Shutdown completed.
22:09:08:421  INFO 35208 --- [main] c.l.his_service.HisServiceApplication    : Starting HisServiceApplication using Java 17.0.11 on luo with PID 35208 (A:\Desktop\workspace\HIS\his_service\target\classes started by 22407 in A:\Desktop\workspace\HIS)
22:09:08:422 DEBUG 35208 --- [main] c.l.his_service.HisServiceApplication    : Running with Spring Boot v2.7.12, Spring v5.3.27
22:09:08:422  INFO 35208 --- [main] c.l.his_service.HisServiceApplication    : The following 1 profile is active: "dev"
22:09:09:179 DEBUG 35208 --- [main] o.s.c.openfeign.FeignClientsRegistrar$1  : Identified candidate component class: file [A:\Desktop\workspace\HIS\his_api\target\classes\com\luojiawei\api\client\FlaskAiDoctorClient.class]
22:09:09:180 DEBUG 35208 --- [main] o.s.c.openfeign.FeignClientsRegistrar$1  : Identified candidate component class: file [A:\Desktop\workspace\HIS\his_api\target\classes\com\luojiawei\api\client\FlaskModelAnalyzeClient.class]
22:09:09:180 DEBUG 35208 --- [main] o.s.c.openfeign.FeignClientsRegistrar$1  : Identified candidate component class: file [A:\Desktop\workspace\HIS\his_api\target\classes\com\luojiawei\api\client\FlaskUploadClient.class]
22:09:09:628  INFO 35208 --- [main] .s.d.r.c.RepositoryConfigurationDelegate : Multiple Spring Data modules found, entering strict repository configuration mode
22:09:09:631  INFO 35208 --- [main] .s.d.r.c.RepositoryConfigurationDelegate : Bootstrapping Spring Data Redis repositories in DEFAULT mode.
22:09:09:661  INFO 35208 --- [main] .s.d.r.c.RepositoryConfigurationDelegate : Finished Spring Data repository scanning in 15 ms. Found 0 Redis repository interfaces.
22:09:09:973  INFO 35208 --- [main] o.s.cloud.context.scope.GenericScope     : BeanFactory id=15115e6d-eb61-304d-ae7c-b74e3e436bbc
22:09:10:603  INFO 35208 --- [main] o.s.b.w.embedded.tomcat.TomcatWebServer  : Tomcat initialized with port(s): 8080 (http)
22:09:10:612  INFO 35208 --- [main] o.apache.catalina.core.StandardService   : Starting service [Tomcat]
22:09:10:612  INFO 35208 --- [main] org.apache.catalina.core.StandardEngine  : Starting Servlet engine: [Apache Tomcat/9.0.75]
22:09:10:778  INFO 35208 --- [main] o.a.c.c.C.[Tomcat].[localhost].[/]       : Initializing Spring embedded WebApplicationContext
22:09:10:779  INFO 35208 --- [main] w.s.c.ServletWebServerApplicationContext : Root WebApplicationContext: initialization completed in 2308 ms
22:09:11:220  INFO 35208 --- [main] org.redisson.Version                     : Redisson 3.17.7
22:09:11:632  INFO 35208 --- [redisson-netty-2-9] o.r.c.pool.MasterPubSubConnectionPool    : 1 connections initialized for 111.230.32.147/111.230.32.147:9631
22:09:12:319  INFO 35208 --- [redisson-netty-2-19] o.r.c.pool.MasterConnectionPool          : 24 connections initialized for 111.230.32.147/111.230.32.147:9631
22:09:12:627 DEBUG 35208 --- [main] c.l.h.filter.RefreshTokenFilter          : Filter 'refreshTokenFilter' configured for use
22:09:13:443  INFO 35208 --- [main] o.s.c.openfeign.FeignClientFactoryBean   : For 'flask-service' URL not provided. Will try picking an instance via load-balancing.
22:09:13:748  INFO 35208 --- [main] o.s.c.openfeign.FeignClientFactoryBean   : For 'ai-doctor-service' URL not provided. Will try picking an instance via load-balancing.
22:09:15:421  WARN 35208 --- [main] iguration$LoadBalancerCaffeineWarnLogger : Spring Cloud LoadBalancer is currently working with the default cache. While this cache implementation is useful for development and tests, it's recommended to use Caffeine cache in production.You can switch to using Caffeine cache, by adding it and org.springframework.cache.caffeine.CaffeineCacheManager to the classpath.
22:09:15:428  INFO 35208 --- [main] o.s.b.a.e.web.EndpointLinksResolver      : Exposing 1 endpoint(s) beneath base path '/actuator'
22:09:15:521  INFO 35208 --- [main] o.s.b.w.embedded.tomcat.TomcatWebServer  : Tomcat started on port(s): 8080 (http) with context path ''
22:09:15:561  INFO 35208 --- [main] c.a.n.p.a.s.c.ClientAuthPluginManager    : [ClientAuthPluginManager] Load ClientAuthService com.alibaba.nacos.client.auth.impl.NacosClientAuthServiceImpl success.
22:09:15:561  INFO 35208 --- [main] c.a.n.p.a.s.c.ClientAuthPluginManager    : [ClientAuthPluginManager] Load ClientAuthService com.alibaba.nacos.client.auth.ram.RamClientAuthServiceImpl success.
22:09:16:791  INFO 35208 --- [main] c.a.n.c.a.AbstractAbilityControlManager  : Ready to get current node abilities...
22:09:16:792  INFO 35208 --- [main] c.a.n.c.a.AbstractAbilityControlManager  : Ready to initialize current node abilities, support modes: [SDK_CLIENT]
22:09:16:793  INFO 35208 --- [main] c.a.n.c.a.AbstractAbilityControlManager  : Initialize current abilities finish...
22:09:16:793  INFO 35208 --- [main] c.a.n.c.a.d.NacosAbilityManagerHolder    : [AbilityControlManager] Successfully initialize AbilityControlManager
22:09:16:888  INFO 35208 --- [main] c.a.c.n.registry.NacosServiceRegistry    : nacos registry, DEFAULT_GROUP his-service 10.21.93.70:8848 register finished
22:09:17:163  INFO 35208 --- [main] c.l.his_service.HisServiceApplication    : Started HisServiceApplication in 9.835 seconds (JVM running for 10.933)
22:09:17:743  INFO 35208 --- [RMI TCP Connection(3)-10.21.93.70] o.a.c.c.C.[Tomcat].[localhost].[/]       : Initializing Spring DispatcherServlet 'dispatcherServlet'
22:09:17:743  INFO 35208 --- [RMI TCP Connection(3)-10.21.93.70] o.s.web.servlet.DispatcherServlet        : Initializing Servlet 'dispatcherServlet'
22:09:17:747  INFO 35208 --- [RMI TCP Connection(3)-10.21.93.70] o.s.web.servlet.DispatcherServlet        : Completed initialization in 4 ms
22:09:17:749  INFO 35208 --- [RMI TCP Connection(2)-10.21.93.70] com.zaxxer.hikari.HikariDataSource       : HikariPool-1 - Starting...
22:09:18:334  INFO 35208 --- [RMI TCP Connection(2)-10.21.93.70] com.zaxxer.hikari.HikariDataSource       : HikariPool-1 - Start completed.
22:10:24:406  WARN 35208 --- [Thread-15] c.a.nacos.common.notify.NotifyCenter     : [NotifyCenter] Start destroying Publisher
22:10:24:406  WARN 35208 --- [Thread-18] c.a.n.common.http.HttpClientBeanHolder   : [HttpClientBeanHolder] Start destroying common HttpClient
22:10:24:407  WARN 35208 --- [Thread-15] c.a.nacos.common.notify.NotifyCenter     : [NotifyCenter] Destruction of the end
22:10:24:407  WARN 35208 --- [Thread-18] c.a.n.common.http.HttpClientBeanHolder   : [HttpClientBeanHolder] Destruction of the end
22:10:24:452  INFO 35208 --- [SpringApplicationShutdownHook] c.a.c.n.registry.NacosServiceRegistry    : De-registering from Nacos Server now...
22:10:24:486  INFO 35208 --- [SpringApplicationShutdownHook] c.a.c.n.registry.NacosServiceRegistry    : De-registration finished.
22:10:24:499  INFO 35208 --- [SpringApplicationShutdownHook] com.zaxxer.hikari.HikariDataSource       : HikariPool-1 - Shutdown initiated...
22:10:24:812  INFO 35208 --- [SpringApplicationShutdownHook] com.zaxxer.hikari.HikariDataSource       : HikariPool-1 - Shutdown completed.
